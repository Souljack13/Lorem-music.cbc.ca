/*
 * Third Party Lib
 * Copyright(c), CBC Music.
 */


if(typeof(Control)=='undefined')
Control={};var $proc=function(proc){return typeof(proc)=='function'?proc:function(){return proc};};var $value=function(value){return typeof(value)=='function'?value():value;};Object.Event={extend:function(object){object._objectEventSetup=function(event_name){this._observers=this._observers||{};this._observers[event_name]=this._observers[event_name]||[];};object.observe=function(event_name,observer){if(typeof(event_name)=='string'&&typeof(observer)!='undefined'){this._objectEventSetup(event_name);if(!this._observers[event_name].include(observer))
this._observers[event_name].push(observer);}else
for(var e in event_name)
this.observe(e,event_name[e]);};object.stopObserving=function(event_name,observer){this._objectEventSetup(event_name);if(event_name&&observer)
this._observers[event_name]=this._observers[event_name].without(observer);else if(event_name)
this._observers[event_name]=[];else
this._observers={};};object.observeOnce=function(event_name,outer_observer){var inner_observer=function(){outer_observer.apply(this,arguments);this.stopObserving(event_name,inner_observer);}.bind(this);this._objectEventSetup(event_name);this._observers[event_name].push(inner_observer);};object.notify=function(event_name){this._objectEventSetup(event_name);var collected_return_values=[];var args=$A(arguments).slice(1);try{for(var i=0;i<this._observers[event_name].length;++i)
collected_return_values.push(this._observers[event_name][i].apply(this,args)||null);}catch(e){if(e==$break)
return false;else
throw e;}
return collected_return_values;};if(object.prototype){object.prototype._objectEventSetup=object._objectEventSetup;object.prototype.observe=object.observe;object.prototype.stopObserving=object.stopObserving;object.prototype.observeOnce=object.observeOnce;object.prototype.notify=function(event_name){if(object.notify){var args=$A(arguments).slice(1);args.unshift(this);args.unshift(event_name);object.notify.apply(object,args);}
this._objectEventSetup(event_name);var args=$A(arguments).slice(1);var collected_return_values=[];try{if(this.options&&this.options[event_name]&&typeof(this.options[event_name])=='function')
collected_return_values.push(this.options[event_name].apply(this,args)||null);var callbacks_copy=this._observers[event_name];for(var i=0;i<callbacks_copy.length;++i)
collected_return_values.push(callbacks_copy[i].apply(this,args)||null);}catch(e){if(e==$break)
return false;else
throw e;}
return collected_return_values;};}}};Element.addMethods({observeOnce:function(element,event_name,outer_callback){var inner_callback=function(){outer_callback.apply(this,arguments);Element.stopObserving(element,event_name,inner_callback);};Element.observe(element,event_name,inner_callback);}});(function(){function wheel(event){var delta,element,custom_event;if(event.wheelDelta){delta=event.wheelDelta/120;}else if(event.detail){delta=-event.detail/3;}
if(!delta){return;}
element=Event.extend(event).target;element=Element.extend(element.nodeType===Node.TEXT_NODE?element.parentNode:element);custom_event=element.fire('mouse:wheel',{delta:delta});if(custom_event.stopped){Event.stop(event);return false;}}
document.observe('mousewheel',wheel);document.observe('DOMMouseScroll',wheel);})();var IframeShim=Class.create({initialize:function(){this.element=new Element('iframe',{style:'position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);display:none',src:'javascript:void(0);',frameborder:0});$(document.body).insert(this.element);},hide:function(){this.element.hide();return this;},show:function(){this.element.show();return this;},positionUnder:function(element){var element=$(element);var offset=element.cumulativeOffset();var dimensions=element.getDimensions();this.element.setStyle({left:offset[0]+'px',top:offset[1]+'px',width:dimensions.width+'px',height:dimensions.height+'px',zIndex:element.getStyle('zIndex')-1}).show();return this;},setBounds:function(bounds){for(prop in bounds)
bounds[prop]+='px';this.element.setStyle(bounds);return this;},destroy:function(){if(this.element)
this.element.remove();return this;}});

if(typeof(Draggable)!='undefined'){Draggable.prototype.draw=function(point){var pos=Position.cumulativeOffset(this.element);if(this.options.ghosting){var r=Position.realOffset(this.element);pos[0]+=r[0]-Position.deltaX;pos[1]+=r[1]-Position.deltaY;}
var d=this.currentDelta();pos[0]-=d[0];pos[1]-=d[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){pos[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;pos[1]-=this.options.scroll.scrollTop-this.originalScrollTop;}
var p=[0,1].map(function(i){return(point[i]-pos[i]-this.offset[i])}.bind(this));if(this.options.snap){if(typeof this.options.snap=='function'){p=this.options.snap(p[0],p[1],this);}else{if(this.options.snap instanceof Array){p=p.map(function(v,i){return Math.round(v/this.options.snap[i])*this.options.snap[i]}.bind(this))}else{p=p.map(function(v){return Math.round(v/this.options.snap)*this.options.snap}.bind(this))}}}
if(this.options.onDraw)
this.options.onDraw.bind(this)(p);else{var style=this.element.style;if(this.options.constrainToViewport){var viewport_dimensions=document.viewport.getDimensions();var container_dimensions=this.element.getDimensions();var margin_top=parseInt(this.element.getStyle('margin-top'));var margin_left=parseInt(this.element.getStyle('margin-left'));var boundary=[[0-margin_left,0-margin_top],[(viewport_dimensions.width-container_dimensions.width)-margin_left,(viewport_dimensions.height-container_dimensions.height)-margin_top]];if((!this.options.constraint)||(this.options.constraint=='horizontal')){if((p[0]>=boundary[0][0])&&(p[0]<=boundary[1][0]))
this.element.style.left=p[0]+"px";else
this.element.style.left=((p[0]<boundary[0][0])?boundary[0][0]:boundary[1][0])+"px";}
if((!this.options.constraint)||(this.options.constraint=='vertical')){if((p[1]>=boundary[0][1])&&(p[1]<=boundary[1][1]))
this.element.style.top=p[1]+"px";else
this.element.style.top=((p[1]<=boundary[0][1])?boundary[0][1]:boundary[1][1])+"px";}}else{if((!this.options.constraint)||(this.options.constraint=='horizontal'))
style.left=p[0]+"px";if((!this.options.constraint)||(this.options.constraint=='vertical'))
style.top=p[1]+"px";}
if(style.visibility=="hidden")
style.visibility="";}};}
if(typeof(Prototype)=="undefined")
throw"Control.Window requires Prototype to be loaded.";if(typeof(IframeShim)=="undefined")
throw"Control.Window requires IframeShim to be loaded.";if(typeof(Object.Event)=="undefined")
throw"Control.Window requires Object.Event to be loaded.";Control.Window=Class.create({initialize:function(container,options){Control.Window.windows.push(this);this.container=false;this.isOpen=false;this.href=false;this.sourceContainer=false;this.ajaxRequest=false;this.remoteContentLoaded=false;this.numberInSequence=Control.Window.windows.length+1;this.indicator=false;this.effects={fade:false,appear:false};this.indicatorEffects={fade:false,appear:false};this.options=Object.extend({beforeOpen:Prototype.emptyFunction,afterOpen:Prototype.emptyFunction,beforeClose:Prototype.emptyFunction,afterClose:Prototype.emptyFunction,height:null,width:null,className:false,position:'center',offsetLeft:0,offsetTop:0,iframe:false,hover:false,indicator:false,closeOnClick:false,iframeshim:true,fade:false,fadeDuration:0.75,draggable:false,onDrag:Prototype.emptyFunction,resizable:false,minHeight:false,minWidth:false,maxHeight:false,maxWidth:false,onResize:Prototype.emptyFunction,constrainToViewport:false,method:'post',parameters:{},onComplete:Prototype.emptyFunction,onSuccess:Prototype.emptyFunction,onFailure:Prototype.emptyFunction,onException:Prototype.emptyFunction,onRemoteContentLoaded:Prototype.emptyFunction,insertRemoteContentAt:false},options||{});this.indicator=this.options.indicator?$(this.options.indicator):false;if(container){if(typeof(container)=="string"&&container.match(Control.Window.uriRegex))
this.href=container;else{this.container=$(container);this.createDefaultContainer(container);if(this.container&&((this.container.readAttribute('href')&&this.container.readAttribute('href')!='')||(this.options.hover&&this.options.hover!==true))){if(this.options.hover&&this.options.hover!==true)
this.sourceContainer=$(this.options.hover);else{this.sourceContainer=this.container;this.href=this.container.readAttribute('href');var rel=this.href.match(/^#(.+)$/);if(rel&&rel[1]){this.container=$(rel[1]);this.href=false;}else
this.container=false;}
this.sourceContainerOpenHandler=function(event){this.open(event);event.stop();return false;}.bindAsEventListener(this);this.sourceContainerCloseHandler=function(event){this.close(event);}.bindAsEventListener(this);this.sourceContainerMouseMoveHandler=function(event){this.position(event);}.bindAsEventListener(this);if(this.options.hover){this.sourceContainer.observe('mouseenter',this.sourceContainerOpenHandler);this.sourceContainer.observe('mouseleave',this.sourceContainerCloseHandler);if(this.options.position=='mouse')
this.sourceContainer.observe('mousemove',this.sourceContainerMouseMoveHandler);}else
this.sourceContainer.observe('click',this.sourceContainerOpenHandler);}}}
this.createDefaultContainer(container);if(this.options.insertRemoteContentAt===false)
this.options.insertRemoteContentAt=this.container;var styles={margin:0,position:'absolute',zIndex:Control.Window.initialZIndexForWindow()};if(this.options.width)
styles.width=$value(this.options.width)+'px';if(this.options.height)
styles.height=$value(this.options.height)+'px';this.container.setStyle(styles);if(this.options.className)
this.container.addClassName(this.options.className);this.positionHandler=this.position.bindAsEventListener(this);this.outOfBoundsPositionHandler=this.ensureInBounds.bindAsEventListener(this);this.bringToFrontHandler=this.bringToFront.bindAsEventListener(this);this.container.observe('mousedown',this.bringToFrontHandler);this.container.hide();this.closeHandler=this.close.bindAsEventListener(this);if(this.options.iframeshim){this.iFrameShim=new IframeShim();this.iFrameShim.hide();}
this.applyResizable();this.applyDraggable();Event.observe(window,'resize',this.outOfBoundsPositionHandler);this.notify('afterInitialize');},open:function(event){if(this.isOpen){this.bringToFront();return false;}
if(this.notify('beforeOpen')===false)
return false;if(this.options.closeOnClick){if(this.options.closeOnClick===true)
this.closeOnClickContainer=$(document.body);else if(this.options.closeOnClick=='container')
this.closeOnClickContainer=this.container;else if(this.options.closeOnClick=='overlay'){Control.Overlay.load();this.closeOnClickContainer=Control.Overlay.container;}else
this.closeOnClickContainer=$(this.options.closeOnClick);this.closeOnClickContainer.observe('click',this.closeHandler);}
if(this.href&&!this.options.iframe&&!this.remoteContentLoaded){this.remoteContentLoaded=true;if(this.href.match(/\.(jpe?g|gif|png|tiff?)$/i)){var img=new Element('img');img.observe('load',function(img){this.getRemoteContentInsertionTarget().insert(img);this.position();if(this.notify('onRemoteContentLoaded')!==false){if(this.options.indicator)
this.hideIndicator();this.finishOpen();}}.bind(this,img));img.writeAttribute('src',this.href);}else{if(!this.ajaxRequest){if(this.options.indicator)
this.showIndicator();this.ajaxRequest=new Ajax.Request(this.href,{method:this.options.method,parameters:this.options.parameters,onComplete:function(request){this.notify('onComplete',request);this.ajaxRequest=false;}.bind(this),onSuccess:function(request){this.getRemoteContentInsertionTarget().insert(request.responseText);this.notify('onSuccess',request);if(this.notify('onRemoteContentLoaded')!==false){if(this.options.indicator)
this.hideIndicator();this.finishOpen();}}.bind(this),onFailure:function(request){this.notify('onFailure',request);if(this.options.indicator)
this.hideIndicator();}.bind(this),onException:function(request,e){this.notify('onException',request,e);if(this.options.indicator)
this.hideIndicator();}.bind(this)});}}
return true;}else if(this.options.iframe&&!this.remoteContentLoaded){this.remoteContentLoaded=true;if(this.options.indicator)
this.showIndicator();this.getRemoteContentInsertionTarget().insert(Control.Window.iframeTemplate.evaluate({href:this.href}));var iframe=this.container.down('iframe');iframe.onload=function(){this.notify('onRemoteContentLoaded');if(this.options.indicator)
this.hideIndicator();iframe.onload=null;}.bind(this);}
this.finishOpen(event);return true},close:function(event){if(!this.isOpen||this.notify('beforeClose',event)===false)
return false;if(this.options.closeOnClick)
this.closeOnClickContainer.stopObserving('click',this.closeHandler);if(this.options.fade){this.effects.fade=new Effect.Fade(this.container,{queue:{position:'front',scope:'Control.Window'+this.numberInSequence},from:1,to:0,duration:this.options.fadeDuration/2,afterFinish:function(){if(this.iFrameShim)
this.iFrameShim.hide();this.isOpen=false;this.notify('afterClose');}.bind(this)});}else{this.container.hide();if(this.iFrameShim)
this.iFrameShim.hide();}
if(this.ajaxRequest)
this.ajaxRequest.transport.abort();if(!(this.options.draggable||this.options.resizable)&&this.options.position=='center')
Event.stopObserving(window,'resize',this.positionHandler);if(!this.options.draggable&&this.options.position=='center')
Event.stopObserving(window,'scroll',this.positionHandler);if(this.options.indicator)
this.hideIndicator();if(!this.options.fade){this.isOpen=false;this.notify('afterClose');}
return true;},position:function(event){if(this.options.position=='mouse'){var xy=[Event.pointerX(event),Event.pointerY(event)];this.container.setStyle({top:xy[1]+$value(this.options.offsetTop)+'px',left:xy[0]+$value(this.options.offsetLeft)+'px'});return;}
var container_dimensions=this.container.getDimensions();var viewport_dimensions=document.viewport.getDimensions();Position.prepare();var offset_left=(Position.deltaX+Math.floor((viewport_dimensions.width-container_dimensions.width)/2));var offset_top=(Position.deltaY+((viewport_dimensions.height>container_dimensions.height)?Math.floor((viewport_dimensions.height-container_dimensions.height)/2):0));if(this.options.position=='center'){this.container.setStyle({top:(container_dimensions.height<=viewport_dimensions.height)?((offset_top!=null&&offset_top>0)?offset_top:0)+'px':0,left:(container_dimensions.width<=viewport_dimensions.width)?((offset_left!=null&&offset_left>0)?offset_left:0)+'px':0});}else if(this.options.position=='relative'){var xy=this.sourceContainer.cumulativeOffset();var top=xy[1]+$value(this.options.offsetTop);var left=xy[0]+$value(this.options.offsetLeft);this.container.setStyle({top:(container_dimensions.height<=viewport_dimensions.height)?(this.options.constrainToViewport?Math.max(0,Math.min(viewport_dimensions.height-(container_dimensions.height),top)):top)+'px':0,left:(container_dimensions.width<=viewport_dimensions.width)?(this.options.constrainToViewport?Math.max(0,Math.min(viewport_dimensions.width-(container_dimensions.width),left)):left)+'px':0});}else if(this.options.position.length){var top=$value(this.options.position[1])+$value(this.options.offsetTop);var left=$value(this.options.position[0])+$value(this.options.offsetLeft);this.container.setStyle({top:(container_dimensions.height<=viewport_dimensions.height)?(this.options.constrainToViewport?Math.max(0,Math.min(viewport_dimensions.height-(container_dimensions.height),top)):top)+'px':0,left:(container_dimensions.width<=viewport_dimensions.width)?(this.options.constrainToViewport?Math.max(0,Math.min(viewport_dimensions.width-(container_dimensions.width),left)):left)+'px':0});}
if(this.iFrameShim)
this.updateIFrameShimZIndex();},ensureInBounds:function(){if(!this.isOpen)
return;var viewport_dimensions=document.viewport.getDimensions();var container_offset=this.container.cumulativeOffset();var container_dimensions=this.container.getDimensions();if(container_offset.left+container_dimensions.width>viewport_dimensions.width){this.container.setStyle({left:(Math.max(0,viewport_dimensions.width-container_dimensions.width))+'px'});}
if(container_offset.top+container_dimensions.height>viewport_dimensions.height){this.container.setStyle({top:(Math.max(0,viewport_dimensions.height-container_dimensions.height))+'px'});}},bringToFront:function(){Control.Window.bringToFront(this);this.notify('bringToFront');},destroy:function(){this.container.stopObserving('mousedown',this.bringToFrontHandler);if(this.draggable){Resizables.removeObserver(this.container);this.draggable.handle.stopObserving('mousedown',this.bringToFrontHandler);this.draggable.destroy();}
if(this.resizable){Resizables.removeObserver(this.container);this.resizable.handle.stopObserving('mousedown',this.bringToFrontHandler);this.resizable.destroy();}
if(this.container&&!this.sourceContainer)
this.container.remove();if(this.sourceContainer){if(this.options.hover){this.sourceContainer.stopObserving('mouseenter',this.sourceContainerOpenHandler);this.sourceContainer.stopObserving('mouseleave',this.sourceContainerCloseHandler);if(this.options.position=='mouse')
this.sourceContainer.stopObserving('mousemove',this.sourceContainerMouseMoveHandler);}else
this.sourceContainer.stopObserving('click',this.sourceContainerOpenHandler);}
if(this.iFrameShim)
this.iFrameShim.destroy();Event.stopObserving(window,'resize',this.outOfBoundsPositionHandler);Control.Window.windows=Control.Window.windows.without(this);this.notify('afterDestroy');},applyResizable:function(){if(this.options.resizable){if(typeof(Resizable)=="undefined")
throw"Control.Window requires resizable.js to be loaded.";var resizable_handle=null;if(this.options.resizable===true){resizable_handle=new Element('div',{className:'resizable_handle'});this.container.insert(resizable_handle);}else
resizable_handle=$(this.options.resziable);this.resizable=new Resizable(this.container,{handle:resizable_handle,minHeight:this.options.minHeight,minWidth:this.options.minWidth,maxHeight:this.options.constrainToViewport?function(element){return(document.viewport.getDimensions().height-parseInt(element.style.top||0))-(element.getHeight()-parseInt(element.style.height||0));}:this.options.maxHeight,maxWidth:this.options.constrainToViewport?function(element){return(document.viewport.getDimensions().width-parseInt(element.style.left||0))-(element.getWidth()-parseInt(element.style.width||0));}:this.options.maxWidth});this.resizable.handle.observe('mousedown',this.bringToFrontHandler);Resizables.addObserver(new Control.Window.LayoutUpdateObserver(this,function(){if(this.iFrameShim)
this.updateIFrameShimZIndex();this.notify('onResize');}.bind(this)));}},applyDraggable:function(){if(this.options.draggable){if(typeof(Draggables)=="undefined")
throw"Control.Window requires dragdrop.js to be loaded.";var draggable_handle=null;if(this.options.draggable===true){draggable_handle=new Element('div',{className:'draggable_handle'});this.container.insert(draggable_handle);}else
draggable_handle=$(this.options.draggable);this.draggable=new Draggable(this.container,{handle:draggable_handle,constrainToViewport:this.options.constrainToViewport,zindex:this.container.getStyle('z-index'),starteffect:function(){if(Prototype.Browser.IE){this.old_onselectstart=document.onselectstart;document.onselectstart=function(){return false;};}}.bind(this),endeffect:function(){document.onselectstart=this.old_onselectstart;}.bind(this)});this.draggable.handle.observe('mousedown',this.bringToFrontHandler);Draggables.addObserver(new Control.Window.LayoutUpdateObserver(this,function(){if(this.iFrameShim)
this.updateIFrameShimZIndex();this.notify('onDrag');}.bind(this)));}},createDefaultContainer:function(container){if(!this.container){this.container=new Element('div',{id:'control_window_'+this.numberInSequence});$(document.body).insert(this.container);if(typeof(container)=="string"&&$(container)==null&&!container.match(/^#(.+)$/)&&!container.match(Control.Window.uriRegex))
this.container.update(container);}},finishOpen:function(event){this.bringToFront();if(this.options.fade){if(typeof(Effect)=="undefined")
throw"Control.Window requires effects.js to be loaded."
if(this.effects.fade)
this.effects.fade.cancel();this.effects.appear=new Effect.Appear(this.container,{queue:{position:'end',scope:'Control.Window.'+this.numberInSequence},from:0,to:1,duration:this.options.fadeDuration/2,afterFinish:function(){if(this.iFrameShim)
this.updateIFrameShimZIndex();this.isOpen=true;this.notify('afterOpen');}.bind(this)});}else
this.container.show();this.position(event);if(!(this.options.draggable||this.options.resizable)&&this.options.position=='center')
Event.observe(window,'resize',this.positionHandler,false);if(!this.options.draggable&&this.options.position=='center')
Event.observe(window,'scroll',this.positionHandler,false);if(!this.options.fade){this.isOpen=true;this.notify('afterOpen');}
return true;},showIndicator:function(){this.showIndicatorTimeout=window.setTimeout(function(){if(this.options.fade){this.indicatorEffects.appear=new Effect.Appear(this.indicator,{queue:{position:'front',scope:'Control.Window.indicator.'+this.numberInSequence},from:0,to:1,duration:this.options.fadeDuration/2});}else
this.indicator.show();}.bind(this),Control.Window.indicatorTimeout);},hideIndicator:function(){if(this.showIndicatorTimeout)
window.clearTimeout(this.showIndicatorTimeout);this.indicator.hide();},getRemoteContentInsertionTarget:function(){return typeof(this.options.insertRemoteContentAt)=="string"?this.container.down(this.options.insertRemoteContentAt):$(this.options.insertRemoteContentAt);},updateIFrameShimZIndex:function(){if(this.iFrameShim)
this.iFrameShim.positionUnder(this.container);}});Object.extend(Control.Window,{windows:[],baseZIndex:9999,indicatorTimeout:250,iframeTemplate:new Template('<iframe src="#{href}" width="100%" height="100%" frameborder="0"></iframe>'),uriRegex:/^(\/|\#|https?\:\/\/|[\w]+\/)/,bringToFront:function(w){Control.Window.windows=Control.Window.windows.without(w);Control.Window.windows.push(w);Control.Window.windows.each(function(w,i){var z_index=Control.Window.baseZIndex+i;w.container.setStyle({zIndex:z_index});if(w.isOpen){if(w.iFrameShim)
w.updateIFrameShimZIndex();}
if(w.options.draggable)
w.draggable.options.zindex=z_index;});},open:function(container,options){var w=new Control.Window(container,options);w.open();return w;},initialZIndexForWindow:function(w){return Control.Window.baseZIndex+(Control.Window.windows.length-1);}});Object.Event.extend(Control.Window);Control.Window.LayoutUpdateObserver=Class.create({initialize:function(w,observer){this.w=w;this.element=$(w.container);this.observer=observer;},onStart:Prototype.emptyFunction,onEnd:function(event_name,instance){if(instance.element==this.element&&this.iFrameShim)
this.w.updateIFrameShimZIndex();},onResize:function(event_name,instance){if(instance.element==this.element)
this.observer(this.element);},onDrag:function(event_name,instance){if(instance.element==this.element)
this.observer(this.element);}});Control.Overlay={id:'control_overlay',loaded:false,container:false,lastOpacity:0,styles:{position:'fixed',top:0,left:0,width:'100%',height:'100%',zIndex:9998},ieStyles:{position:'absolute',top:0,left:0,zIndex:9998},effects:{fade:false,appear:false},load:function(){if(Control.Overlay.loaded)
return false;Control.Overlay.loaded=true;Control.Overlay.container=new Element('div',{id:Control.Overlay.id});$(document.body).insert(Control.Overlay.container);if(Prototype.Browser.IE){Control.Overlay.container.setStyle(Control.Overlay.ieStyles);Event.observe(window,'scroll',Control.Overlay.positionOverlay);Event.observe(window,'resize',Control.Overlay.positionOverlay);Control.Overlay.observe('beforeShow',Control.Overlay.positionOverlay);}else
Control.Overlay.container.setStyle(Control.Overlay.styles);Control.Overlay.iFrameShim=new IframeShim();Control.Overlay.iFrameShim.hide();Event.observe(window,'resize',Control.Overlay.positionIFrameShim);Control.Overlay.container.hide();return true;},unload:function(){if(!Control.Overlay.loaded)
return false;Event.stopObserving(window,'resize',Control.Overlay.positionOverlay);Control.Overlay.stopObserving('beforeShow',Control.Overlay.positionOverlay);Event.stopObserving(window,'resize',Control.Overlay.positionIFrameShim);Control.Overlay.iFrameShim.destroy();Control.Overlay.container.remove();Control.Overlay.loaded=false;return true;},show:function(opacity,fade){if(Control.Overlay.notify('beforeShow')===false)
return false;Control.Overlay.lastOpacity=opacity;Control.Overlay.positionIFrameShim();Control.Overlay.iFrameShim.show();if(fade){if(typeof(Effect)=="undefined")
throw"Control.Window requires effects.js to be loaded."
if(Control.Overlay.effects.fade)
Control.Overlay.effects.fade.cancel();Control.Overlay.effects.appear=new Effect.Appear(Control.Overlay.container,{queue:{position:'end',scope:'Control.Overlay'},afterFinish:function(){Control.Overlay.notify('afterShow');},from:0,to:Control.Overlay.lastOpacity,duration:(fade===true?0.75:fade)/2});}else{Control.Overlay.container.setStyle({opacity:opacity||1});Control.Overlay.container.show();Control.Overlay.notify('afterShow');}
return true;},hide:function(fade){if(Control.Overlay.notify('beforeHide')===false)
return false;if(Control.Overlay.effects.appear)
Control.Overlay.effects.appear.cancel();Control.Overlay.iFrameShim.hide();if(fade){Control.Overlay.effects.fade=new Effect.Fade(Control.Overlay.container,{queue:{position:'front',scope:'Control.Overlay'},afterFinish:function(){Control.Overlay.notify('afterHide');},from:Control.Overlay.lastOpacity,to:0,duration:(fade===true?0.75:fade)/2});}else{Control.Overlay.container.hide();Control.Overlay.notify('afterHide');}
return true;},positionIFrameShim:function(){if(Control.Overlay.container.visible())
Control.Overlay.iFrameShim.positionUnder(Control.Overlay.container);},positionOverlay:function(){Control.Overlay.container.setStyle({width:document.body.clientWidth+'px',height:document.body.clientHeight+'px'});}};Object.Event.extend(Control.Overlay);Control.ToolTip=Class.create(Control.Window,{initialize:function($super,container,tooltip,options){$super(tooltip,Object.extend(Object.extend(Object.clone(Control.ToolTip.defaultOptions),options||{}),{position:'mouse',hover:container}));}});Object.extend(Control.ToolTip,{defaultOptions:{offsetLeft:10}});Control.Modal=Class.create(Control.Window,{initialize:function($super,container,options){Control.Modal.InstanceMethods.beforeInitialize.bind(this)();$super(container,Object.extend(Object.clone(Control.Modal.defaultOptions),options||{}));}});Object.extend(Control.Modal,{defaultOptions:{overlayOpacity:0.5,closeOnClick:'overlay'},current:false,open:function(container,options){var modal=new Control.Modal(container,options);modal.open();return modal;},close:function(){if(Control.Modal.current)
Control.Modal.current.close();},InstanceMethods:{beforeInitialize:function(){Control.Overlay.load();this.overlayFinishedOpening=false;this.observe('beforeOpen',Control.Modal.Observers.beforeOpen.bind(this));this.observe('afterOpen',Control.Modal.Observers.afterOpen.bind(this));this.observe('afterClose',Control.Modal.Observers.afterClose.bind(this));}},Observers:{beforeOpen:function(){if(!this.overlayFinishedOpening){Control.Overlay.observeOnce('afterShow',function(){this.overlayFinishedOpening=true;this.open();}.bind(this));Control.Overlay.show(this.options.overlayOpacity,this.options.fade?this.options.fadeDuration:false);throw $break;}else
Control.Window.windows.without(this).invoke('close');},afterOpen:function(){Control.Modal.current=this;},afterClose:function(){Control.Overlay.hide(this.options.fade?this.options.fadeDuration:false);Control.Modal.current=false;this.overlayFinishedOpening=false;}}});Control.LightBox=Class.create(Control.Window,{initialize:function($super,container,options){this.allImagesLoaded=false;if(options.modal){var options=Object.extend(Object.clone(Control.LightBox.defaultOptions),options||{});options=Object.extend(Object.clone(Control.Modal.defaultOptions),options);options=Control.Modal.InstanceMethods.beforeInitialize.bind(this)(options);$super(container,options);}else
$super(container,Object.extend(Object.clone(Control.LightBox.defaultOptions),options||{}));this.hasRemoteContent=this.href&&!this.options.iframe;if(this.hasRemoteContent)
this.observe('onRemoteContentLoaded',Control.LightBox.Observers.onRemoteContentLoaded.bind(this));else
this.applyImageObservers();this.observe('beforeOpen',Control.LightBox.Observers.beforeOpen.bind(this));},applyImageObservers:function(){var images=this.getImages();this.numberImagesToLoad=images.length;this.numberofImagesLoaded=0;images.each(function(image){image.observe('load',function(image){++this.numberofImagesLoaded;if(this.numberImagesToLoad==this.numberofImagesLoaded){this.allImagesLoaded=true;this.onAllImagesLoaded();}}.bind(this,image));image.hide();}.bind(this));},onAllImagesLoaded:function(){this.getImages().each(function(image){this.showImage(image);}.bind(this));if(this.hasRemoteContent){if(this.options.indicator)
this.hideIndicator();this.finishOpen();}else
this.open();},getImages:function(){return this.container.select(Control.LightBox.imageSelector);},showImage:function(image){image.show();}});Object.extend(Control.LightBox,{imageSelector:'img',defaultOptions:{},Observers:{beforeOpen:function(){if(!this.hasRemoteContent&&!this.allImagesLoaded)
throw $break;},onRemoteContentLoaded:function(){this.applyImageObservers();if(!this.allImagesLoaded)
throw $break;}}});

if(typeof CBCR3=="undefined"||!CBCR3){var CBCR3={};}
var debug=false;var traceCount=0;function docDomain(){var myDomain=window.location.hostname;var isLive=myDomain.search("cbc.ca");if(isLive>-1){return document.domain="cbc.ca";}else{return null;}}
CBCR3.namespace=function(){var a=arguments,o=null,i,j,d;for(i=0;i<a.length;i=i+1){d=(""+a[i]).split(".");o=CBCR3;for(j=(d[0]=="CBCR3")?1:0;j<d.length;j=j+1){o[d[j]]=o[d[j]]||{};o=o[d[j]];}}
return o;}
var Trace={log:function(obj){this._outputToConsole(obj);},error:function(error){var fileName=error.fileName;var lineNumber=error.lineNumber;this._outputToConsole("ERROR - message: "+error.message+" error:"+error+" fileName: "+fileName+" lineNumber: "+lineNumber);},write:function(obj,overwrite){if(debug){this._outputToConsole(obj);}else{if(overwrite)
this._outputToConsole(obj);}},_outputToConsole:function(obj){if(!window.top.location.href.toQueryParams().debug)
return;if(typeof window.opera!="undefined")
window.opera.postError(obj);if(typeof console!="undefined"){traceCount++;console.log(this._source+" "+traceCount+":");console.log(obj);}},_source:""};if(!Array.prototype.filter)
{Array.prototype.filter=function(fun)
{var len=this.length>>>0;if(typeof fun!="function")
throw new TypeError();var res=new Array();var thisp=arguments[1];for(var i=0;i<len;i++)
{if(i in this)
{var val=this[i];if(fun.call(thisp,val,i,this))
res.push(val);}}
return res;};}
var CBCDetect={isIE:function(){var isMinIE10=!!window.MSStream;return(Prototype&&Prototype.Browser)?(isMinIE10||Prototype.Browser.IE):isMinIE10;}};function isIE(v){var isMinIE10=!!window.MSStream;alert(isMinIE10);return(isMinIE10||Prototype.Browser.IE);}
CBCR3.environment=function()
{if(!top.document._r3Environment)
top.document._r3Environment={};return top.document._r3Environment;};

CBCR3.namespace("CBCR3.Commons");CBCR3.Commons.EventDispatcher=Class.create({listenerChain:null,debug:false,initialize:function(){},buildListenerChain:function(){if(!this.listenerChain)
this.listenerChain={};},getListeners:function(){return(this.listenerChain)?this.listenerChain:null;},addEventListener:function(type,listener){if(!listener instanceof Function)
alert("Listener isn't a function");this.buildListenerChain();if(!this.listenerChain[type])
this.listenerChain[type]=[listener];else
this.listenerChain[type].push(listener);},hasEventListener:function(type){if(this.listenerChain)
return(typeof this.listenerChain[type]!="undefined");return false;},removeEventListenerType:function(type){if(!this.hasEventListener(type))
return false;this.listenerChain[type]=[];},removeEventListener:function(type,listener){if(!this.hasEventListener(type))
return false;Trace.write("METANODE: removeEventListener BEFORE",this.debug);Trace.write(this.listenerChain[type],this.debug);Trace.write(listener,this.debug);Trace.write(this.listenerChain,this.debug);for(var i=0;i<this.listenerChain[type].length;i++){if(this.listenerChain[type][i]==listener){Trace.write("equal",this.debug);this.listenerChain[type].splice(i,1);}}
Trace.write("METANODE: removeEventListener AFTER",this.debug);Trace.write(this.listenerChain,this.debug);},clearEventListeners:function(){this.listenerChain={};},dispatchEvent:function(type,data,target){var event;if(typeof type==="object"){event=type;type=event.type;}
else
event=new CBCR3.Commons.Event(type,data,target||this);this.buildListenerChain();if(!this.hasEventListener(type))
return false;this.listenerChain[type].any(function(funct){return(funct(event)==false?true:false);});}});

CBCR3.namespace("CBCR3.Commons");CBCR3.Commons.Event=Class.create({initialize:function(type,data,target)
{this.type=type;this.data=data;this.target=target;}});

CBCR3.namespace("CBCR3.Commons");CBCR3.Commons.Cookies={create:function(name,value,days,mins,domain,path){var expires;if(days&&days!=0){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toGMTString();}
else
expires="";if(mins&&mins!=0){var date=new Date();date.setTime(date.getTime()+(mins*60*1000));expires="; expires="+date.toGMTString();}
var domainSegment=(domain)?"; domain="+domain:"";var pathSegment=(path)?"; path=/"+path:"; path=/";var newCookie=name+"="+value+expires+domainSegment+pathSegment;document.cookie=newCookie;},getValue:function(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1,c.length);}
if(c.indexOf(nameEQ)==0){return c.substring(nameEQ.length,c.length);}}
return null;},deleteCookie:function(name){this.create(name,"",-1);}};

CBCR3.namespace("CBCR3.Player.Events");CBCR3.Player.Events.StateInitEvent={r3PlayerInit:"stateInitEvent:r3PlayerInit",playlistPlayerLoaded:"stateInitEvent:playlistPlayerLoaded",streamPlayerLoaded:"stateInitEvent:streamPlayerLoaded",streamAudioOnlyLoaded:"stateInitEvent:streamAudioOnlyLoaded"};CBCR3.Player.Events.StreamEvent={connecting:"streamEvent:connecting",connected:"streamEvent:connected",metaData:"streamEvent:metaData",metaDataConnected:"streamEvent:metaDataConnected",metaDataStreamUpdated:"streamEvent:metaDataStreamUpdated",metaDataStreamError:"streamEvent:metaDataStreamError",channelSelected:"streamEvent:channelSelected",genreSelected:"streamEvent:genreSelected",categorySelected:"streamEvent:categorySelected",error:"streamEvent:error"};CBCR3.Player.Events.StreamErrorEvent={notFound:"streamErrorEvent:notFound",failed:"streamErrorEvent:failed"};CBCR3.Player.Events.PlaybackEvent={start:"playbackEvent:start",pause:"playbackEvent:pause",progress:"playbackEvent:progress",finished:"playbackEvent:finished",stream:"playbackEvent:stream",next:"playbackEvent:next",prev:"playbackEvent:prev"};CBCR3.Player.Events.LoadingEvent={ready:"loadingEvent:ready",open:"loadingEvent:open",progress:"loadingEvent:progress",complete:"loadingEvent:complete",buffering:"loadingEvent:buffering"};CBCR3.Player.Events.ServiceEvent={success:"serviceEvent:success",trackReceived:"serviceEvent:trackReceived",playlistReceived:"serviceEvent:playlistReceived",permalinkContextReceived:"serviceEvent:permalinkContextReceived",metaDataUpdated:"serviceEvent:metaDataUpdated",cbcMusicMetaDataUpdated:"serviceEvent:cbcMusicMetaDataUpdated",permalinkChanged:"serviceEvent:permalinkChanged",adminPlaylistsReceived:"serviceEvent:adminPlaylistsReceived"};CBCR3.Player.Events.PlaylistEvent={playlistSelected:"playlistEvent:playlistSelected",deletePlaylist:"playlistEvent:deletePlaylist",permalinkSelected:"playlistEvent:permalinkSelected",permalinkAdded:"playlistEvent:permalinkAdded",trackSelected:"playlistEvent:trackSelected",createNewPlaylist:"playlistEvent:createNewPlaylist",savePlaylist:"playlistEvent:savePlaylist",addPlaylistSelected:"playlistEvent:addPlaylistSelected",newPlaylistCreated:"playlistEvent:newPlaylistCreated"};CBCR3.Player.Events.PlaybackCommand={play:"playbackCommand:play",stop:"playbackCommand:stop",pause:"playbackCommand:pause",playPause:"playbackCommand:playPause",kill:"playbackCommand:kill"};CBCR3.Player.Events.ScrubCommand={playhead:"scrubCommand:playhead",playheadPercent:"scrubCommand:playheadPercent",volume:"scrubCommand:volume"};CBCR3.Player.Events.ScrubEvent={changed:"scrubEvent:changed",slide:"scrubEvent:slide"};CBCR3.Player.Events.PlayerErrorEvent={streamError:"playerErrorEvent:streamError",trackNotFound:"playerErrorEvent:trackNotFound",ioError:"playerErrorEvent:ioError"};CBCR3.Player.Events.RTMPStreamEvent={ready:"rtmpStreamEvent:ready",connecting:"rtmpStreamEvent:connecting",connected:"rtmpStreamEvent:connected",stopped:"rtmpStreamEvent:stopped",progress:"rtmpStreamEvent:progress",start:"rtmpStreamEvent:start",streaming:"rtmpStreamEvent:streaming",buffering:"rtmpStreamEvent:buffering",metaDataConnected:"rtmpStreamEvent:metaDataConnected",metaDataConnectionFailed:"rtmpStreamEvent:metaDataConnectionFailed",metaDataReceived:"rtmpStreamEvent:metaDataReceived",metaDataStreamUpdated:"rtmpStreamEvent:metaDataStreamUpdated",streamAudioOnly:"rtmpStreamEvent:streamAudioOnly",failed:"rtmpStreamEvent:failed"};CBCR3.Player.Events.StreamCommand={load:"streamCommand:load",play:"streamCommand:play",stop:"streamCommand:stop",pause:"streamCommand:pause",kill:"streamCommand:kill",playPause:"streamCommand:playPause",loadAudioOnly:"streamCommand:loadAudioOnly",volume:"streamCommand:volume"};CBCR3.Player.Events.ModeControlEvent={stream:"modeControlEvent:stream",playlist:"modeControlEvent:playlist",browseTracks:"modeControlEvent:browseTracks",browseStreams:"modeControlEvent:browseStreams"};CBCR3.Player.Events.PermalinkEvent={trackAdded:"permalinkEvent:trackAdded",favouriteRemoved:"permalinkEvent:favouriteRemoved",favouriteAdded:"permalinkEvent:favouriteAdded",favouriteStatus:"permalinkEvent:favouriteStatus",confirm:"permalinkEvent:confirm",cancel:"permalinkEvent:cancel",sendPermalink:"permalinkEvent:sendPermalink",retrievePermalinkContext:"permalinkEvent:retrievePermalinkContext"};CBCR3.Player.Events.SelectorEvent={scheduleReceived:"selectorEvent:scheduleReceived"};CBCR3.Player.Events.ShuffleEvent={changed:"shuffleEvent:changed"};CBCR3.Player.Events.ThumbEvent={received:"thumbEvent:received",registered:"thumbEvent:registered",changed:"thumbEvent:changed"};CBCR3.Player.Events.PanelEvent={remove:"panelEvent:remove",click:"panelEvent:click"};CBCR3.Player.Events.TrackTimeEvent={changed:"trackTimeEvent:changed"};CBCR3.Player.Events.ServiceExceptionEvent={userNotAuthenticated:"serviceExceptionEvent:userNotAuthenticated",userOutsideCanada:"serviceExceptionEvent:userOutsideCanada",duplicateTrack:"serviceExceptionEvent:duplicateTrack",emptyPlaylist:"serviceExceptionEvent:emptyPlaylist",endOfPlaylist:"serviceExceptionEvent:endOfPlaylist",nullPlaylist:"serviceExceptionEvent:nullPlaylist"};CBCR3.Player.Events.PlaybackExceptionEvent={emptyPlaylist:"playbackExceptionEvent:emptyPlaylist",endOfPlaylist:"playbackExceptionEvent:endOfPlaylist",nullPlaylist:"playbackExceptionEvent:nullPlaylist"};CBCR3.Player.Events.AuthenticationEvent={loginRequired:"authenticationEvent:loginRequired"};CBCR3.Player.Events.PageEvent={playPermalink:"pageEvent:playPermalink",addPermalink:"pageEvent:addPermalink",favouritePermalink:"pageEvent:favouritePermalink",permalink:"pageEvent:permalink",showtrackinfo:"pageEvent:showtrackinfo",playStream:"pageEvent:playStream",socialShare:"pageEvent:socialShare"};CBCR3.Player.Events.DisplayEvent={forceIERefresh:"displayEvent:forceIERefresh"};CBCR3.Player.Events.StatusEvent={notify:"statusEvent:notify"};

CBCR3.namespace("CBCR3.Commons");CBCR3.Commons.GlobalBroker={_eventDispatcher:null,eventDispatcher:function(){if(!this._eventDispatcher)
this._eventDispatcher=new CBCR3.Commons.EventDispatcher();return this._eventDispatcher;},addEventListener:function(event,callback){this.eventDispatcher().addEventListener(event,callback);},dispatchEvent:function(event,data,target){this.eventDispatcher().dispatchEvent(event,data,target);}}

CBCR3.namespace("CBCR3.Commons");CBCR3.Commons.GlobalEvents={becameFanOfArtist:"globalEvents:BecameFanOfArtist"}

CBCR3.namespace("CBCR3.Commons");CBCR3.Commons.MapperBase=Class.create({mapCollection:function(dtos)
{var collection=new Array();if(dtos!=null&&dtos instanceof Array)
for(var i=0;i<dtos.length;i++)
collection.push(this.mapFrom(dtos[i]))
return collection;},mapFrom:function(dto)
{throw"This function must be overridden by a sub class";}});

CBCR3.namespace("CBCR3.Commons");CBCR3.Commons.MobileUtilities=Class.create({initialize:function(){},isMobileDevice:function(){var check=false;(function(a){if(/(android|bb\d+|meego)|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r|s)|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp(i|ip)|hs\-c|ht(c(\-||_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac(|\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt(|\/)|klon|kpt|kwc\-|kyo(c|k)|le(no|xi)|lg(g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-||o|v)|zz)|mt(50|p1|v)|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v)|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-|)|webc|whit|wi(g|nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))
check=true;})(navigator.userAgent||navigator.vendor||window.opera);return check;}});

CBCR3.namespace("CBCR3.Commons.Controls");var _tinymceCreator=null;CBCR3.Commons.Controls.TinyMceCreatorProvider={getInstance:function(){if(_tinymceCreator==null)
_tinymceCreator=new CBCR3.Commons.Controls.TinyMceCreator();return _tinymceCreator;}};CBCR3.Commons.Controls.TinyMceCreator=Class.create(CBCR3.Commons.EventDispatcher,{defaultText:"",hasClicked:false,initialize:function(){if(!tinyMCE)
throw new Error("TinyMCE is not defined, please include the tiny mce plugin");},createEditor:function(textareaId,settings,defaultText){this.defaultText=defaultText;tinyMCE.settings=settings;tinyMCE.execCommand('mceAddControl',false,textareaId);},onInit:function(instance){$$(".mceToolbar").each(function(item){item.descendants().each(function(desc){desc.setAttribute("tabIndex","-1");});});var self=this;tinyMCE.dom.Event.add(instance.getWin(),'focus',function(e){self.dispatchEvent(CBCR3.Common.Events.TinyMCEEvent.focus);});tinyMCE.dom.Event.add(instance.getWin(),'blur',function(e){self.dispatchEvent(CBCR3.Common.Events.TinyMCEEvent.blur);});instance.onActivate.add(this.onActivate.bind(this));},onSetupContent:function(editorId,body,doc){},onChange:function(instance){},onActivate:function(instance){}});

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.TwitterBox=Class.create({serviceMethod:null,container:null,fromAccount:null,hashTag:null,displayNum:null,initialize:function(options){this.serviceMethod=options.serviceMethod;this.container=$(options.container);this.fromAccount=options.fromAccount;this.hashTag=options.hashTag|"";this.displayNum=options.displayNum|1;},load:function(){this.serviceMethod(this.SetQuery(this.fromAccount,this.hashTag),this.displayNum,this.onSuccess.bind(this),this.onFailure.bind(this));},SetQuery:function(){var frArr=this.fromAccount.split(',');if(this.hashTag==-1||this.hashTag==0)
return frArr;var hshArr=this.hashTag.split(',');for(var index=0;index<hshArr.length;index++){frArr[frArr.length]=hshArr[index];}
return frArr;},onSuccess:function(respItems){this.updateStatus("");var self=this;respItems.each(function(item){var div=new Element("div");div.addClassName("recentTweet");div.update(self.template(item));self.container.appendChild(div);});},onFailure:function(response){this.updateStatus("Our Twitter feed is currently not available. Click here to view the CBC Radio 3 Twitter page","");},template:function(vars){var markup="<a href=\"http://twitter.com/#{TwitterAccount}\">#{TwitterAccount}</a>"+"<p>#{Text}<br><i>Posted #{Date}</i></p>";return new Template(markup).evaluate(vars);},updateStatus:function(text){this.container.update(text);}});

CBCR3.namespace("CBCR3.Commons.LoginTasks");CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.namespace("CBCR3.Commons.Controls.Events");CBCR3.Commons.Controls.Events={forgotPassword:"forgotPassword"};var loginPanelInstance;CBCR3.Commons.LoginTasks.launchLogin=function(message,options){try{if(loginPanelInstance==null)
loginPanelInstance=new CBCR3.Commons.Controls.LoginPanel(options);if(message==null||message=="")
message="You need to be logged in to do that";loginPanelInstance.setUserMessage(message);loginPanelInstance.open();loginPanelInstance.addEventListener(CBCR3.Commons.Controls.Events.forgotPassword,function(event){loginPanelInstance.close();forgotPassword();});}catch(e){Trace.write("ERROR: in launchLogin",true);Trace.error(e);}};CBCR3.Commons.Controls.LoginPanel=Class.create(CBCR3.Commons.EventDispatcher,{isOpen:false,panel:null,userMessage:"",options:{},usernameInput:null,passwordInput:null,modal:null,debug:false,type:null,Member_Login:1,Action_Login:2,initialize:function($super,options){try{$super();this.options.loginUrl=options.loginUrl;this.options.returnUrl=options.returnUrl;this.options.facebookLoginUrl=options.facebookLoginUrl;this.options.signupUrl=options.signupUrl;this.options.forgotUrl=options.forgotUrl;this.type=(options.type)?options.type:this.Action_Login;Trace.write("LoginPanel Type:"+this.type+" options.type:"+options.type,true);}catch(e){Trace.write("ERROR in LoginPanel",this.debug);Trace.error(e);}},setUserMessage:function(userMessage){try{this.userMessage=userMessage;}catch(e){Trace.write("ERROR: setUserMessage()",this.debug);Trace.error(e);}},open:function(){try{Trace.write("in loginpanel.js -> open()",this.debug);this.panel=new Element("div",{className:"notLoggedInBox modal"});this.panel.insert(this.getTemplate().evaluate({userMessage:this.userMessage,action:CBCR3.Application.Config.applicationPath+this.options.loginUrl,returnUrl:this.options.returnUrl,signupUrl:CBCR3.Application.Config.applicationPath+this.options.signupUrl,forgotUrl:CBCR3.Application.Config.applicationPath+this.options.forgotUrl}));Trace.write("panel InnerHTML: ",this.debug);Trace.write(this.panel.innerHTML,this.debug);var isiPad=CBCR3.environment().isIphone;if(isiPad==true){TINY.box.show({html:this.panel,animate:false,close:true,opacity:75,top:50,boxid:"loginpaneldiv",openjs:this.focusUsername});}else{TINY.box.show({html:this.panel,animate:false,close:true,opacity:75,boxid:"loginpaneldiv",openjs:this.focusUsername});}
var containerDiv=$("loginpaneldiv");var contentDiv=containerDiv.down(".tcontent");contentDiv.update();contentDiv.update(this.panel);this.panel.down("#loginPanel_login").observe("click",this.loginButton_Click.bind(this));this.usernameInput=this.panel.down("#loginPanel_username");this.usernameInput.observe("keypress",this.input_KeyPress.bind(this));this.usernameInput.focus();this.passwordInput=this.panel.down("#loginPanel_password");this.passwordInput.observe("keypress",this.input_KeyPress.bind(this));}catch(e){Trace.error(e);}},focusUsername:function(){var userName=$("loginPanel_username");if(userName)
userName.focus();},getLoading:function(){return"<div class=\"loading\">Loading...</div>";},closePanel_Click:function(event){this.close();},loginButton_Click:function(event){this.performLogin();},input_KeyPress:function(event){if(event.keyCode==13){Event.stop(event);this.performLogin();}
if(event.keyCode==27){Event.stop(event);this.close();}},performLogin:function(){this.panel.down("form").submit();},close:function(){this.panel=null;},getTemplate:function(){var header="<div class=\"headerInfo\"><h5>#{userMessage}</h5></div>";var welcome="";if(this.type==this.Member_Login){welcome="<div class=\"headerInfo welcome\"></div>";header="";}
var facebookLogin=" href=\""+this.options.facebookLoginUrl+"\"";return new Template(welcome+"<div class=\"notLoggedInForm\">"+
header+"<form method=\"post\" action=\"#{action}\">"+"<fieldset class=\"selected\">"+"<div class=\"inputField username\">"+"<label>User Name or Email Address</label><br/>"+"<input type=\"text\" class=\"navLoginInput inputBottom\" name=\"username\" id=\"loginPanel_username\" tabindex=\"1\" />"+"</div>"+"<br class=\"clear\" />"+"<div class=\"inputField\">"+"<label>Password:</label><br/>"+"<input type=\"password\" class=\"navLoginInput active\" name=\"password\" id=\"loginPanel_password\" tabindex=\"2\" />"+"</div>"+"<br class=\"clear\" />"+"<div class=\"forgottenPasswordLink\">"+"<a style=\"color: #c33;font-size:12px;\" rel=\"nofollow\" href=\"#{forgotUrl}\">Forgotten your password?</a>"+"</div>"+"<div class=\"signInDiv\">"+"<a "+facebookLogin+" target=\"_parent\" class=\"signInFacebook\">Signin with Facebook</a>"+"<input type=\"button\" id=\"loginPanel_login\" class=\"yellowButton\" tabindex=\"3\" style=\"width:80px\" value=\"SIGN IN\"/>"+"</div>"+"<input type=\"hidden\" name=\"flag\" value=\"true\" />"+"<input type=\"hidden\" name=\"returnUrl\" value=\"#{returnUrl}\" />"+"</fieldset>"+"</form>"+"</div>"+"<div class=\"signUpForm\">"+""+"<a href=\"#{signupUrl}\">Sign up for your free <img src=\"/lib/cbcmusic/images/cbcmusiclogo_sm.gif\" border=\"0\" alt=\"CBC Music\" title=\"CBC Music\"/> account</a>"+"</div>");}});

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.NameInputLookup=Class.create({serviceMethod:null,button:null,inputBox:null,statusBox:null,defaultText:null,initialize:function(options){this.serviceMethod=options.serviceMethod;this.inputBox=$(options.inputBox);this.button=$(options.trigger);this.button.observe("blur",this.onBlur.bind(this));this.statusBox=$(options.statusBox);this.defaultText=options.defaultText||"";},onBlur:function(event){this.validateUsername(event);},validateUsername:function(event){var inputName=this.inputBox.getValue();Event.stop(event);this.resetValidation();if(inputName.blank()||inputName==this.defaultText){this.statusBox.hide();this.showError("","","errorMessage");return;}
if(this.checkForCommas(inputName))return;this.serviceMethod(this.inputBox.getValue(),this.onSuccess.bind(this),this.onFailure.bind(this),this.inputBox.getValue());},onSuccess:function(response,context){if(response){this.inputBox.addClassName('validInput');}
else{this.inputBox.addClassName('invalidInput');this.updateStatus(context+" is already taken.","","errorMessage");}},resetValidation:function(){this.updateStatus("","","");this.inputBox.removeClassName('invalidInput');this.inputBox.removeClassName('validInput');},checkForCommas:function(value){if(value.indexOf(",")>=0){this.showError("Commas are not allowed.");return true;}
return false;},onFailure:function(response){alert("Something went wrong, please try refreshing the page");},showError:function(msg){this.inputBox.addClassName('invalidInput');this.updateStatus(msg,"","errorMessage");},updateStatus:function(message,tip,cssClass){this.statusBox.show();this.statusBox.update(this.getStatusTemplate().evaluate({cssClass:cssClass,message:message,tip:tip}));},getStatusTemplate:function(){return new Template("<div id='membershipUsernameError' class='statusMessage #{cssClass}'>#{message}</div>"+"<div class='statusTip'>#{tip}</div>");}});

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.EmailInputLookup=Class.create({serviceMethod:null,button:null,inputBox:null,statusBox:null,defaultText:null,submitButton:null,initialize:function(options){this.serviceMethod=options.serviceMethod;this.inputBox=$(options.inputBox);this.button=$(options.trigger);this.button.observe("blur",this.onBlur.bind(this));this.statusBox=$(options.statusBox);this.defaultText=options.defaultText||"";},onBlur:function(event){this.validateEmail(event);},onSubmitForm:function(event){this.validateEmail(event);},onSuccess:function(response,context){if(response){this.inputBox.addClassName('validInput');}
else{this.inputBox.addClassName('invalidInput');if(this.checkForEmptyString(context))return;this.updateStatus(context+" is already taken.","","errorMessage");}},validateEmail:function(event){var inputName=this.inputBox.getValue();Event.stop(event);this.resetValidation();if(inputName.blank()||inputName==this.defaultText){this.statusBox.hide();return;}
if(this.checkForCommas(inputName))return;if(!this.checkEmailAddress(inputName))return;if(!this.checkEmailAddressDomain(inputName))return;},checkEmailAddress:function(email){var re=new RegExp(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);if(!re.test(email)){this.showError("");return false;}
this.inputBox.addClassName('validInput');return true;},checkEmailAddressDomain:function(email){CBC.Radio3.Web.WebServices.RegistrationWebService.EmailDomainIsValid(this.inputBox.getValue(),this.onEmailAddressDomainCheckSuccess.bind(this),this.onEmailAddressDomainCheckFailure.bind(this),this.inputBox.getValue());},onEmailAddressDomainCheckSuccess:function(response,context){if(response){this.serviceMethod(this.inputBox.getValue(),this.onSuccess.bind(this),this.onFailure.bind(this),this.inputBox.getValue());}
else{this.inputBox.addClassName('invalidInput');if(this.checkForEmptyString(context))return;this.updateStatus(context+" is an invalid email address domain","","errorMessage");return false;}},onEmailAddressDomainCheckFailure:function(response){alert("Something went wrong, please try refreshing the page");return false;},resetValidation:function(){this.updateStatus("","","");this.inputBox.removeClassName('invalidInput');this.inputBox.removeClassName('validInput');},checkForEmptyString:function(value){if(value==""){this.updateStatus("Please enter your email address.","","errorMessage");return true;}
return false;},checkForCommas:function(value){if(value.indexOf(",")>=0){this.showError("Commas are not allowed.");return true;}
return false;},onFailure:function(response){alert("Something went wrong, please try refreshing the page");},updateStatus:function(message,tip,cssClass){this.statusBox.show();this.statusBox.update(this.getStatusTemplate().evaluate({cssClass:cssClass,message:message,tip:tip}));},getStatusTemplate:function(){return new Template("<div id='emailCheckError' class='statusMessage #{cssClass}'>#{message}</div>"+"<div class='statusTip'>#{tip}</div>");},showError:function(msg){this.inputBox.addClassName('invalidInput');this.updateStatus(msg,"","errorMessage");}});

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.InputPlaceHolder=Class.create({input:null,defaultText:null,options:null,placeHolderColor:"",textColor:"",initialize:function(element,defaultText,options){this.input=$(element);if(this.input==null)
return;this.input.observe("focus",this.input_Focus.bind(this));this.input.observe("blur",this.input_Blur.bind(this));this.options=options||{};this.placeHolderColor=this.options.placeHolderColor||this.input.getStyle("color");this.textColor=this.input.getStyle("color");this.defaultText=defaultText;this.setPrimaryValue();},setPrimaryValue:function(){if(this.input.value==""||this.input.getValue()==this.defaultText)
this.setBlur();},input_Focus:function(){this.setFocus();},input_Blur:function(){this.setBlur();},setFocus:function(){if(this.input.getValue()==this.defaultText){this.input.value="";this.input.setStyle({color:this.textColor});}},setBlur:function(){if(this.input.getValue().blank()||this.input.getValue()==this.defaultText){this.input.value=this.defaultText;this.input.setStyle({color:this.placeHolderColor});}},getValue:function(){if(!this.hasValue())
return"";return this.input.getValue();},hasValue:function(){return(this.input.getValue()!=this.defaultText&&!this.input.getValue().blank());},setValue:function(value){if(value.empty())
this.input.getValue()=this.defaultText;else
this.input.getValue()=value;},reset:function(){this.input.value="";this.setBlur();this.input.value=this.defaultText;}});

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.ExtendedAutoCompleterBase=Class.create(Autocompleter.Base,{markPrevious:function(){if(this.index>-1)
this.index--;else this.index=this.entryCount-1;},markNext:function(){if(this.index<this.entryCount-1)
this.index++;else this.index=0;},updateChoices:function(){if(!this.changed&&this.hasFocus){Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.select("li").first()&&this.update.select("li")){this.entryCount=this.update.select("li").length;for(var i=0;i<this.entryCount;i++){var entry=this.getEntry(i);if(entry!=null){entry.autocompleteIndex=i;this.addObservers(entry);}}}
else{this.entryCount=0;}
this.stopIndicator();this.index=-1;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide();}
else{this.render();}}},getTypeSearchTemplate:function(type,term){var returnVal="/search/?q=";if(type==CBCR3.Commons.Controls.AutoCompleter.Type.ARTISTS)
returnVal="/music/artists.aspx?q=";if(type==CBCR3.Commons.Controls.AutoCompleter.Type.CONCERTS)
returnVal="/recordings/list.aspx?q=";if(type==CBCR3.Commons.Controls.AutoCompleter.Type.ARTICLES)
returnVal="/search/fullresults.aspx?type=articles&q=";if(type==CBCR3.Commons.Controls.AutoCompleter.Type.PROGRAMS)
returnVal="/search/fullresults.aspx?type=programs&q=";return returnVal+term;},allResultsTemplate:function(){var acGrouping=new Element("div",{id:"acSearchGrouping"});acGrouping.insert(new Element("div",{className:"acGroupTitle"}).update("&nbsp;"));return new Element("a",{id:"acMoreResultsLink"}).update("more results &raquo;");},getEntry:function(index){if(index>-1){return this.update.select("li")[index];}
return null;},selectEntry:function(){this.active=false;var entry=this.getCurrentEntry();if(entry!=null)
this.updateElement(entry);},onKeyPress:function(event){if(this.active)
switch(event.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();return;case Event.KEY_ESC:this.hide();this.active=false;Event.stop(event);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(event);return;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(event);return;}
else
if(event.keyCode==Event.KEY_TAB||event.keyCode==Event.KEY_RETURN||(Prototype.Browser.WebKit>0&&event.keyCode==0))return;this.changed=true;this.hasFocus=true;if(this.observer)clearTimeout(this.observer);this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000);}});CBCR3.Commons.Controls.AutoCompleter=Class.create(CBCR3.Commons.Controls.ExtendedAutoCompleterBase,{inputBox:null,searchMethod:null,searchBtn:null,defaultText:null,directHitUrlTemplate:null,openSearchUrlTemplate:null,hasSubmitted:false,maxItemCount:6,noResults:true,initialize:function(inputBox,updatePanel,searchBtn,options){this.inputBox=$(inputBox);this.inputBox.observe("keypress",this.onInputKeyPress.bind(this));this.searchBtn=$(searchBtn);if(this.searchBtn)
this.searchBtn.observe("click",this.onSubmit.bind(this));this.searchMethod=options.searchMethod;this.openSearchUrlTemplate=options.openSearchUrlTemplate;this.directHitUrlTemplate=options.directHitUrlTemplate;this.defaultText=options.defaultText;this.maxItemCount=options.maxItemCount||6;if(options.trigger)
$(options.trigger).observe("click",this.onSubmit.bind(this));this.baseInitialize(inputBox,updatePanel,{afterUpdateElement:this.onAfterUpdateElement.bind(this),onShow:this.onShow.bind(this),frequency:0.6,select:"artistName",minChars:2});},onShow:function(element,update){Effect.Appear(update,{duration:0.15});},getUpdatedChoices:function(){this.startIndicator();this.searchMethod(this.element.value,this.onSuccess.bind(this),this.onFailed.bind(this),null);},onSuccess:function(response){this.update.update();this.noResults=true;this.update.insert(this.updateSearchCategory(response.OtherResults,CBCR3.Commons.Controls.AutoCompleter.Type.GENERAL));this.update.insert(this.updateSearchCategory(response.ArtistResults,CBCR3.Commons.Controls.AutoCompleter.Type.ARTISTS));this.update.insert(this.updateSearchCategory(response.ConcertResults,CBCR3.Commons.Controls.AutoCompleter.Type.CONCERTS));this.update.insert(this.updateSearchCategory(response.BlogResults,CBCR3.Commons.Controls.AutoCompleter.Type.ARTICLES));this.update.insert(this.updateSearchCategory(response.ProgramResults,CBCR3.Commons.Controls.AutoCompleter.Type.PROGRAMS));if(this.noResults)
this.hide();else{this.update.insert(this.showMoreResultsTemplate());this.updateChoices(this.update);}},showMoreResultsTemplate:function(){var container=new Element("div",{className:"acSearchGrouping"});var topCap=new Element("a",{className:"acGroupTitle",style:"padding-top:0px;"}).update("&nbsp;");container.appendChild(topCap);var ul=new Element("ul",{className:"acResults"});ul.appendChild(new Element("li",{id:"/search/?q="+this.element.value}).update(this.allResultsTemplate()));container.appendChild(ul);return container;},updateSearchCategory:function(results,type){if(results==null||results.ItemCount<1)
return"";this.noResults=false;return this.createListFrom(results.List,type);},createListFrom:function(items,type){var container=new Element("div",{className:"acSearchGrouping"});var topCap=new Element("a",{className:"acGroupTitle",id:"ac"+type+"Results",href:this.getTypeSearchTemplate(type,this.element.value)});var topCapText=document.createTextNode(type);topCap.appendChild(topCapText);container.appendChild(topCap);var ul=new Element("ul",{className:"acResults"});if(items.length<1)
ul.appendChild(new Element("li").update("No results"));else{for(var i=0;i<items.length&&i<this.maxItemCount;i++){ul.appendChild(this.createListItem(items[i],this.getAltClass(i)));}}
container.appendChild(ul);return container;},createListItem:function(item,altClass){var li=new Element("li",{className:altClass,id:item.Permalink});li.update(this.itemTemplate({Title:item.Title,Permalink:item.Permalink,ImageUrl:item.ImageUrl}));return li;},itemTemplate:function(vars){var markup="<img src=\"#{ImageUrl}\" alt=\"#{Title}\" />"+"<div class=\"itemText\">"+"<span class=\"small\">#{Title}</span>"+"<span class=\"smallest\">#{Permalink}</span>"+"</div>";return new Template(markup).evaluate(vars);},getAltClass:function(count){return(count%2==0)?"":"odd";},onInputKeyPress:function(event){Trace.write('in oninputKeyPress, this.hassubmitted:'+this.hasSubmitted);if(!this.active&&event.keyCode==Event.KEY_RETURN){Event.stop(event);if(!this.hasSubmitted)
this.submitOpenSearch();}},onAfterUpdateElement:function(element,selected){this.hasSubmitted=true;this.submitDirectHit(selected.id);},onSubmit:function(event){this.submitOpenSearch();},submitOpenSearch:function(){Trace.write("submitOpenSearch: openSearchUrlTemplate:"+this.openSearchUrlTemplate,true);this.submitUrl(this.openSearchUrlTemplate);},submitDirectHit:function(selection){Trace.write("submitDirectHit: directHitUrlTemplate:"+this.directHitUrlTemplate,true);window.location.href=selection;},submitUrl:function(urlTemplate){var inputText=(this.inputBox.getValue()==this.defaultText)?"":this.inputBox.getValue();Trace.write("submitUrl: template: "+urlTemplate+", value: "+inputText,true);window.location.href=new Template(urlTemplate).evaluate({name:encodeURIComponent(inputText)});},onFailed:function(response,context){Trace.write("AutoComplete failed. Please refresh the page and try again.",true);}});CBCR3.Commons.Controls.AutoCompleter.Type={ARTISTS:"artists",CONCERTS:"concerts",ARTICLES:"articles",PROGRAMS:"programs",GENERAL:"general"};

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.ActionNotifier=Class.create({imageTable:null,initialize:function(){this.imageTable=new Hash();this.imageTable.set("playlistPlayed","anPlay");this.imageTable.set("favouriteAdded","anLike");this.imageTable.set("trackAdded","anAdd");this.imageTable.set("facebookPosted","anFacebook");this.imageTable.set("streamPlayed","anPlay");},notify:function(type){try{Trace.write("in notify() type:"+type,true);var notifierContainer=new Element("div",{className:"actionNotifier"});var imgType=this.imageTable.get(type);notifierContainer.update(this.getTemplate().evaluate({imgType:imgType}));$(document.body).insert(notifierContainer);new Effect.Fade(notifierContainer,{duration:3.0});}catch(e)
{Trace.error(e);}},getTemplate:function(){var markup="<span class='#{imgType}'></span>";return new Template(markup);}});

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.FlashDetector=Class.create({modal:null,panel:null,hideButton:null,cookieName:"flashVersionOverride",isBot:false,initialize:function()
{if(!DetectFlashVer)
alert("can't find adobe flash detection script \n http://www.adobe.com/products/flashplayer/download/detection_kit/");this.isBot=CBCR3.environment().isBot;},check:function()
{var reqVersion=CBCR3.Player.Configuration.flashVersion;var hasMinVersionIntalled=DetectFlashVer(reqVersion.major,reqVersion.minor,reqVersion.revision);if(!hasMinVersionIntalled&&!this.hasOverrideCookie()&&!this.isBot)
this.notify();},notify:function()
{this.panel=new Element("div");this.panel.update(this.getTemplate({userVersion:GetSwfVer(),reqVersion:CBCR3.Player.Configuration.flashVersion.full}));this.hideButton=this.panel.down(".overrideLink a");this.hideButton.observe("click",this.onHideButtonClick.bind(this));if(!Control.Modal)
alert("can't find Control.Modal");TINY.box.show({html:this.panel,width:280,height:310,animate:false,close:true,top:5,opacity:75,boxid:"noflashpaneldiv"});},hasOverrideCookie:function()
{return CBCR3.Commons.Cookies.getValue(this.cookieName);},setOverrideCookie:function()
{CBCR3.Commons.Cookies.create(this.cookieName,"true",30);},onHideButtonClick:function(event)
{Event.stop(event);this.setOverrideCookie();TINY.box.hide();},getTemplate:function(variables)
{var markup="<div class='errorHeader'></div>"+"<div class='flashDetector'>"+"<div class='errorMessage'>It appears that your Flash plug-in is out of date.</div>"+"<div class='versionMessage'>"+"<strong>CBC Music uses the Adobe Flash player to stream music to your computer.</strong> "+"Please follow the link below to update your Flash player and get access to all of the great music on this website.  It's quick, it's easy and it's free."+"<div class='flashLink'><a href='http://get.adobe.com/flashplayer/' target='_blank'><img src='/lib/cbcmusic/images/modal/get_flash.png'></a></div>"+"</div>"+"<div class='overrideLink'><a href='#'></a></div>"+"</div>";return new Template(markup).evaluate(variables);}});

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.FirstTimeNotifier=Class.create({container:null,closeButton:null,tourButton:null,infoButton:null,videoModal:null,load:function()
{if(this.shouldShowPanel())
setTimeout(this.render.bind(this),1000);},shouldShowPanel:function()
{if(CBCR3.Commons.Cookies.getValue("r3HideNotifier"))
return false;return(!CBCR3.Application.Config.authenticated);},render:function()
{if(!this.container)
this.container=new Element("div",{className:"firstTimeNotifier"});this.container.setStyle({display:"none"});$(document.body).insert({top:this.container});this.container.update(this.template({helpPath:CBCR3.Application.Config.applicationPath+"/help/"}));new Effect.SlideDown(this.container,{duration:.5});this.closeButton=this.container.down(".closeButton");this.closeButton.observe("click",this.closeButton_click.bind(this));this.tourButton=this.container.down(".tourButton");this.tourButton.observe("click",this.tourButton_click.bind(this));this.infoButton=this.container.down(".infoButton");this.infoButton.observe("click",this.closeButton_click.bind(this));},tourButton_click:function(event)
{event.stop();new CBCR3.Commons.Controls.VideoTour().launch();var player=new CBCR3.Player.Application.R3PlayerInstanceService().getInstance();player.pause();this.permanentlyClosePanel();},closeButton_click:function(event)
{this.permanentlyClosePanel();},permanentlyClosePanel:function()
{Effect.Fade(this.container,{duration:.5});CBCR3.Commons.Cookies.create('r3HideNotifier',true,30);},template:function(vars)
{var markup="<div class='notifierBox'>"+"<div class='message'>Is this your first time here? "+"<a href='#{helpPath}' class='tourButton'>Take a tour</a>"+" or <a href='#{helpPath}' class='infoButton'>Learn more</a>"+"</div>"+"<button type='button' class='imageButton closeButton' title='Close'>Close</button>"+"</div>";return new Template(markup).evaluate(vars);}});

CBCR3.Commons.Controls.VideoTour=Class.create({container:null,modal:null,launch:function()
{this.container=new Element("div",{className:"videoTour",id:"videoTour"});$(document.body).appendChild(this.container);this.container.update(this.template({videoUrl:"http://www.youtube.com/v/w8ao1nIprnM",width:854,height:505}));this.modal=new Control.Modal(this.container,{overlayOpacity:0.75,className:'modalWindow',fade:false,iframe:false});this.container.down(".close").observe("click",this.closeButton_click.bind(this));this.modal.open();},closeButton_click:function()
{this.container.remove();this.modal.close();},template:function(vars)
{var markup="<div><button type='button' title='Close' class='close'>Close</button></div>"+"<object width='#{width}' height='#{height}'>"+"<param name='movie' value='#{videoUrl}&hl=en_US&fs=1&rel=0&autoplay=1'></param>"+"<param name='allowFullScreen' value='true'></param>"+"<param name='allowscriptaccess' value='always'></param>"+"<param name='wmode' value='opaque'></param>"+"<embed src='#{videoUrl}&hl=en_US&fs=1&rel=0&autoplay=1' type='application/x-shockwave-flash' allowscriptaccess='always' allowfullscreen='true' width='#{width}' height='#{height}' wmode='opaque'></embed>"+"</object>";return new Template(markup).evaluate(vars);}});

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.BrowserNotifier=Class.create({closeButton:null,closeSubmit:null,initialize:function(){},hiddenByUser:function(){return CBCR3.Commons.Cookies.getValue("r3HideIe6Alert")!=null;},showAlert:function(){if(this.hiddenByUser())
return;window.location.href="http://music.cbc.ca/browserwarning.aspx";},onClose_Click:function(event){CBCR3.Commons.Cookies.create('r3HideIe6Alert',true,30);}});

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.PromoRotator=Class.create({initialize:function(xmlPath,pathToFlash,containerId,width,height){this.xmlPath=xmlPath;this.pathToFlash=pathToFlash;this.containerId=containerId;this.width=width;this.height=height;},load:function(){var flashvars={xmlFile:this.xmlPath};var params={menu:'false',allowScriptAccess:'always',wmode:'transparent'};swfobject.embedSWF(this.pathToFlash,this.containerId,this.width,this.height,CBCR3.Player.Configuration.flashVersion.full,null,flashvars,params,null);}});

CBCR3.namespace("CBCR3.Commons.Controls");CBCR3.Commons.Controls.JsPromoRotator=Class.create({container:null,width:null,height:null,promoItems:null,currentPromo:null,timerIndex:null,currentIndex:null,manuallyStopped:false,indexTray:null,initialize:function(options){this.promoItems=[];this.currentIndex=0;this.container=$(options.container);this.width=options.width;this.height=options.height;this.container.setStyle({width:this.width+"px",height:this.height+"px"});},add:function(promo,refImage)
{var promoItem=new CBCR3.Commons.Controls.JsPromoItem(promo,this.promoItems.length);promoItem.addEventListener(CBCR3.Commons.Controls.Events.PromoEvent.imageLoaded,this.onImageLoaded.bind(this));this.promoItems.push(promoItem);},load:function(promos)
{if(this.promoItems.length>1)
{this.indexTray=new CBCR3.Commons.Controls.JsPromoIndexButtonsTray(this.promoItems);this.indexTray.addEventListener(CBCR3.Commons.Controls.Events.PromoEvent.indexChanged,this.onIndexChanged.bind(this));this.container.insert(this.indexTray.element());}
var self=this;this.promoItems.each(function(promoItem,index){if(index==0)
promoItem.load(self.container.down("a.promo"));else
promoItem.load();});if(!this.currentPromo)
this.loadPromo(0,false);},loadPromo:function(promoIndex,doAnimation)
{var promoItem=this.promoItems[promoIndex];if(this.currentPromo)
this.currentPromo.fade();this.container.insert(promoItem.element());if(doAnimation)
promoItem.appear();else
promoItem.show();this.currentPromo=promoItem;if(!this.manuallyStopped&&this.promoItems.length>1)
this.timerIndex=setTimeout(this.onTimeout.bind(this),promoItem.duration()*1000);if(this.indexTray!=null)
this.indexTray.highlightAt(promoIndex);},onImageLoaded:function(event)
{if(this.indexTray!=null)
this.indexTray.enableAt(event.target.getIndex());},onIndexChanged:function(event)
{this.manuallyStopped=true;clearTimeout(this.timerIndex);this.loadPromo(event.data.selectedIndex,true);},onTimeout:function(event)
{if(this.currentIndex==this.promoItems.length-1)
this.currentIndex=0;else
this.currentIndex++;this.loadPromo(this.currentIndex,true);}});CBCR3.Commons.Controls.JsPromoIndexButtonsTray=Class.create(CBCR3.Commons.EventDispatcher,{container:null,promoItems:null,buttons:null,initialize:function($super,promoItems)
{$super();this.promoItems=promoItems;this.buttons=[];},element:function()
{if(!this.container)
{this.container=new Element("div",{className:"indexButtons"});this.generateButtons();}
return this.container;},generateButtons:function()
{for(var i=0;i<this.promoItems.length;i++)
{var button=new Element("button",{type:"button",className:"indexButton",disabled:"disabled",title:this.promoItems[i].promo.title});button.observe("click",this.onSelectPromoClick.bind(this));button.store("index",i);button.setOpacity(0.5);this.buttons.push(button);this.container.insert(button)}},enableAt:function(index)
{this.buttons[index].removeAttribute("disabled");},highlightAt:function(thisIndex)
{this.buttons.each(function(button,index){if(index!=thisIndex)
button.removeClassName("selected");else
button.addClassName("selected")});},onSelectPromoClick:function(event)
{this.dispatchEvent(CBCR3.Commons.Controls.Events.PromoEvent.indexChanged,{selectedIndex:event.element().retrieve("index")});}});CBCR3.Commons.Controls.JsPromoItem=Class.create(CBCR3.Commons.EventDispatcher,{promo:null,domElement:null,effect:null,image:null,index:0,initialize:function($super,promo,index)
{$super();this.promo=promo;this.index=index;},load:function(existingElement)
{if(existingElement!=null){this.domElement=existingElement;this.dispatchEvent(CBCR3.Commons.Controls.Events.PromoEvent.imageLoaded);}
else
{this.image=$(new Image());this.image.observe("load",this.onImageLoaded.bind(this));this.image.src=this.promo.src;}},element:function()
{if(!this.domElement)
{this.domElement=new Element("div");if(!this.promo.href.blank()){this.domElement=new Element("a",{href:this.promo.href});}
this.domElement.title=this.promo.title;this.domElement.insert(this.image);this.domElement.addClassName("promo");this.domElement.hide();}
return this.domElement;},getIndex:function()
{return this.index;},onImageLoaded:function(event)
{this.dispatchEvent(CBCR3.Commons.Controls.Events.PromoEvent.imageLoaded);},fade:function(){this.doEffect(Effect.Fade);},appear:function(){this.doEffect(Effect.Appear)},doEffect:function(effectDelegate)
{if(this.effect)
this.effect.cancel();this.effect=new effectDelegate(this.domElement);},show:function(){this.domElement.show();},duration:function()
{return this.promo.duration;}});CBCR3.namespace("CBCR3.Commons.Controls.Events");CBCR3.Commons.Controls.Events.PromoEvent={indexChanged:"indexChanged",imageLoaded:"imageLoaded"};

TINY={};TINY.box=function(){var j,m,b,g,v,p=0;return{show:function(o){v={opacity:70,close:1,animate:1,fixed:1,mask:1,maskid:'',boxid:'',topsplit:2,url:0,post:0,height:0,width:0,html:0,iframe:0};for(s in o){v[s]=o[s]}
if(!p){j=document.createElement('div');j.className='tbox';p=document.createElement('div');p.className='tinner';b=document.createElement('div');b.className='tcontent';m=document.createElement('div');m.className='tmask';g=document.createElement('div');g.className='tclose';g.v=0;document.body.appendChild(m);document.body.appendChild(j);j.appendChild(p);p.appendChild(b);m.onclick=g.onclick=TINY.box.hide;window.onresize=TINY.box.resize}else{j.style.display='none';clearTimeout(p.ah);if(g.v){p.removeChild(g);g.v=0}}
p.id=v.boxid;m.id=v.maskid;j.style.position=v.fixed?'fixed':'absolute';if(v.html&&!v.animate){p.style.backgroundImage='none';b.innerHTML=v.html;b.style.display='';p.style.width=v.width?v.width+'px':'auto';p.style.height=v.height?v.height+'px':'auto'}else{b.style.display='none';if(!v.animate&&v.width&&v.height){p.style.width=v.width+'px';p.style.height=v.height+'px'}else{p.style.width=p.style.height='100px'}}
if(v.mask){this.mask();this.alpha(m,1,v.opacity)}else{this.alpha(j,1,100)}
if(v.autohide){p.ah=setTimeout(TINY.box.hide,1000*v.autohide)}else{document.onkeyup=TINY.box.esc}},fill:function(c,u,k,a,w,h){if(u){if(v.image){var i=new Image();i.onload=function(){w=w||i.width;h=h||i.height;TINY.box.psh(i,a,w,h)};i.src=v.image}else if(v.iframe){this.psh('<iframe src="'+v.iframe+'" width="'+v.width+'" frameborder="0" height="'+v.height+'"></iframe>',a,w,h)}else{var x=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject('Microsoft.XMLHTTP');x.onreadystatechange=function(){if(x.readyState==4&&x.status==200){p.style.backgroundImage='';TINY.box.psh(x.responseText,a,w,h)}};if(k){x.open('POST',c,true);x.setRequestHeader('Content-type','application/x-www-form-urlencoded');x.send(k)}else{x.open('GET',c,true);x.send(null)}}}else{this.psh(c,a,w,h)}},psh:function(c,a,w,h){if(typeof c=='object'){b.appendChild(c)}else{b.innerHTML=c;}
var x=p.style.width,y=p.style.height;if(!w||!h){p.style.width=w?w+'px':'';p.style.height=h?h+'px':'';b.style.display='';if(!h){h=parseInt(b.offsetHeight)}
if(!w){w=parseInt(b.offsetWidth)}
b.style.display='none'}
p.style.width=x;p.style.height=y;this.size(w,h,a)},esc:function(e){e=e||window.event;if(e.keyCode==27){TINY.box.hide()}},hide:function(){TINY.box.alpha(j,-1,0,3);document.onkeypress=null;if(v.closejs){v.closejs()}},resize:function(){TINY.box.pos();TINY.box.mask()},mask:function(){m.style.height=this.total(1)+'px';m.style.width=this.total(0)+'px'},pos:function(){var t;if(typeof v.top!='undefined'){t=v.top}else{t=(this.height()/v.topsplit)-(j.offsetHeight/2);t=t<20?20:t}
if(!v.fixed&&!v.top){t+=this.top()}
j.style.top=t+'px';j.style.left=typeof v.left!='undefined'?v.left+'px':(this.width()/2)-(j.offsetWidth/2)+'px'},alpha:function(e,d,a){clearInterval(e.ai);if(d){e.style.opacity=0;e.style.filter='alpha(opacity=0)';e.style.display='block';TINY.box.pos()}
e.ai=setInterval(function(){TINY.box.ta(e,a,d)},20)},ta:function(e,a,d){var o=Math.round(e.style.opacity*100);if(o==a){clearInterval(e.ai);if(d==-1){e.style.display='none';e==j?TINY.box.alpha(m,-1,0,2):b.innerHTML=p.style.backgroundImage=''}else{if(e==m){this.alpha(j,1,100)}else{j.style.filter='';TINY.box.fill(v.html||v.url,v.url||v.iframe||v.image,v.post,v.animate,v.width,v.height)}}}else{var n=a-Math.floor(Math.abs(a-o)*.5)*d;e.style.opacity=n/100;e.style.filter='alpha(opacity='+n+')'}},size:function(w,h,a){if(a){clearInterval(p.si);var wd=parseInt(p.style.width)>w?-1:1,hd=parseInt(p.style.height)>h?-1:1;p.si=setInterval(function(){TINY.box.ts(w,wd,h,hd)},20)}else{p.style.backgroundImage='none';if(v.close){p.appendChild(g);g.v=1}
p.style.width=w+'px';p.style.height=h+'px';b.style.display='';this.pos();if(v.openjs){v.openjs()}}},ts:function(w,wd,h,hd){var cw=parseInt(p.style.width),ch=parseInt(p.style.height);if(cw==w&&ch==h){clearInterval(p.si);p.style.backgroundImage='none';b.style.display='block';if(v.close){p.appendChild(g);g.v=1}
if(v.openjs){v.openjs()}}else{if(cw!=w){p.style.width=(w-Math.floor(Math.abs(w-cw)*.6)*wd)+'px'}
if(ch!=h){p.style.height=(h-Math.floor(Math.abs(h-ch)*.6)*hd)+'px'}
this.pos()}},top:function(){return document.documentElement.scrollTop||document.body.scrollTop},width:function(){return self.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},height:function(){return self.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},total:function(d){var b=document.body,e=document.documentElement;return d?Math.max(Math.max(b.scrollHeight,e.scrollHeight),Math.max(b.clientHeight,e.clientHeight)):Math.max(Math.max(b.scrollWidth,e.scrollWidth),Math.max(b.clientWidth,e.clientWidth))}}}();

var swfobject=function(){var D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=false,U=[h],o=[],N=[],I=[],l,Q,E,B,J=false,a=false,n,G,m=true,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=Y?/win/.test(Y):/win/.test(ah),ac=Y?/mac/.test(Y):/mac/.test(ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,X=!+"\v1",ag=[0,0,0],ab=null;if(typeof t.plugins!=D&&typeof t.plugins[S]==r){ab=t.plugins[S].description;if(ab&&!(typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin)){T=true;X=false;ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1");ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10);ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10);ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof O.ActiveXObject!=D){try{var ad=new ActiveXObject(W);if(ad){ab=ad.GetVariable("$version");if(ab){X=true;ab=ab.split(" ")[1].split(",");ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}}catch(Z){}}}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac}}(),k=function(){if(!M.w3){return}if((typeof j.readyState!=D&&j.readyState=="complete")||(typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))){f()}if(!J){if(typeof j.addEventListener!=D){j.addEventListener("DOMContentLoaded",f,false)}if(M.ie&&M.win){j.attachEvent(x,function(){if(j.readyState=="complete"){j.detachEvent(x,arguments.callee);f()}});if(O==top){(function(){if(J){return}try{j.documentElement.doScroll("left")}catch(X){setTimeout(arguments.callee,0);return}f()})()}}if(M.wk){(function(){if(J){return}if(!/loaded|complete/.test(j.readyState)){setTimeout(arguments.callee,0);return}f()})()}s(f)}}();function f(){if(J){return}try{var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));Z.parentNode.removeChild(Z)}catch(aa){return}J=true;var X=U.length;for(var Y=0;Y<X;Y++){U[Y]()}}function K(X){if(J){X()}else{U[U.length]=X}}function s(Y){if(typeof O.addEventListener!=D){O.addEventListener("load",Y,false)}else{if(typeof j.addEventListener!=D){j.addEventListener("load",Y,false)}else{if(typeof O.attachEvent!=D){i(O,"onload",Y)}else{if(typeof O.onload=="function"){var X=O.onload;O.onload=function(){X();Y()}}else{O.onload=Y}}}}}function h(){if(T){V()}else{H()}}function V(){var X=j.getElementsByTagName("body")[0];var aa=C(r);aa.setAttribute("type",q);var Z=X.appendChild(aa);if(Z){var Y=0;(function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");if(ab){ab=ab.split(" ")[1].split(",");M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)]}}else{if(Y<10){Y++;setTimeout(arguments.callee,10);return}}X.removeChild(aa);Z=null;H()})()}else{H()}}function H(){var ag=o.length;if(ag>0){for(var af=0;af<ag;af++){var Y=o[af].id;var ab=o[af].callbackFn;var aa={success:false,id:Y};if(M.pv[0]>0){var ae=c(Y);if(ae){if(F(o[af].swfVersion)&&!(M.wk&&M.wk<312)){w(Y,true);if(ab){aa.success=true;aa.ref=z(Y);ab(aa)}}else{if(o[af].expressInstall&&A()){var ai={};ai.data=o[af].expressInstall;ai.width=ae.getAttribute("width")||"0";ai.height=ae.getAttribute("height")||"0";if(ae.getAttribute("class")){ai.styleclass=ae.getAttribute("class")}if(ae.getAttribute("align")){ai.align=ae.getAttribute("align")}var ah={};var X=ae.getElementsByTagName("param");var ac=X.length;for(var ad=0;ad<ac;ad++){if(X[ad].getAttribute("name").toLowerCase()!="movie"){ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value")}}P(ai,ah,Y,ab)}else{p(ae);if(ab){ab(aa)}}}}}else{w(Y,true);if(ab){var Z=z(Y);if(Z&&typeof Z.SetVariable!=D){aa.success=true;aa.ref=Z}ab(aa)}}}}}function z(aa){var X=null;var Y=c(aa);if(Y&&Y.nodeName=="OBJECT"){if(typeof Y.SetVariable!=D){X=Y}else{var Z=Y.getElementsByTagName(r)[0];if(Z){X=Z}}}return X}function A(){return!a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312)}function P(aa,ab,X,Z){a=true;E=Z||null;B={success:false,id:X};var ae=c(X);if(ae){if(ae.nodeName=="OBJECT"){l=g(ae);Q=null}else{l=ae;Q=X}aa.id=R;if(typeof aa.width==D||(!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)){aa.width="310"}if(typeof aa.height==D||(!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)){aa.height="137"}j.title=j.title.slice(0,47)+" - Flash Player Installation";var ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;if(typeof ab.flashvars!=D){ab.flashvars+="&"+ac}else{ab.flashvars=ac}if(M.ie&&M.win&&ae.readyState!=4){var Y=C("div");X+="SWFObjectNew";Y.setAttribute("id",X);ae.parentNode.insertBefore(Y,ae);ae.style.display="none";(function(){if(ae.readyState==4){ae.parentNode.removeChild(ae)}else{setTimeout(arguments.callee,10)}})()}u(aa,ab,X)}}function p(Y){if(M.ie&&M.win&&Y.readyState!=4){var X=C("div");Y.parentNode.insertBefore(X,Y);X.parentNode.replaceChild(g(Y),X);Y.style.display="none";(function(){if(Y.readyState==4){Y.parentNode.removeChild(Y)}else{setTimeout(arguments.callee,10)}})()}else{Y.parentNode.replaceChild(g(Y),Y)}}function g(ab){var aa=C("div");if(M.win&&M.ie){aa.innerHTML=ab.innerHTML}else{var Y=ab.getElementsByTagName(r)[0];if(Y){var ad=Y.childNodes;if(ad){var X=ad.length;for(var Z=0;Z<X;Z++){if(!(ad[Z].nodeType==1&&ad[Z].nodeName=="PARAM")&&!(ad[Z].nodeType==8)){aa.appendChild(ad[Z].cloneNode(true))}}}}}return aa}function u(ai,ag,Y){var X,aa=c(Y);if(M.wk&&M.wk<312){return X}if(aa){if(typeof ai.id==D){ai.id=Y}if(M.ie&&M.win){var ah="";for(var ae in ai){if(ai[ae]!=Object.prototype[ae]){if(ae.toLowerCase()=="data"){ag.movie=ai[ae]}else{if(ae.toLowerCase()=="styleclass"){ah+=' class="'+ai[ae]+'"'}else{if(ae.toLowerCase()!="classid"){ah+=" "+ae+'="'+ai[ae]+'"'}}}}}var af="";for(var ad in ag){if(ag[ad]!=Object.prototype[ad]){af+='<param name="'+ad+'" value="'+ag[ad]+'" />'}}aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>";N[N.length]=ai.id;X=c(ai.id)}else{var Z=C(r);Z.setAttribute("type",q);for(var ac in ai){if(ai[ac]!=Object.prototype[ac]){if(ac.toLowerCase()=="styleclass"){Z.setAttribute("class",ai[ac])}else{if(ac.toLowerCase()!="classid"){Z.setAttribute(ac,ai[ac])}}}}for(var ab in ag){if(ag[ab]!=Object.prototype[ab]&&ab.toLowerCase()!="movie"){e(Z,ab,ag[ab])}}aa.parentNode.replaceChild(Z,aa);X=Z}}return X}function e(Z,X,Y){var aa=C("param");aa.setAttribute("name",X);aa.setAttribute("value",Y);Z.appendChild(aa)}function y(Y){var X=c(Y);if(X&&X.nodeName=="OBJECT"){if(M.ie&&M.win){X.style.display="none";(function(){if(X.readyState==4){b(Y)}else{setTimeout(arguments.callee,10)}})()}else{X.parentNode.removeChild(X)}}}function b(Z){var Y=c(Z);if(Y){for(var X in Y){if(typeof Y[X]=="function"){Y[X]=null}}Y.parentNode.removeChild(Y)}}function c(Z){var X=null;try{X=j.getElementById(Z)}catch(Y){}return X}function C(X){return j.createElement(X)}function i(Z,X,Y){Z.attachEvent(X,Y);I[I.length]=[Z,X,Y]}function F(Z){var Y=M.pv,X=Z.split(".");X[0]=parseInt(X[0],10);X[1]=parseInt(X[1],10)||0;X[2]=parseInt(X[2],10)||0;return(Y[0]>X[0]||(Y[0]==X[0]&&Y[1]>X[1])||(Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]))?true:false}function v(ac,Y,ad,ab){if(M.ie&&M.mac){return}var aa=j.getElementsByTagName("head")[0];if(!aa){return}var X=(ad&&typeof ad=="string")?ad:"screen";if(ab){n=null;G=null}if(!n||G!=X){var Z=C("style");Z.setAttribute("type","text/css");Z.setAttribute("media",X);n=aa.appendChild(Z);if(M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0){n=j.styleSheets[j.styleSheets.length-1]}G=X}if(M.ie&&M.win){if(n&&typeof n.addRule==r){n.addRule(ac,Y)}}else{if(n&&typeof j.createTextNode!=D){n.appendChild(j.createTextNode(ac+" {"+Y+"}"))}}}function w(Z,X){if(!m){return}var Y=X?"visible":"hidden";if(J&&c(Z)){c(Z).style.visibility=Y}else{v("#"+Z,"visibility:"+Y)}}function L(Y){var Z=/[\\\"<>\.;]/;var X=Z.exec(Y)!=null;return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y}var d=function(){if(M.ie&&M.win){window.attachEvent("onunload",function(){var ac=I.length;for(var ab=0;ab<ac;ab++){I[ab][0].detachEvent(I[ab][1],I[ab][2])}var Z=N.length;for(var aa=0;aa<Z;aa++){y(N[aa])}for(var Y in M){M[Y]=null}M=null;for(var X in swfobject){swfobject[X]=null}swfobject=null})}}();return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab;Y.swfVersion=X;Y.expressInstall=aa;Y.callbackFn=Z;o[o.length]=Y;w(ab,false)}else{if(Z){Z({success:false,id:ab})}}},getObjectById:function(X){if(M.w3){return z(X)}},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:false,id:ah};if(M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y){w(ah,false);K(function(){ae+="";ag+="";var aj={};if(af&&typeof af===r){for(var al in af){aj[al]=af[al]}}aj.data=ab;aj.width=ae;aj.height=ag;var am={};if(ad&&typeof ad===r){for(var ak in ad){am[ak]=ad[ak]}}if(Z&&typeof Z===r){for(var ai in Z){if(typeof am.flashvars!=D){am.flashvars+="&"+ai+"="+Z[ai]}else{am.flashvars=ai+"="+Z[ai]}}}if(F(Y)){var an=u(aj,am,ah);if(aj.id==ah){w(ah,true)}X.success=true;X.ref=an}else{if(aa&&A()){aj.data=aa;P(aj,am,ah,ac);return}else{w(ah,true)}}if(ac){ac(X)}})}else{if(ac){ac(X)}}},switchOffAutoHideShow:function(){m=false},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]}},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){if(M.w3){return u(Z,Y,X)}else{return undefined}},showExpressInstall:function(Z,aa,X,Y){if(M.w3&&A()){P(Z,aa,X,Y)}},removeSWF:function(X){if(M.w3){y(X)}},createCSS:function(aa,Z,Y,X){if(M.w3){v(aa,Z,Y,X)}},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash;if(Z){if(/\?/.test(Z)){Z=Z.split("?")[1]}if(aa==null){return L(Z)}var Y=Z.split("&");for(var X=0;X<Y.length;X++){if(Y[X].substring(0,Y[X].indexOf("="))==aa){return L(Y[X].substring((Y[X].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(a){var X=c(R);if(X&&l){X.parentNode.replaceChild(l,X);if(Q){w(Q,true);if(M.ie&&M.win){l.style.display="block"}}if(E){E(B)}}a=false}}}}();

var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion()
{var version;var axo;var e;try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");version=axo.GetVariable("$version");}catch(e){}
if(!version)
{try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");version="WIN 6,0,21,0";axo.AllowScriptAccess="always";version=axo.GetVariable("$version");}catch(e){}}
if(!version)
{try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");version=axo.GetVariable("$version");}catch(e){}}
if(!version)
{try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");version="WIN 3,0,18,0";}catch(e){}}
if(!version)
{try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");version="WIN 2,0,0,11";}catch(e){version=-1;}}
return version;}
function GetSwfVer(){var flashVer=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var swVer2=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var flashDescription=navigator.plugins["Shockwave Flash"+swVer2].description;var descArray=flashDescription.split(" ");var tempArrayMajor=descArray[2].split(".");var versionMajor=tempArrayMajor[0];var versionMinor=tempArrayMajor[1];var versionRevision=descArray[3];if(versionRevision==""){versionRevision=descArray[4];}
if(versionRevision[0]=="d"){versionRevision=versionRevision.substring(1);}else if(versionRevision[0]=="r"){versionRevision=versionRevision.substring(1);if(versionRevision.indexOf("d")>0){versionRevision=versionRevision.substring(0,versionRevision.indexOf("d"));}}
var flashVer=versionMajor+"."+versionMinor+"."+versionRevision;}}
else if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1)flashVer=4;else if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1)flashVer=3;else if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1)flashVer=2;else if(isIE&&isWin&&!isOpera){flashVer=ControlVersion();}
return flashVer;}
function DetectFlashVer(reqMajorVer,reqMinorVer,reqRevision)
{versionStr=GetSwfVer();if(versionStr==-1){return false;}else if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",");}else{versionArray=versionStr.split(".");}
var versionMajor=versionArray[0];var versionMinor=versionArray[1];var versionRevision=versionArray[2];if(versionMajor>parseFloat(reqMajorVer)){return true;}else if(versionMajor==parseFloat(reqMajorVer)){if(versionMinor>parseFloat(reqMinorVer))
return true;else if(versionMinor==parseFloat(reqMinorVer)){if(versionRevision>=parseFloat(reqRevision))
return true;}}
return false;}}
function AC_AddExtension(src,ext)
{if(src.indexOf('?')!=-1)
return src.replace(/\?/,ext+'?');else
return src+ext;}
function AC_Generateobj(objAttrs,params,embedAttrs)
{var str='';if(isIE&&isWin&&!isOpera)
{str+='<object ';for(var i in objAttrs)
str+=i+'="'+objAttrs[i]+'" ';for(var i in params)
str+='><param name="'+i+'" value="'+params[i]+'" /> ';str+='></object>';}else{str+='<embed ';for(var i in embedAttrs)
str+=i+'="'+embedAttrs[i]+'" ';str+='> </embed>';}
document.write(str);}
function AC_FL_RunContent(){var ret=AC_GetArgs
(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(ret.objAttrs,ret.params,ret.embedAttrs);}
function AC_GetArgs(args,ext,srcParamName,classid,mimeType){var ret=new Object();ret.embedAttrs=new Object();ret.params=new Object();ret.objAttrs=new Object();for(var i=0;i<args.length;i=i+2){var currArg=args[i].toLowerCase();switch(currArg){case"classid":break;case"pluginspage":ret.embedAttrs[args[i]]=args[i+1];break;case"src":case"movie":args[i+1]=AC_AddExtension(args[i+1],ext);ret.embedAttrs["src"]=args[i+1];ret.params[srcParamName]=args[i+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":ret.objAttrs[args[i]]=args[i+1];break;case"id":case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":ret.embedAttrs[args[i]]=ret.objAttrs[args[i]]=args[i+1];break;default:ret.embedAttrs[args[i]]=ret.params[args[i]]=args[i+1];}}
ret.objAttrs["classid"]=classid;if(mimeType)ret.embedAttrs["type"]=mimeType;return ret;}

function loadIFrameScript(){try{var mediaServer="";var globalTemplateVersion="";var searchString=document.location.search.substr(1);var parameters=searchString.split('&');for(var i=0;i<parameters.length;i++){var keyValuePair=parameters[i].split('=');var parameterName=keyValuePair[0];var parameterValue=keyValuePair[1];if(parameterName=="gtVersion")
globalTemplateVersion=unescape(parameterValue);else if(parameterName=="mediaserver")
mediaServer=unescape(parameterValue);}
generateScriptBlock(mediaServer,globalTemplateVersion);}
catch(e){}}
function generateScriptBlock(mediaServerUrl,gtVersion){if(!isValid(gtVersion)){reportError();return;}
var mediaServerParts=mediaServerUrl.split("/");var host=mediaServerParts[2];var hostParts=host.split(".");if(hostParts.length>4||hostParts.length<3){reportError();return;}
var subdomainOne=hostParts[0];if(!isValid(subdomainOne)){reportError();return;}
var subdomainTwo=(hostParts.length==4)?hostParts[1]:"";if(!isValid(subdomainTwo)){reportError();return;}
var subdomain=subdomainOne+((subdomainTwo=="")?"":"."+subdomainTwo);var advertiserId=mediaServerParts[3];if(!isValid(advertiserId)){reportError();return;}
var publisherProtocol=window.location.protocol+"//";var iframeScriptFile=advertiserId+'/DARTIFrame_'+gtVersion+'.js';var urlStart=publisherProtocol+subdomain;document.write('<scr'+'ipt src="'+urlStart+".2mdn.net/"+iframeScriptFile+'">');document.write('</scr'+'ipt>');}
function isValid(stringValue){var isValid=false;if(stringValue.length<=15&&stringValue.search(new RegExp("[^A-Za-z0-9_]"))==-1)
isValid=true;return isValid;}
function reportError(){var publisherProtocol=window.location.protocol+"//";document.write(' <img src="'+publisherProtocol+'ad.doubleclick.net/activity;badserve=1" style="visibility:hidden" width=1 height=1>');}
loadIFrameScript();

(function(){var day=24*60*60*1000;var zeroPad=function(number,digits){number=String(number);while(number.length<digits)number='0'+number;return number;};var multipliers={millisecond:1,second:1000,minute:60*1000,hour:60*60*1000,day:day,week:7*day,month:{add:function(d,number){multipliers.year.add(d,Math[number>0?'floor':'ceil'](number/12));var prevMonth=d.getMonth()+(number%12);if(prevMonth==12){prevMonth=0;d.setYear(d.getFullYear()+1);}else if(prevMonth==-1){prevMonth=11;d.setYear(d.getFullYear()-1);}
d.setMonth(prevMonth);},diff:function(d1,d2){var diffYears=d1.getFullYear()-d2.getFullYear();var diffMonths=d1.getMonth()-d2.getMonth()+(diffYears*12);var diffDays=d1.getDate()-d2.getDate();return diffMonths+(diffDays/30);}},year:{add:function(d,number){d.setYear(d.getFullYear()+Math[number>0?'floor':'ceil'](number));},diff:function(d1,d2){return multipliers.month.diff(d1,d2)/12;}}};for(var unit in multipliers){if(unit.substring(unit.length-1)!='s'){multipliers[unit+'s']=multipliers[unit];}}
var format=function(d,code){if(Date.prototype.strftime.formatShortcuts[code]){return d.strftime(Date.prototype.strftime.formatShortcuts[code]);}else{var getter=(Date.prototype.strftime.formatCodes[code]||'').split('.');var nbr=d['get'+getter[0]]?d['get'+getter[0]]():'';if(getter[1])nbr=zeroPad(nbr,getter[1]);return nbr;}};var instanceMethods={succ:function(unit){return this.clone().add(1,unit);},add:function(number,unit){var factor=multipliers[unit]||multipliers.day;if(typeof factor=='number'){this.setTime(this.getTime()+(factor*number));}else{factor.add(this,number);}
return this;},diff:function(dateObj,unit,allowDecimal){dateObj=Date.create(dateObj);if(dateObj===null)return null;var factor=multipliers[unit]||multipliers.day;if(typeof factor=='number'){var unitDiff=(this.getTime()-dateObj.getTime())/factor;}else{var unitDiff=factor.diff(this,dateObj);}
return(allowDecimal?unitDiff:Math[unitDiff>0?'floor':'ceil'](unitDiff));},strftime:function(formatStr){var source=formatStr||'%Y-%m-%d',result='',match;while(source.length>0){if(match=source.match(Date.prototype.strftime.formatCodes.matcher)){result+=source.slice(0,match.index);result+=(match[1]||'')+format(this,match[2]);source=source.slice(match.index+match[0].length);}else{result+=source,source='';}}
return result;},getShortYear:function(){return this.getYear()%100;},getMonthNumber:function(){return this.getMonth()+1;},getMonthName:function(){return Date.MONTHNAMES[this.getMonth()];},getAbbrMonthName:function(){return Date.ABBR_MONTHNAMES[this.getMonth()];},getDayName:function(){return Date.DAYNAMES[this.getDay()];},getAbbrDayName:function(){return Date.ABBR_DAYNAMES[this.getDay()];},getDayOrdinal:function(){return Date.ORDINALNAMES[this.getDate()%10];},getHours12:function(){var hours=this.getHours();return hours>12?hours-12:(hours==0?12:hours);},getAmPm:function(){return this.getHours()>=12?'PM':'AM';},getUnix:function(){return Math.round(this.getTime()/1000,0);},getGmtOffset:function(){var hours=this.getTimezoneOffset()/60;var prefix=hours<0?'+':'-';hours=Math.abs(hours);return prefix+zeroPad(Math.floor(hours),2)+':'+zeroPad((hours%1)*60,2);},getTimezoneName:function(){var match=/(?:\((.+)\)$| ([A-Z]{3}) )/.exec(this.toString());return match[1]||match[2]||'GMT'+this.getGmtOffset();},toYmdInt:function(){return(this.getFullYear()*10000)+(this.getMonthNumber()*100)+this.getDate();},clone:function(){return new Date(this.getTime());}};for(var name in instanceMethods)Date.prototype[name]=instanceMethods[name];var staticMethods={create:function(date){if(date instanceof Date)return date;if(typeof date=='number')return new Date(date*1000);var parsable=String(date).replace(/^\s*(.+)\s*$/,'$1'),i=0,length=Date.create.patterns.length,pattern;var current=parsable;while(i<length){ms=Date.parse(current);if(!isNaN(ms))return new Date(ms);pattern=Date.create.patterns[i];if(typeof pattern=='function'){obj=pattern(current);if(obj instanceof Date)return obj;}else{current=parsable.replace(pattern[0],pattern[1]);}
i++;}
return NaN;},MONTHNAMES:'January February March April May June July August September October November December'.split(' '),ABBR_MONTHNAMES:'Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec'.split(' '),DAYNAMES:'Sunday Monday Tuesday Wednesday Thursday Friday Saturday'.split(' '),ABBR_DAYNAMES:'Sun Mon Tue Wed Thu Fri Sat'.split(' '),ORDINALNAMES:'th st nd rd th th th th th th'.split(' '),ISO:'%Y-%m-%dT%H:%M:%S.%N%G',SQL:'%Y-%m-%d %H:%M:%S',daysInMonth:function(year,month){if(month==2)
return new Date(year,1,29).getDate()==29?29:28;return[undefined,31,undefined,31,30,31,30,31,31,30,31,30,31][month];}};for(var name in staticMethods)Date[name]=staticMethods[name];Date.prototype.strftime.formatCodes={matcher:/()%(#?(%|[a-z]))/i,Y:'FullYear',y:'ShortYear.2',m:'MonthNumber.2','#m':'MonthNumber',B:'MonthName',b:'AbbrMonthName',d:'Date.2','#d':'Date',e:'Date',A:'DayName',a:'AbbrDayName',w:'Day',o:'DayOrdinal',H:'Hours.2','#H':'Hours',I:'Hours12.2','#I':'Hours12',p:'AmPm',M:'Minutes.2','#M':'Minutes',S:'Seconds.2','#S':'Seconds',s:'Unix',N:'Milliseconds.3','#N':'Milliseconds',O:'TimezoneOffset',Z:'TimezoneName',G:'GmtOffset'};Date.prototype.strftime.formatShortcuts={F:'%Y-%m-%d',T:'%H:%M:%S',X:'%H:%M:%S',x:'%m/%d/%y',D:'%m/%d/%y','#c':'%a %b %e %H:%M:%S %Y',v:'%e-%b-%Y',R:'%H:%M',r:'%I:%M:%S %p',t:'\t',n:'\n','%':'%'};Date.create.patterns=[[/-/g,'/'],[/st|nd|rd|th/g,''],[/(3[01]|[0-2]\d)\s*\.\s*(1[0-2]|0\d)\s*\.\s*([1-9]\d{3})/,'$2/$1/$3'],[/([1-9]\d{3})\s*-\s*(1[0-2]|0\d)\s*-\s*(3[01]|[0-2]\d)/,'$2/$3/$1'],function(str){var match=str.match(/^(?:(.+)\s+)?([1-9]|1[012])(?:\s*\:\s*(\d\d))?(?:\s*\:\s*(\d\d))?\s*(am|pm)\s*$/i);if(match){if(match[1]){var d=Date.create(match[1]);if(isNaN(d))return;}else{var d=new Date();d.setMilliseconds(0);}
var hour=parseFloat(match[2]);hour=match[5].toLowerCase()=='am'?(hour==12?0:hour):(hour==12?12:hour+12);d.setHours(hour,parseFloat(match[3]||0),parseFloat(match[4]||0));return d;}}];})();var $D=Date.create;

CBCR3.namespace("CBCR3.Application");var _pageInitializerInstance;CBCR3.Application.PageInitializerProvider=Class.create({getInstance:function(){if(_pageInitializerInstance==null){_pageInitializerInstance=new CBCR3.Application.PageInitializer();}
return _pageInitializerInstance;}});CBCR3.Application.PageInitializer=Class.create(CBCR3.Commons.EventDispatcher,{domNode:null,debug:true,eventDelegatedEventsAdded:false,initialize:function($super){$super();},registerNode:function(domNode){Trace.write("pageinitializer -> registerNode() "+domNode,this.debug);Trace.write(domNode,this.debug);this.domNode=$(domNode);Trace.write(this.domNode,this.debug);this.registerAllButtons();},unregisterNodes:function(domNode){try{this.domNode=$(domNode);this.domNode.select("a.playButton").each(function(item){item.stopObserving("click",self.playButtonClickHandler);});this.domNode.select(".streamLink").each(function(item){item.stopObserving("click",self.playButtonClickHandler);});this.domNode.select(".addButton").each(function(item){item.stopObserving("click",self.addButtonClickHandler);});this.domNode.select(".likeButton").each(function(item){item.stopObserving("click",self.likeButtonClickHandler);});this.domNode.select(".favourite").each(function(item){item.stopObserving("click",self.favouriteButtonClickHandler);});this.domNode.select(".permalinkButton").each(function(item){item.stopObserving("click",self.permalinkButtonClickHandler);});this.domNode.select(".twitterShare").each(function(item){item.stopObserving("click",self.socialShareClickHandler);});this.domNode.select(".facebookShare").each(function(item){item.stopObserving("click",self.socialShareClickHandler);});}catch(e){Trace.error(e);}},registerAllButtons:function(){this.registerPlayButtons();this.registerEventDelegatedEvents();this.registerStreamButtons();this.registerAddButtons();this.registerLikeButtons();this.registerInfoButtons();this.registerPermalinkButtons();this.registerPlaylistButtons();this.registerGearsBox();this.registerSocialButtons();},registerInfoButtons:function(){try{var self=this;var counter=0;Trace.write("registerInfoButtons counter:"+counter,false);this.domNode.select(".infoButton").each(function(item){item.observe("click",self.infoButtonClickHandler.bind(self));});}catch(e){Trace.error(e);}},registerPlayButtons:function(){var self=this;var msg=0;Trace.write("registerPlayButtons()...",this.debug);this.domNode.select(".playButton").each(function(item){var inDynamicPlaySection=($(item).up(".dynamicPlaySection"))?true:false;if(!inDynamicPlaySection){msg++;item.observe("click",self.playButtonClickHandler.bind(self));}});},registerEventDelegatedEvents:function(){if(this.eventDelegatedEventsAdded){return;}
this.eventDelegatedEventsAdded=true;var self=this;$(document).on("click",".dynamicPlaySection .playButton",self.playButtonClickHandler.bind(self));$(document).on("click",".dynamicShareSection .gearsButton",self.gearsBoxClickHandler.bind(self));$(document).on("click",".dynamicShareSection .permalinkButton",self.shareClickHandler.bind(self));},registerPanelButtons:function(){var self=this;var msg=0;msg=0;this.domNode.select(".streamPanelLink").each(function(item){msg++;item.observe("click",self.streamClickHandler.bind(self));});},registerStreamButtons:function(){var self=this;var msg=0;msg=0;this.domNode.select("a.streamLink").each(function(item){msg++;item.observe("click",self.streamClickHandler.bind(self));});},registerAddButtons:function(){var self=this;this.domNode.select(".addButton").each(function(item){item.observe("click",self.addButtonClickHandler.bind(self));});},registerLikeButtons:function(){var self=this;this.domNode.select(".likeButton").each(function(item){item.observe("click",self.likeButtonClickHandler.bind(self));});this.domNode.select(".favourite").each(function(item){item.observe("click",self.favouriteButtonClickHandler.bind(self));});},registerPermalinkButtons:function(){var self=this;this.domNode.select(".permalinkButton").each(function(item){item.observe("click",self.permalinkButtonClickHandler.bind(self));});},registerPlaylistButtons:function(){var self=this;this.domNode.select(".playlistplay").each(function(item){item.observe("click",self.playPlaylistHandler.bind(self));});},registerGearsBox:function(){try{Trace.write("Registering registerGearsBox",this.debug);var self=this;this.domNode.select(".gearsButton").each(function(item){var inDynamicShareSection=($(item).up(".dynamicShareSection"))?true:false;if(!inDynamicShareSection){item.observe("click",self.gearsBoxClickHandler.bind(self));item.show();}});}catch(e){Trace.error(e);}},registerSocialButtons:function(){var self=this;this.domNode.select(".twitterShare").each(function(item){item.observe("click",self.socialShareClickHandler.bind(self));});this.domNode.select(".facebookShare").each(function(item){item.observe("click",self.socialShareClickHandler.bind(self));});},playPlaylistHandler:function(event){var self=this;this.playButtonClickHandler(event);},infoButtonClickHandler:function(event){try{Event.stop(event);Trace.write("infoButtonClickHandler: ",this.debug);Trace.write(event,this.debug);var source=event.target;var permalink=source.readAttribute("href");Trace.write(permalink,this.debug);this.dispatchEvent(CBCR3.Player.Events.PageEvent.showtrackinfo,{permalink:permalink,source:source});}catch(e){Trace.error(e);}},shareClickHandler:function(event){try{Trace.write("shareClickHandler: ",this.debug);Trace.write(event,this.debug);var source=event.target;var permalink=source.readAttribute("href");var title=source.readAttribute("title");Trace.write(permalink,this.debug);var opts={permalink:permalink,source:source,title:title};opts=this.checkForSearchlightShare(source,opts);this.dispatchEvent(CBCR3.Player.Events.PageEvent.permalink,opts);Event.stop(event);}catch(e){Trace.error(e);}},gearsBoxClickHandler:function(event){try{Trace.write("gearsBoxClickHandler: ",this.debug);Trace.write(event,this.debug);var source=event.target;var permalink=source.readAttribute("href");var title=source.readAttribute("title");Trace.write(permalink,this.debug);this.dispatchEvent(CBCR3.Player.Events.PageEvent.gearsSelected,{permalink:permalink,source:source,title:title});Event.stop(event);}catch(e){Trace.error(e);}},playButtonClickHandler:function(event){Trace.write("PlayButtonClickHandler: ",true);Event.stop(event);var permalink=event.target.readAttribute("href");Trace.write(permalink,true);var moreInfo=this.submitPlayEventTrackingForStreamPanel(permalink,event);if(permalink==null)
return;if(permalink.toLowerCase().indexOf("/stream/")>-1){if(Prototype.Browser.IE){permalink=this.fixIeHref(permalink);}
this.dispatchEvent(CBCR3.Player.Events.PageEvent.playStream,{streamPermalink:permalink});}else{var item=$(event.target);var isSearchlightPlaylist=(item.hasClassName("searchlightPlaylist"))?true:false;this.dispatchEvent(CBCR3.Player.Events.PageEvent.playPermalink,{permalink:permalink,isSearchlight:isSearchlightPlaylist});}},streamClickHandler:function(event){Event.stop(event);var permalink=event.target.readAttribute("href");Trace.write("streamClickHandler() the permalink:"+permalink,this.debug);if(Prototype.Browser.IE){permalink=this.fixIeHref(permalink);}
if(permalink==null)
return;this.playStream(permalink);},socialShareClickHandler:function(event){Event.stop(event);Trace.write("socialShareClick",true);Trace.write(event,true);Trace.write(this,true);Trace.write(this.getListeners(),true);this.dispatchEvent(CBCR3.Player.Events.PageEvent.socialShare,{permalink:event.target.readAttribute("href"),type:event.target.readAttribute("class")});},playStream:function(permalink){this.dispatchEvent(CBCR3.Player.Events.PageEvent.playStream,{streamPermalink:permalink});},addButtonClickHandler:function(event){Event.stop(event);Trace.write("addButtonClickHandler()",true);if(this.checkDisabled(event))
return;if(!CBCR3.environment().isLoggedIn){this.dispatchEvent(CBCR3.Player.Events.AuthenticationEvent.loginRequired,{message:"You must be logged in to add tracks to your playlists."});return;}
this.dispatchEvent(CBCR3.Player.Events.PageEvent.addPermalink,{permalink:event.target.readAttribute("href")});},favouriteButtonClickHandler:function(event){Event.stop(event);if(this.checkDisabled(event))
return;this.dispatchEvent(CBCR3.Player.Events.PageEvent.favouritePermalink,{permalink:event.target.readAttribute("href")});},likeButtonClickHandler:function(event){Event.stop(event);try{Trace.write("likeButtonClickHandler() ->",this.debug);if(this.checkDisabled(event))
return;if(!CBCR3.environment().isLoggedIn){this.dispatchEvent(CBCR3.Player.Events.AuthenticationEvent.loginRequired,{message:"You must be logged in to like something."});return;}
this.dispatchEvent(CBCR3.Player.Events.PageEvent.favouritePermalink,{permalink:event.target.readAttribute("href")});}catch(e){Trace.error(e);}},permalinkButtonClickHandler:function(event){Event.stop(event);Trace.write("pageinitializer.js -> permalinkButtonClickHandler()",true);Trace.write(event,true);if(this.checkDisabled(event))
return;var opts={permalink:event.target.readAttribute("href"),title:event.target.readAttribute("title")||"CBC Music"};opts=this.checkForSearchlightShare(event.target,opts);this.dispatchEvent(CBCR3.Player.Events.PageEvent.permalink,opts);},checkForSearchlightShare:function(source,opts){if(source==null)
return opts;var shareUrl=source.readAttribute("data-share-url");if(shareUrl){opts.isSearchlight=true;opts.searchlightLink=shareUrl;}
return opts;},fixIeHref:function(permalink){Trace.write("fixIeHref() permalink:"+permalink+" include?:"+permalink.include('http://'),true);if(permalink.include('http://'))
return permalink.sub(/(http:\/\/.*?\/)/,'/');return permalink;},checkDisabled:function(event){var disabled=Event.element(event).hasClassName('disabled');Trace.write("checkDisabled() disabled:"+disabled,true);Trace.write(event,true);return disabled;},submitPlayEventTrackingForStreamPanel:function(permalink,event){if(permalink===null||permalink===''||event===null){return;}
if(_gaq&&event!=null&&event.currentTarget!=null){var eventName='';var title='';var logEvent=false;var playEventName="Track Play Click";var playEventValue="";var params=document.location.href.toQueryParams();var pagePermalink=(params.permalink!=null&&params.permalink!="")?params.permalink:"/";if(permalink.toLowerCase().indexOf("/stream/")>-1||permalink.toLowerCase().indexOf('/searchlight')>-1){logEvent=true;title=event.currentTarget.title;eventName='Stream';playEventName="Stream Play Click";_gaq.push(['_trackEvent',eventName,pagePermalink,title]);}else if(permalink.toLowerCase().indexOf("/play/")>-1){logEvent=true;var extraData="";if(event.target&&event.target.innerHTML){extraData=event.target.hasClassName("searchlightPlaylist")?"Searchlight ":"";title=event.target.innerHTML;}else{title=event.currentTarget.innerHTML;}
if(event.target)
playEventValue=event.target.title;if(permalink.toLowerCase().indexOf("/concert/")>-1){eventName='OnDemand RecordingTrack';_gaq.push(['_trackEvent',eventName,pagePermalink,title]);}else if(permalink.toLowerCase().indexOf("/artist/")>-1){eventName='OnDemand ArtistTrack';_gaq.push(['_trackEvent',extraData+eventName,pagePermalink,title]);}else if(permalink.toLowerCase().indexOf("/playlist/")>-1){eventName='OnDemand PlaylistTrack';_gaq.push(['_trackEvent',eventName,pagePermalink,title]);}else{eventName='OnDemand ModularTrack';_gaq.push(['_trackEvent',eventName,pagePermalink,title]);}}
_gaq.push(['_trackEvent',playEventName,pagePermalink,permalink]);if(logEvent){this.dispatchEvent(CBCR3.Player.Events.StreamEvent.logInfo,{title:title,eventName:eventName});}}}});

CBCR3.namespace("CBCR3.Panel.Models");CBCR3.Panel.Models.Track=Class.create({initialize:function(properties){Trace.write("Track: initialize()",false);if(!properties)
properties={};this.title=properties.title||"";this.artist=properties.artist||"";this.infoLink=properties.infoLink||"";this.permalink=properties.permalink||"";this.type=properties.type||"";this.iTunesLink=properties.iTunesLink||"";}});

CBCR3.namespace("CBCR3.Player.Modules");CBCR3.Player.Modules.TrackItem=Class.create(CBCR3.Commons.EventDispatcher,{track:null,isActive:false,clientId:null,item:null,initialize:function($super,track)
{$super();this.track=track;},getElement:function()
{return this.item;},showActive:function()
{this.item.addClassName("trackItem_active");this.item.focus();},hideActive:function()
{this.item.removeClassName("trackItem_active");},create:function()
{this.item=new Element("button",{type:"button",title:"Select this track to play",className:"panelButton trackItem"});this.item.update(this.getTemplate().evaluate({artist:this.track.artist.escapeHTML(),title:this.track.title.escapeHTML(),sequence:this.track.sequence,toolTip:this.track.artist.escapeHTML()+" "+this.track.title.escapeHTML()}));this.item.observe('click',this.track_Click.bind(this));if((this.track.sequence%2)!=0)
this.item.addClassName("odd");return this.item;},track_Click:function(event)
{this.dispatchEvent(CBCR3.Player.Events.PlaylistEvent.trackSelected,{track:this.track});},getTemplate:function()
{var markup="<div class='trackItem_info'>"+"<label class='sequence'>#{sequence}</label>"+"<label class='track'>"+"<span class='artist'>#{artist}</span> "+"<span class='title'>#{title}</span>"+"</label>"+"</div>";return new Template(markup);}});

CBCR3.namespace("CBCR3.Panel.Modules");CBCR3.Panel.Modules.TrackPanel=Class.create(CBCR3.Commons.EventDispatcher,{modal:null,panel:null,trackItemPanel:null,playlistInfo:null,closeButton:null,musicService:null,playlistPermalink:null,sequence:0,trackItems:null,scrollTop:0,initialize:function($super,musicService)
{$super();this.musicService=musicService;this.musicService.addEventListener(CBCR3.Player.Events.ServiceEvent.playlistReceived,this.playlistReceivedHandler.bind(this));},update:function(newSequence)
{if(!this.isOpen())
return;if(this.sequence!=0)
this.trackItems[this.sequence].hideActive();this.sequence=newSequence;this.trackItems[this.sequence].showActive();},show:function(playlistPermalink,sequence)
{if(this.isOpen()){this.hide();return;}
this.playlistPermalink=playlistPermalink;this.sequence=sequence;this.showPanel();CBCR3.Player.Util.showLoading(this.trackItemPanel);this.retrievePlaylistTracks();},showPanel:function()
{if(!this.panel)
{this.panel=new Element('div',{id:'trackPanel'});$(document.body).insert(this.panel);Event.observe(window,"resize",this.windowResizeHandler.bind(this));}
this.panel.update(this.getPanelTemplate().evaluate({}));this.closeButton=this.panel.down(".trackPanel_close");this.closeButton.observe('click',this.trackPanelClose_Click.bind(this));this.trackItemPanel=this.panel.down(".trackPanel_trackItems");this.playlistInfo=this.panel.down(".trackPanel_playlistInfo");this.modal=new Control.Modal(this.panel,{overlayOpacity:0.75,className:'modalWindow',fade:false,position:[this.getXPos.bind(this),230]});this.modal.open();},getXPos:function()
{var viewport=(document.viewport.getWidth()>1000)?document.viewport.getWidth():1000;return viewport/2-this.panel.getWidth()/2+50;},windowResizeHandler:function(event)
{if(this.isOpen())
this.modal.position(event);},isOpen:function()
{return this.modal!=null&&this.modal.isOpen;},retrievePlaylistTracks:function()
{this.musicService.getPlaylist(this.playlistPermalink);},playlistReceivedHandler:function(event)
{var playlist=event.data.playlist;CBCR3.Player.Util.hideLoading(this.trackItemPanel);this.setHeaderItems(playlist);this.addTrackItems(playlist.tracks);},setHeaderItems:function(playlist)
{this.playlistInfo.update(this.getInfoTemplate().evaluate({title:playlist.title.truncate(37),toolTip:playlist.title,editUrl:playlist.permalink,permalink:playlist.permalink}));},addTrackItems:function(tracks)
{this.trackItems=new Array();for(var i=0;i<tracks.length;i++){this.addTrackItem(tracks[i]);}
this.setScrollPosition(this.scrollTop);},addTrackItem:function(track)
{var trackItem=new CBCR3.Player.Modules.TrackItem(track);trackItem.addEventListener(CBCR3.Player.Events.PlaylistEvent.trackSelected,this.trackSelectedHandler.bind(this));this.trackItemPanel.appendChild(trackItem.create());if(track.sequence==this.sequence){trackItem.showActive();this.scrollTop=this.calculateScrollPosition(trackItem.getElement(),track.sequence);}
this.trackItems[track.sequence]=trackItem;},calculateScrollPosition:function(element,sequence)
{return element.getHeight()*(sequence-1);},setScrollPosition:function(pos)
{this.trackItemPanel.scrollTop=pos;},trackSelectedHandler:function(event)
{this.update(event.data.track.sequence);this.dispatchEvent(CBCR3.Player.Events.PlaylistEvent.trackSelected,{track:event.data.track});},hide:function()
{this.modal.close();},trackPanelClose_Click:function(event)
{this.hide();},getPanelTemplate:function()
{return new Template("<div class='trackPanel_header'>"+"<button type='button' class='close trackPanel_close' title='Close track panel'>Close</button>"+"<div class='trackPanel_playlistInfo'></div>"+"</div>"+"<div class='trackPanel_trackItemsWrapper'>"+"<div class='trackPanel_trackItems'></div>"+"</div>"+"<div class='trackPanel_footer'></div>");},getInfoTemplate:function()
{return new Template("<label class='trackPanel_playlistTitle' title='#{toolTip}'>#{title}</label>"+"<div class='trackPanel_playlistLinks'>"+"<a class='r3playerLink' href='#{editUrl}' title='View playlist page'>VIEW</a> <span style='font-size:10px;'>|</span> "+"<a class='r3playerLink' href='#{permalink}' title='Right-click and copy this link to send playlist permalink to a friend'>PERMALINK</a>"+"</div>"+"<div class='clear'></div>");}});

CBCR3.namespace("CBCR3.Panel.Models");CBCR3.Panel.Models.TrackMetaData=Class.create(CBCR3.Panel.Models.Track,{initialize:function($super,properties){Trace.write("TrackmetaData: initialize()",false);$super(properties);if(!properties)
properties={};this.status=properties.status||"";this.thumbnail=properties.thumbnail||"";}});

CBCR3.namespace("CBCR3.Panel");CBCR3.namespace("CBCR3.Panel.Mappers");CBCR3.Panel.Mappers.TrackMetaDataDtoMapper=Class.create(CBCR3.Commons.MapperBase,{initialize:function($super){$super();},mapFrom:function(dto){return new CBCR3.Panel.Models.TrackMetaData({artist:dto.artist.blank()?"CBC Radio 3":dto.artist,infoLink:dto.infoLink,permalink:dto.permalink,status:dto.status.toLowerCase(),thumbnail:dto.thumbnail,title:dto.title,type:dto.type.toLowerCase(),iTunesLink:dto.iTunesLink});}});

CBCR3.namespace("CBCR3.Panel.Mappers");CBCR3.Panel.Mappers.StreamMetaDataDtoMapper=Class.create(CBCR3.Commons.MapperBase,{trackMapper:null,initialize:function($super){$super();this.trackMapper=new CBCR3.Panel.Mappers.TrackMetaDataDtoMapper();},mapFrom:function(dto){return new CBCR3.Panel.Models.StreamMetaData({name:dto.name,streamType:dto.streamType,permalink:dto.permalink,rtmpName:dto.rtmpName,rtmpUrl:dto.rtmpUrl,shoutcastUrl:dto.shoutcastUrl,tracks:this.trackMapper.mapCollection(dto.tracks)});}});

CBCR3.namespace("CBCR3.Mappers");CBCR3.Mappers.PlaylistDtoMapper=Class.create(CBCR3.Commons.MapperBase,{trackMapper:null,initialize:function($super){Trace.write("PlaylistDtoMapper() -> lib/cbcmusic/js/mappers",false);$super();this.trackMapper=new CBCR3.Player.Mappers.PlaylistTrackDtoMapper();},mapFrom:function(dto){return new CBCR3.Player.Models.Playlist({title:dto.Title,permalink:dto.Permalink,playlistPermalink:dto.PlaylistPermalink,trackcount:dto.TrackCount,lastmodified:dto.LastModifiedDate,tracks:this.trackMapper.mapCollection(dto.Tracks)});}});

CBCR3.namespace("CBCR3.Panel.PanelEvents");CBCR3.Panel.PanelEvents={itemSelected:"panelEvent:itemSelected",returnItem:"panelEvent:returnItem"};CBCR3.namespace("CBCR3.Panel");CBCR3.Panel.PanelSlider=Class.create(CBCR3.Commons.EventDispatcher,{mainDiv:null,subDiv:null,container:null,width:null,panelClassName:"slider_panel",debug:false,isSliding:false,initialize:function($super,container){$super();this.container=container;},movePanel:function(event){this.updateContent(event);this.togglePanel(this.container,event.moveTo,false);},movePanelNew:function(container,moveTo){this.togglePanel($(container),moveTo,false);},returnPanelNew:function(event,moveTo){Trace.write("returnPanelNew()",this.debug);this.togglePanel(this.container,moveTo,true);},returnPanel:function(event){Trace.write("returnPanel()",this.debug);this.togglePanel($(this.container),300,true);},removePanel:function(remove,moveTo){if(remove){var last=this.lastDescendant(this.container);var container=$(this.container);Trace.write("in removePanel() ",this.debug);Trace.write(this.container,this.debug);Trace.write(container,this.debug);if(container!=null){var width=parseInt(container.getStyle('width'));var total=width-moveTo;container.setStyle({'width':total+'px'});}
last.select(".item","a").each(function(item){item.stopObserving("click");});last.remove();}
Trace.write("isSliding: setting to FALSE",this.debug);this.isSliding=false;},updateContent:function(event){Trace.write('updateContent',this.debug);Trace.write(event,this.debug);var subDiv=event.subDiv;Trace.write(event.subDiv);subDiv.update();subDiv.insert(event.header);subDiv.insert(event.subContent);subDiv.insert(event.footer);this.subDiv=subDiv;},getNextDiv:function(element){var div=element.up("."+this.panelClassName);var newDiv=new Element("div",{className:this.panelClassName});div.insert({after:newDiv});return newDiv;},insertPanel:function(panel,element){Trace.write("insertPanel",this.debug);Trace.write(panel.innerHTML,this.debug);var header=panel.down(".header > div");header.observe("click",this.returnClickHandler.bind(this));var div=element.up("."+this.panelClassName);var parent=div.up("div");parent.insert(panel);},returnClickHandler:function(){this.dispatchEvent(CBCR3.Panel.Events.PanelEvent.returnPanel,{container:this.container,moveTo:300});},checkPanel:function(container,hide,moveTo,leftPosition){var origLeft=parseInt(moveTo)+parseInt(leftPosition);var left=parseInt(container.getStyle("left"));var remainder=left-origLeft;if(remainder!=0){Trace.write("CHECK Panel() -> left: "+left+" moveTo:"+moveTo+" remainder:"+remainder,this.debug);Trace.write("CHECK Panel() remainder:"+remainder,this.debug);new Effect.Move(container,{x:remainder*-1,transition:Effect.Transitions.sinoidal,duration:0.3});}
this.removePanel(hide,moveTo);},togglePanel:function(container,moveTo,hide){try{var self=this;Trace.write("isSliding: in togglePanel() "+this.isSliding,this.debug);if(this.isSliding)
return;Trace.write("togglePanel()",this.debug);Trace.write(container,this.debug);Trace.write("isSliding: setting to TRUE",this.debug);this.isSliding=true;Trace.write("togglePanel() moveTo -> "+moveTo,this.debug);var leftPosition=parseInt(container.getStyle('left'));if(!hide){var width=parseInt(container.getStyle('width'));var total=width+(moveTo*-1);container.setStyle({'width':total+'px'});}
new Effect.Move(container,{x:moveTo,transition:Effect.Transitions.sinoidal,duration:0.6,afterFinish:self.checkPanel.bind(self,container,hide,moveTo,leftPosition)});}catch(ex){Trace.error(ex);}},getTemplate:function(){var markup="<div class='streamPanel_status'></div>";return new Template(markup);},lastDescendant:function(element){element=$(element).lastChild;while(element&&element.nodeType!=1)
element=element.previousSibling;return $(element);}});

CBCR3.namespace("CBCR3.Panel");CBCR3.Panel.Feature=Class.create({items:null,container:null,containerName:null,currentPanel:null,mainDiv:null,subDiv:null,panelSlider:null,debug:true,initialize:function(options){try{this.items=new Array();Trace.write("Feature initialized -> test",this.debug);Trace.write(options,this.debug);this.container=$(options.container);this.mainDiv=new Element("div",{id:"panel_ondemand",className:"slider_panel gearsblock"});this.mainDiv.addClassName(" left-curve bottomleft-curve bottomright-curve");this.panelSlider=new CBCR3.Panel.PanelSlider(this.container);}catch(e){Trace.write("In Feature initialize()",this.debug);Trace.error(e);};},addItem:function(item){this.items.push(item);},render:function(){var content="";var self=this;var div=new Element("div",{className:"features items"});this.items.each(function(item,index){var styles=" genre";styles+=(index==0)?" feature left-curve topcontainer":" feature";styles+=(index%2==0)?" alt":"";item.addEventListener(CBCR3.Panel.PanelEvents.itemSelected,self.itemClickHandler.bind(self,{item:self}));item.addEventListener(CBCR3.Panel.PanelEvents.returnItem,self.returnClickHandler.bind(self,{item:self}));var el=item.render(index,styles);div.insert(el);});this.mainDiv.insert(div);this.container.appendChild(this.mainDiv);},itemClickHandler:function(opts,event){try{if(this.clicked)
return;this.clicked=true;Trace.write("itemClickHandler()",this.debug);Trace.write(event,this.debug);var target=event.data.element;var subItems=event.target.subItems;var newPanel=new CBCR3.Panel.FeaturesListPanel({prevName:"On Demand",name:event.target.description,panelStyle:"features"});Trace.write("itemClickHandler() this.items:",this.debug);Trace.write(subItems,this.debug);newPanel.create();newPanel.load(subItems);if(event.target.showViewAll){newPanel.panel.down(".footer").update(this.buildShowAll(event.target.permalink,event.target.name));}
Trace.write("panelSlider.insertPanel()",this.debug);this.panelSlider.insertPanel(newPanel.panel,target);newPanel.addEventListener(CBCR3.Panel.Events.PanelEvent.returnPanel,this.returnClickHandler.bind(this,{item:opts.item}));this.panelSlider.movePanelNew(this.container,newPanel.width*-1);}catch(e){Trace.error(e);}},buildShowAll:function(url,text){var anchor=new Element("a",{href:url});anchor.update("view all "+text.toLowerCase()+" &gt;&gt;");return anchor;},returnClickHandler:function(opts,event){try{Trace.write("EventListener Stop Observing -> event "+event+" opts:"+opts,this.debug);Trace.write(opts,this.debug);Trace.write(event,this.debug);var items=(event.target)?event.target.items:null;if(items!=null){Trace.write("EventListener items not Null",this.debug);items.each(function(item){if(item.clearEventListeners){Trace.write("clearing EventListener s for "+item,this.debug);item.clearEventListeners();}});}
opts.item.clicked=false;this.panelSlider.returnPanel();}catch(e){Trace.error(e);}}});CBCR3.Panel.FeatureItem=Class.create(CBCR3.Commons.EventDispatcher,{permalink:null,playlistPermalink:null,element:null,description:null,imageSrc:null,subItems:null,container:null,panelName:null,name:null,panelType:null,showViewAll:false,width:300,debug:false,initialize:function(options){Trace.write("options",this.debug);Trace.write(options,this.debug);this.permalink=options.permalink;this.playlistPermalink=options.playlistPermalink;this.description=options.description;this.imageSrc=options.imageSrc;this.container=options.container;this.subItems=options.subItems;this.name=options.name;this.panelName=options.panelName;this.panelType=options.panelType;this.showViewAll=options.showViewAll;},itemClickHandler:function(event){Event.stop(event);this.dispatchEvent(CBCR3.Panel.PanelEvents.itemSelected,{event:event,element:Event.element(event),name:this.panelName,moveTo:(this.width*-1),header:this.buildHeader(this.panelName),footer:this.buildFooter()});},returnClickHandler:function(event){Trace.write("FeatureItem returnClickHandler()",true);Event.stop(event);this.dispatchEvent(CBCR3.Panel.PanelEvents.returnItem,{moveTo:this.width});},buildHeader:function(name){var div=new Element("div",{className:"header left-curve right-curve"});div.update("<div class=\"left-curve\">"+this.panelType+"</div> <h4>"+name+"</h4>");return div;},buildFooter:function(permalink){var div=new Element("div",{className:"footer"});div.update("<a href=\"#"+permalink+"\">View More &gt;&gt;</div>");return div;},buildSubItems:function(){var content="";var self=this;this.subItems.each(function(item,index){Trace.write("feature item",this.debug);Trace.write(item,this.debug);var styles=(index%2==0)?" alt":"";styles+=(self.subItems.length==(index+1))?" bottomright-curve bottomleft-curve":"";content+=item.render(index,"item"+styles);});Trace.write(content,this.debug);return content;},render:function(index,styles){Trace.write("featureItem Render()",this.debug);var div=new Element("div",{className:"item"+styles});div.observe("click",this.itemClickHandler.bind(this));div.update(this.template(this));return div;},template:function(vars){Trace.write("template:",this.debug);Trace.write(vars,this.debug);var markup="<div class=\"left\"><label><a>#{description}</a></label></div>"+"<div class=\"right\"><a href=\"#play\" class=\"openList\"></a></div>";return new Template(markup).evaluate(vars);}});CBCR3.Panel.FeatureSubItem=Class.create({permalink:null,playlistPermalink:null,description:null,imageSrc:null,debug:false,initialize:function(options){this.permalink=options.permalink;this.playlistPermalink=options.playlistPermalink;this.description=options.description;this.imageSrc=options.imageSrc;Trace.write("FeatureSubItem: init",this.debug);},render:function(index,styles){return this.template(this,{styles:styles});},template:function(vars,options){vars.styles=options.styles;Trace.write("SubItems Template",this.debug);Trace.write(vars,this.debug);Trace.write(options,this.debug);var playtemplate=(this.playlistPermalink==null||this.playlistPermalink.blank())?"":"<a href=\"#{playlistPermalink}\" class=\"playButton\">#{description}</a>"+"<a href=\"#{playlistPermalink}\" class=\"gearsButton noinfo noadd\">#{description}</a>";var linktemplate=(this.permalink==null||this.permalink.blank())?"#{description}":"<a href=\"#{permalink}\">#{description}</a>";var markup="<div class=\"#{styles}\">"+"<div class=\"left bottomleft-curve\" style=\"width:90px;height:90px;border-right: solid 1px #fff;background: url(#{imageSrc}) no-repeat top left;\"></div>"+"<div class=\"left\"><label style=\"width:100px;\">"+linktemplate+"</label></div>"+"<div class=\"right\">"+playtemplate+"</div></div>";return new Template(markup).evaluate(vars);}});

CBCR3.namespace("CBCR3.Panel");CBCR3.Panel.Panel=Class.create(CBCR3.Commons.EventDispatcher,{panel:null,prevName:null,name:null,panelContent:null,panelStyle:null,width:null,debug:false,initialize:function($super,opts){$super();this.prevName=opts.prevName||"";this.name=opts.name||"";this.width=opts.width||300;this.panelStyle=opts.panelStyle||"";this.pageInitializer=new CBCR3.Application.PageInitializerProvider().getInstance();},create:function(){if(!this.panel)
this.buildPanel();},getNowPlaying:function(tracks){for(var i=0;i<tracks.length;i++){if(tracks[i].status==CBCR3.Player.StreamTrackStatus.playing)
return tracks[i];}
throw"COULD NOT FIND A NOW PLAYING STREAM FOR: "+this.name;},load:function(items){this.addItems(items);this.pageInitializer.registerNode(this.panelContent);},buildPanel:function(){try{this.panel=new Element('div',{className:'slider_panel gearsblock'});this.panel.update(this.getPanelTemplate().evaluate({styles:this.panelStyle+" items"}));this.modifyHeader();this.panelContent=this.panel.down(".items");}catch(e){Trace.write("buildPanel() error",this.debug);Trace.error(e);}},modifyHeader:function(){var twoLines;if(this.prevName=="web radio stations"){twoLines="style=\"line-height:12px;\"";}else{twoLines="";}
var header=this.panel.down('.header');header.update("<div class=\"left-curve\" "+twoLines+">"+this.prevName+"</div> <h4>"+this.name+"</h4>");header.down("div").observe("click",this.returnPanelHandler.bind(this));},returnPanelHandler:function(event){this.clearListeners();this.dispatchEvent(CBCR3.Panel.Events.PanelEvent.returnPanel);},addItems:function(items){this.panelContent.update();if(items.length==0){this.displayEmptyTemplate();return;}
for(var i=0;i<items.length;i++){this.addItem(items[i],i+1);}},displayEmptyTemplate:function(){this.panelContent.update(this.getEmptyTemplate());},addItem:function(item){alert("not implemented");},playStream_Handler:function(event){this.dispatchEvent(CBCR3.Panel.Events.PanelEvent.playStream,event);},permalinkSelectedHandler:function(event){this.hide();this.dispatchEvent(CBCR3.Player.Events.PlaylistEvent.permalinkSelected,{permalink:event.data.permalink,playlistPermalink:event.data.playlistPermalink});},permalinkAddedHandler:function(event){this.hide();this.dispatchEvent(CBCR3.Player.Events.PlaylistEvent.permalinkAdded,{permalink:event.data.permalink});},getPanelTemplate:function(tokens){return new Template("<div class='header left-curve right-curve'></div>"+"<div class='#{styles}'></div>"+"<div class='footer'></div>");},playButton_Click:function(event){},clearListeners:function(){}});CBCR3.Panel.FeaturesListPanel=Class.create(CBCR3.Panel.Panel,{initialize:function($super,opts){Trace.write("FeaturesListPanel -> init",this.debug);$super(opts);},addItem:function(item){var featureItem=new CBCR3.Panel.FeatureListItem(item);var featItem=featureItem.render();this.panelContent.insert(featItem);}});CBCR3.Panel.StationListPanel=Class.create(CBCR3.Panel.Panel,{streamStationManager:null,roomid:null,panelId:null,funcStationSelected:null,initialize:function($super,opts){$super(opts);this.panelId=opts.panelId;this.streamStationManager=CBCR3.Panel.StreamStationManagerProvider.getInstance();this.debug=false;},load:function(stations){var count=0;var self=this;var stationManager=this.streamStationManager;this.funcStationSelected=stationManager.stationSelectedHandler.bind(stationManager);self.panelContent.update();this.items=stations;this.items.each(function(station){var newStation=new CBCR3.Panel.StreamStation(station);newStation.addEventListener(CBCR3.Panel.Events.PanelEvent.stationSelected,self.funcStationSelected);self.panelContent.insert(newStation.renderContainer(count%2!=0));newStation.connectNode();});this.pageInitializer.registerNode(this.panelContent);},unloadEventListener:function(event){var self=this;this.items.each(function(station){Trace.write(station,this.debug);station.removeEventListener(CBCR3.Panel.Events.PanelEvent.stationSelected,self.funcStationSelected);});},getEmptyTemplate:function(){return"No stations available";},clearListeners:function(){this.unloadEventListener();}});CBCR3.Panel.PlayListListPanel=Class.create(CBCR3.Panel.Panel,{initialize:function($super,opts){$super(opts);},getEmptyTemplate:function(){return"No playlists available";},addItem:function(item){var playlistItem=new CBCR3.Panel.PlayListListItem(item);var itemDiv=playlistItem.render();itemDiv.observe("click",this.playlistSelected_Handler.bind(this,{item:item,target:itemDiv}));playlistItem.addEventListener(CBCR3.Panel.Events.PanelEvent.playlistSelected,this.playlistSelected_Handler.bind(this,{item:item,target:itemDiv}));this.panelContent.insert(itemDiv);playlistItem.wireUp();},load:function(items){this.addItems(items);this.pageInitializer.registerNode(this.panelContent);},playlistSelected_Handler:function(opts,event){this.dispatchEvent(CBCR3.Panel.Events.PanelEvent.playlistSelected,{panel:this,item:opts.item,target:opts.target});}});CBCR3.Panel.TrackListPanel=Class.create(CBCR3.Panel.Panel,{MAX_SIZE:8,tracksDiv:null,STATUS_PLAYING:"1",type:null,debug:true,initialize:function($super,opts){Trace.write("CBCR3.Panel.TrackListPanel initialize()",this.debug);$super(opts);this.type=opts.type;},getEmptyTemplate:function(){return"<span style=\"float:left;padding:5px\">No tracks have been added.</span>";},addItem:function(item,index){this.debug=true;var trackItem=new CBCR3.Panel.TrackListItem(item,index,this.type);trackItem.addEventListener("panelEvent:divChanged",this.checkContentHeight.bind(this));this.panelContent.insert(trackItem.render());trackItem.wireUp();},checkContentHeight:function(event){var tracksDiv=this.panel.down(".tracks");var totalHeight=0;var totalWidth=0;tracksDiv.select(".item").each(function(item){var dim=item.getDimensions();totalHeight+=dim.height;totalWidth=(dim.width>totalWidth)?dim.width:totalWidth;});this.tracksDiv=this.panel.down(".tracks");if(totalHeight>tracksDiv.getHeight())
this.tracksDiv.removeClassName('noscroll');else
this.tracksDiv.addClassName('noscroll');},registerNode:function(){try{this.pageInitializer.registerNode(this.panelContent);}catch(e){Trace.error(e);}},load:function(items){this.checkItems(items);this.pageInitializer.registerNode(this.panelContent);},checkItems:function(items){try{if(items!=null&&items.length<this.MAX_SIZE){this.tracksDiv=this.panel.down(".tracks");this.tracksDiv.addClassName('noscroll');}
this.addItems(items);}catch(e){Trace.error(e);}}});CBCR3.Panel.StreamPanelItem=Class.create(CBCR3.Commons.EventDispatcher,{stream:null,artist:null,name:null,title:null,permalink:null,playlistPermalink:null,format:null,date:null,label:null,subgenre:null,playButton:null,gearsButton:null,thumbnail:null,styles:null,item:null,buttonName:null,isPlaying:false,debug:false,initialize:function($super,streamData){$super();Trace.write("StreamPanelItem Initialize:",this.debug);this.artist=streamData.artist||"";this.infoLink=streamData.infoLink||"";this.title=streamData.title||"";this.thumbnail=streamData.thumbnail||"";this.name=streamData.name;this.permalink=streamData.permalink;this.playlistPermalink=streamData.playlistPermalink||"";this.styles=streamData.styles||"";this.buttonName=streamData.buttonName||".playButton";this.format=streamData.format||"MP3";this.date=streamData.date||"";this.label=streamData.label||"";this.subgenre=streamData.subgenre||"";},setPlaying:function(styles){this.styles=styles;this.isPlaying=true;},checkLength:function(name,maxSize){if(name==null||name=="")
return"";return(name.length>maxSize)?name.truncate(maxSize):name;},render:function(){var artistMin=this.artist;var titleMin=this.title;this.artist=this.checkLength(artistMin,37);this.title=this.checkLength(titleMin,37);var variables={artist:artistMin.escapeHTML(),title:titleMin.escapeHTML(),permalink:this.permalink,playlistPermalink:this.playlistPermalink,thumbnail:this.thumbnail,name:this.name,styles:this.styles,format:this.format,date:this.date,label:this.label,subgenre:this.subgenre,isPlaying:this.isPlaying};var item=new Element("div",{className:(this.isPlaying)?"item playing":"item"});item.update(this.template(this));this.item=item;this.playButton=item.down(this.buttonName);this.gearsButton=item.down(".gearsButton");return item;},wireUp:function(){this.playButton.observe("click",this.playHandler.bind(this));},playHandler:function(event){this.dispatchEvent(CBCR3.Panel.Events.PanelEvent.playStream);},template:function(tokens){var markup="<div class=\"left\">"+"<label><a href=\"#\">#{title}</a></label>"+"????<span><b>#{title}</b> <i>w/ #{artist}</i></span>"+"</div>"+"<div class=\"right\">"+"   <a class=\"#{linkStyle}\" href=\"#{permalink}\"></a>"+"</div>";return new Template(markup).evaluate(tokens);}});CBCR3.Panel.CategoryListItem=Class.create(CBCR3.Panel.StreamPanelItem,{initialize:function($super,streamData){$super(streamData);}});CBCR3.Panel.StationListItem=Class.create(CBCR3.Panel.StreamPanelItem,{initialize:function($super,streamData){var currentItem=streamData.getNowPlaying();$super({artist:currentItem.artist,title:currentItem.title,permalink:streamData.permalink,playlistPermalink:streamData.playlistPermalink,name:streamData.name});}});CBCR3.Panel.PlayListListItem=Class.create(CBCR3.Panel.StreamPanelItem,{lastupdated:null,count:null,initialize:function($super,streamData){this.lastupdated=(streamData.lastmodified!=null||streamData.lastmodified!="")?new Date(streamData.lastmodified):"";this.count=streamData.trackcount;$super({artist:"",thumbnail:streamData.thumbnail,title:streamData.title,permalink:streamData.permalink,playlistPermalink:streamData.playlistPermalink,name:streamData.name});this.buttonName=".playButton";},template:function(tokens){var lastUpdated=(this.lastupdated==null||this.lastupdated=="")?"":this.lastupdated.strftime("%B %e, %Y");var markup="<div class=\"left\">"+"<label><a href=\"#{permalink}\">#{title}</a><br/><span>"+this.count+" tracks | updated "+lastUpdated+"</span></label>"+"<span></span>"+"</div>"+"<div class=\"right\">"+"   <a class=\"playButton\" href=\"#{playlistPermalink}\" title=\"#{title}\">#{title}</a>"+"   <a class=\"gearsButton noinfo noadd\" href=\"#{playlistPermalink}\" title=\"#{title}\">#{title}</a>"+"</div>";return new Template(markup).evaluate(tokens);},playHandler:function(event){this.dispatchEvent(CBCR3.Panel.Events.PanelEvent.playlistSelected);}});CBCR3.Panel.FeatureListItem=Class.create(CBCR3.Panel.StreamPanelItem,{imageSrc:null,permalink:null,description:null,playlistPermalink:null,initialize:function($super,streamData){this.imageSrc=streamData.imageSrc;this.description=streamData.description;this.permalink=streamData.permalink;this.playlistPermalink=streamData.playlistPermalink;$super({thumbnail:streamData.imageSrc,artist:streamData.description,title:streamData.name,permalink:streamData.permalink,playlistPermalink:streamData.playlistPermalink,name:streamData.name});},wireUp:function()
{},template:function(vars,options){var playtemplate=(vars.playlistPermalink==null||vars.playlistPermalink.blank())?"":"<a href=\"#{playlistPermalink}\" class=\"playButton\" title=\"#{artist}\">#{description}</a>"+"<a href=\"#{playlistPermalink}\" class=\"gearsButton noinfo noadd\" title=\"#{artist}\">#{description}</a>";var linktemplate=(vars.permalink==null||vars.permalink.blank())?"#{description}":"<a href=\"#{permalink}\" title=\"#{artist}\">#{description}</a>";var markup="<div class=\"left\">"+"<div class=\"thumbnail\">"+"<img alt=\"#{artist}\" src=\"#{thumbnail}\"></div>"+"<label>"+linktemplate+"</label></div>"+"<div class=\"right\">"+playtemplate+"</div>";return new Template(markup).evaluate(vars);}});CBCR3.Panel.TrackListItem=Class.create(CBCR3.Panel.StreamPanelItem,{gearsButton:null,gearsBox:null,infoBox:null,infoBtn:null,container:null,addButton:null,artistInfoService:null,infoBoxUpdated:false,itunesLink:null,index:null,type:null,helper:null,debug:true,initialize:function($super,streamData,index,type){$super(streamData);this.index=index;this.type=type;this.helper=CBCR3.Panel.StreamPanelHelperProvider.getInstance();this.buttonName=".playButton";this.iTunesLink=streamData.iTunesLink;this.artistInfoService=new CBCR3.Gears.Services.InfoService("");this.artistInfoService.addEventListener(CBCR3.ArtistTrackList.ServiceEvent.trackInfoReceived,this.trackInfoReceivedHandler.bind(this));},wireUp:function(){this.container=this.item.up(".items");this.gearsButton=this.item.down(".gearsButton");this.gearsBox=this.item.down(".gearsBox");this.gearsBox.hide();if(this.permalink==null||this.permalink.blank())
this.gearsButton.addClassName("disabled");else
this.gearsButton.observe("click",this.gearsClickedHandler.bind(this));this.infoBox=this.item.down(".infoBox");this.infoBox.hide();this.infoBtn=this.item.down(".infoBtn");this.permalinkButton=this.item.down(".permalinkButton");this.addButton=this.item.down(".addButton");this.thumbUp=this.item.down(".likeButton");this.infoBtn.observe("click",this.showInfoBoxHandler.bind(this));this.checkPermalink();},trackInfoReceivedHandler:function(event){var trackInfo=event.data.trackInfo;var date=trackInfo.recordingDate;var formattedDate=(date!=null)?date.strftime("%B %e, %Y"):"";var tokens={artist:this.artist||"",track:this.title||"",format:trackInfo.format||"",permalink:this.permalink||"",date:formattedDate,label:trackInfo.label||"",subGenre:trackInfo.subGenre||"",title:trackInfo.title||"",releaseTitle:trackInfo.releaseTitle||"",ituneslink:trackInfo.ituneslink||"",urlToAudioFile:trackInfo.urlToAudioFile||"",credits:this.helper.processArray(trackInfo.credits)};this.infoBox.update(this.templateInfoBox(tokens));this.infoBoxUpdated=true;},wireUpExtras:function(){if(this.item==null)
return;},gearsClickedHandler:function(event){try{Trace.write("gearsClickedHandler",this.debug);Trace.write("infobox visible():"+this.infoBox.visible()+" updated:"+this.infoBoxUpdated,this.debug);if(!this.infoBoxUpdated){if(this.permalink!=null&&!this.permalink.blank())
this.artistInfoService.getTrackInfo(this.permalink);}
event.stop(event);}catch(e){Trace.error(e);}},addToPlaylistHandler:function(){var trackPermalink=item.down(".addButton").href;this.listElement.highlight({startcolor:"#ffcc00"});this.dispatchEvent(CBCR3.Playlists.Events.PlaylistEvent.addTrackToPlaylist,{playlistPermalink:this.playlistPermalink,trackPermalink:trackPermalink,element:item});},showGearsHandler:function(){Trace.write("in SHOW GEARS Handler",this.debug);Trace.write(" gearsBox is visible:"+this.gearsBox.visible(),this.debug);try{if(this.gearsBox.visible()){this.gearsBox.hide();this.infoBox.hide();this.item.removeClassName("itemShowInfo");}else{this.hideAll();this.gearsBox.show();}
this.dispatchEvent("panelEvent:divChanged");}catch(e){Trace.error(e);}},showInfoBoxHandler:function(event){Trace.write("showInfoBoxHandler:",this.debug);Trace.write(event,this.debug);if(this.infoBox.visible())
this.item.removeClassName("itemShowInfo");else
this.item.addClassName("itemShowInfo");this.infoBox.toggle();this.dispatchEvent("panelEvent:divChanged");event.stop(event);},thumbUpHandler:function(event){if(this.infoBox.visible())
this.item.removeClassName("itemShowInfo");else
this.item.addClassName("itemShowInfo");this.infoBox.toggle();event.stop(event);},hideAll:function(){this.container.select(".item").each(function(item){item.removeClassName("itemShowInfo");item.down(".infoBox").hide();item.down(".gearsBox").hide();});},checkPermalink:function(){try{if(this.permalink==null||this.permalink.blank()){this.playButton.removeClassName("playButton");this.playButton.addClassName("disabledPlayButton");this.playButton.observe('click',Event.stop);this.addButton.hide();this.permalinkButton.hide();this.thumbUp.hide();this.gearsButton.addClassName("disabled");}}catch(e){Trace.error(e);}},template:function(tokens){var nowplaying="";var nowplayingpermalink=(this.type=="playlist"&&this.index!=null||this.index>0)?this.playlistPermalink+"#"+this.index:tokens.permalink;var ituneslink=tokens.iTunesLink==null||tokens.iTunesLink.blank()?"":"<a class=\"itunesbtn\" target=\"_blank\" href=\""+tokens.iTunesLink+"\">iTunes Link</a>";if(tokens.isPlaying){nowplaying="";}
var artistInfo=tokens.artist+((this.title!=null&&this.title.trim()!="")?" - "+this.title:"");var markup="<div class=\"left\">"+"<div class=\"thumbnail\"><img src=\"#{thumbnail}\" alt=\"#{artist}\"/></div>"+
nowplaying+"<div class=\"trackInfo\"><a href=\"#{permalink}\">#{artist}</a><label>#{title}</label>"+ituneslink+"</div>"+"</div>"+"<div class=\"right\">"+"   <a class=\"playButton#{styles}\" href=\""+nowplayingpermalink+"\" title=\""+artistInfo+"\">"+artistInfo+"</a><a href=\"#{permalink}\" class=\"gearsButton\" title=\""+this.title+"\">"+this.title+"</a>"+"<div class=\"gearsBox\">"+"<a class=\"addButton\" href=\"#{permalink}\" title=\"#{title}\">add to playlist</a>"+"<a class=\"likeButton\" href=\"#{permalink}\" title=\"#{title}\">like</a>"+"<a class=\"permalinkButton\" href=\"#{permalink}\" title=\"#{title}\">share</a>"+"<a class=\"infoBtn\" href=\"#{permalink}\" title=\"#{title}\">info</a>"+"</div>"+"</div>"+"<div class=\"infoBox\">"+"</div>";return new Template(markup).evaluate(tokens);},templateInfoBox:function(tokens){var itunesButton=(tokens.ituneslink&&!tokens.ituneslink.blank())?"<a class=\"itunesbtn\" target=\"_blank\"  href=\""+tokens.ituneslink+"\">iTunes Link</a>":"";var downloadButton=(tokens.urlToAudioFile&&!tokens.urlToAudioFile.blank())?"<a class=\"downloadBtn\" href=\""+tokens.urlToAudioFile+"\">Download MP3</a>":"";var rowBreak="<li class=\"rowbreak\">&nbsp;</li>";var buyRow=!itunesButton.blank()||!downloadButton.blank()?rowBreak+"<li class=\"buyrow\"><label>Buy</label>"+itunesButton+downloadButton+"</li>":"";var markup="<ul>"+
rowBreak+"<li><label>Artist</label><span class=\"trackArtist\"><a href=\"#{permalink}\">#{artist}</a></span></li>"+"<li><label>Track</label><span class=\"trackTitle\">#{track}</span></li>"+"<li><br/></li>"+"<li><label>Release</label><span class=\"releaseTitle\">#{title}</span></li>"+"<li><label>Date</label><span>#{date}</span></li>"+"<li><label>Label</label><span>#{label}</span></li>"+"<li><label>Format</label><span>#{format}</span></li>"+"<li><label>Genre</label><span>#{subGenre}</span></li>"+"<li class=\"rowbreak\"><br/></li>"+"<li><label>Credits</label><span >#{credits}</span></li>"+
buyRow+rowBreak+"</ul>";return new Template(markup).evaluate(tokens);}});CBCR3.Panel.StreamStation=Class.create(CBCR3.Commons.EventDispatcher,{id:null,data:null,roomid:null,nodesocketservice:null,debug:false,funcHandler:null,playButtonName:".playButton",allTrackMetaData:null,isRadio2:false,isRadio3:false,pageinitializer:null,showcomposer:false,initialize:function($super,streamData){try{$super();this.data=streamData;this.roomid=streamData.roomid;this.id=this.stripId(streamData.id)||"";this.isRadio3=(this.id.indexOf("radio3")>-1);this.isRadio2=(this.roomid.indexOf("/radio2/")>-1);this.allTrackMetaData=false;this.nodesocketservice=getNodeService();this.pageinitializer=new CBCR3.Application.PageInitializerProvider().getInstance();this.showcomposer=streamData.showcomposer||false;if(this.roomid!=null){this.funcHandler=this.metaDataNodeUpdateHandler.bind(this);this.nodesocketservice.addEventListener("metaNode:updated",this.funcHandler);}}catch(e){Trace.error(e);}},connectNode:function(){Trace.write("streampanel.js -> connectNode()",true);Trace.write("this.nodesocketservice:"+this.nodesocketservice+" this.roomid:"+this.roomid,true);if(this.nodesocketservice!=null&&this.roomid!=null)
this.nodesocketservice.joinRoom(this.roomid);else
Trace.write("ERROR in connectNode() this.nodesocketservice: "+this.nodesocketservice+" this.roomid:"+this.roomid,true);},metaDataNodeUpdateHandler:function(event){try{var data=event.data.value;var station=$(this.id);var stream=data.stream;var track=data.getNowPlaying();if(station!=null&&this.roomid!=null&&this.roomid==stream.roomid){var mappedStation=this.stationMapper(stream,track,this.showcomposer);this.pageinitializer.unregisterNodes(station);var nowPlayingDiv=station.down(".currentlyPlaying");if(this.isRadio3)
nowPlayingDiv.update(this.templateRadio3(mappedStation));else
nowPlayingDiv.update(this.template(mappedStation));var link=station.down(this.playButtonName);if(mappedStation.showTracks)
link.observe("click",this.stationSelectedHandler.bind(this));if(this.data!=null&&this.data.isspecial)
this.dispatchEvent(CBCR3.Panel.Events.specialStreamUpdated);this.pageinitializer.registerNode(station);}}catch(e){if(!(typeof Trace=='undefined'))
Trace.error(e);}},stationMapper:function(stream,track,showcomposer){if(!this.isRadio2){return{permalink:stream.permalink,stationname:stream.name,artistpermalink:track.playlistPermalink,description:track.title,author:track.artist,composer:track.composer,composerPermalink:track.composerPermalink,iTunesLink:(this.isRadio3)?"":track.iTunesLink,mount:stream.mount,room:stream.roomid,showcomposer:showcomposer,showTracks:this.allTrackMetaData};}else{return{permalink:stream.permalink,stationname:stream.name,artistpermalink:"",description:stream.programdescription,author:stream.programname,mount:stream.mount,room:stream.roomid,showcomposer:showcomposer,showTracks:false};}},stationSelectedHandler:function(event){Event.stop(event);this.dispatchEvent(CBCR3.Panel.Events.PanelEvent.stationSelected,event);},renderContainer:function(isAlt){var data=this.data;return this.templateContainer({stationname:data.name,room:data.fullroomid,itemid:this.id,permalink:data.permalink,styles:"item station"+((isAlt)?" alt":"")});},stripId:function(id){var tmpId=id.sub("/","");return tmpId.gsub("/","-");},getSpecialMarkup:function(){var data=this.data;var specialMarkup="";if(data!=null&&data.isspecial){var sponsorMarkup=(data.specialimage)?"<img src=\""+data.specialimage+"\" alt=\"Sponsor\" />":"";sponsorMarkup=(data.specialurl)?"<a href=\""+data.specialurl+"\">"+sponsorMarkup+"</a>":sponsorMarkup;specialMarkup="<div class=\"specialHeader\">";specialMarkup=(data.specialimage)?specialMarkup+sponsorMarkup+"</div>":specialMarkup+"<span>Special</span></div>";}
return specialMarkup;},templateContainer:function(tokens){var markup="<div id=\"#{itemid}\" class=\"#{styles}\">"+"<div class=\"left\">"+
this.getSpecialMarkup()+"<div class=\"specialHeader\"><label><a href=\"#{permalink}\" title=\"#{stationname}\">#{stationname}</a></label></div><br />"+"<span class=\"currentlyPlaying\"></span></div>"+"<div class=\"right\"><a class=\"playButton\" href=\"#{permalink}\" title=\"#{stationname}\">#{stationname}</a></div>"+"</div>";return new Template(markup).evaluate(tokens);},templateRadio3:function(tokens){var maxAmount=37;var separator=": ";tokens.authorOrig=tokens.author;tokens.descriptionOrig=tokens.description;if(tokens.author==null){tokens.author="";tokens.authorOrig="";separator="";}
if(tokens.description==null||tokens.description==""){tokens.description="";tokens.descriptionOrig="";separator="";}
tokens.authorOrig+=separator+tokens.descriptionOrig;if(tokens.author.length+tokens.description.length>maxAmount){if(tokens.author.length>maxAmount){tokens.author=tokens.author.substr(0,maxAmount-3)+"...";tokens.description="";}else{maxAmount=maxAmount-tokens.author.length;tokens.description=tokens.description.substr(0,maxAmount-3)+"...";}}
var markup="<span class=\"currentArtist\" title=\"#{authorOrig}\">#{author}</span><span style=\"\" title=\"#{descriptionOrig}\">#{description}</span>";return new Template(markup).evaluate(tokens);},template:function(tokens){var composerMarkup=(tokens.composerPermalink)?"<span class=\"currentComposer\"><a href=\""+tokens.composerPermalink+"\" title=\"#{composer}\">#{composer}</a></span>":"<span class=\"currentComposer\" title=\"#{composer}\">#{composer}</span>";var iTunesMarkup=(tokens.iTunesLink)?"<a class=\"itunesbtn\" target=\"_blank\" href=\""+tokens.iTunesLink+"\">iTunes Link</a>":"";if(!tokens.showcomposer)
composerMarkup="";var markup="<span class=\"currentArtist\" title=\"#{author}\">#{author}</span><span style=\"\" title=\"#{description}\">#{description}"+composerMarkup+"</span>"+
iTunesMarkup;return new Template(markup).evaluate(tokens);}});

CBCR3.namespace("CBCR3.Panel");var _streamStationManager=null;CBCR3.Panel.StreamStationManagerProvider={getInstance:function(message){if(_streamStationManager==null)
_streamStationManager=new CBCR3.Panel.StreamStationManager({container:"stationcontainer"});return _streamStationManager;}};CBCR3.Panel.StreamStationManager=Class.create(CBCR3.Commons.EventDispatcher,{categories:null,panels:null,panelSlider:null,pageInitializer:null,container:null,debug:false,nodesocketservice:null,funcFull:null,hasSpecial:false,specialDivId:null,genreDivId:null,initialize:function($super,opts){$super();this.catHash=new Hash();this.categories=new Array();this.panels=new Array();this.container=opts.container;this.panelSlider=new CBCR3.Panel.PanelSlider(this.container);this.pageInitializer=new CBCR3.Application.PageInitializerProvider().getInstance();this.nodesocketservice=getNodeService();},setTabListeners:function(tabs,event){this.tabs=tabs;if(this.tabs)
this.tabs.addEventListener(event,this.resetSpecialDiv.bind(this));},processCategories:function(event){Trace.write("ProcessCategories()",this.debug);Trace.write(event,this.debug);try{if(event.data==null)
return;var categories=event.data.categories;var self=this;for(var catName in categories){self.addCategory(categories[catName]);}
this.registerLinks("panel_stations");}catch(e){Trace.error(e);}},resetSpecialDiv:function(){var genreDiv=$(this.genreDivId);var specialDiv=$(this.specialDivId);var streamPanelContent=$("streamPanelContent");var stationsPanel=$("panel_stations");var firstStationsDiv=(stationsPanel!=null)?stationsPanel.down(".panelBox"):null;if(!specialDiv||!genreDiv||!stationsPanel||!firstStationsDiv||!streamPanelContent)
return;var bufferOffSet=45;genreDiv.setStyle({height:(streamPanelContent.offsetHeight-(bufferOffSet+specialDiv.offsetHeight+firstStationsDiv.offsetHeight))+'px'});},addSpecialStation:function(station,specialDivId,genreDivId){this.specialDivId=specialDivId;this.genreDivId=genreDivId;this.hasSpecial=true;station.addEventListener(CBCR3.Panel.Events.specialStreamUpdated,this.resetSpecialDiv.bind(this));},addCategory:function(category){this.catHash.set(category.name,category);this.categories.push(category);},registerLinks:function(panelContainer){var container=$(panelContainer);var self=this;if(container!=null){container.select(".item.category").each(function(item){item.observe("click",self.openCategoryHandler.bind(self));});}},registerNode:function(container){this.pageInitializer.registerNode(container);},openCategoryHandler:function(event){try{var elemTarget=Event.element(event);var container=elemTarget.hasClassName('item')?elemTarget:elemTarget.up(".item");var name=container.down(".left > label > a");this.openCategory(name.innerHTML,event.target);event.stop();}catch(e){this.clicked=false;Trace.error(e);}},openCategory:function(name,target,isAutomaticallyCalled){if(this.clicked){return;}
this.clicked=true;var stationContainer=$(this.container);if(stationContainer!=null&&stationContainer.visible()&&!this.hasMultiPanels(stationContainer)){this.addPanel(name,target,isAutomaticallyCalled);}else{this.clicked=false;}},hasMultiPanels:function(container){if(container==null)
return false;var panels=container.select('.slider_panel');return(panels.length>1);},addPanel:function(name,target,isAutomaticallyCalled){var newName=name.unescapeHTML();var category=this.catHash.get(newName);if(category==null){this.clicked=false;return;}
var prevNameVal="genres";if(newName!=null&&newName.indexOf("Radio")>-1){prevNameVal="web radio stations";}
var panel=new CBCR3.Panel.StationListPanel({prevName:prevNameVal,name:newName,panelId:"stationlistpanel",panelStyle:"stations"});var parentItem=$(target).hasClassName("item")?target:$(target).up(".item");var isCBCRadio2=$(parentItem).down("label").readAttribute("id")==="cbcRadio2Label";if(isCBCRadio2&&isAutomaticallyCalled!==true){var isCanadianIP=(CBCR3.Commons.Cookies.getValue("isCanadianIP")==="1")?true:false;var stationsSubset=[];for(var i=0;i<category.stations.length;i++){var isGeofenced=category.stations[i].geofenced;if(isCanadianIP){if(isGeofenced){stationsSubset.push(category.stations[i]);}}else{if(!isGeofenced){stationsSubset.push(category.stations[i]);}}}
category.stations=stationsSubset;}
panel.create();panel.load(category.stations);this.panelSlider.insertPanel(panel.panel,target);var funcStationSelected=this.stationSelectedHandler.bind(this);if(!panel.hasEventListener(CBCR3.Panel.Events.PanelEvent.stationSelected)){panel.addEventListener(CBCR3.Panel.Events.PanelEvent.stationSelected,this.stationSelectedHandler.bind(this));}
panel.addEventListener(CBCR3.Panel.Events.PanelEvent.returnPanel,this.returnClickHandler.bind(this,{type:"roomid",funcSelected:funcStationSelected,stations:category.stations,source:panel,streamManager:this}));this.panelSlider.movePanelNew(this.container,panel.width*-1);},returnClickHandler:function(opts,event){for(var i=0;i<opts.stations.length;i++){var station=opts.stations[i];var roomid=(opts.type=="roomid")?station.roomid:station.fullroomid;this.nodesocketservice.leaveRoom(roomid);}
var panel=opts.source;panel.removeEventListener(CBCR3.Panel.Events.PanelEvent.stationSelected,opts.funcSelected);this.clicked=false;this.panelSlider.returnPanel();},stationSelectedHandler:function(event){try{var target=event.data.target;var station=event.target;var newPanel=new CBCR3.Panel.TrackListPanel({prevName:station.name,name:"Now Playing",panelStyle:"tracks"});var stationsArr=new Array();stationsArr.push(station);newPanel.create();this.funcFull=this.metaDataNodeUpdateHandler.bind(this,newPanel);this.nodesocketservice.addEventListener("metaNode:updatedFull",this.funcFull);this.nodesocketservice.joinFullRoom(station.fullroomid);this.panelSlider.insertPanel(newPanel.panel,target);newPanel.addEventListener(CBCR3.Panel.Events.PanelEvent.returnPanel,this.returnClickHandler.bind(this,{test:"station",stations:stationsArr,source:newPanel,streamManager:this}));this.panelSlider.movePanelNew(this.container,newPanel.width*-1);}catch(e)
{Trace.error(e);}},metaDataNodeUpdateHandler:function(panel,event){var stream=event.data.value.stream;panel.load(stream.tracks);},updateVisibleRadio2StationCount:function(){if(!$("cbcRadio2Label")||!$("streamsPanelStationCount")){return;}
var categoryName=$("cbcRadio2Label").down("a").innerHTML;var category=this.catHash.get(categoryName);var isCanadianIP=(CBCR3.Commons.Cookies.getValue("isCanadianIP")==="1")?true:false;if(!isCanadianIP)
document.fire(CBCR3.Common.Events.GeoFence.IsInternational);var numStations=0;for(var i=0;i<category.stations.length;i++){var isGeofenced=category.stations[i].geofenced;if(isCanadianIP){if(isGeofenced){numStations++;}}else{if(!isGeofenced){numStations++;}}}
$("streamsPanelStationCount").update("("+numStations+" stations)");}});

CBCR3.namespace("CBCR3.Panel");var _streamPanelHelperInstance;CBCR3.Panel.StreamPanelHelperProvider={getInstance:function(){if(_streamPanelHelperInstance==null||_streamPanelHelperInstance==undefined)
_streamPanelHelperInstance=new CBCR3.Panel.StreamPanelHelperService();return _streamPanelHelperInstance;},addEventListener:function(type,method){this.getProvider().addEventListener(type,method);}};CBCR3.Panel.StreamPanelHelperService=Class.create(CBCR3.Commons.EventDispatcher,{addPlaylistPanel:null,initialize:function($super){$super();this.initModules();},initModules:function(){this.addPlaylistPanel=new CBCR3.Panel.Modules.AddPlaylistPanel(CBCR3.Services.ServicesProvider.getInstanceOf("playlistService"),this.permalinkService);this.addPlaylistPanel.addEventListener(CBCR3.Player.Events.PermalinkEvent.trackAdded,this.trackAddedHandler.bind(this));this.addPlaylistPanel.addEventListener(CBCR3.Player.Events.AuthenticationEvent.loginRequired,this.loginRequiredHandler.bind(this));this.addPlaylistPanel.addEventListener(CBCR3.Player.Events.PlaylistEvent.newPlaylistCreated,this.newPlaylistCreatedHandler.bind(this));},playPermalink:function(permalink){},addTrack:function(permalink){this.showAddPlaylistPanel(permalink);},addToFavourites:function(permalink){},trackAddedHandler:function(event){this.dispatchEvent(CBCR3.Player.Events.PermalinkEvent.trackAdded,event.data);},newPlaylistCreatedHandler:function(event){this.dispatchEvent(CBCR3.Player.Events.PlaylistEvent.newPlaylistCreated,{playlistPermalink:event.data.playlistPermalink});},loginRequiredHandler:function(event){this.dispatchEvent(CBCR3.Player.Events.AuthenticationEvent.loginRequired,event.data);},showAddPlaylistPanel:function(trackPermalink){this.addPlaylistPanel.setPermalinks("",trackPermalink);this.addPlaylistPanel.show();},processArray:function(list){if(list==null)
return"";var returnVal="";for(var i=0;i<list.length;i++){returnVal+=list[i]+"<br/>";}
return returnVal;}});

CBCR3.namespace("CBCR3.Panel");CBCR3.Panel.PlaylistGroup=Class.create({items:null,panelSlider:null,name:null,groupName:null,container:null,playlistContainer:null,moveTo:300,playlistService:null,debug:false,itemCount:null,trackPanel:null,playlistListPanel:null,getPlaylistTracks:null,trackListType:"playlist",isLast:false,initialize:function(options){this.items=new Array();this.name=options.name;this.playlistContainer=options.playlistContainer;this.groupName=options.groupName;this.container=options.container;this.itemCount=options.count||0;this.panelSlider=new CBCR3.Panel.PanelSlider(this.container);this.playlistService=new CBCR3.Services.PlaylistService();this.getPlaylistTracks=options.playlistmethod;this.isLast=options.islast;this.init();},init:function(){this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.tracksReceived,this.onTracksReceived.bind(this));this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.favouriteConcertsReceived,this.onPlaylistsReceived.bind(this));this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.personalPlaylistsReceived,this.onPlaylistsReceived.bind(this));this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.favouriteArtistsReceived,this.onPlaylistsReceived.bind(this));this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.favouritePlaylistsReceived,this.onPlaylistsReceived.bind(this));this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.favouritesReceived,this.onPlaylistsReceived.bind(this));},addItem:function(item){this.items.push(item);},render:function(){try{if(this.itemCount==0)
$(this.playlistContainer).hide();var div=new Element("div",{className:"item left-curve bottomleft-curve bottomright-curve"});div.insert(this.template({description:this.name,count:this.itemCount}));if(this.isLast)
div.setStyle("border:0px solid #000");if(this.itemCount>0)
div.observe("click",this.playlistGroupSelectedHandler.bind(this));$(this.playlistContainer).insert(div);}catch(errr){Trace.write("Error in playlistGroup Render()",this.debug);Trace.error(errr);}},onPlaylistsReceived:function(event){Trace.write("in onPlaylistsReceived",this.debug);Trace.write(event,this.debug);this.playlistListPanel.load(event.data.playlists);},buildHeader:function(vars){var div=new Element("div",{className:"header left-curve right-curve"});div.update("<div class=\"left-curve\">"+vars.groupName+"</div> <h4>"+vars.name+"</h4>");div.down("div").observe("click",this.returnClickHandler.bind(this));return div;},renderItems:function(){try{var self=this;var content=new Element("div");this.items.each(function(item,index){content.insert(item.render(index,(index%2==0)?" alt":""));});return content;}catch(e){Trace.error(e);}},playlistSelected:function(event){Trace.write("playlistSelected()",this.debug);Trace.write(event,this.debug);var permalink=event.data.permalink;this.dispatchEvent(CBCR3.Player.Events.PageEvent.playPermalink,{permalink:permalink});},addPanel:function(name,target){try{this.playlistListPanel=new CBCR3.Panel.PlayListListPanel({prevName:this.groupName,name:this.name,panelId:"myplaylists",panelStyle:"playlists",buttonName:"playButton"});this.playlistListPanel.create();this.panelSlider.insertPanel(this.playlistListPanel.panel,target);Trace.write("Adding EventListener to Panel -> "+target,this.debug);this.playlistListPanel.addEventListener(CBCR3.Panel.Events.PanelEvent.returnPanel,this.returnClickHandler.bind(this,{source:this.playlistListPanel,streamManager:this}));this.playlistListPanel.addEventListener(CBCR3.Panel.Events.PanelEvent.playlistSelected,this.playlistSelectedHandler.bind(this));this.panelSlider.movePanelNew(this.container,this.playlistListPanel.width*-1);}catch(e){Trace.error(e);}},addPlaylistPanel:function(item,target){try{this.trackPanel=new CBCR3.Panel.TrackListPanel({prevName:"my saved items",name:item.title,panelStyle:"tracks",type:this.trackListType});this.trackPanel.create();this.playlistService.getPlaylistTracks(item.playlistPermalink,100,1);this.panelSlider.insertPanel(this.trackPanel.panel,target);this.trackPanel.addEventListener(CBCR3.Panel.Events.PanelEvent.returnPanel,this.returnClickHandler.bind(this,{source:this.trackPanel,streamManager:this}));this.panelSlider.movePanelNew(this.container,this.trackPanel.width*-1);}catch(errr){Trace.error(errr);}},onTracksReceived:function(event){Trace.write("onTracksReceived()",this.debug);Trace.write(event,this.debug);var tracks=event.data.tracks;this.trackPanel.load(tracks);},playlistSelectedHandler:function(event){if(this.clicked)
return;this.clicked=true;Trace.write("playlistSelectedHandler in saveditemspanel.js",this.debug);Trace.write(event,this.debug);var item=event.data.item;var target=event.data.target;this.addPlaylistPanel(item,target);},playlistGroupSelectedHandler:function(event){try{if(this.clickedGroup)
return;this.clickedGroup=true;var elemTarget=Event.element(event);var container=(elemTarget.up(".item"))?elemTarget.up(".item"):elemTarget;if(container==null)
return;var name=container.down(".left > label > a");this.addPanel(name.innerHTML,event.target);Trace.write("this.playlistService."+this.getPlaylistTracks+"();",this.debug);eval("this.playlistService."+this.getPlaylistTracks+"();");}catch(e){Trace.error(e);}},returnClickHandler:function(event){this.clickedGroup=this.clicked=false;this.panelSlider.returnPanel({container:this.container,moveTo:this.moveTo});},template:function(vars){var markup="<div class=\"left\"><label><a>#{description} (#{count})</a></label></div>"+"<div class=\"right\"><a class=\"openList\"></a></div>";return new Template(markup).evaluate(vars);}});CBCR3.Panel.Playlist=Class.create(CBCR3.Commons.EventDispatcher,{items:null,name:null,groupName:null,container:null,moveTo:300,panelSlider:null,nowPlaying:null,permalink:null,pageInitializer:null,lastUpdated:null,trackCount:null,debug:false,initialize:function($super,options){$super();this.items=new Array();this.name=options.name;this.groupName=options.groupName;this.container=options.container;this.permalink=options.permalink;this.trackCount=options.trackcount;this.lastUpdated=options.lastedited;this.panelSlider=new CBCR3.Panel.PanelSlider(options.container);this.nowPlaying=null;this.pageInitializer=new CBCR3.Application.PageInitializerProvider().getInstance();},addItem:function(item){this.items.push(item);},setPlayingItem:function(){},render:function(){var containerDiv=new Element("div",{className:"item genre"});containerDiv.observe("click",this.playlistSelectedHandler.bind(this));return containerDiv.insert(this.template({name:this.name,count:this.itemCount,lastupdated:this.lastUpdated}));},playlistItemPlayHandler:function(event){this.dispatchEvent("PlayPlaylist",{permalink:this.permalink});},playlistSelectedHandler:function(event){if(this.clickedPlaylist)
return;this.clickedPlaylist=true;var target=Event.element(event);Trace.write("playlistSelectedHandler() 2",this.debug);Trace.write(event,this.debug);this.panelSlider.movePanel({subDiv:this.panelSlider.getNextDiv(target.up(".item")),container:this.container,header:this.buildHeader({groupName:this.groupName,name:this.name}),subContent:this.renderItems(),footer:"",moveTo:this.moveTo*-1});this.checkPlayingItem();Event.stop(event);this.dispatchEvent("PlayPlaylist",event);},load:function(items){this.items=items;},checkPlayingItem:function(){var playing=$(this.container).down(".playing");if(playing!=null&&playing!="undefined"){var containerDiv=playing.up("div");var playPos=playing.cumulativeOffset();var parentPos=playing.offsetParent.cumulativeOffset();var offsetHeight=playPos[1]-parentPos[1];if(containerDiv.getHeight()<(playPos[1]-parentPos[1]))
containerDiv.scrollTop=offsetHeight-((containerDiv.getHeight()/2)-playing.getHeight());}},renderItems:function(){try{var self=this;var content=new Element("div",{className:"tracks items gearsblock"});this.items.each(function(item,index){var styles=" genre";styles+=(index%2==0)?" alt":"";if(self.checkNowPlaying(item)){styles+=" playing";}
content.insert(item.render(index,styles));item.wireUp();});this.pageInitializer.registerNode(content);return content;}catch(e){Trace.write("saved items panel - renderItems()"+err,this.debug);Trace.error(e);}},checkNowPlaying:function(item){Trace.write(this.container);return(item.permalink.indexOf(this.nowPlaying)!=-1);},returnClickHandler:function(event){this.clickedPlaylist=false;this.panelSlider.returnPanel({container:this.container,moveTo:this.moveTo});},buildHeader:function(vars){var div=new Element("div",{className:"header left-curve right-curve"});div.update("<div class=\"left-curve\">"+vars.groupName+"</div> <h4>"+vars.name+"</h4>");div.down("div").observe("click",this.returnClickHandler.bind(this));return div;},template:function(vars){var markup="<div class=\"left\"><label><a>#{name}</a></label><br/>#{count} tracks | last update #{lastupdated}</div>"+"<div class=\"right\"><a class=\"openList\" href=\"#{permalink}\"></a></div>";return new Template(markup).evaluate(vars);}});

CBCR3.namespace("CBCR3.Panel.Events");CBCR3.Panel.Events={PanelEvent:{returnPanel:"panelEvent:returnPanel",openPanel:"panelEvent:openPanel",playStream:"panelEvent:playStream",stationSelected:"panelEvent:stationSelected",specialStreamUpdated:"panelEvent:specialStreamUpdated",resetSpecialDiv:"panel:resetSpecialDiv"},ServiceEvent:{tracksReceived:"panelServiceEvent:tracksReceived",tracksReceivedError:"panelServiceEvent:tracksReceivedError"}};CBCR3.namespace("CBCR3.Common.Events");CBCR3.Common.Events={TinyMCEEvent:{focus:"tinymce:focus",blur:"tinymce:blur"},GeoFence:{IsInternational:"geofence:isInternational"}};CBCR3.namespace("CBCR3.Social.Events");CBCR3.Social.Events={SocialEvent:{authorized:"social:authorized",disconnected:"social:disconnected"}};

CBCR3.namespace("CBCR3.Commons");CBCR3.Commons.Tabs=Class.create(CBCR3.Commons.EventDispatcher,{tempObj:null,initialize:function(element,options){try{this.container=element;this.element=$(element);this.contentContainer=$(options.contentContainer);this.displayContainer=null;this.defaultNum=(options.defaultNum!=null)?options.defaultNum:1;this.trackTabs=options.trackTabs||false;this.stopMinCheck=(options.stopMinCheck>0)||false;if(options.displayContainer!=null)
this.displayContainer=$(options.displayContainer);else
this.displayContainer=this.contentContainer;var self=this;this.menuItems=this.element.select('ul>li');this.menuLinks=this.element.select('ul>li>a');this.separators=this.element.select('ul>li>*:not(a)');this.menuLinkCount=(this.menuLinks)?this.menuLinks.length:0;this.menuLinks.each(function(item,index){item.observe("click",self.toggleTab.bind(this,index+1,self,self.trackTabs));});if(this.defaultNum!=null&&this.defaultNum<=this.menuLinks.length){this.toggleTab(options.defaultNum,self);}
this.tempObj=new Object();}catch(ex){Trace.error(ex);}},toggleDisp:function(tab,num){var d=$(tab);if(d.style.display=='none'){d.style.display='block';if(this.tabListener&&this.tabListener==num)
this.dispatchEvent(this.tabListenerEvent);}
else{d.style.display='none';}},attachTabListener:function(tabNum,eventName){this.tabListener=tabNum;this.tabListenerEvent=eventName;},toggleTab:function(num,parent,trackTabs){var parentDisplay=$(parent.container+num).style.display;if(parentDisplay==''||parentDisplay=='none'){var itemNum=0;for(var i=1;i<=parent.menuLinks.size();i++){var tempc=parent.container+i;var c=$(tempc);if(c.style.display!='none')
parent.toggleDisp(tempc,num);if(num==i){parent.menuLinks[num-1].addClassName('active-tab');var innerTabName=parent.menuLinks[num-1].innerHTML;if(innerTabName!=null&&trackTabs)
_cbcMusicUpdateTabs(innerTabName.toLowerCase());}
else
parent.menuLinks[i-1].removeClassName('active-tab');}
for(ii=0;ii<parent.separators.size();ii++){parent.separators[ii].removeClassName('right-active');parent.separators[ii].removeClassName('left-active');}
parent.displayContainer.removeClassName('right-curve');parent.displayContainer.removeClassName('left-curve');tempObj=parent.displayContainer;if(num==parent.menuLinks.size()){var tabWidth=$(parent.container).down("ul").getWidth();var containerWidth=parent.displayContainer.up().getWidth();if(tabWidth<containerWidth)
parent.displayContainer.addClassName('right-curve');}else{parent.displayContainer.addClassName('right-curve');}
if(num>1)
parent.displayContainer.addClassName('left-curve');var elemTmp=parent.menuLinks[num-1].up(0);var separator=elemTmp.previous(0);if(separator!=null){separator.down('div').removeClassName('left-active');separator.down('div').addClassName('right-active');}
separator=elemTmp.next(0);if(separator!=null){separator.down('div').removeClassName('right-active');separator.down('div').addClassName('left-active');}
parent.toggleDisp(parent.container+num,num);}
return false;},toggleTabContainer:function(){this.toggleDisp(this.bindTabContainer);},checkForEmptyContainers:function(tabObject,containerClass,deleteNull){if(typeof deleteNull=="undefined"){deleteNull=false;}
var numRemoved=0;this.menuLinks.each(function(item,index){var tabNum=index+1;item.removeClassName('disabled');if($$("#"+tabObject.container+tabNum+" ."+containerClass)[0].empty()){item.stopObserving("click");item.addClassName('disabled');if(tabObject.defaultNum==tabNum){tabObject.toggleTab(tabNum,tabObject);if(deleteNull==true){tabObject.defaultNum++;tabObject.toggleTab(tabObject.defaultNum,tabObject);}}
if(deleteNull==true){numRemoved++;if(typeof item.up().next()!="undefined"&&item.up().next().hasClassName("separator")){item.up().next().remove();}
item.up().remove();}}});if(numRemoved>=this.menuLinkCount){tempObj.removeClassName('left-curve');tempObj.addClassName('right-curve');}
if(numRemoved=0){Trace.write("need to remove the last seperator",true);}
this.checkContentHeight();},checkContentHeight:function(){if(this.stopMinCheck)
return;var defaultMinH=84;var minH;var leftCol=$('leftContentColumn').getHeight();var rightCol=$('rightContentColumn').getHeight();var heightDiff=leftCol-rightCol;if(heightDiff<0){minH=defaultMinH-heightDiff+"px";$$('.main-content').each(function(d){d.setStyle({minHeight:minH});});}}});

CBCR3.namespace("CBCR3.Modules");CBCR3.Modules.PlaylistItemType={personal:"personal",favourite:"favourite"};CBCR3.Modules.TimeCount={down:"down",up:"up"};CBCR3.Modules.PlayerMode={stream:"stream",playlist:"playlist"};CBCR3.Modules.ShuffleMode={shuffle:"shuffle",sequential:"sequential"};CBCR3.Modules.PlayerStatus={playing:"playing",stopped:"stopped",inTransition:"inTransition"};CBCR3.Modules.ThumbStatus={up:"up",down:"down",none:"none",disabled:"disabled"};CBCR3.Modules.FavouriteStatus={clearToFavourite:"clearToFavourite",alreadyFavourited:"alreadyFavourited",disabled:"disabled"};CBCR3.Modules.TrackType={track:"track",hostbreak:"hostbreak"};CBCR3.Modules.StreamTrackStatus={playing:"playing",played:"played",scheduled:"scheduled"};

CBCR3.namespace("CBCR3.Commons");CBCR3.Commons.ActionList=Class.create({lastChildDiv:null,children:null,initialize:function(){this.actionLists=$$(".actionList");this.actionLists.each(function(list){this.children=list.getElementsByClassName("actionItem");if(this.children.length>0){this.lastChildDiv=this.children[this.children.length-1];this.lastChildDiv.addClassName('bottomleft-curve');this.lastChildDiv.addClassName('bottomright-curve');}});}});

CBCR3.namespace("CBCR3.Commons");var _cbcmodal=null;CBCR3.Commons.CBCModalProvider={getInstance:function(){if(_cbcmodal==null)
_cbcmodal=new CBCR3.Commons.CBCModal("",{top:20,width:280,height:400});return _cbcmodal;}};CBCR3.Commons.CBCModal=Class.create({content:"",animate:false,closeOpt:true,top:0,opacity:75,maskopacity:75,isOpen:false,boxid:null,width:0,height:0,contentDiv:null,initialize:function(content,opts){try{if(TINY.box==undefined){Trace.error("Tiny.box is not implemented;");return;}
this.content=content||"";this.animate=opts.animate||false;this.closeOpt=opts.close||false;this.top=opts.top||0;this.opacity=opts.opacity||75;this.maskopacity=opts.maskopacity||75;this.boxid=opts.boxid||"cbcmusic_modal";this.width=opts.width||300;this.height=opts.height||200;}catch(errr){Trace.error(errr);}},updateContentDiv:function(content){try{Trace.write("CBCMODAL: updateContent()",false);var boxDiv=$(this.boxid);if(boxDiv!=null||boxDiv!=undefined){boxDiv.update(content);}else{this.open(content.innerHTML);}
boxDiv.down(".tclose").observe("click",this.closeDiv);}catch(errr){Trace.error(errr);}},open:function(content){try{Trace.write("CBCMODAL: open()",false);Trace.write(content,false);if(this.contentDiv)
this.contentDiv.update();Trace.write(this.contentDiv,false);Trace.write("boxid:"+this.boxid,false);var cont=content;this.isOpen=true;TINY.box.show({html:cont,width:this.width,height:this.height,animate:this.animate,close:this.closeOpt,top:this.top,opacity:this.opacity,maskopacity:this.maskopacity,boxid:this.boxid,closejs:this.closeModal});this.contentDiv=$(this.boxid);var closeButton=this.contentDiv.down(".tclose");if(closeButton!=null||closeButton!=undefined)
closeButton.observe("click",this.closeDiv);}catch(errr){Trace.error(errr);}},closeModal:function(){this.isOpen=false;var boxDiv=$(this.boxid);},closeDiv:function(){TINY.box.hide();}});

CBCR3.namespace("CBCR3.Panel.Modules");CBCR3.Panel.Modules.AddPlaylistPanel=Class.create(CBCR3.Commons.EventDispatcher,{panel:null,panelContent:"",activePlaylistPermalink:"",trackPermalink:"",playlistService:null,createNewPlaylistItem:null,personalPlaylistContainer:null,closeButton:null,initialize:function($super,playlistService,permalinkService){try{$super();this.playlistService=playlistService;this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.personalPlaylistsReceived,this.personalPlaylistsRetrievedHandler.bind(this));this.playlistService.addEventListener("adminPlaylistsReceived",this.adminPlaylistsRetrievedHandler.bind(this));this.playlistService.addEventListener(CBCR3.Player.Events.ServiceExceptionEvent.userNotAuthenticated,this.userNotAuthenticatedHandler.bind(this));}catch(errr){Trace.error(errr);}},setPermalinks:function(activePlaylistPermalink,trackPermalinkToAdd){this.activePlaylistPermalink=activePlaylistPermalink;this.trackPermalink=trackPermalinkToAdd;},show:function(){try{if(!CBCR3.environment().isLoggedIn){this.userNotAuthenticatedHandler();return;}}catch(e){Trace.error(e);}
this.showPanel();this.retreivePlaylists();},showPanel:function(){this.panel=new Element('div');this.panel.update(this.getPanelTemplate().evaluate({}));this.personalPlaylistContainer=this.panel.down("#playlistPanel_personalPlaylists");Trace.write("CBCMODAL: addplaylistpanel.js -> showPanel()",false);Trace.write(this.panel.innerHTML,false);TINY.box.show({html:this.panel,width:280,height:530,animate:false,close:true,opacity:75,maskopacity:75,boxid:"cbcmusic_modal"});var containerDiv=$("cbcmusic_modal");var contentDiv=containerDiv.down(".tcontent");contentDiv.update();contentDiv.update(this.panel);this.panelContent=this.panel.down(".panelContent");},getLoading:function(){return"<div class=\"loading\">Loading...</div>";},retreivePlaylists:function(){this.personalPlaylistContainer.update();this.playlistService.getPersonalPlaylists();this.playlistService.getAdminPlaylists();},focus:function(){this.closeButton.focus();},isOpen:function(){return true;},close:function(){TINY.box.hide();this.createNewPlaylistItem=null;},personalPlaylistsRetrievedHandler:function(event){var playlists=event.data.playlists;this.addPlaylists(playlists);this.addCreateNewPlaylistItem();Trace.write("CBCMODAL: addplaylistpanel.js -> personalPlaylistsRetrievedHandler",false);Trace.write(this.panel.innerHTML,false);if(this.panelContent!=null)
this.panelContent.update(this.panel);},adminPlaylistsRetrievedHandler:function(event){var playlists=event.data.playlists;if(playlists.length>0){this.personalPlaylistContainer.insert(new Element("div").update("<img src='/images/staffPlaylist_bground.png' />"));this.addPlaylists(playlists);Trace.write("CBCMODAL: addplaylistpanel.js -> adminPlaylistsRetrievedHandler",false);Trace.write(this.panel.innerHTML,false);if(this.panelContent!=null)
this.panelContent.update(this.panel);}},addPlaylists:function(playlists){for(var i=0;i<playlists.length;i++){this.addPlaylistItem(playlists[i]);}
CBCR3.Player.Util.hideLoading(this.personalPlaylistContainer);},addPlaylistItem:function(playlist){var playlistItem=new CBCR3.Player.Modules.PersonalPlaylistItem(playlist);playlistItem.setIsActive(true);playlistItem.setShowViewButton(true);playlistItem.attachTo(this.personalPlaylistContainer);playlistItem.addEventListener(CBCR3.Player.Events.PlaylistEvent.permalinkSelected,this.playlistItem_Selected.bind(this));},addCreateNewPlaylistItem:function(event){this.createNewPlaylistItem=new CBCR3.Player.Modules.CreateNewPlaylistItem();this.createNewPlaylistItem.addEventListener(CBCR3.Player.Events.PlaylistEvent.newPlaylistCreated,this.newPlaylistCreatedHandler.bind(this));this.personalPlaylistContainer.appendChild(this.createNewPlaylistItem.create());},playlistItem_Selected:function(event){try{var element=$(event.data.id);var playlistPermalink=event.target.playlist.playlistPermalink;var trackPermalink=this.trackPermalink;this.attachPlaylistTrackConfirmationAdder(element,playlistPermalink,trackPermalink);}catch(e){Trace.error(e);}},attachPlaylistTrackConfirmationAdder:function(element,playlistPermalink,trackPermalink){var playlistTrackAdder=new CBCR3.Player.Modules.PlaylistTrackAdder(CBCR3.Services.ServicesProvider.getInstanceOf("permalinkService"),trackPermalink,playlistPermalink);playlistTrackAdder.attachTo(element);playlistTrackAdder.addEventListener(CBCR3.Player.Events.PermalinkEvent.trackAdded,this.trackAddedHandler.bind(this));playlistTrackAdder.addEventListener(CBCR3.Player.Events.DisplayEvent.forceIERefresh,this.forceIERefreshHandler.bind(this));playlistTrackAdder.addTrackToPlaylist();this.refreshList();},trackAddedHandler:function(event){this.close();this.dispatchEvent(CBCR3.Player.Events.PermalinkEvent.trackAdded,event.data);},forceIERefreshHandler:function(event){this.refreshList();},refreshList:function(){var items=$$(".playlistItem");items.each(function(item){item.setStyle({visibility:"hidden"});item.setStyle({visibility:""});});var items=$$(".trackExistsChooser");items.each(function(item){item.setStyle({visibility:"hidden"});item.setStyle({visibility:""});});},closeButton_Click:function(event){this.close();},getPanelTemplate:function(){var markup="<div id='playlistPanel'>"+"<div id='playlistPanel_addPlaylistHeader'>"+"</div>"+"<div id='playlistPanel_personalPlaylists'></div>"+"<div id='playlistPanel_footer'></div>"+"</div></div>"+"<div class='tclose'>close</div>";return new Template(markup);},newPlaylistCreatedHandler:function(event){this.retreivePlaylists();this.dispatchEvent(CBCR3.Player.Events.PlaylistEvent.newPlaylistCreated,{playlistPermalink:event.data.playlistPermalink});},userNotAuthenticatedHandler:function(event){this.dispatchEvent(CBCR3.Player.Events.AuthenticationEvent.loginRequired,{message:"You must be logged in to add tracks to your playlists."});}});

CBCR3.namespace("CBCR3.Panel.Modules");CBCR3.Panel.Modules.Thumbs=Class.create(CBCR3.Commons.EventDispatcher,{thumbStatus:CBCR3.Modules.ThumbStatus.none,thumbService:null,thumbUpFunction:null,permalink:null,upButton:null,initialize:function($super,thumbService)
{$super();this.upButton=$("thumbUp");this.upButton.observe("click",this.thumbUp_Click.bind(this));this.enableThumbUp();this.thumbService=thumbService;this.thumbService.addEventListener(CBCR3.Player.Events.ThumbEvent.registered,this.thumbRegisteredHandler.bind(this));this.thumbService.addEventListener(CBCR3.Player.Events.ServiceExceptionEvent.userNotAuthenticated,this.userNotAuthenticated.bind(this));},load:function(permalink,trackType)
{Trace.write("Load thumbs: "+permalink,false);Trace.write("Track type: "+trackType,false);this.permalink=permalink;if(!this.permalink.blank()&&trackType!=CBCR3.Player.TrackType.hostbreak)
this.enable();else
this.disable();},thumbUp_Click:function(event)
{this.registerThumbStatus(CBCR3.Player.ThumbStatus.up);},enable:function()
{this.enableThumbUp();},disable:function()
{this.upButton.addClassName("disabled");this.upButton.setAttribute("disabled","disable");},enableThumbUp:function()
{this.upButton.removeClassName("disabled");this.upButton.removeClassName("selected");this.upButton.removeAttribute("disabled");this.upButton.removeClassName("thumbed");},registerThumbStatus:function(thumbStatus)
{var isUp=(thumbStatus==CBCR3.Player.ThumbStatus.up);this.thumbService.registerThumbStatus(isUp,this.permalink);},thumbRegisteredHandler:function(event)
{var thumbStatus=event.data.thumbStatus;if(event.data.thumbStatus==CBCR3.Player.ThumbStatus.up)
this.notifyThumbUp();this.dispatchEvent(CBCR3.Player.Events.ThumbEvent.changed,{thumbStatus:thumbStatus});},userNotAuthenticated:function(event)
{this.dispatchEvent(CBCR3.Player.Events.AuthenticationEvent.loginRequired,{message:"You must be logged in to thumb a song."});},notifyThumbUp:function()
{this.upButton.removeClassName("thumbed");this.upButton.addClassName("thumbed");setTimeout(this.enableThumbUp.bind(this),5000);}});

CBCR3.namespace("CBCR3.Modules");CBCR3.Modules.Gears=Class.create(CBCR3.Commons.EventDispatcher,{infoService:null,permalink:null,container:null,itemContainer:null,containerName:null,pageinitializer:null,gearsClass:'gearsBox',listClass:"trackList",itemClass:"item",showInfo:false,showLike:false,infoBox:null,debug:true,showAddPlaylist:false,helper:null,item:null,initialize:function($super,opts){try{$super();Trace.write(" gears.js initialize() -> container:"+this.containerName,this.debug);this.listClass=opts.listClass||this.listClass;this.itemClass=opts.itemClass||this.itemClass;this.helper=CBCR3.Panel.StreamPanelHelperProvider.getInstance();Trace.write(opts,this.debug);Trace.write(this,this.debug);this.pageinitializer=new CBCR3.Application.PageInitializerProvider().getInstance();this.pageinitializer.addEventListener(CBCR3.Player.Events.PageEvent.gearsSelected,this.gearsSelected.bind(this));this.pageinitializer.addEventListener(CBCR3.Player.Events.PageEvent.showtrackinfo,this.showTrackInfoHandler.bind(this));this.infoService=new CBCR3.Gears.Services.InfoService("");this.infoService.addEventListener(CBCR3.ArtistTrackList.ServiceEvent.trackInfoReceived,this.trackInfoReceivedHandler.bind(this));}catch(e){Trace.error(e);}},gearsSelected:function(event){try
{Trace.write("in gears.js -> gearsSelected:",this.debug);Trace.write(event,this.debug);this.item=event.data.source.up('.item');var parent=event.data.source.up('div');var parentList=this.item.up('.gearsblock');var data=event.data;this.showInfo=!event.data.source.hasClassName("noinfo");this.showAddPlaylist=!event.data.source.hasClassName("noadd");this.showLike=!event.data.source.hasClassName("nolike");Trace.write(parent,this.debug);var gearsDiv=parent.down("."+this.gearsClass);if(!gearsDiv){parent.insert(this.template({permalink:data.permalink,title:data.title}));gearsDiv=parent.down("."+this.gearsClass);this.pageinitializer.registerNode(gearsDiv);}
if(gearsDiv){Trace.write("parentlist",this.debug);Trace.write(parentList,this.debug);if(!parentList){Trace.write("gears.js parentList is null, listClass:"+this.listClass,true);return;}
var self=this;var isVisible=gearsDiv.visible();if(this.showInfo){this.infoBox=this.item.down(".infoBox");if(this.infoBox==null){this.item.insert(this.infoBoxEmptyTemplate());this.infoBox=this.item.down(".infoBox");this.infoBox.hide();}}
if(isVisible){gearsDiv.hide();if(this.showInfo){this.infoBox.hide();this.item.removeClassName("itemShowInfo");}}else{this.hideAll(parentList);gearsDiv.show();if(data.permalink!=null&&!data.permalink.blank()&&this.showInfo)
this.infoService.getTrackInfo(data.permalink);}}
Trace.write("gears.js - gearsDiv",true);Trace.write(gearsDiv,true);}catch(e){Trace.error(e);}},hideAll:function(parentList){parentList.select(".item").each(function(item){item.removeClassName("itemShowInfo");if(item.down(".infoBox"))
item.down(".infoBox").hide();if(item.down(".gearsBox"))
item.down(".gearsBox").hide();});},infoBoxEmptyTemplate:function(){var infoDiv=new Element("div",{className:"infoBox"});infoDiv.update("loading...");return infoDiv;},trackInfoReceivedHandler:function(event){var trackInfo=event.data.trackInfo;Trace.write("trackInfoReceivedHandler()",this.debug);Trace.write(trackInfo,this.debug);var date=trackInfo.recordingDate;var formattedDate=(date!=null)?date.strftime("%B %e, %Y"):"";var tokens={artist:trackInfo.artist||"",track:trackInfo.title||"",format:trackInfo.format||"",permalink:trackInfo.permalink||"",date:formattedDate,label:trackInfo.label||"",subGenre:trackInfo.subGenre||"",title:trackInfo.title||"",releaseTitle:trackInfo.releaseTitle||"",ituneslink:trackInfo.ituneslink||"",urlToAudioFile:trackInfo.urlToAudioFile||"",credits:this.helper.processArray(trackInfo.credits),performers:this.helper.processArray(trackInfo.performers)};this.infoBox.update(this.templateInfoBox(tokens));this.infoBoxUpdated=true;},showTrackInfoHandler:function(event){Trace.write("showTrackInfoHandler",this.debug);Trace.write(event,this.debug);if(this.infoBox.visible())
this.item.removeClassName("itemShowInfo");else
this.item.addClassName("itemShowInfo");this.infoBox.toggle();},templateInfoBox:function(tokens){var itunesButton=(tokens.ituneslink&&!tokens.ituneslink.blank())?"<a class=\"itunesbtn\" target=\"_blank\" href=\""+tokens.ituneslink+"\">iTunes Link</a>":"";var downloadButton=(tokens.urlToAudioFile&&!tokens.urlToAudioFile.blank())?"<a class=\"downloadBtn\" href=\""+tokens.urlToAudioFile+"\">Download MP3</a>":"";var rowBreak="<li class=\"rowbreak\">&nbsp;</li>";var buyRow=!itunesButton.blank()||!downloadButton.blank()?rowBreak+"<li class=\"buyrow\"><label>Buy</label>"+itunesButton+downloadButton+"</li>":"";var performersArray=(tokens.performers.length>0)?"<li><label>Performers</label><span>#{performers}</span></li>":"";var markup="<ul>"+
rowBreak+"<li><label>Artist</label><span class=\"trackArtist\"><a href=\"#{permalink}\">#{artist}</a></span></li>"+"<li><label>Track</label><span class=\"trackTitle\">#{track}</span></li>"+"<li><br/></li>"+"<li><label>Release</label><span class=\"releaseTitle\">#{releaseTitle}</span></li>"+"<li><label>Date</label><span>#{date}</span></li>"+"<li><label>Label</label><span>#{label}</span></li>"+"<li><label>Format</label><span>#{format}</span></li>"+"<li><label>Genre</label><span>#{subGenre}</span></li>"+
rowBreak+
performersArray+"<li><label>Credits</label><span>#{credits}</span></li>"+
buyRow+rowBreak+"</ul>";return new Template(markup).evaluate(tokens);},template:function(tokens){var infoBtn=(this.showInfo)?"<a class=\"infoButton\" href=\"#{permalink}\" title=\"#{title}\">info</a>":"";var likeBtn=(this.showLike)?"<a class=\"likeButton\" href=\"#{permalink}\" title=\"#{title}\">like</a>":"";var addPlaylistMarkup=(this.showAddPlaylist)?"<a class=\"addButton\" href=\"#{permalink}\" title=\"#{title}\">add to playlist</a>":"";var markup="<div class=\""+this.gearsClass+"\" style=\"display:none;\">"+
addPlaylistMarkup+
likeBtn+"<a class=\"permalinkButton\" href=\"#{permalink}\" title=\"#{title}\">share</a>"+
infoBtn+"</div>";return new Template(markup).evaluate(tokens);}});

CBCR3.namespace("CBCR3.Services");CBCR3.Services.PlaylistService=Class.create(CBCR3.Commons.EventDispatcher,{initialize:function($super){$super();},createNewPlaylist:function(playlistName){CBC.Radio3.Player.Web.PlayerWebService.CreateNewPlaylist(playlistName,this.createNewPlaylist_Success.bind(this),this.webService_Failed.bind(this));},createNewPlaylist_Success:function(response){this.dispatchEvent(CBCR3.Player.Events.PlaylistEvent.newPlaylistCreated,{playlistPermalink:response});},getPersonalPlaylists:function(){CBC.Radio3.Playlists.Services.PlaylistWebService.GetPlaylists(this.getPersonalPlaylists_Success.bind(this),this.webService_Failed.bind(this));},getPersonalPlaylists_Success:function(response){var playlists=this.parsePlaylists(response);this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.personalPlaylistsReceived,{playlists:playlists});},getAdminPlaylists:function(){CBC.Radio3.Player.Web.PlayerWebService.GetAdminPlaylists(this.getAdminPlaylists_Success.bind(this),this.webService_Failed.bind(this));},getAdminPlaylists_Success:function(response){var playlists=this.parsePlaylists(response);this.dispatchEvent("adminPlaylistsReceived",{playlists:playlists});},getFavouritePlaylists:function(){try{CBC.Radio3.Playlists.Services.PlaylistWebService.GetFavouritePlaylists(this.getFavouritePlaylists_Success.bind(this),this.webService_Failed.bind(this));}catch(e)
{Trace.error(e);}},getFavouritePlaylists_Success:function(response,context){var playlists=this.parsePlaylists(response);this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.favouritePlaylistsReceived,{playlists:playlists});},getFavouriteTracks:function(){try{CBC.Radio3.Playlists.Services.PlaylistWebService.GetFavouriteTracks(this.getFavouriteTracks_Success.bind(this),this.webService_Failed.bind(this));}catch(e)
{Trace.error(e);}},getFavouriteTracks_Success:function(response,context){var tracks=new Array();for(var i=0;i<response.length;i++)
tracks.push(this.translateTrackDTO(response[i]));this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.favouriteTracksReceived,{tracks:tracks});},getFavouriteConcerts:function(){try{CBC.Radio3.Playlists.Services.PlaylistWebService.GetFavouriteConcerts(this.getFavouriteConcerts_Success.bind(this),this.webService_Failed.bind(this));}catch(e)
{Trace.error(e);}},getFavouriteConcerts_Success:function(response,context){Trace.write("getFavouriteConcerts_Success()",true);Trace.write(response,true);var playlists=this.parsePlaylists(response);this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.favouriteConcertsReceived,{playlists:playlists});},parsePlaylists:function(dtoList){return new CBCR3.Mappers.PlaylistDtoMapper().mapCollection(dtoList);},webService_Failed:function(errorResponse){Trace.write("playlistservice.js - webService_Failed()",true);var exception=new CBCR3.Player.Exceptions.SoapExceptionFactory().createException(errorResponse);var type=new CBCR3.Player.Exceptions.SoapExceptionLookup().map(exception.type);this.dispatchEvent(type,{exception:exception});},removeTrack:function(playlistPermalink,sequence){CBC.Radio3.Playlists.Services.PlaylistWebService.RemoveTrack(playlistPermalink,sequence,this.onRemoveTrackSuccess.bind(this),this.onFailure.bind(this));},onRemoveTrackSuccess:function(response){},updateSequence:function(playlistPermalink,oldSequence,newSequence){CBC.Radio3.Playlists.Services.PlaylistWebService.UpdateSequence(playlistPermalink,oldSequence,newSequence,this.onUpdateSequenceSuccess.bind(this),this.onFailure.bind(this));},onUpdateSequenceSuccess:function(response){},addPlaylistToFavourites:function(playlistPermalink){CBC.Radio3.Playlists.Services.PlaylistWebService.AddPlaylistToFavourites(playlistPermalink,this.onAddPlaylistToFavouritesSuccess.bind(this),this.onFailure.bind(this),{playlistPermalink:playlistPermalink});},onAddPlaylistToFavouritesSuccess:function(response,context){this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.playlistAddedToFavourites,{playlistPermalink:context.playlistPermalink},this);},getFavourites:function(){try{CBC.Radio3.Playlists.Services.PlaylistWebService.GetFavourites(this.onGetFavouritesSuccess.bind(this),this.onFailure.bind(this),{});}catch(e){Trace.error(e);}},onGetFavouritesSuccess:function(response,context){this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.favouritesReceived,{playlists:this.parsePlaylistDTOs(response),playlistPermalink:context.playlistPermalink});},getFavouriteArtists:function(playlistPermalink){CBC.Radio3.Playlists.Services.PlaylistWebService.GetFavouriteArtists(this.onGetFavouriteArtistSuccess.bind(this),this.onFailure.bind(this),{playlistPermalink:playlistPermalink});},onGetFavouriteArtistSuccess:function(response,context){try{var playlists=this.parsePlaylists(response);this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.favouriteArtistsReceived,{playlists:playlists,playlistPermalink:context.playlistPermalink});}catch(e){Trace.write("Error in onGetFavouriteArtistSuccess()",true);Trace.error(e);}},getPlaylists:function(playlistPermalink){CBC.Radio3.Playlists.Services.PlaylistWebService.GetPlaylists(this.onGetPlaylistsSuccess.bind(this),this.onFailure.bind(this),{playlistPermalink:playlistPermalink});},onGetPlaylistsSuccess:function(response,context){this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.playlistsReceived,{playlists:this.parsePlaylistDTOs(response),playlistPermalink:context.playlistPermalink});},addTrackToPlaylist:function(trackPermalink,playlistPermalink){CBC.Radio3.Playlists.Services.PlaylistWebService.AddTrackToPlaylist(playlistPermalink,trackPermalink,this.onAddTrackToPlaylistSuccess.bind(this),this.onFailure.bind(this),{playlistPermalink:playlistPermalink,trackPermalink:trackPermalink});},onAddTrackToPlaylistSuccess:function(response,context){this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.trackAddedToPlaylist,{playlistPermalink:context.playlistPermalink,trackPermalink:context.trackPermalink,sequence:response});},parsePlaylistDTOs:function(playlistDtos){var playlists=new Array();for(var i=0;i<playlistDtos.length;i++){playlists.push(this.translatePlaylistDTO(playlistDtos[i]));}
return playlists;},translatePlaylistDTO:function(dto){var playlist=new CBCR3.Playlists.Models.Playlist();playlist.playlistId=dto.PlaylistId;playlist.permalink=dto.Permalink;playlist.title=dto.Title;return playlist;},translateTrackDTO:function(dto){var track=new CBCR3.Playlists.Models.Track();track.id=dto.TrackId;track.length=dto.LengthInSeconds;track.artist=dto.Artist;track.permalink=dto.Permalink;track.title=dto.Title;track.infoLink=dto.InfoLink;track.sequence=dto.Sequence;track.playlistPermalink=dto.PlaylistPermalink;track.iTunesLink=dto.iTunesLink;track.thumbnail=dto.Thumbnail;return track;},getPlaylistTrack:function(playlistPermalink,sequence){CBC.Radio3.Playlists.Services.PlaylistWebService.GetPlaylistTrack(playlistPermalink,sequence,this.onGetPlaylistTrackSuccess.bind(this),this.onFailure.bind(this));},onGetPlaylistTrackSuccess:function(response,context){this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.trackReceived,{track:this.translateTrackDTO(response)});},getPlaylistTracks:function(playlistPermalink,pageSize,startSequence){CBC.Radio3.Playlists.Services.PlaylistWebService.GetPlaylistTracks(playlistPermalink,pageSize,startSequence,this.getPlaylistTracks_Success.bind(this),this.onFailure.bind(this));},getPlaylistTracks_Success:function(response){var tracks=new Array();for(var i=0;i<response.length;i++)
tracks.push(this.translateTrackDTO(response[i]));this.dispatchEvent(CBCR3.Playlists.Events.ServiceEvent.tracksReceived,{tracks:tracks});},onFailure:function(response){}});

CBCR3.namespace("CBCR3.Services");CBCR3.Services.ThumbService=Class.create(CBCR3.Commons.EventDispatcher,{initialize:function()
{},registerThumbStatus:function(isUp,trackPermalink)
{CBC.Radio3.Player.Web.PlayerWebService.Thumbs(isUp,trackPermalink,this.registerThumbStatus_Success.bind(this),this.registerThumbStatus_Failed.bind(this));},registerThumbStatus_Success:function(response)
{this.dispatchEvent(CBCR3.Player.Events.ThumbEvent.registered,{thumbStatus:response});},registerThumbStatus_Failed:function(errorResponse)
{var exception=new CBCR3.Player.Exceptions.SoapExceptionFactory().createException(errorResponse);var type=new CBCR3.Player.Exceptions.SoapExceptionLookup().map(exception.type);this.dispatchEvent(type,{exception:exception});}});

CBCR3.namespace("CBCR3.RecentTracks.Events");CBCR3.RecentTracks.Events.ServiceEvent={audioPlaysReceived:"serviceEvent:audioPlaysReceived"};CBCR3.RecentTracks.Events.ItemEvent={active:"itemEvent:active"};

CBCR3.namespace("CBCR3.RecentTracks.Modules");CBCR3.RecentTracks.Modules.InfoBox=Class.create({audioPlay:null,container:null,pageInitializer:null,effect:null,fadeEffect:null,clearImagePath:"/lib/cbcmusic/images/clear.png",initialize:function(audioPlay){this.audioPlay=audioPlay;this.basicInfo=true;this.pageInitializer=new CBCR3.Application.PageInitializerProvider().getInstance();},render:function(){this.container=new Element("div",{className:"infoBox center"});if(this.audioPlay.username=='Anonymous')
this.audioPlay.userPermalink='http://radio3.cbc.ca';this.container.update(this.template({artistName:this.audioPlay.artistName.truncate(18).toUpperCase(),title:this.audioPlay.title.truncate(18),trackPermalink:this.audioPlay.trackPermalink,artistPermalink:this.audioPlay.artistPermalink,fullArtistName:this.audioPlay.artistName,fullTitle:this.audioPlay.title,username:this.audioPlay.username,userImage:this.audioPlay.userImage,userPermalink:this.audioPlay.userPermalink,listenDate:this.audioPlay.listenDate}));if(this.pageInitializer)this.pageInitializer.registerNode(this.container);return this.container;},hide:function(){if(this.container!=null)
this.container.hide();},show:function(){if(this.container==null)
return;if(this.fadeEffect){this.fadeEffect.cancel();this.container.setStyle({opacity:1});}
this.container.show();},onMouseEnter:function(event){this.show();},onMouseLeave:function(event){},template:function(vars){var markup="";if(true){markup="<div class='details'>"+"<div class='artistName'><a href='#{artistPermalink}' title=\"#{fullArtistName}\">#{artistName}</a></div>"+"<div class='title'><label title=\"#{fullTitle}\">#{title}</label></div>"+"<div class='userDetails' >"+"<div class='playDiv'><a class='playButton' href='#{trackPermalink}' title='Play Track'>Play Track</a></div>"+"<div class='info'>"+"<label>#{listenDate} by</label>"+"<a href='#{userPermalink}' title=\"Go to #{username}'s profile\">#{username}</a>"+"</div>"+"<div class='clear'></div>"+"</div>"+"</div>";}
else{markup="<div class='details'>"+"<div class='artistName'><a target='_blank' href='#{artistPermalink}' title=\"#{fullArtistName}\">#{artistName}</a></div>"+"<div class='title'><label title=\"#{fullTitle}\">\"#{title}\"</label></div>"+"<div class='userDetails'>"+"<a target='_blank' href='#{userPermalink}'><img class='userImage' src='#{userImage}' alt=\"#{username}\" title=\"#{username}\" /></a>"+"<div>"+"<label>#{listenDate} by</label><br />"+"<div><a target='_blank' href='#{userPermalink}' title=\"Go to #{username}'s profile\">#{username}</a></div>"+"</div>"+"</div>"+"</div>";}
return new Template(markup).evaluate(vars);}});

CBCR3.namespace("CBCR3.RecentTracks.Modules");CBCR3.RecentTracks.Modules.TemplateFactory=Class.create({getNextTemplate:function()
{var ran=Math.floor(Math.random()*this.templates.length);return this.templates[ran];},templates:[[{x:0,y:0,size:"medium"},{x:0,y:150,size:"medium"},{x:200,y:0,size:"small"},{x:300,y:0,size:"small"},{x:200,y:75,size:"small"},{x:300,y:75,size:"small"},{x:200,y:150,size:"small"},{x:300,y:150,size:"small"},{x:200,y:225,size:"small"},{x:300,y:225,size:"small"}],[{x:0,y:0,size:"small"},{x:0,y:75,size:"small"},{x:100,y:0,size:"medium"},{x:300,y:0,size:"small"},{x:300,y:75,size:"small"},{x:0,y:150,size:"small"},{x:0,y:225,size:"small"},{x:100,y:150,size:"small"},{x:100,y:225,size:"small"},{x:200,y:150,size:"medium"}],[{x:0,y:0,size:"small"},{x:100,y:0,size:"small"},{x:200,y:0,size:"small"},{x:300,y:0,size:"small"},{x:0,y:75,size:"small"},{x:300,y:75,size:"small"},{x:0,y:150,size:"small"},{x:300,y:150,size:"small"},{x:0,y:225,size:"small"},{x:100,y:225,size:"small"},{x:200,y:225,size:"small"},{x:300,y:225,size:"small"},{x:100,y:75,size:"medium"}],[{x:0,y:0,size:"medium"},{x:200,y:0,size:"medium"},{x:0,y:150,size:"small"},{x:0,y:225,size:"small"},{x:100,y:150,size:"medium"},{x:300,y:150,size:"small"},{x:300,y:225,size:"small"}],[{x:0,y:0,size:"small"},{x:0,y:75,size:"small"},{x:100,y:0,size:"medium"},{x:300,y:0,size:"small"},{x:300,y:75,size:"small"},{x:0,y:150,size:"medium"},{x:200,y:150,size:"medium"}],[{x:0,y:0,size:"small"},{x:100,y:0,size:"small"},{x:0,y:75,size:"medium"},{x:0,y:225,size:"small"},{x:100,y:225,size:"small"},{x:200,y:0,size:"medium"},{x:200,y:150,size:"medium"}],[{x:0,y:0,size:"small"},{x:100,y:0,size:"small"},{x:0,y:75,size:"small"},{x:100,y:75,size:"small"},{x:200,y:0,size:"medium"},{x:0,y:150,size:"medium"},{x:200,y:150,size:"medium"}],[{x:0,y:0,size:"medium"},{x:200,y:0,size:"medium"},{x:0,y:150,size:"medium"},{x:200,y:150,size:"small"},{x:300,y:150,size:"small"},{x:200,y:225,size:"small"},{x:300,y:225,size:"small"}],[{x:0,y:0,size:"medium"},{x:200,y:0,size:"medium"},{x:0,y:150,size:"medium"},{x:200,y:150,size:"medium"}],[{x:0,y:0,size:"medium"},{x:200,y:0,size:"medium"},{x:0,y:150,size:"small"},{x:0,y:225,size:"small"},{x:100,y:150,size:"medium"},{x:300,y:150,size:"small"},{x:300,y:225,size:"small"}]]});

CBCR3.namespace("CBCR3.RecentTracks.Modules");CBCR3.RecentTracks.Modules.TrackGroup=Class.create({tracks:null,container:null,activeItem:null,initialize:function(tracks)
{this.tracks=tracks;},render:function()
{this.container=new Element("div",{className:"trackGroup"});for(var i=0;i<this.tracks.length;i++)
{var trackItem=new CBCR3.RecentTracks.Modules.TrackItem(this.tracks[i]);this.container.insert({top:trackItem.render()});}
this.container.insert(new Element("div",{className:"clear"}));return this.container;},getHeight:function()
{return this.container.getHeight();}});

CBCR3.namespace("CBCR3.RecentTracks.Modules");CBCR3.RecentTracks.Modules.TrackItem=Class.create({track:null,container:null,trackInfo:null,templateData:null,initialize:function(track){this.track=track;},render:function(){this.container=new Element("div",{className:"trackItem"});if(this.trackInfo==null){this.trackInfo=new CBCR3.RecentTracks.Modules.InfoBox(this.track);}
this.container.update(this.template({imagePath:this.track.imagePath,imageUrl:this.track.artistPermalink}));this.container.appendChild(this.trackInfo.render());this.container.observe("mouseover",this.onMouseOver.bind(this));this.trackInfo.show();return this.container;},onMouseOver:function(event){;},template:function(vars){var markup="<div class='rounded-all #{className}' style=\"background: url(#{imagePath}) no-repeat;width:140px;height:80px;\">"+"<a href=\" #{imageUrl} \">"+"<img src=\""+this.trackInfo.clearImagePath+"\" width=\"140\" height=\"80\"/></a>"+"</div>";return new Template(markup).evaluate(vars);}});

CBCR3.namespace("CBCR3.RecentTracks.Models");CBCR3.RecentTracks.Models.AudioPlay=Class.create({initialize:function(properties)
{if(!properties)
properties={};this.title=properties.title||"";this.artistName=properties.artistName||"";this.artistPermalink=properties.artistPermalink||"";this.trackPermalink=properties.trackPermalink||"";this.imagePath=properties.imagePath||"";this.username=properties.username||"";this.userImage=properties.userImage||"";this.userPermalink=properties.userPermalink||"";this.listenDate=properties.listenDate||"recently";}});

CBCR3.namespace("CBCR3.RecentTracks.Services");CBCR3.RecentTracks.Services.AudioPlayService=Class.create(CBCR3.Commons.EventDispatcher,{initialize:function(){},getRecentAudioPlays:function(){CBC.Radio3.Music.WebServices.AudioPlayWebService.GetRecentAudioPlays(this.onSuccess.bind(this),this.onFailed.bind(this));},onSuccess:function(response){this.dispatchEvent(CBCR3.RecentTracks.Events.ServiceEvent.audioPlaysReceived,{tracks:this.mapDtos(response)});},mapDtos:function(audioPlays)
{var dtos=new Array();for(var i=0;i<audioPlays.length;i++)
dtos.push(this.mapDto(audioPlays[i]));return dtos;},mapDto:function(audioPlay)
{return new CBCR3.RecentTracks.Models.AudioPlay({title:audioPlay.Title,artistName:audioPlay.ArtistName,artistPermalink:audioPlay.ArtistPermalink,trackPermalink:audioPlay.TrackPermalink,imagePath:audioPlay.ImagePath,username:audioPlay.Username,userImage:audioPlay.UserImage,userPermalink:audioPlay.UserPermalink,listenDate:audioPlay.ListenDate});},onFailed:function(response){}});

CBCR3.namespace("CBCR3.RecentTracks");CBCR3.RecentTracks.Carousel=Class.create({service:null,container:null,trackList:null,currentGroupCount:0,trackCollection:null,origTracks:null,templateFactory:null,isFirstLoad:true,rows:0,columns:0,audioPlays:null,debug:false,initialize:function(options){this.service=new CBCR3.RecentTracks.Services.AudioPlayService();this.service.addEventListener(CBCR3.RecentTracks.Events.ServiceEvent.audioPlaysReceived,this.onAudioPlaysReceived.bind(this));this.container=$(options.container);this.rows=options.rows||2;this.columns=options.columns||4;},load:function(){this.getAudioPlays();},getAudioPlays:function(){this.service.getRecentAudioPlays();},onAudioPlaysReceived:function(event){this.origTracks=event.data.tracks;this.trackCollection=this.origTracks;if(this.trackCollection.length==0)
return;var amountOfTracks=this.columns;if(this.isFirstLoad){amountOfTracks=this.rows*this.columns;this.container.update();}
if(!this.trackList){this.trackList=new Element("div",{className:"trackList"});this.trackList.setStyle({width:(200*this.columns)+"px"});this.container.insert(this.trackList);}
this.displayTracks(amountOfTracks,!this.isFirstLoad);this.isFirstLoad=false;},displayTracks:function(amount,animate){Trace.write("displayTracks() amount:"+amount+" trackCollection size:"+this.trackCollection.length,this.debug);Trace.write(this.trackCollection[amount-1]==null,this.debug);var tracks=this.shiftTracks(amount);var trackGroup=new CBCR3.RecentTracks.Modules.TrackGroup(tracks);this.trackList.insert({top:trackGroup.render()});this.currentGroupCount++;if(animate){var height=trackGroup.getHeight();this.trackList.setStyle({marginTop:(height*-1)+"px"});setTimeout(this.slideWindow.bind(this),500);}
else
this.onSlideFinished();},slideWindow:function(){new Effect.Morph(this.trackList,{style:"margin:0px",duration:.75,afterFinish:this.onSlideFinished.bind(this)});},shiftTracks:function(amount){var tracks=new Array();for(var i=0;i<amount;i++){var newtrack=this.trackCollection[i];tracks.push(newtrack);this.trackCollection.push(newtrack);}
this.trackCollection.splice(0,amount);return tracks;},onSlideFinished:function(){if(this.trackList!=null&&this.trackList.childElements()!=null){var group=this.trackList.childElements().last();if(this.currentGroupCount>this.rows)
group.remove();setTimeout(this.onTimeout.bind(this),10000);}},onTimeout:function(event){this.displayTracks(this.columns,true);}});

CBCR3.namespace("CBCR3.Commons");CBCR3.Commons.Paging=Class.create(CBCR3.Commons.EventDispatcher,{service:null,page:null,numPerPage:null,postCount:null,initialize:function(options){this.service=options.service;this.page=options.page;this.numPerPage=options.numPerPage;},getPageList:function(page,postCount){this.page=page;var pagingElement=new Element("div",{"class":"pages"});var lastPage=Math.ceil(postCount/this.numPerPage);if(lastPage<11){for(var n=1;n<=lastPage;n++){pagingElement.insert(this.createPageLink(n));}}else if(this.page<7&&lastPage>10){for(var p=1;p<=10;p++){pagingElement.insert(this.createPageLink(p));}
pagingElement.insert(new Element("span").update("..."));pagingElement.insert(this.createPageLink(lastPage));}else if(this.page>6&&this.page<lastPage-4){pagingElement.insert(this.createPageLink(1));pagingElement.insert(new Element("span").update("..."));for(var x=this.page-4;x<this.page+4;x++){pagingElement.insert(this.createPageLink(x));}
pagingElement.insert(new Element("span").update("..."));pagingElement.insert(this.createPageLink(lastPage));}else{pagingElement.insert(this.createPageLink(1));pagingElement.insert(new Element("span").update("..."));for(var o=lastPage-8;o<=lastPage;o++){pagingElement.insert(this.createPageLink(o));}}
var prevNext=new Element("div",{"class":"prevNextButtons"});if(this.page!=1){prevNext.insert(this.createPageLink(this.page-1,"prev"));}else{prevNext.insert(new Element("span").update("prev"));}
prevNext.insert(new Element("span").update("|"));if(this.page!=lastPage&&postCount>0){prevNext.insert(this.createPageLink(this.page+1,"next"));}else{prevNext.insert(new Element("span").update("next"));}
pagingElement.insert(prevNext);return pagingElement;},createPageLink:function(i,text){var pageLink;if(this.page==i){pageLink=new Element("span");}else{pageLink=new Element("a",{title:"Page "+i});var obj=this;pageLink.observe("click",this.pageLinkEvent.bind(self,obj,i));}
if(text==null){pageLink.update(i);}else{pageLink.update(text);}
return pageLink;},pageLinkEvent:function(obj,i){obj.service.getList(i,obj.numPerPage);}});

CBCR3.namespace("CBCR3.Genre");CBCR3.Genre.WebStationManagerRenderingStrategies=Class.create({initialize:function(){},stationSetup:function(){},buildStations:function(){},trackInfoMarkup:function(trackInfo){},getTrackTitle:function(trackTitle,trackInfo){return trackTitle;},getTrackImage:function(trackInfo,programInfo){var imgThumbnail=programInfo.programImage?programInfo.programImage:((trackInfo.thumbnail_lrg)?trackInfo.thumbnail_lrg:trackInfo.thumbnail);return imgThumbnail;},getStationImage:function(programInfo,trackInfo){var imgThumbnail=programInfo.programImage?programInfo.programImage:((trackInfo.thumbnail_lrg)?trackInfo.thumbnail_lrg:trackInfo.thumbnail);return imgThumbnail;},updateWebStationBackground:function(){},template:function(tokens){var img=tokens.thumbnail?"<img class=\"fullSizeArtwork\" src=\""+tokens.thumbnail+"\" alt=\""+tokens.stationname+"\" />":"";var playOverlay='<div class="play contentAudio panelAudio"><a class=\"playButton\" href=\"#{permalink}\" title=\"#{stationname}\"></a></div>';var sponsoredStreamLogo=tokens.specialimage?'<div class="sponsoredStreamLogo"><img src="#{specialimage}"/></div>':'';var markup='';if(this.activityFormat){markup="<div class=\"stationImageWrapper\">"+
img+playOverlay+sponsoredStreamLogo+"</div>"+"<div class=\"streamInfo\">"+"<h4>#{stationname}</h4>"+"<div class=\"currentlyPlaying\">#{description}&nbsp;</div></div>";}else{markup="<h4>#{stationname}</h4>"+"<div class=\"stationImageWrapper\">"+
img+"<div class=\"play\"><a class=\"playButton\" href=\"#{permalink}\" title=\"#{stationname}\"></a></div>"+"</div>"+"<div class=\"currentlyPlaying\"><label>Now Playing</label>"+"#{description}"+"</div>";}
return new Template(markup).evaluate(tokens);}});CBCR3.Genre.Radio3HomeStrategy=Class.create(CBCR3.Genre.WebStationManagerRenderingStrategies,{programInfoSyncd:false,programInfo:'',stationSetup:function(){var self=this,userRegionStation=false;if(this.genreStreams!=null){this.genreStreams.each(function(genreStream){var newStation=new CBCR3.Genre.WebStation(genreStream);self.webStations.push(newStation);});this.buildStations();}},buildStations:function(){var stationContainer=$(this.stationsId);var self=this;this.webStations.each(function(station,index){var updatedStation=null;var slideindex="slide-"+index;var curClassName='activityStation';updatedStation=new Element("li",{className:curClassName,id:slideindex});if(self.showStationNameInPanelHeading){$$('.activityRadioStations .panelHeading')[0].update('Now Playing on '+station.name);}
var description=self.trackInfoTemplate({});updatedStation.update(self.template({permalink:station.permalink,stationname:station.name,description:description,thumbnail:"",hideStation:station.hideStation}));self.registeredStreams[station.mount]=true;stationContainer.insert(updatedStation);self.stationElemCacheMap[station.mount]={stationElem:updatedStation,fullyConstructed:false,stationObj:station};station.registerForUpdatesFromNode(self.nodelistenerservice);});},trackInfoMarkup:function(trackInfo){if(!trackInfo.programDescription)
trackInfo.programDescription="CBC Radio 3";var artistMarkup=(trackInfo.artist)?"<span class=\"artist\" title=\"#{artist}\">"+((trackInfo.infoLink)?"<a href=\"#{infoLink}\">"+trackInfo.artist+"</a></span>":trackInfo.artist+"</span>"):"<span class=\"artist\" title=\"\"></span>";var byStr=(trackInfo.artist)?" by&nbsp;":"";var programDescription='<div class="programDescription">#{programDescription}</div>';var markup='<div class="onAirLabel">On Air</div>'+programDescription+'<div class="nowPlayingLabel">Now Playing</div>'+((trackInfo.title)?"<span class=\"trackinfo\" title=\"#{title}\">"+trackInfo.title+byStr+"</span>":"")+artistMarkup;return new Template(markup).evaluate(trackInfo);},getTrackTitle:function(trackTitle,trackInfo){if(trackInfo==null||trackInfo=="")
return"";return trackTitle+((trackInfo.artist)?" by":"");},updateWebStationBackground:function(stationThumbnail){var webStationBackground=$("webRadioStationBackground");if(CBCDetect!=null&&!CBCDetect.isIE()){if(webStationBackground)
webStationBackground.show();}
if(webStationBackground){webStationBackground.style.background="url('"+stationThumbnail+"') top left no-repeat";}},template:function(tokens){var img="<img class=\"fullSizeArtwork\" src=\"#{thumbnail}\" alt=\"#{stationname}\" />";var playOverlay='<div class="play contentAudio panelAudio"><a class=\"playButton\" href=\"#{permalink}\" title=\"#{stationname}\"></a></div>';var thumbBackImage='<div id="webRadioStationBackground" style="display:none;"></div>';var markup='';markup="<div class=\"stationImageWrapper\">"+thumbBackImage+
img+playOverlay+"</div>"+"<div class=\"streamInfo\">"+"<h4>#{stationname}</h4>"+"<div class=\"currentlyPlaying\">#{description}&nbsp;</div></div>";return new Template(markup).evaluate(tokens);}});CBCR3.Genre.StationListStrategy=Class.create(CBCR3.Genre.WebStationManagerRenderingStrategies,{stationSetup:function(){var self=this,userRegionStation=false;if(this.genreStreams!=null){this.genreStreams.each(function(genreStream){var newStation=new CBCR3.Genre.WebStation(genreStream);if(self.isInternational){if(genreStream.category.toLowerCase()==='cbc radio 2'&&genreStream.name.toLowerCase().indexOf('international')>0){self.webStations.push(newStation);return;}
if(!(genreStream.name.toLowerCase()==='cbc radio 3'||genreStream.name.toLowerCase()==='sonica')){return;}}
if(genreStream.category.toLowerCase()!=='cbc radio 2'){self.webStations.push(newStation);}else if(genreStream.category.toLowerCase()==='cbc radio 2'){var stationToPush=self.R2WebStationFilter(genreStream,newStation);if(stationToPush!=null&&stationToPush.hideStation==false){self.webStations.push(newStation);}}});this.buildStations();}},buildStations:function(){var stationContainer=$(this.stationsId);var self=this;if(this.isInternational){$('viewMoreStreams').hide();}
this.webStations.each(function(station,index){var updatedStation=null;var slideindex="slide-"+index;var curClassName='';curClassName=(index<=3?'activityStation':'activityStation notActive');curClassName=(station.hideStation?'activityStation notActive':curClassName);updatedStation=new Element("li",{className:curClassName,id:slideindex});var specialImage=station.specialimage?station.specialimage:null;var defaultThumb='http://static.music.cbc.ca/v2/misc/defaults/'+station.mount+'_400x400.jpg';updatedStation.update(self.template({permalink:station.permalink,stationname:station.name,description:"",thumbnail:defaultThumb,hideStation:station.hideStation,specialimage:specialImage}));self.registeredStreams[station.mount]=true;stationContainer.insert(updatedStation);self.stationElemCacheMap[station.mount]={stationElem:updatedStation,fullyConstructed:false,stationObj:station};station.registerForUpdatesFromNode(self.nodelistenerservice);});},trackInfoMarkup:function(trackInfo){var artistShort='';if(trackInfo.artist)
artistShort=trackInfo.artist.truncate(20);var artistMarkup=(trackInfo.artist)?"<span class=\"artist\" title=\"#{artist}\">"+((trackInfo.infoLink)?"<a href=\"#{infoLink}\">"+artistShort+"</a></span>":artistShort+"</span>"):"";var programDescription='<div class="programDescription">#{programDescription}</div>';var markup=((trackInfo.title)?"<span class=\"trackinfo\" title=\"#{title}\">"+trackInfo.title.truncate(20)+"</span>":"")+artistMarkup+programDescription;return new Template(markup).evaluate(trackInfo);},getTrackImage:function(trackInfo,programInfo){if(programInfo.programImage&&programInfo.programImage.indexOf('www.cbc.ca')===-1){programInfo.programImage=programInfo.programImage.replace('.jpg','_1x1_120x120.jpg')}
var imgThumbnail=programInfo.programImage?programInfo.programImage:((trackInfo.thumbnail_lrg)?trackInfo.thumbnail_lrg:trackInfo.thumbnail);return imgThumbnail;}});CBCR3.Genre.Radio2HomeStrategy=Class.create(CBCR3.Genre.WebStationManagerRenderingStrategies,{stationSetup:function(){var self=this,userRegionStation=false,easternInternationalStation;if(this.genreStreams!=null){this.genreStreams.each(function(genreStream){var newStation=new CBCR3.Genre.WebStation(genreStream);var stationToPush=self.R2WebStationFilter(genreStream,newStation);if(stationToPush!=null){self.webStations.push(stationToPush);}});this.buildStations();this.initStationSelector();}},buildStations:function(){var stationContainer=$(this.stationsId);var self=this;this.webStations.each(function(station,index){var updatedStation=null;var slideindex="slide-"+index;var curClassName='';curClassName=(station.hideStation?'activityStation notActive':'activityStation Active');updatedStation=new Element("li",{className:curClassName,id:slideindex});if(!station.hideStation){$$('.activityRadioStations .panelHeading')[0].update('Now Playing on '+station.name);}
updatedStation.update(self.template({permalink:station.permalink,stationname:station.name,description:"",thumbnail:"",hideStation:station.hideStation}));self.registeredStreams[station.mount]=true;stationContainer.insert(updatedStation);self.stationElemCacheMap[station.mount]={stationElem:updatedStation,fullyConstructed:false,stationObj:station};station.registerForUpdatesFromNode(self.nodelistenerservice);});},getTrackTitle:function(trackTitle,trackInfo){if(trackInfo==null||trackInfo=="")
return"";return'<a href="'+trackInfo.programLink+'" target="_blank">'+trackTitle+'</a>';},getTrackImage:function(trackInfo,programInfo){var imgThumbnail;if(programInfo.programImage&&programInfo.programImage.indexOf('www.cbc.ca')===-1){programInfo.programImage=programInfo.programImage.replace('.jpg','_16x9_620x350.jpg');}
imgThumbnail=programInfo.programImage?programInfo.programImage:((trackInfo.thumbnail_lrg)?trackInfo.thumbnail_lrg:trackInfo.thumbnail);return imgThumbnail;},trackInfoMarkup:function(trackInfo){var artistShort='';if(trackInfo.artist)
artistShort=trackInfo.artist.truncate(20);var artistMarkup=(trackInfo.artist)?"<span class=\"artist\" title=\"#{artist}\">"+((trackInfo.infoLink)?"<a href=\"#{infoLink}\">"+artistShort+"</a></span>":artistShort+"</span>"):"";var programDescription='<div class="programDescription">#{programDescription}</div>';var markup=((trackInfo.title)?'<span class="trackinfo" title=""><a href="#{programLink}" target="_blank">#{title}</a></span>':'')+artistMarkup+programDescription;return new Template(markup).evaluate(trackInfo);}});CBCR3.Genre.GenreStationStrategy=Class.create(CBCR3.Genre.WebStationManagerRenderingStrategies,{stationSetup:function(){var self=this;if(this.genreStreams!=null){this.genreStreams.each(function(genreStream){var newStation=new CBCR3.Genre.WebStation(genreStream);self.webStations.push(newStation);});this.buildStations();this.setupNav();var webRadioStationsContent=$(this.id);var webRadioStations=$(this.stationsId);var webStationsNav=$(this.navId);var webNavEls=(webStationsNav)?webStationsNav.select('a'):null;webRadioStations.setAttribute("style","width:"+this.webStations.length*301+"px");this.carousel=new Carousel(webRadioStationsContent,webRadioStations.select('.slide'),webNavEls,{frequency:this.frequency,duration:0.8,circular:false,auto:(this.webStations.length>1),afterMove:self.handleAfterMove.bind(self)});}},buildStations:function(){var stationContainer=$(this.stationsId);var self=this;this.webStations.each(function(station,index){var updatedStation=null;var slideindex="slide-"+index;var curClassName='';updatedStation=new Element("div",{className:"slide",id:slideindex});station.index=slideindex;var defaultThumb='http://static.music.cbc.ca/v2/misc/defaults/'+station.mount+'_400x400.jpg';updatedStation.update(self.template({permalink:station.permalink,stationname:station.name,description:"",thumbnail:defaultThumb,hideStation:station.hideStation}));self.registeredStreams[station.mount]=true;stationContainer.insert(updatedStation);self.stationElemCacheMap[station.mount]={stationElem:updatedStation,fullyConstructed:false,stationObj:station};station.registerForUpdatesFromNode(self.nodelistenerservice);});},trackInfoMarkup:function(trackInfo){var artistMarkup=(trackInfo.artist)?"<span class=\"artist\">"+((trackInfo.infoLink)?"<a href=\"#{infoLink}\">#{artist}</a></span>":"#{artist}</span>"):"";var composerMarkup=(trackInfo.composer)?"<div class=\"composer\">#{composer}</div>":"";var markup=artistMarkup+((trackInfo.title)?"<span class=\"trackinfo\">"+trackInfo.title+"</span>":"")+composerMarkup;return new Template(markup).evaluate(trackInfo);}});

CBCR3.namespace("CBCR3.Genre");CBCR3.Genre.WebStation=Class.create(CBCR3.Commons.EventDispatcher,{name:null,permalink:null,category:null,image:null,description:null,roomid:null,mount:null,id:null,nodelistener:null,trackInfo:null,programInfo:null,hideStation:false,specialimage:null,initialize:function(genreOpts){this.name=genreOpts.name;this.permalink=genreOpts.permalink;this.id="webStation-"+genreOpts.id;this.category=genreOpts.category;this.roomid=genreOpts.roomid;this.mount=genreOpts.mount;this.specialimage=genreOpts.specialimage;},connectNode:function(){if(this.roomid!=null){this.nodelistenerservice.addEventListener(CBCR3.Genre.WebStation.Events.metaNodeUpdated,this.metaDataNodeUpdateHandler.bind(this));this.registerForUpdatesFromNode();}},registerForUpdatesFromNode:function(nodeservice){nodeservice.joinWebStationRoom(this.roomid);},metaDataNodeUpdateHandler:function(event){try{var data=event.data.value;var stream=data.stream;if(this.roomid==null||this.roomid!=stream.roomid)
return;this.trackInfo=data.getNowPlaying();this.programInfo={programName:stream.programname,programImage:stream.programimage};this.dispatchEvent(CBCR3.Genre.WebStation.Events.webStationUpdated,this);}catch(e){if(!(typeof Trace=='undefined'))
Trace.error(e);}}});CBCR3.Genre.WebStationManager=Class.create({genre:null,genreStreams:null,webStations:null,id:null,stationsId:null,pageinitializer:null,autoMove:true,carousel:null,frequency:4,activityFormat:false,showStationNameInPanelHeading:false,stationElemCache:null,stationElemCacheMap:{},nodelistenerservice:null,timezoneMap:null,trackInfoTemplate:null,truncateTrackInfo:false,showStationSelector:false,displayMode:null,listService:null,programItemList:null,renderingStrategy:null,isInternational:false,getTrackTitle:null,getTrackImage:null,$headerPlayButton:null,flattenGroupedStreams:false,initialize:function(genre,genreStreams,options){if(genreStreams==null||genreStreams.length==0){$('webRadioStationContent').hide();$('webRadioStationContentNotAvailable').show();return;}
this.genreStreams=genreStreams;if(options!==undefined){this.showStationNameInPanelHeading=(options.showStationNameInPanelHeading!==undefined&&options.showStationNameInPanelHeading)||false;if(options.trackInfoMode){this.displayMode=options.trackInfoMode;}
if(options.renderingStrategy){this.renderingStrategy=options.renderingStrategy;this.setupStations=this.renderingStrategy.stationSetup;this.buildStations=this.renderingStrategy.buildStations;this.trackInfoTemplate=this.renderingStrategy.trackInfoMarkup;this.getTrackTitle=this.renderingStrategy.getTrackTitle;this.getTrackImage=this.renderingStrategy.getTrackImage;this.template=this.renderingStrategy.template;}
this.truncateTrackInfo=(options.truncateTrackInfo!==undefined&&options.truncateTrackInfo)||false;this.showStationSelector=(options.showStationSelector!==undefined&&options.showStationSelector)||false;this.activityFormat=(options.activityFormat!==undefined&&options.activityFormat)||false;this.isInternational=(options.isInternational!==undefined&&options.isInternational)||false;if(options.$headerPlayButton){this.$headerPlayButton=options.$headerPlayButton;}
if(options.flattenGroupedStreams){this.flattenGroupedStreams=true;this.doFlattenGroupedStreams();}}
this.registeredStreams=new Array();this.nodelistenerservice=getNodeService();this.nodelistenerservice.addEventListener(CBCR3.Genre.WebStation.Events.metaNodeUpdated,this.updateHandler.bind(this));this.timezoneMap=['eastern','eastern','Atlantic','Atlantic','Eastern','Central','Mountain','Pacific'];this.timezoneMapInternational=['eastern','eastern','Atlantic','Atlantic','Eastern (International)','Central','Mountain','Pacific (International)'];var offset=new Date().getTimezoneOffset();this.curZoneOffset=Math.floor((offset/60));var today=new Date();if(!this.dst(today)){this.curZoneOffset=this.curZoneOffset-1;}
this.genre=genre;this.webStations=new Array();this.id="webRadioStationContent";this.stationsId="webRadioStations";this.wrapperId="webRadioStationsWrapper";this.navId="webStationsNav";this.pageinitializer=new CBCR3.Application.PageInitializerProvider().getInstance();this.setupStations();this.updateNav(0);},addToStreamListCollection:function(streamSet,streamList,alreadyAdded){var stream,streams;if(streamSet==null)
return streamList;streams=streamSet.stations;for(var i=0;i<streams.length;i++){stream=streams[i];if(!alreadyAdded.hasOwnProperty(stream.mount)){streamList.push(stream);alreadyAdded[stream.mount]=true;}}
return streamList;},groupFlatStreams:function(streams){var groups={},curCategory;for(var i=0;i<streams.length;i++){curCategory=streams[i].category;if(!groups.hasOwnProperty(curCategory)){groups[curCategory]=[];}
groups[curCategory].push(streams[i]);}
return groups;},doFlattenGroupedStreams:function(){var newStreamList=[],streamGroups=this.genreStreams,alreadyAddedMap={};newStreamList=this.addToStreamListCollection(streamGroups['CBC Radio 2'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Radio3'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Sonica'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Special'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Classical'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Luminaries'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Rock'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Electronic'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Moods'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Pop'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Jazz'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Singer-Songwriter'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['World'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Blues'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['R&B / Soul'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Hip-Hop'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Aboriginal'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Country'],newStreamList,alreadyAddedMap);newStreamList=this.addToStreamListCollection(streamGroups['Kids CBC'],newStreamList,alreadyAddedMap);this.genreStreams=newStreamList;},configureHeaderPlayButton:function(selectedText){if(this.$headerPlayButton){if(this.isInternational){this.$headerPlayButton.href='/stream/station/radio2/'+selectedText.replace(/([a-z]+) \((international)\)/i,function(str,grp1,grp2){return(grp1+'-'+grp2).toLowerCase();});}else{this.$headerPlayButton.href='/stream/station/radio2/'+selectedText.toLowerCase();}}},stdTimezoneOffset:function(date){var jan=new Date(date.getFullYear(),0,1);var jul=new Date(date.getFullYear(),6,1);return Math.max(jan.getTimezoneOffset(),jul.getTimezoneOffset());},dst:function(date){return date.getTimezoneOffset()<this.stdTimezoneOffset(date);},initStationSelector:function(){var self=this,selectElem,selectorDiv=$('stationSelector'),newOption,tzMapToUse,arrayOffset=0;selectElem=new Element("select",{className:''});var selectedValue="";tzMapToUse=this.isInternational?['Pacific (International)','Eastern (International)']:this.timezoneMap;arrayOffset=this.isInternational?0:3;for(var i=arrayOffset;i<tzMapToUse.length;i++){newOption=new Element('option',{value:i-arrayOffset}).update(tzMapToUse[i]);if(this.isInternational&&this.outsideNorthAmerica()&&tzMapToUse[i]==='Eastern (International)'){newOption.selected=true;}else
newOption.selected=this.currentRegionalStation(tzMapToUse[i]);if(newOption.selected)
selectedValue=newOption.text;selectElem.insert(newOption);}
selectElem.observe('change',function(){var stationIndex=this.getValue(),selectedText="";this.select("option:selected").each(function(opt){selectedText=opt.text;stationIndex=opt.value;var nowPlayingHeading=$('nowPlayingHeading');if(nowPlayingHeading)
nowPlayingHeading.update('Now Playing on '+selectedText);});$$('#webRadioStations > li').each(function(elem){elem.removeClassName('Active').addClassName('notActive');});$('slide-'+stationIndex).removeClassName('notActive').addClassName('Active');self.updateSelectOverlay(selectorDiv,selectedText);self.configureHeaderPlayButton(selectedText);});this.configureHeaderPlayButton(selectedValue);selectorDiv.insert(selectElem).show();selectorDiv.insert(new Element('div',{className:'selectOverlay'}));self.updateSelectOverlay(selectorDiv,selectedValue);},updateSelectOverlay:function(listContainer,value){if(listContainer==null)
return;var selectOver=listContainer.down(".selectOverlay");if(selectOver){selectOver.update(value);}},setupStations:function(){},keepR2StationInternational:function(genreStream,newStation){var userRegionStation;if(genreStream.name.match(/international/i)){if(this.outsideNorthAmerica()&&genreStream.name.toLowerCase()==='eastern (international)'){newStation.hideStation=false;return newStation;}
else if(this.outsideNorthAmerica()&&genreStream.name.toLowerCase()!=='eastern (international)'){newStation.hideStation=true;return newStation;}
userRegionStation=this.currentRegionalStation(genreStream.name);newStation.hideStation=!userRegionStation;return newStation;}
return null;},keepR2Station:function(genreStream,newStation){var userRegionStation=this.currentRegionalStation(genreStream.name);newStation.hideStation=!userRegionStation;return newStation;},R2WebStationFilter:function(genreStream,newStation){if(this.isInternational)
return this.keepR2StationInternational(genreStream,newStation);return this.keepR2Station(genreStream,newStation);},outsideNorthAmerica:function(){if(this.curZoneOffset<2||this.curZoneOffset>7)
return true;return false;},currentRegionalStation:function(stationName){if(this.outsideNorthAmerica())
return false;if(!this.isInternational&&this.timezoneMap[this.curZoneOffset].toLowerCase()===stationName.toLowerCase()){return true;}
else if(this.isInternational&&this.timezoneMapInternational[this.curZoneOffset].toLowerCase()===stationName.toLowerCase()){return true;}
return false;},buildStations:function(){},updateStationInfo:function(trackInfo,stationElem,programInfo){var trackTitle,artistShort;var imgThumbnail=this.getTrackImage(trackInfo,programInfo);var stationLi=stationElem;if(this.truncateTrackInfo){trackTitle=(trackInfo.title)?trackInfo.title.truncate(20):'';artistShort=(trackInfo.artist)?trackInfo.artist.truncate(20):'';}else{trackTitle=(trackInfo.title)?trackInfo.title:'';artistShort=(trackInfo.artist)?trackInfo.artist:'';}
var artistName=(trackInfo.artist)?((trackInfo.infoLink)?'<a href="'+trackInfo.infoLink+'">'+artistShort+'</a></div>':artistShort+'</div>'):'';var thumbElem=stationLi.down('.fullSizeArtwork');if(thumbElem)
thumbElem.src=imgThumbnail;trackTitle=this.getTrackTitle(trackTitle,trackInfo);var trackTitleElem=stationLi.down('.trackinfo');var artistElem=stationLi.down('.artist');var programDescElem=stationLi.down('.programDescription');if(trackTitleElem){trackTitleElem.update(trackTitle+"&nbsp;");trackTitleElem.setAttribute("title",trackTitle);}
if(artistElem){artistElem.update(artistName+"&nbsp;");artistElem.setAttribute("title",(trackInfo.artist?trackInfo.artist:''));}
if(programDescElem){var desc=(programInfo.programDescription!=null)?programInfo.programDescription:"";programDescElem.update(desc+"&nbsp;");}
this.renderingStrategy.updateWebStationBackground(imgThumbnail);},constructTrackAndProgramInfo:function(data,stream){var trackInfo=data.getNowPlaying();var programInfo={programName:stream.programname,programImage:stream.programimage,programDescription:stream.programdescription};if(stream.category.toLowerCase()==='radio2'){trackInfo={artist:stream.name,title:programInfo.programName,programDescription:stream.programdescription,programLink:stream.programinfolink};stream.name='CBC Radio 2';}
else if(stream.category.toLowerCase()==='radio3'){programInfo.programDescription=stream.programname;trackInfo.programDescription=stream.programname;}
return{trackInfo:trackInfo,programInfo:programInfo};},updateHandler:function(event){var data=event.data.value;var stream=data.stream;var trackInfo,programInfo;var imgThumbnail;if(!this.registeredStreams[stream.mount])
return;if(stream.roomid==null||stream.roomid=='')
return;var tAndpObj=this.constructTrackAndProgramInfo(data,stream);trackInfo=tAndpObj.trackInfo;programInfo=tAndpObj.programInfo;var stationMarkup=null,stationElem=null,stationElemObj=null,stationObj=null;try{stationElemObj=this.stationElemCacheMap[stream.mount];stationElem=stationElemObj.stationElem;stationObj=stationElemObj.stationObj;if(stationElemObj.fullyConstructed){this.updateStationInfo(trackInfo,stationElem,programInfo);}else{imgThumbnail=this.renderingStrategy.getTrackImage(trackInfo,programInfo);var description=this.trackInfoTemplate(trackInfo);stationMarkup=this.template({permalink:stationObj.permalink,stationname:stream.name,description:description,thumbnail:imgThumbnail,specialimage:stationObj.specialimage});stationElem.update(stationMarkup);this.pageinitializer.registerNode(stationElem);this.renderingStrategy.updateWebStationBackground(imgThumbnail);stationElemObj.stationElem=stationElem;stationElemObj.fullyConstructed=true;this.stationElemCacheMap[stream.mount]=stationElemObj;}}catch(e){Trace.error(e);}},handleAfterMove:function(){var curr=this.carousel.current;var lastId="slide-"+(this.webStations.length-1);var self=this;this.updateNav(curr._index);if(this.autoMove&&curr.id==lastId){this.autoMove=false;this.carousel.pause();if(this.webStations.length>1)
window.setTimeout(function(){self.carousel.first();},self.frequency*1000);}},setupNav:function(){var webStationsNav=$(this.navId);var navElWidth=20;var totalNavWidth=0;if(!webStationsNav){var webStationsWrapper=$(this.wrapperId);var navWrapper=new Element("div",{className:"webStationsNavWrapper"});var newDiv=new Element("div",{id:"webStationsNav"});if(this.webStations.length<=1)
return;this.webStations.each(function(station,index){var anchor=new Element("a",{title:station.name,href:"javascript:",rel:"slide-"+index,className:"carousel-jumper"});anchor.update("&nbsp;");newDiv.insert(anchor);totalNavWidth+=navElWidth;});navWrapper.insert(newDiv);webStationsWrapper.insert(navWrapper);newDiv.setAttribute("style","width:"+totalNavWidth+"px");}},updateNav:function(number){if(this.webStations.length<=1)
return;var navWrapper=$(this.navId);if(navWrapper){navWrapper.select(".carousel-jumper").each(function(item,index){if(number==index)
item.addClassName("carousel-selected");else
item.removeClassName("carousel-selected");});}},});CBCR3.namespace("CBCR3.Genre.WebStation");CBCR3.Genre.WebStation.Events={webStationUpdated:"webstation:Updated",metaNodeUpdated:"metaNode:updated"};

(function(){window.ActivityPostProcessor=(function(){var _lastPostIndex;_lastPostIndex=1;function ActivityPostProcessor(postList,bigFeatureMod){this.postList=postList;this.bigFeatureMod=bigFeatureMod;}
ActivityPostProcessor.prototype.groupByDateRecursive=function(dateMap,ixItem,curDay){var curDayString,curPost,curPostDate;if(ixItem===this.postList.length){return dateMap;}
curPost=this.postList[ixItem];curPostDate=curPost.postDate;if(curDay===null){curDay=curPostDate;}else{if(curDay!==curPostDate){curDay=curPostDate;}}
curDayString=moment(curDay).format('MMMM D, YYYY');if(dateMap[curDayString]===void 0){dateMap[curDayString]=[];}
if(curPostDate===curDay){dateMap[curDayString].push(curPost);}
curPost.isBigFeature=ixItem%this.bigFeatureMod===0;return this.groupByDateRecursive(dateMap,++ixItem,curDay);};ActivityPostProcessor.prototype.groupByDate=function(){var dateMap;return dateMap=this.groupByDateRecursive({},0,null);};ActivityPostProcessor.prototype.stampFirst=function(postArr,date){return postArr[0].activityStamp=date;};ActivityPostProcessor.prototype.stampPost=function(curPost,postArr,i){var as,curPostDate,curPostTime,ms,now,plural,postDate,postDateTime,timeDiff,unit;now=moment();as='';curPostDate=curPost.postDate;curPostTime=curPost.postTime;postDate=new Date(curPostDate+' '+curPostTime);postDateTime=moment(postDate);unit='';plural='';timeDiff=null;ms=now.diff(postDateTime);if(ms<=60000){timeDiff=now.diff(postDateTime,'seconds');unit='second';}else if(ms>60000&&ms<3600000){timeDiff=now.diff(postDateTime,'minutes');unit='minute';}else if(ms>=3600000&&ms<21600000){timeDiff=now.diff(postDateTime,'hours');unit='hour';}else{as='Earlier Today';}
plural=(timeDiff!=null)&&timeDiff>1?'s':'';as=timeDiff!=null?""+timeDiff+" "+unit+plural+" ago":as;curPost.activityStamp=as;curPost.showActivityStamp=false;if(postArr[i-1]&&postArr[i-1].showActivityStamp===true&&postArr[i-1].activityStamp===curPost.activityStamp){return curPost.showActivityStamp=false;}else if(postArr[i-1]&&postArr[i-1].showActivityStamp===false&&postArr[i-1].activityStamp===curPost.activityStamp){return curPost.showActivityStamp=false;}else{return curPost.showActivityStamp=true;}};ActivityPostProcessor.prototype.processToday=function(postArr){var curPost,i,_i,_len,_results;_results=[];for(i=_i=0,_len=postArr.length;_i<_len;i=++_i){curPost=postArr[i];_results.push(this.stampPost(curPost,postArr,i));}
return _results;};ActivityPostProcessor.prototype.applyTimeStamps=function(){var array,date,dateMap,today,yesterday;today=moment().format('MMMM D, YYYY');yesterday=moment().subtract('days',1).format('MMMM D, YYYY');dateMap=this.groupByDate();for(date in dateMap){array=dateMap[date];if(date!==today&&date!==yesterday){this.stampFirst(dateMap[date],date);}}
if(dateMap[yesterday]!==void 0){this.stampFirst(dateMap[yesterday],'Yesterday');}
if(dateMap[today]!==void 0){this.processToday(dateMap[today]);}
return this.postList;};ActivityPostProcessor.prototype.addToListAndApplyStamps=function(items){var item,postsToReturn,_i,_len;if(items===null||items.length===0){return this.postList;}
for(_i=0,_len=items.length;_i<_len;_i++){item=items[_i];this.postList.push(item);}
this.applyTimeStamps();postsToReturn=this.postList.slice(_lastPostIndex-1,this.postList.length);_lastPostIndex+=items.length;return postsToReturn;};return ActivityPostProcessor;})();}).call(this);

(function(a){function b(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function c(a,b){return function(c){return k(a.call(this,c),b)}}function d(a,b){return function(c){return this.lang().ordinal(a.call(this,c),b)}}function e(){}function f(a){w(a),h(this,a)}function g(a){var b=q(a),c=b.year||0,d=b.month||0,e=b.week||0,f=b.day||0,g=b.hour||0,h=b.minute||0,i=b.second||0,j=b.millisecond||0;this._milliseconds=+j+1e3*i+6e4*h+36e5*g,this._days=+f+7*e,this._months=+d+12*c,this._data={},this._bubble()}function h(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function i(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&qb.hasOwnProperty(b)&&(c[b]=a[b]);return c}function j(a){return 0>a?Math.ceil(a):Math.floor(a)}function k(a,b,c){for(var d=""+Math.abs(a),e=a>=0;d.length<b;)d="0"+d;return(e?c?"+":"":"-")+d}function l(a,b,c,d){var e,f,g=b._milliseconds,h=b._days,i=b._months;g&&a._d.setTime(+a._d+g*c),(h||i)&&(e=a.minute(),f=a.hour()),h&&a.date(a.date()+h*c),i&&a.month(a.month()+i*c),g&&!d&&db.updateOffset(a),(h||i)&&(a.minute(e),a.hour(f))}function m(a){return"[object Array]"===Object.prototype.toString.call(a)}function n(a){return"[object Date]"===Object.prototype.toString.call(a)||a instanceof Date}function o(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&s(a[d])!==s(b[d]))&&g++;return g+f}function p(a){if(a){var b=a.toLowerCase().replace(/(.)s$/,"$1");a=Tb[a]||Ub[b]||b}return a}function q(a){var b,c,d={};for(c in a)a.hasOwnProperty(c)&&(b=p(c),b&&(d[b]=a[c]));return d}function r(b){var c,d;if(0===b.indexOf("week"))c=7,d="day";else{if(0!==b.indexOf("month"))return;c=12,d="month"}db[b]=function(e,f){var g,h,i=db.fn._lang[b],j=[];if("number"==typeof e&&(f=e,e=a),h=function(a){var b=db().utc().set(d,a);return i.call(db.fn._lang,b,e||"")},null!=f)return h(f);for(g=0;c>g;g++)j.push(h(g));return j}}function s(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=b>=0?Math.floor(b):Math.ceil(b)),c}function t(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function u(a){return v(a)?366:365}function v(a){return a%4===0&&a%100!==0||a%400===0}function w(a){var b;a._a&&-2===a._pf.overflow&&(b=a._a[jb]<0||a._a[jb]>11?jb:a._a[kb]<1||a._a[kb]>t(a._a[ib],a._a[jb])?kb:a._a[lb]<0||a._a[lb]>23?lb:a._a[mb]<0||a._a[mb]>59?mb:a._a[nb]<0||a._a[nb]>59?nb:a._a[ob]<0||a._a[ob]>999?ob:-1,a._pf._overflowDayOfYear&&(ib>b||b>kb)&&(b=kb),a._pf.overflow=b)}function x(a){return null==a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&a._pf.overflow<0&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length)),a._isValid}function y(a){return a?a.toLowerCase().replace("_","-"):a}function z(a,b){return b._isUTC?db(a).zone(b._offset||0):db(a).local()}function A(a,b){return b.abbr=a,pb[a]||(pb[a]=new e),pb[a].set(b),pb[a]}function B(a){delete pb[a]}function C(a){var b,c,d,e,f=0,g=function(a){if(!pb[a]&&rb)try{require("./lang/"+a)}catch(b){}return pb[a]};if(!a)return db.fn._lang;if(!m(a)){if(c=g(a))return c;a=[a]}for(;f<a.length;){for(e=y(a[f]).split("-"),b=e.length,d=y(a[f+1]),d=d?d.split("-"):null;b>0;){if(c=g(e.slice(0,b).join("-")))return c;if(d&&d.length>=b&&o(e,d,!0)>=b-1)break;b--}f++}return db.fn._lang}function D(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function E(a){var b,c,d=a.match(vb);for(b=0,c=d.length;c>b;b++)d[b]=Yb[d[b]]?Yb[d[b]]:D(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function F(a,b){return a.isValid()?(b=G(b,a.lang()),Vb[b]||(Vb[b]=E(b)),Vb[b](a)):a.lang().invalidDate()}function G(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(wb.lastIndex=0;d>=0&&wb.test(a);)a=a.replace(wb,c),wb.lastIndex=0,d-=1;return a}function H(a,b){var c,d=b._strict;switch(a){case"DDDD":return Ib;case"YYYY":case"GGGG":case"gggg":return d?Jb:zb;case"Y":case"G":case"g":return Lb;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return d?Kb:Ab;case"S":if(d)return Gb;case"SS":if(d)return Hb;case"SSS":if(d)return Ib;case"DDD":return yb;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Cb;case"a":case"A":return C(b._l)._meridiemParse;case"X":return Fb;case"Z":case"ZZ":return Db;case"T":return Eb;case"SSSS":return Bb;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return d?Hb:xb;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return xb;default:return c=new RegExp(P(O(a.replace("\\","")),"i"))}}function I(a){a=a||"";var b=a.match(Db)||[],c=b[b.length-1]||[],d=(c+"").match(Qb)||["-",0,0],e=+(60*d[1])+s(d[2]);return"+"===d[0]?-e:e}function J(a,b,c){var d,e=c._a;switch(a){case"M":case"MM":null!=b&&(e[jb]=s(b)-1);break;case"MMM":case"MMMM":d=C(c._l).monthsParse(b),null!=d?e[jb]=d:c._pf.invalidMonth=b;break;case"D":case"DD":null!=b&&(e[kb]=s(b));break;case"DDD":case"DDDD":null!=b&&(c._dayOfYear=s(b));break;case"YY":e[ib]=s(b)+(s(b)>68?1900:2e3);break;case"YYYY":case"YYYYY":case"YYYYYY":e[ib]=s(b);break;case"a":case"A":c._isPm=C(c._l).isPM(b);break;case"H":case"HH":case"h":case"hh":e[lb]=s(b);break;case"m":case"mm":e[mb]=s(b);break;case"s":case"ss":e[nb]=s(b);break;case"S":case"SS":case"SSS":case"SSSS":e[ob]=s(1e3*("0."+b));break;case"X":c._d=new Date(1e3*parseFloat(b));break;case"Z":case"ZZ":c._useUTC=!0,c._tzm=I(b);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":a=a.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":a=a.substr(0,2),b&&(c._w=c._w||{},c._w[a]=b)}}function K(a){var b,c,d,e,f,g,h,i,j,k,l=[];if(!a._d){for(d=M(a),a._w&&null==a._a[kb]&&null==a._a[jb]&&(f=function(b){var c=parseInt(b,10);return b?b.length<3?c>68?1900+c:2e3+c:c:null==a._a[ib]?db().weekYear():a._a[ib]},g=a._w,null!=g.GG||null!=g.W||null!=g.E?h=Z(f(g.GG),g.W||1,g.E,4,1):(i=C(a._l),j=null!=g.d?V(g.d,i):null!=g.e?parseInt(g.e,10)+i._week.dow:0,k=parseInt(g.w,10)||1,null!=g.d&&j<i._week.dow&&k++,h=Z(f(g.gg),k,j,i._week.doy,i._week.dow)),a._a[ib]=h.year,a._dayOfYear=h.dayOfYear),a._dayOfYear&&(e=null==a._a[ib]?d[ib]:a._a[ib],a._dayOfYear>u(e)&&(a._pf._overflowDayOfYear=!0),c=U(e,0,a._dayOfYear),a._a[jb]=c.getUTCMonth(),a._a[kb]=c.getUTCDate()),b=0;3>b&&null==a._a[b];++b)a._a[b]=l[b]=d[b];for(;7>b;b++)a._a[b]=l[b]=null==a._a[b]?2===b?1:0:a._a[b];l[lb]+=s((a._tzm||0)/60),l[mb]+=s((a._tzm||0)%60),a._d=(a._useUTC?U:T).apply(null,l)}}function L(a){var b;a._d||(b=q(a._i),a._a=[b.year,b.month,b.day,b.hour,b.minute,b.second,b.millisecond],K(a))}function M(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function N(a){a._a=[],a._pf.empty=!0;var b,c,d,e,f,g=C(a._l),h=""+a._i,i=h.length,j=0;for(d=G(a._f,g).match(vb)||[],b=0;b<d.length;b++)e=d[b],c=(h.match(H(e,a))||[])[0],c&&(f=h.substr(0,h.indexOf(c)),f.length>0&&a._pf.unusedInput.push(f),h=h.slice(h.indexOf(c)+c.length),j+=c.length),Yb[e]?(c?a._pf.empty=!1:a._pf.unusedTokens.push(e),J(e,c,a)):a._strict&&!c&&a._pf.unusedTokens.push(e);a._pf.charsLeftOver=i-j,h.length>0&&a._pf.unusedInput.push(h),a._isPm&&a._a[lb]<12&&(a._a[lb]+=12),a._isPm===!1&&12===a._a[lb]&&(a._a[lb]=0),K(a),w(a)}function O(a){return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e})}function P(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Q(a){var c,d,e,f,g;if(0===a._f.length)return a._pf.invalidFormat=!0,a._d=new Date(0/0),void 0;for(f=0;f<a._f.length;f++)g=0,c=h({},a),c._pf=b(),c._f=a._f[f],N(c),x(c)&&(g+=c._pf.charsLeftOver,g+=10*c._pf.unusedTokens.length,c._pf.score=g,(null==e||e>g)&&(e=g,d=c));h(a,d||c)}function R(a){var b,c,d=a._i,e=Mb.exec(d);if(e){for(a._pf.iso=!0,b=0,c=Ob.length;c>b;b++)if(Ob[b][1].exec(d)){a._f=Ob[b][0]+(e[6]||" ");break}for(b=0,c=Pb.length;c>b;b++)if(Pb[b][1].exec(d)){a._f+=Pb[b][0];break}d.match(Db)&&(a._f+="Z"),N(a)}else a._d=new Date(d)}function S(b){var c=b._i,d=sb.exec(c);c===a?b._d=new Date:d?b._d=new Date(+d[1]):"string"==typeof c?R(b):m(c)?(b._a=c.slice(0),K(b)):n(c)?b._d=new Date(+c):"object"==typeof c?L(b):b._d=new Date(c)}function T(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function U(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function V(a,b){if("string"==typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!=typeof a)return null}else a=parseInt(a,10);return a}function W(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function X(a,b,c){var d=hb(Math.abs(a)/1e3),e=hb(d/60),f=hb(e/60),g=hb(f/24),h=hb(g/365),i=45>d&&["s",d]||1===e&&["m"]||45>e&&["mm",e]||1===f&&["h"]||22>f&&["hh",f]||1===g&&["d"]||25>=g&&["dd",g]||45>=g&&["M"]||345>g&&["MM",hb(g/30)]||1===h&&["y"]||["yy",h];return i[2]=b,i[3]=a>0,i[4]=c,W.apply({},i)}function Y(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=db(a).add("d",f),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function Z(a,b,c,d,e){var f,g,h=U(a,0,1).getUTCDay();return c=null!=c?c:e,f=e-h+(h>d?7:0)-(e>h?7:0),g=7*(b-1)+(c-e)+f+1,{year:g>0?a:a-1,dayOfYear:g>0?g:u(a-1)+g}}function $(a){var b=a._i,c=a._f;return null===b?db.invalid({nullInput:!0}):("string"==typeof b&&(a._i=b=C().preparse(b)),db.isMoment(b)?(a=i(b),a._d=new Date(+b._d)):c?m(c)?Q(a):N(a):S(a),new f(a))}function _(a,b){db.fn[a]=db.fn[a+"s"]=function(a){var c=this._isUTC?"UTC":"";return null!=a?(this._d["set"+c+b](a),db.updateOffset(this),this):this._d["get"+c+b]()}}function ab(a){db.duration.fn[a]=function(){return this._data[a]}}function bb(a,b){db.duration.fn["as"+a]=function(){return+this/b}}function cb(a){var b=!1,c=db;"undefined"==typeof ender&&(a?(gb.moment=function(){return!b&&console&&console.warn&&(b=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),c.apply(null,arguments)},h(gb.moment,c)):gb.moment=db)}for(var db,eb,fb="2.5.1",gb=this,hb=Math.round,ib=0,jb=1,kb=2,lb=3,mb=4,nb=5,ob=6,pb={},qb={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},rb="undefined"!=typeof module&&module.exports&&"undefined"!=typeof require,sb=/^\/?Date\((\-?\d+)/i,tb=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,ub=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,vb=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,wb=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,xb=/\d\d?/,yb=/\d{1,3}/,zb=/\d{1,4}/,Ab=/[+\-]?\d{1,6}/,Bb=/\d+/,Cb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Db=/Z|[\+\-]\d\d:?\d\d/gi,Eb=/T/i,Fb=/[\+\-]?\d+(\.\d{1,3})?/,Gb=/\d/,Hb=/\d\d/,Ib=/\d{3}/,Jb=/\d{4}/,Kb=/[+-]?\d{6}/,Lb=/[+-]?\d+/,Mb=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Nb="YYYY-MM-DDTHH:mm:ssZ",Ob=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],Pb=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Qb=/([\+\-]|\d\d)/gi,Rb="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),Sb={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Tb={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Ub={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Vb={},Wb="DDD w W M D d".split(" "),Xb="M D H h m s w W".split(" "),Yb={M:function(){return this.month()+1},MMM:function(a){return this.lang().monthsShort(this,a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return k(this.year()%100,2)},YYYY:function(){return k(this.year(),4)},YYYYY:function(){return k(this.year(),5)},YYYYYY:function(){var a=this.year(),b=a>=0?"+":"-";return b+k(Math.abs(a),6)},gg:function(){return k(this.weekYear()%100,2)},gggg:function(){return k(this.weekYear(),4)},ggggg:function(){return k(this.weekYear(),5)},GG:function(){return k(this.isoWeekYear()%100,2)},GGGG:function(){return k(this.isoWeekYear(),4)},GGGGG:function(){return k(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return s(this.milliseconds()/100)},SS:function(){return k(s(this.milliseconds()/10),2)},SSS:function(){return k(this.milliseconds(),3)},SSSS:function(){return k(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+k(s(a/60),2)+":"+k(s(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+k(s(a/60),2)+k(s(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},Zb=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Wb.length;)eb=Wb.pop(),Yb[eb+"o"]=d(Yb[eb],eb);for(;Xb.length;)eb=Xb.pop(),Yb[eb+eb]=c(Yb[eb],2);for(Yb.DDDD=c(Yb.DDD,3),h(e.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(a){return this._months[a.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c,d;for(this._monthsParse||(this._monthsParse=[]),b=0;12>b;b++)if(this._monthsParse[b]||(c=db.utc([2e3,b]),d="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),this._monthsParse[b]=new RegExp(d.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c,d;for(this._weekdaysParse||(this._weekdaysParse=[]),b=0;7>b;b++)if(this._weekdaysParse[b]||(c=db([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"==typeof c?c.apply(b):c},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},postformat:function(a){return a},week:function(a){return Y(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),db=function(c,d,e,f){var g;return"boolean"==typeof e&&(f=e,e=a),g={},g._isAMomentObject=!0,g._i=c,g._f=d,g._l=e,g._strict=f,g._isUTC=!1,g._pf=b(),$(g)},db.utc=function(c,d,e,f){var g;return"boolean"==typeof e&&(f=e,e=a),g={},g._isAMomentObject=!0,g._useUTC=!0,g._isUTC=!0,g._l=e,g._i=c,g._f=d,g._strict=f,g._pf=b(),$(g).utc()},db.unix=function(a){return db(1e3*a)},db.duration=function(a,b){var c,d,e,f=a,h=null;return db.isDuration(a)?f={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(f={},b?f[b]=a:f.milliseconds=a):(h=tb.exec(a))?(c="-"===h[1]?-1:1,f={y:0,d:s(h[kb])*c,h:s(h[lb])*c,m:s(h[mb])*c,s:s(h[nb])*c,ms:s(h[ob])*c}):(h=ub.exec(a))&&(c="-"===h[1]?-1:1,e=function(a){var b=a&&parseFloat(a.replace(",","."));return(isNaN(b)?0:b)*c},f={y:e(h[2]),M:e(h[3]),d:e(h[4]),h:e(h[5]),m:e(h[6]),s:e(h[7]),w:e(h[8])}),d=new g(f),db.isDuration(a)&&a.hasOwnProperty("_lang")&&(d._lang=a._lang),d},db.version=fb,db.defaultFormat=Nb,db.updateOffset=function(){},db.lang=function(a,b){var c;return a?(b?A(y(a),b):null===b?(B(a),a="en"):pb[a]||C(a),c=db.duration.fn._lang=db.fn._lang=C(a),c._abbr):db.fn._lang._abbr},db.langData=function(a){return a&&a._lang&&a._lang._abbr&&(a=a._lang._abbr),C(a)},db.isMoment=function(a){return a instanceof f||null!=a&&a.hasOwnProperty("_isAMomentObject")},db.isDuration=function(a){return a instanceof g},eb=Zb.length-1;eb>=0;--eb)r(Zb[eb]);for(db.normalizeUnits=function(a){return p(a)},db.invalid=function(a){var b=db.utc(0/0);return null!=a?h(b._pf,a):b._pf.userInvalidated=!0,b},db.parseZone=function(a){return db(a).parseZone()},h(db.fn=f.prototype,{clone:function(){return db(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var a=db(this).utc();return 0<a.year()&&a.year()<=9999?F(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):F(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var a=this;return[a.year(),a.month(),a.date(),a.hours(),a.minutes(),a.seconds(),a.milliseconds()]},isValid:function(){return x(this)},isDSTShifted:function(){return this._a?this.isValid()&&o(this._a,(this._isUTC?db.utc(this._a):db(this._a)).toArray())>0:!1},parsingFlags:function(){return h({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(a){var b=F(this,a||db.defaultFormat);return this.lang().postformat(b)},add:function(a,b){var c;return c="string"==typeof a?db.duration(+b,a):db.duration(a,b),l(this,c,1),this},subtract:function(a,b){var c;return c="string"==typeof a?db.duration(+b,a):db.duration(a,b),l(this,c,-1),this},diff:function(a,b,c){var d,e,f=z(a,this),g=6e4*(this.zone()-f.zone());return b=p(b),"year"===b||"month"===b?(d=432e5*(this.daysInMonth()+f.daysInMonth()),e=12*(this.year()-f.year())+(this.month()-f.month()),e+=(this-db(this).startOf("month")-(f-db(f).startOf("month")))/d,e-=6e4*(this.zone()-db(this).startOf("month").zone()-(f.zone()-db(f).startOf("month").zone()))/d,"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:j(e)},from:function(a,b){return db.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)},fromNow:function(a){return this.from(db(),a)},calendar:function(){var a=z(db(),this).startOf("day"),b=this.diff(a,"days",!0),c=-6>b?"sameElse":-1>b?"lastWeek":0>b?"lastDay":1>b?"sameDay":2>b?"nextDay":7>b?"nextWeek":"sameElse";return this.format(this.lang().calendar(c,this))},isLeapYear:function(){return v(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=V(a,this.lang()),this.add({d:a-b})):b},month:function(a){var b,c=this._isUTC?"UTC":"";return null!=a?"string"==typeof a&&(a=this.lang().monthsParse(a),"number"!=typeof a)?this:(b=this.date(),this.date(1),this._d["set"+c+"Month"](a),this.date(Math.min(b,this.daysInMonth())),db.updateOffset(this),this):this._d["get"+c+"Month"]()},startOf:function(a){switch(a=p(a)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1),this},endOf:function(a){return a=p(a),this.startOf(a).add("isoWeek"===a?"week":a,1).subtract("ms",1)},isAfter:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)>+db(a).startOf(b)},isBefore:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)<+db(a).startOf(b)},isSame:function(a,b){return b=b||"ms",+this.clone().startOf(b)===+z(a,this).startOf(b)},min:function(a){return a=db.apply(null,arguments),this>a?this:a},max:function(a){return a=db.apply(null,arguments),a>this?this:a},zone:function(a){var b=this._offset||0;return null==a?this._isUTC?b:this._d.getTimezoneOffset():("string"==typeof a&&(a=I(a)),Math.abs(a)<16&&(a=60*a),this._offset=a,this._isUTC=!0,b!==a&&l(this,db.duration(b-a,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(a){return a=a?db(a).zone():0,(this.zone()-a)%60===0},daysInMonth:function(){return t(this.year(),this.month())},dayOfYear:function(a){var b=hb((db(this).startOf("day")-db(this).startOf("year"))/864e5)+1;return null==a?b:this.add("d",a-b)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(a){var b=Y(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==a?b:this.add("y",a-b)},isoWeekYear:function(a){var b=Y(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=Y(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this.day()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},get:function(a){return a=p(a),this[a]()},set:function(a,b){return a=p(a),"function"==typeof this[a]&&this[a](b),this},lang:function(b){return b===a?this._lang:(this._lang=C(b),this)}}),eb=0;eb<Rb.length;eb++)_(Rb[eb].toLowerCase().replace(/s$/,""),Rb[eb]);_("year","FullYear"),db.fn.days=db.fn.day,db.fn.months=db.fn.month,db.fn.weeks=db.fn.week,db.fn.isoWeeks=db.fn.isoWeek,db.fn.toJSON=db.fn.toISOString,h(db.duration.fn=g.prototype,{_bubble:function(){var a,b,c,d,e=this._milliseconds,f=this._days,g=this._months,h=this._data;h.milliseconds=e%1e3,a=j(e/1e3),h.seconds=a%60,b=j(a/60),h.minutes=b%60,c=j(b/60),h.hours=c%24,f+=j(c/24),h.days=f%30,g+=j(f/30),h.months=g%12,d=j(g/12),h.years=d},weeks:function(){return j(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*s(this._months/12)},humanize:function(a){var b=+this,c=X(b,!a,this.lang());return a&&(c=this.lang().pastFuture(b,c)),this.lang().postformat(c)},add:function(a,b){var c=db.duration(a,b);return this._milliseconds+=c._milliseconds,this._days+=c._days,this._months+=c._months,this._bubble(),this},subtract:function(a,b){var c=db.duration(a,b);return this._milliseconds-=c._milliseconds,this._days-=c._days,this._months-=c._months,this._bubble(),this},get:function(a){return a=p(a),this[a.toLowerCase()+"s"]()},as:function(a){return a=p(a),this["as"+a.charAt(0).toUpperCase()+a.slice(1)+"s"]()},lang:db.fn.lang,toIsoString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),f=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":""):"P0D"}});for(eb in Sb)Sb.hasOwnProperty(eb)&&(bb(eb,Sb[eb]),ab(eb.toLowerCase()));bb("Weeks",6048e5),db.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},db.lang("en",{ordinal:function(a){var b=a%10,c=1===s(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),rb?(module.exports=db,cb(!0)):"function"==typeof define&&define.amd?define("moment",function(b,c,d){return d.config&&d.config()&&d.config().noGlobal!==!0&&cb(d.config().noGlobal===a),db}):cb()}).call(this);

CBCR3.namespace("CBCR3.BlogPostList");CBCR3.BlogPostList.List=Class.create({listContainer:null,categoryId:null,page:null,numPerPage:null,listService:null,postCount:null,paging:null,showLoadMore:null,loadMoreId:"loadMoreArticles",activityFormat:false,isLoadingAdditionalEntries:false,loadingIndicator:null,activityPostProcessor:null,disableInfiniteScroll:false,initialize:function(options){var browserExIE=/MSIE 8.0/gim;var browserEx_iOS=/\b(iPad|iPhone)\b/gim;this.listContainer=$(options.listContainer);this.categoryId=options.categoryId;this.page=(options.page==null)?1:options.page;this.numPerPage=(options.numPerPage==null)?10:options.numPerPage;this.showLoadMore=options.showLoadMore||false;this.activityFormat=options.activityFormat||false;var usrAgentString=navigator.userAgent;if(browserExIE.test(usrAgentString)||browserEx_iOS.test(usrAgentString)){this.disableInfiniteScroll=true;}
this.showFirstTimeStamp=options.showFirstTimeStamp||false;this.listService=new CBCR3.BlogPostList.Services.PostService({categoryId:this.categoryId,webServiceCall:options.webServiceMethod?options.webServiceMethod:CBC.Radio3.Blogs.UI.Web.WebServices.BlogWebService.GetPostsForCategory});this.loadingIndicator=$(options.loadingIndicatorId);this.listService.addEventListener(CBCR3.BlogPostList.Events.ServiceEvent.postsReceived,this.onPostsReceived.bind(this));this.listService.addEventListener(CBCR3.BlogPostList.Events.ServiceEvent.postsError,this.onPostsError.bind(this));this.firstPostParsed=false;if(this.showLoadMore){var loadMore=$(this.loadMoreId);var self=this;this.activityPostProcessor=new ActivityPostProcessor([],4);if(loadMore){if(this.activityFormat){if(!this.disableInfiniteScroll)
Event.observe(window,'scroll',function(event){self.checkScroll(self);});loadMore.observe("click",function(event){Event.stop(event);self.numPerPage=4;self.loadingIndicator.show();self.page+=1;self.getPostList();});if(!this.disableInfiniteScroll)
loadMore.hide();}
else{loadMore.show();loadMore.observe("click",function(event){Event.stop(event);self.page+=1;self.getPostList();});}}}else{this.paging=new CBCR3.Commons.Paging({service:this.listService,page:this.page,numPerPage:this.numPerPage});}},getPostList:function(){this.isLoadingAdditionalEntries=true;this.listService.getList(this.page,this.numPerPage);},preParsePostsForActivityFeed:function(postList){var today=moment(),curPost=null,curPostDate,curPostTime,postDate,postDateTime,_activityLastDisplayedTimeMoment=null;for(var i=0;i<postList.length;i++){curPost=postList[i];curPostDate=curPost.postDate;curPostTime=curPost.postTime;postDate=new Date(curPostDate+' '+curPostTime);postDateTime=moment(postDate);if(today.isSame(postDateTime,'days')){if(_activityLastDisplayedTimeMoment){curPost.ShowActivityTimeDate=(Math.abs(postDateTime.diff(_activityLastDisplayedTimeMoment,'hours'))!=0)&&Math.abs(today.diff(postDateTime,'hours'))<=5;}else{curPost.ShowActivityTimeDate=true;}}else if(_activityLastDisplayedTimeMoment&&_activityLastDisplayedTimeMoment.isSame(postDateTime,'days')){curPost.ShowActivityTimeDate=false;}else{curPost.ShowActivityTimeDate=true;}
_activityLastDisplayedTimeMoment=postDateTime;}
return postList;},onPostsReceived:function(event){if(!this.showLoadMore)
this.listContainer.update();var postList=event.data.postList;this.postCount=event.data.postCount;this.page=event.data.currentPage;if(this.activityFormat){postList=this.activityPostProcessor.addToListAndApplyStamps(postList);}
for(var i=0;i<postList.length;i++){var post=postList[i];if(this.showFirstTimeStamp&&i===0&&this.firstPostParsed===false){post.firstTimeStamp=true;this.firstPostParsed=true;}
var postItem=new CBCR3.BlogPostList.BlogPost(post,false,this.activityFormat);this.listContainer.insert(postItem.render());}
if(!this.showLoadMore){var pagingElement=this.paging.getPageList(this.page,this.postCount);this.listContainer.insert(pagingElement);}else{}
this.isLoadingAdditionalEntries=false;if(this.loadingIndicator)
this.loadingIndicator.hide();},nearBottom:function(that){var children=that.listContainer.childElements();var childCount=children.length;var lastItem=children[childCount-1];var viewPortSize=window.innerHeight;if(!lastItem)
return false;var itemYOffset=lastItem.viewportOffset()[1];var loadMore=itemYOffset<(viewPortSize*0.75);return loadMore;},checkScroll:function(that){var inView=false,ldMore=false;try{inView=that.listContainer.viewportOffset()[1]<(window.innerHeight*0.5);ldMore=that.nearBottom(that);if(!that.isLoadingAdditionalEntries&&inView&&ldMore){if(that.listContainer.childElements().length>=12){Event.stopObserving(window,'scroll');$(that.loadMoreId).show();return;}
that.page+=1;that.getPostList();that.loadingIndicator.show();}}catch(e){Trace.log('Error in checkScroll: '+e);}},onPostsError:function(){Trace.write("onPostsError()");}});

CBCR3.namespace("CBCR3.BlogPostList");CBCR3.BlogPostList.BlogPost=Class.create({postElement:null,imageUrl:null,title:null,postLink:null,author:null,authorLink:null,postTime:null,postDate:null,content:null,commentCount:null,isNewGenre:null,activityFormat:false,ShowActivityTimeDate:false,firstTimeStamp:false,isBigFeature:false,initialize:function(post,isNewGenre,activityFormat){this.imageUrl=post.imageUrl;this.imageUrlSmall=post.imageUrlSmall;this.title=post.title;this.postLink=post.postLink;this.author=post.author;this.authorLink=post.authorLink;this.postTime=post.postTime;this.postDate=post.postDate;this.content=post.content;this.commentCount=post.commentCount;this.isNewGenre=isNewGenre||false;this.activityFormat=(activityFormat!==undefined&&activityFormat)||false;this.ShowActivityTimeDate=post.ShowActivityTimeDate;this.firstTimeStamp=post.firstTimeStamp?post.firstTimeStamp:false;this.isBigFeature=post.isBigFeature?post.isBigFeature:false;this.activityStamp=post.activityStamp?post.activityStamp:'';if(post.showActivityStamp!=undefined){this.showActivityStamp=post.showActivityStamp;}},render:function(){this.postElement=new Element("div",{'class':'postItem'});var templateResult="";var templateOpts={imageUrl:this.imageUrl,imageUrlSmall:this.imageUrlSmall,title:this.title,postLink:this.postLink,postTitle:this.postTitle,author:this.author,authorLink:this.authorLink,postTime:this.postTime,postDate:this.postDate,content:this.content,commentCount:this.commentCount,ShowActivityTimeDate:this.ShowActivityTimeDate,firstTimeStamp:this.firstTimeStamp,isBigFeature:this.isBigFeature,activityStamp:this.activityStamp};if(this.showActivityStamp!=undefined){templateOpts.showActivityStamp=this.showActivityStamp;}
if(this.isNewGenre){templateResult=this.genreTemplate(templateOpts);}else if(this.activityFormat){templateResult=this.activityTemplate(templateOpts);}else{templateResult=this.template(templateOpts);}
this.postElement.update(templateResult);return this.postElement;},template:function(vars){var markup="<div class='postImage grid_3 alpha'><a href='#{postLink}' title='#{title}'><img src='#{imageUrl}' border='0' /></a></div>";markup+="<div class='postDetails'>";markup+="<div class='postTitle'><h3><a href='#{postLink}' title='#{title}'>#{title}</a></h3></div>";markup+="<div class='blogAuthor smaller'>posted by <a href='#{authorLink}' title='#{author}'>#{author}</a> at #{postTime} on #{postDate}</div>";markup+="<div class='postContent'>#{content}</div></div>";markup+="<a href='#{postLink}#commentsAnchor'><div class='comment-count-button'><span>#{commentCount}</span></div></a>";return new Template(markup).evaluate(vars);},genreTemplate:function(vars){var markup="<div class='postImage grid_2 alpha'><a href='#{postLink}' title='#{title}'><img src='#{imageUrlSmall}' border='0' width='140' height='80'/></a></div>";markup+="<div class='postDetails'>";markup+="<div class='postTitle'><h3><a href='#{postLink}' title='#{title}'>#{title}</a></h3></div>";markup+="<div class='postContent'>#{content}</div>";markup+="<div class='blogAuthor smaller'>posted by <a href='#{authorLink}' title='#{author}'>#{author}</a> at #{postTime} on #{postDate}</div>";markup+="</div>";return new Template(markup).evaluate(vars);},activityTime:function(params){var settings={time:params.time,date:params.date,format:"LT, MMMM D, YYYY",adjustForTimezone:true,verboseFormat:false};if(settings.date===null){console.warn("{{activityTime}} didn't contain a time attribute.");return"";}
var _timeParsed=moment(settings.date).format("LT, MMMM D, YYYY");if(!settings.adjustForTimezone){_timeParsed=moment.utc(settings.date).format("MMMM D, YYYY");}
var theDate=new Date(settings.date+' '+settings.time),theTime=(settings.time?moment(theDate):_timeParsed);moment.lang('en',{calendar:{sameDay:function(){var displayValue;if(settings.time){var overFiveHoursAgo=moment().subtract('hour',5),oneHourAgo=moment().subtract('hour',1);displayValue=(this<overFiveHoursAgo?'Earlier today':this.fromNow());if(this==oneHourAgo){displayValue='1 hour ago';}
displayValue='['+displayValue+']';}else{displayValue='[Today], dddd MMMM D, YYYY';}
return displayValue;},lastDay:'[Yesterday]',lastWeek:'MMMM D, YYYY',nextDay:'[Tomorrow], dddd MMMM D, YYYY',nextWeek:'dddd MMMM D, YYYY',nextMonth:'dddd MMMM D, YYYY',sameElse:'MMMM D, YYYY'},});return moment(theTime).calendar();},activityTemplate:function(vars){var showTime=vars.firstTimeStamp?"firstTimeStamp":(vars.activityStamp!=undefined&&vars.activityStamp!==''?"showTime":"hideTime");if(vars.showActivityStamp!=undefined){showTime=vars.showActivityStamp==true?'showTime':'hideTime';}
var shortenedContent='';if(vars.isBigFeature){vars.titleShort=vars.title.truncate(140);shortenedContent=vars.content?vars.content.truncate(182):'';}else{if(vars.content)
shortenedContent=vars.content.truncate(102);vars.titleShort=vars.title.truncate(110);}
vars.activityTimeText=vars.firstTimeStamp?'Activity':vars.activityStamp;vars.imageUrl=vars.isBigFeature?vars.imageUrl.replace('220x120','620x350'):vars.imageUrl;var markup="<div class='activityTime "+showTime+"'><span class='timeDivider "+(vars.firstTimeStamp?"":"prevDivider")+" nextDivider'>&#8226;</span> #{activityTimeText} </div>";markup+="<div class='activityPost"+(vars.isBigFeature?' bigFeature ':' ')+"clearfix'><div class='postImage grid_3 alpha'><a href='#{postLink}' title='#{title}'><img src='#{imageUrl}' border='0' /></a></div>";markup+="<div class='postDetails'>";markup+="<div class='postTitle'><h3><a href='#{postLink}' title='#{title}'>#{titleShort}</a></h3></div>";markup+="<div class='postContent'>"+shortenedContent+"</div>";markup+="</div></div>";return new Template(markup).evaluate(vars);},});

CBCR3.namespace("CBCR3.BlogPostList.Services");CBCR3.BlogPostList.Services.PostService=Class.create(CBCR3.Commons.EventDispatcher,{categoryId:null,webServiceCall:null,initialize:function($super,options){$super();this.categoryId=options.categoryId;this.webServiceCall=options.webServiceCall;},getList:function(page,numPerPage){Trace.write("in getPostList() -> categoryId: "+this.categoryId+", page: "+page+", numPerPage: "+numPerPage);this.webServiceCall(this.categoryId,page,numPerPage,this.getPostList_Success.bind(this),this.getPostList_Failed.bind(this));},getPostList_Success:function(response){this.dispatchEvent(CBCR3.BlogPostList.Events.ServiceEvent.postsReceived,{postList:this.mapPosts(response),postCount:response.PostCount,currentPage:response.CurrentPage});},mapPosts:function(dtos){var posts=[];for(var i=0;i<dtos.List.length;i++){var dto=dtos.List[i];posts.push({imageUrl:dto.ImageUrl,imageUrlSmall:dto.ImageUrlSmall,title:dto.Title,postLink:dto.Permalink,postTitle:dto.PostTitle,author:dto.Author,authorLink:dto.UserPermalink,postTime:dto.PostTime,postDate:dto.PostDate,content:dto.Content,commentCount:dto.CommentCount});}
return posts;},getPostList_Failed:function(response){Trace.write("in getPostList_Failed()");this.dispatchEvent(CBCR3.BlogPostList.Events.ServiceEvent.postsError,{posts:"We couldn't load the posts for this category.  Please refresh the page and try again."});}});

CBCR3.namespace("CBCR3.BlogPostList.Events");CBCR3.BlogPostList.Events.ServiceEvent={postsReceived:"postsReceived",postsError:"postsError"};

CBCR3.namespace("CBCR3.Services");CBCR3.Services.AudioStreamService=Class.create(CBCR3.Commons.EventDispatcher,{initialize:function($super){$super();}});var _audioStreamManager=null;CBCR3.namespace("CBCR3.Models");CBCR3.Models.AudioStreamManagerProvider={getInstance:function(){if(_audioStreamManager==null)
_audioStreamManager=new CBCR3.Models.AudioStreamManager();return _audioStreamManager;}};CBCR3.Models.AudioStreamManager=Class.create(CBCR3.Commons.EventDispatcher,{streams:null,categories:null,debug:false,isReady:false,processed:false,initialize:function($super){$super();this.streams=new Array();this.categories=new Object();},processJSONStreams:function(streamsJSON){Trace.write("processJSONStreams",true);Trace.write(streamsJSON,true);for(var i=0;i<streamsJSON.length;i++){var stream=this.mapStation(streamsJSON[i]);if(!stream.disabled){if(!this.categories[stream.category]){this.categories[stream.category]=new CBCR3.Models.StreamCategory({name:stream.category});}
this.categories[stream.category].addStation(stream);if(stream.secondCategory!=null){if(!this.categories[stream.secondCategory])
this.categories[stream.secondCategory]=new CBCR3.Models.StreamCategory({name:stream.secondCategory});this.categories[stream.secondCategory].addStation(stream);}
this.streams.push(stream);}}
this.processed=true;this.sendCategories();},sendCategories:function(){if(this.isReady&&this.processed)
this.dispatchEvent("streamPanel:streamInfoloaded",{categories:this.categories});},setReady:function(isReady){this.isReady=isReady;this.sendCategories();},unload:function(){this.setReady(false);this.removeEventListenerType("streamPanel:streamInfoloaded");},mapStation:function(stream){var strCategoryName=(stream.Category=="Radio2")?"CBC Radio 2":stream.Category;var secCat=null;if(stream.Name.indexOf("Heppner")>-1)
secCat="hepp";if(stream.SecondCategory!=null)
secCat=stream.SecondCategory;if(stream.PreRollAdTarget!=null&&stream.PreRollAdTarget!="")
Trace.write("PREROLLTARGET:"+stream.PreRollAdTarget,true);return new CBCR3.Models.StreamStation({name:stream.Name,id:stream.NodeKeyCurrentAndPreviousSong,fullroomid:stream.NodeKeyCurrentAndPreviousSong,roomid:stream.NodeKeyCurrentSong,disabled:stream.Disabled,mount:stream.MountName,permalink:stream.Permalink,isspecial:stream.IsSpecialStream,specialurl:stream.AdUrl,specialimage:stream.AdUrlSmall,category:strCategoryName,secondCategory:stream.SecondCategory,showcomposer:stream.ShowComposer,network:null,playpreroll:stream.PlayPrerollAd,prerollTarget:stream.PreRollAdTarget,geofenced:stream.GeoFenced});},getStreamsByCategory:function(category){Trace.write("*** category:"+category,true);var categoryStreams=new Array();if(category==null)
return"";category=category.toLowerCase();Trace.write(this.streams,true);for(var i=0;i<this.streams.length;i++){if(this.streams[i].category!=null){var streamCategory=this.streams[i].category.toLowerCase();if(streamCategory==category)
categoryStreams.push(this.streams[i]);}
if(this.streams[i].secondCategory!=null){var secondCategory=this.streams[i].secondCategory.toLowerCase();if(secondCategory==category)
categoryStreams.push(this.streams[i]);}}
return categoryStreams;},getStreamByPermalink:function(permalink){Trace.write("*** permalink:"+permalink+" streams->",true);if(permalink==null)
return"";var index=permalink.indexOf("/stream/");var tmpPermalink=permalink.substring(index);Trace.write(this.streams,true);for(var i=0;i<this.streams.length;i++){if(this.streams[i].permalink!=null&&this.streams[i].permalink==tmpPermalink)
return this.streams[i];}
return null;},getStreamByRoomId:function(roomid){this.streams.each(function(stream){if(stream.roomid!=null&&stream.roomid==roomid)
return stream;});return null;}});

CBCR3.namespace("CBCR3.Services");CBCR3.Services.MusicService=Class.create(CBCR3.Commons.EventDispatcher,{END_OF_PLAYLIST:"End of Playlist",ONLY_IN_CANADA:"This track is only available to those within Canada.",initialize:function($super){$super();},getPlaylist:function(playlistPermalink){CBC.Radio3.Player.Web.PlayerWebService.GetPlaylist(playlistPermalink,this.getPlaylist_Success.bind(this),this.webService_Failed.bind(this));},getTrack:function(permalink,sequence){CBC.Radio3.Player.Web.PlayerWebService.GetPlaylistTrack(permalink,sequence,this.getTrack_Success.bind(this),this.webService_Failed.bind(this));},getPollTrack:function(permalink,sequence){CBC.Radio3.Player.Web.PlayerWebService.GetPollPlaylistTrack(permalink,sequence,this.getTrack_Success.bind(this),this.webService_Failed.bind(this));},getPrevPollTrack:function(permalink,sequence,isShuffle){CBC.Radio3.Player.Web.PlayerWebService.GetPreviousPollPlaylistTrack(permalink,sequence,isShuffle,this.getTrack_Success.bind(this),this.webService_Failed.bind(this));},getNextPollTrack:function(permalink,sequence,isShuffle){CBC.Radio3.Player.Web.PlayerWebService.GetNextPollPlaylistTrack(permalink,sequence,isShuffle,this.getTrack_Success.bind(this),this.webService_Failed.bind(this));},getPollTrackByPermalink:function(permalink,promoUrl){CBC.Radio3.Player.Web.PlayerWebService.GetPollPlaylistTrackByPermalink(permalink,promoUrl,this.getTrack_Success.bind(this),this.webService_Failed.bind(this));},getNextTrack:function(permalink,sequence,isShuffle){CBC.Radio3.Player.Web.PlayerWebService.GetNextPlaylistTrack(permalink,sequence,isShuffle,this.getTrack_Success.bind(this),this.webService_Failed.bind(this));},getPrevTrack:function(permalink,sequence,isShuffle){CBC.Radio3.Player.Web.PlayerWebService.GetPreviousPlaylistTrack(permalink,sequence,isShuffle,this.getTrack_Success.bind(this),this.webService_Failed.bind(this));},getTrack_Success:function(response){Trace.write("getTrack_Success",true);Trace.write(response,true);if(response!=null){var track=(response.Payload!=null)?new CBCR3.Player.Mappers.PlaylistTrackDtoMapper().mapFrom(response.Payload):null;if(response.Successful){this.dispatchEvent(CBCR3.Player.Events.ServiceEvent.trackReceived,{track:track});}else
{if(response.ErrorMessage==this.END_OF_PLAYLIST){this.dispatchEvent(CBCR3.Player.Events.ServiceExceptionEvent.endOfPlaylist,{message:response.ErrorMessage});}else if(response.ErrorMessage==this.ONLY_IN_CANADA){this.dispatchEvent(CBCR3.Player.Events.ServiceExceptionEvent.userOutsideCanada,{message:response.ErrorMessage,track:track});}}}},getPlaylist_Success:function(response){var playlist=this.parsePlaylist(response);this.dispatchEvent(CBCR3.Player.Events.ServiceEvent.playlistReceived,{playlist:playlist});},parsePlaylist:function(playlistDto){return new CBCR3.Mappers.PlaylistDtoMapper().mapFrom(playlistDto);},webService_Failed:function(errorResponse){var exception=new CBCR3.Player.Exceptions.SoapExceptionFactory().createException(errorResponse);var type=new CBCR3.Player.Exceptions.SoapExceptionLookup().map(exception.type);this.dispatchEvent(type,{exception:exception});}});

CBCR3.namespace("CBCR3.Services");CBCR3.Services.LoggingService=Class.create(CBCR3.Commons.EventDispatcher,{initialize:function($super)
{$super();},logTrackPlay:function(trackPermalink)
{CBC.Radio3.Player.Web.PlayerWebService.LogTrackPlay(trackPermalink,this.logTrackPlay_Success.bind(this),this.webService_Failed.bind(this));},logTrackPlay_Success:function(response,context)
{},webService_Failed:function(errorResponse)
{var exception=new CBCR3.Player.Exceptions.SoapExceptionFactory().createException(errorResponse);var type=new CBCR3.Player.Exceptions.SoapExceptionLookup().map(exception.type);this.dispatchEvent(type,{exception:exception});}});

CBCR3.namespace("CBCR3.Services");var _permalinkServices=null;CBCR3.Services.PermalinkServiceProvider=Class.create({getInstance:function(){if(_permalinkServices==null)
_permalinkServices=CBCR3.Services.PermalinkService();return _permalinkServices;}});CBCR3.Services.PermalinkService=Class.create(CBCR3.Commons.EventDispatcher,{initialize:function($super){$super();},addTrackToPlaylist:function(trackPermalink,playlistPermalink,allowDuplicates){CBC.Radio3.Player.Web.PlayerWebService.AddTrackToPlaylist(trackPermalink,playlistPermalink,allowDuplicates,this.addTrackToPlaylist_Success.bind(this),this.webService_Failed.bind(this),{trackPermalink:trackPermalink,playlistPermalink:playlistPermalink});},addTrackToPlaylist_Success:function(response,userContext){if(response==-1)
{this.dispatchEvent(CBCR3.Player.Events.ServiceExceptionEvent.duplicateTrack,{elementId:userContext.elementId,playlistPermalink:userContext.playlistPermalink});}
else{this.dispatchEvent(CBCR3.Player.Events.PermalinkEvent.trackAdded,{trackPermalink:userContext.trackPermalink,playlistPermalink:userContext.playlistPermalink,sequence:response});}},addTrackToPlaylist_failed:function(response,userContext){var exParser=new CBCR3.Player.Exceptions.SoapExceptionParser();var exception=exParser.parseException(response);this.dispatchEvent(CBCR3.Player.Events.PermalinkEvent.trackExists,{elementId:userContext.elementId,playlistPermalink:userContext.playlistPermalink});},addLike:function(permalink){try{CBC.Radio3.Web.WebServices.LikeWebService.Like(permalink,this.addLike_Success.bind(this),this.webService_Failed.bind(this));}catch(e){Trace.error(e);}},addPlaylistToFavourites_Success:function(response,userContext){this.dispatchEvent(CBCR3.Player.Events.PermalinkEvent.favouriteAdded);},addLike_Success:function(response,userContext){this.dispatchEvent(CBCR3.Player.Events.PermalinkEvent.favouriteAdded);},getFavouriteStatus:function(playlistPermalink){CBC.Radio3.Player.Web.PlayerWebService.GetFavouriteStatus(playlistPermalink,this.getFavouriteStatus_Success.bind(this),this.webService_Failed.bind(this));},getFavouriteStatus_Success:function(response,userContext){this.dispatchEvent(CBCR3.Player.Events.PermalinkEvent.favouriteStatus,{favouriteStatus:response});},removePlaylistFromFavourites:function(playlistPermalink,elementId){CBC.Radio3.Player.Web.PlayerWebService.RemovePlaylistFromFavourites(playlistPermalink,this.removePlaylistFromFavourites_Success.bind(this),this.webService_Failed.bind(this),{elementId:elementId,playlistPermalink:playlistPermalink});},removePlaylistFromFavourites_Success:function(response,context){var elementId=context.elementId;var playlistPermalink=context.playlistPermalink;this.dispatchEvent(CBCR3.Player.Events.PermalinkEvent.favouriteRemoved,{id:elementId,playlistPermalink:playlistPermalink});},getPermalinkContext:function(playlistPermalink){CBC.Radio3.Player.Web.PlayerWebService.GetPermalinkContext(playlistPermalink,this.getPermalinkContext_Success.bind(this),this.webService_Failed.bind(this));},getPermalinkContext_Success:function(response,context){var playlistContext=new CBCR3.Player.Models.PlaylistPermalinkContext({title:response.Title,infoLink:response.InfoLink,details:response.Details,detailLink:response.DetailLink});this.dispatchEvent(CBCR3.Player.Events.PermalinkEvent.permalinkContextReceived,{permalinkContext:playlistContext});},webService_Failed:function(errorResponse){Trace.write("ERROR in permalinkservice -> webService_Failed()",true);Trace.error(errorResponse);var exception=new CBCR3.Player.Exceptions.SoapExceptionFactory().createException(errorResponse);var type=new CBCR3.Player.Exceptions.SoapExceptionLookup().map(exception.type);this.dispatchEvent(type,{exception:exception});}});

CBCR3.namespace("CBCR3.Services");CBCR3.Services.AutoplayService=Class.create(CBCR3.Commons.EventDispatcher,{initialize:function($super){$super();},getStreamPermalinkFromPlaylistPermalink:function(playlistPermalink){CBC.Radio3.Web.WebServices.AutoplayStreamWebService.StreamPermalinkFromPlaylistPermalink(playlistPermalink,this._streamPermalinkFromPlaylistPermalink_success.bind(this),this.webService_Failed.bind(this),{playlistPermalink:playlistPermalink});},_streamPermalinkFromPlaylistPermalink_success:function(response,context){this.dispatchEvent(CBCR3.Player.Events.AutoplayStream.permalinkReceived,{streamPermalink:response});},webService_Failed:function(errorResponse){Trace.write("ERROR in autoplayservice -> webService_Failed()",true);Trace.error(errorResponse);var exception=new CBCR3.Player.Exceptions.SoapExceptionFactory().createException(errorResponse);var type=new CBCR3.Player.Exceptions.SoapExceptionLookup().map(exception.type);this.dispatchEvent(type,{exception:exception});}});

CBCR3.namespace("CBCR3.Services");var serviceConfig={musicService:CBCR3.Services.MusicService,loggingService:CBCR3.Services.LoggingService,permalinkService:CBCR3.Services.PermalinkService,autoplayService:CBCR3.Services.AutoplayService,playlistService:CBCR3.Services.PlaylistService,thumbService:CBCR3.Services.ThumbService};var staticContainer={};CBCR3.Services.ServicesProvider={getInstanceOf:function(serviceType){if(serviceConfig[serviceType]==null)
alert("Unknown service type in ServiceProvider: "+serviceType);if(staticContainer[serviceType]==null)
staticContainer[serviceType]=new serviceConfig[serviceType]();return staticContainer[serviceType];}};

CBCR3.namespace("CBCR3.Services");var _nodeSocketService=null;CBCR3.Services.NodeSocketServiceProvider={getInstance:function(socketio){if(_nodeSocketService==null)
_nodeSocketService=new CBCR3.Services.NodeSocketService(socketio);return _nodeSocketService;}};CBCR3.Services.NodeSocketService=Class.create(CBCR3.Commons.EventDispatcher,{metarooms:null,roomsArr:null,data:null,debug:true,socketio:null,funcOnPush:null,funcOnFullPush:null,playerRoom:null,webstationrooms:null,pushSet:false,page:null,timestamp:null,connected:false,siteLoaded:false,exceptionHdr:"nodesocketservice exception:",streamsToIgnore:parent.tangoMetadataStreamsToIgnore,initialize:function($super,socketio){$super();this.metarooms=new Array();this.webstationrooms=new Array();this.roomsArr=new Array();this.timestamp=new Date();this.page=document.location;this.socketio=socketio;this.init();},init:function(){try{if(typeof Trace=='undefined'){Trace.write(this.exceptionHdr+" init(): Trace is undefined",true);}else{Trace.write("nodesocketservice.js -> init() timestamp:"+this.timestamp+" page:"+this.page,this.debug);Trace.write(this,this.debug);}
if(this.socketio){this.socketio.on('connect',this.onConnect.bind(this));this.socketio.on('disconnect',this.onDisconnect.bind(this));}}catch(e){Trace.write(this.exceptionHdr+" init():"+e.message,true);Trace.error(e);}},setPush:function(){if(this.pushSet)
return;if(this.socketio){this.socketio.on('push',this.onPush.bind(this));this.pushSet=true;}else{Trace.write(this.exceptionHdr+" setPush(): Error this.socketio is null",true);}},setSiteLoaded:function(setting){this.siteLoaded=setting;},resetPush:function(){this.pushSet=false;},clearWebStations:function(){this.webstationrooms.each(function(webstation){if(!this.metarooms[webstation]){this.socketio.emit('leave',webstation);this.removeRoomId(webstation);}});this.webstationrooms=new Array();},disconnect:function(){try{if(typeof Trace=='undefined'){Trace.write(this.exceptionHdr+" disconnect(): Trace is undefined",true);}else{Trace.write('nodesocketservice.js -> timestamp: '+this.timestamp+' disconnect()'+this.timestamp,this.debug);}
if(this.socketio)
this.socketio.emit('disconnect');}catch(e){Trace.write(this.exceptionHdr+" disconnect():"+e.message,true);Trace.error(e);}},joinPlayerRoom:function(roomid){try{this.setPush();Trace.write("nodesocketservice.js -> timestamp: "+this.timestamp+" metarooms[roomid]:"+this.metarooms[roomid]+" joinPlayerRoom() page:"+this.page+" roomid:"+roomid+" playerRoomid:"+this.playerRoom,this.debug);if(this.streamsToIgnore.indexOf(roomid)!=-1)
return;if(this.playerRoom)
this.leavePlayerRoom(this.playerRoom);if(!this.metarooms[roomid])
this.metarooms[roomid]=roomid;this.playerRoom=roomid;if(this.connected)
this.socketio.emit('join',roomid);}catch(e){Trace.write(this.exceptionHdr+" joinPlayerRoom():"+e.message,true);Trace.error(e);}},leavePlayerRoom:function(roomid){try{Trace.write("nodesocketservice.js -> timestamp: "+this.timestamp+" leavePlayerRoom() metarooms[roomid]: "+this.metarooms[roomid]+" roomid:"+roomid+" playerRoom:"+this.playerRoom,this.debug);if(!this.metarooms[roomid])
this.socketio.emit('leave',roomid);}catch(e){Trace.write(this.exceptionHdr+" leavePlayerRoom():"+e.message,true);Trace.error(e);}},joinWebStationRoom:function(roomid){try{this.setPush();if(this.streamsToIgnore.indexOf(roomid)!=-1)
return;if(!this.webstationrooms[roomid])
this.webstationrooms[roomid]=roomid;if(this.connected)
this.socketio.emit('join',roomid);}catch(e){Trace.write(this.exceptionHdr+" joinWebStationRoom():"+e.message,true);Trace.error(e);}},joinRoom:function(roomid){try{this.setPush();if(this.streamsToIgnore.indexOf(roomid)!=-1)
return;Trace.write("nodesocketservice -> timestamp: "+this.timestamp+" joinRoom() roomid:"+roomid,true);if(this.connected)
this.socketio.emit('join',roomid);if(!this.metarooms[roomid])
this.metarooms[roomid]=roomid;if(this.roomsArr.indexOf(roomid)<0)
this.roomsArr.push(roomid);}catch(e){Trace.write(this.exceptionHdr+" joinRoom():"+e.message,true);Trace.error(e);}},leaveRoom:function(roomid){try{if(this.metarooms[roomid]){Trace.write("nodesocketservice -> timestamp: "+this.timestamp+" leaveRoom - > "+roomid+"< playerRoom:"+this.playerRoom+"<",this.debug);if(this.playerRoom==roomid||this.webstationrooms[roomid])
return;this.socketio.emit('leave',roomid);this.roomsArr=this.removeRoomId(roomid);delete this.metarooms[roomid];}}catch(e){Trace.write(this.exceptionHdr+" leaveRoom():"+e.message,true);Trace.error(e);}},removeRoomId:function(roomid){var tmpArr=new Array();this.roomsArr.each(function(item){if(item!=roomid)tmpArr.push(item);});return tmpArr;},onPush:function(event){try{Trace.write("nodesocketservice.js -> onPush()",this.debug);Trace.write(event,this.debug);if(!this.siteLoaded)
return;var metadata=this.processData({key:event.key,value:event.value});Trace.write("nodesocketservice onPush() Metadata: ",this.debug);Trace.write(metadata,this.debug);if(this.playerRoom==event.key)
this.dispatchEvent("metaNode:playerupdated",{value:metadata});this.dispatchEvent("metaNode:updated",{value:metadata});}catch(e){Trace.write("nodesocketservice.js -> ERROR onPush(): siteloaded:"+this.siteLoaded+" location:"+document.location,true);Trace.error(e);}},reloadData:function(){Trace.write("nodesocketservice.js -> reloadData() ",true);this.onConnect();},onConnect:function(event){try{Trace.write("NODESOCKETSERVICE: onConnect in nodesocketservice.js",this.debug);Trace.write(this,this.debug);this.connected=true;var self=this;this.roomsArr.each(function(roomid){if(self.metarooms!=null&&self.metarooms[roomid])
self.joinRoom(roomid);});if(this.playerRoom)
this.joinPlayerRoom(this.playerRoom);this.dispatchEvent("metaNode:connected");}catch(e){Trace.write(this.exceptionHdr+" onConnect():"+e.message,true);Trace.error(e);}},onDisconnect:function(event){Trace.write("NODESOCKETSERVICE: onDisconnect in nodesocketservice.js",this.debug);this.connected=false;this.dispatchEvent("metaNode:disconnected");},processData:function(data){try{if(data.key.indexOf('/metadata/now/')!=-1){Trace.write(data,this.debug);var myObject=eval('('+data.value+')');var stream=myObject;var datatrack=(stream.tracks&&stream.tracks.length>0)?stream.tracks[0]:{thumbnail:"",artist:"",title:""};var track=this.mapTrack(datatrack);var tracksArr=new Array();tracksArr.push(track);return{rawData:data.value,key:data.key,getNowPlaying:function(){return track;},stream:this.mapStream(stream,data.key,tracksArr)};}}catch(e){Trace.write(this.exceptionHdr+" processData():"+e.message,true);Trace.error(e);}
return null;},filterComposer:function(track,key){if(track!=null&&key.indexOf("classical")<0)
track.composer="";return track;},processFullData:function(data){try{Trace.write("processFullData:",this.debug);Trace.write(data,this.debug);if(data.key.indexOf('/metadata/full/')!=-1){var myObject=eval('('+data.value+')');var stream=myObject;var tracks=stream.tracks;var tracksArr=new Array();var len=tracks.length;var idx=0;for(var i=0;i<len;i++){var track=tracks[i];if(track["status"]=="0"||track["status"]=="1"||track["status"]=="2"){idx++;tracksArr.push(this.mapTrack(track));}}
return{rawData:data.value,key:data.key,stream:this.mapStream(stream,data.key,tracksArr)};}else{Trace.write("ERROR",true);Trace.write(data,true);}
return null;}catch(e){Trace.write(this.exceptionHdr+" processFullData():"+e.message,true);Trace.error(e);}},mapTrack:function(track){Trace.write("mapTrack(): track composerPermalink"+track["composerPermalink"],this.debug);Trace.write(track,this.debug);return{artist:track["artist"],infoLink:track["infolink"],composer:track["composer"],composerPermalink:track["composerPermalink"],iTunesLink:track["ituneslink"],permalink:track["permalink"],status:track["status"],thumbnail:track["thumbnail"],thumbnail_lrg:track["artwork400"],title:track["title"],type:track["type"]};},mapStream:function(stream,key,tracksArr){var arr=key.split("/");var postfixStream=(arr[3].indexOf('radio')!=-1)?"station":"genre";var permalink="/stream/"+postfixStream+"/"+arr[3]+"/"+arr[4];var category=stream["category"]||"none";var programinfolink=stream["permalink"];stream["permalink"]=permalink;return{name:stream["name"],category:category,programname:stream["programname"],programimage:stream["programimage"],programdescription:stream["programdescription"],programstarttime:stream["programstarttime"],programendtime:stream["programendtime"],programinfolink:programinfolink,mount:stream["stwmount"],roomid:key,permalink:stream["permalink"],tracks:tracksArr};}});

CBCR3.namespace("CBCR3.Modules");var _socketIO=null;var _nodeID=0;var options={'flash policy port':443};if(!_metadataServicesUrl)
var _metadataServicesUrl='';CBCR3.Modules.MetaNodeSocketProvider={getInstance:function(){try{if(typeof io=='undefined')
return null;if(_socketIO==null)
_socketIO=io.connect(_metadataServicesUrl,options);return _socketIO;}catch(e){Trace.write("io not defined",true);Trace.write(io,true);Trace.write(e,true);return null;}}};CBCR3.Modules.MetaNode=Class.create(CBCR3.Commons.EventDispatcher,{roomid:null,nodeID:"",initialize:function($super,roomid){try{$super();this.roomid=roomid;}catch(e){Trace.error(e);}}});

CBCR3.namespace("CBCR3.Playlists.Events");CBCR3.Playlists.Events.ItemEvent={removed:"remove",sort:"sort",play:"play"};CBCR3.Playlists.Events.FieldEvent={changed:"changed"};CBCR3.Playlists.Events.ServiceEvent={playlistDeleted:"playlistDeleted",trackRemoved:"trackRemoved",trackAddedToPlaylist:"trackAddedToPlaylist",playlistAddedToFavourites:"playlistAddedToFavourites",favouritesReceived:"favouritesReceived",favouriteArtistsReceived:"favouriteArtistsReceived",playlistsReceived:"playlistsReceived",trackReceived:"trackReceived",tracksReceived:"tracksReceived",personalPlaylistsReceived:"serviceEvent:personalPlaylistsReceived",favouritePlaylistsReceived:"serviceEvent:favouritePlaylistsReceived",favouriteTracksReceived:"serviceEvent:favouriteTracksReceived",favouriteConcertsReceived:"serviceEvent:favouriteConcertsReceived"};CBCR3.Playlists.Events.PlaylistEvent={addTrackToPlaylist:"addTrackToPlaylist",playlistAddedToFavourites:"playlistAddedToFavourites",pagedTracksReceived:"pagedTracksReceived",listSizeChanged:"listSizeChanged"};

Object.extend(Sortable,{activeElement:null,nextElement:null,onHover:function(element,dropon,overlap)
{if(!Sortable.activeElement&&!Sortable.nextElement)
{Sortable.activeElement=element;Sortable.nextElement=element.next();}
if(Element.isParent(dropon,element))
return;if(overlap>.33&&overlap<.66&&Sortable.options(dropon).tree)
{return;}
else if(overlap>0.5)
{Sortable.mark(dropon,'before');if(dropon.previousSibling!=element)
{var oldParentNode=element.parentNode;element.style.visibility="hidden";dropon.parentNode.insertBefore(element,dropon);if(dropon.parentNode!=oldParentNode)
Sortable.options(oldParentNode).onChange(element);Sortable.options(dropon.parentNode).onChange(element);}}
else
{Sortable.mark(dropon,'after');var nextElement=dropon.nextSibling||null;if(nextElement!=element)
{var oldParentNode=element.parentNode;element.style.visibility="hidden";dropon.parentNode.insertBefore(element,nextElement);if(dropon.parentNode!=oldParentNode)
Sortable.options(oldParentNode).onChange(element);Sortable.options(dropon.parentNode).onChange(element);}}},cancel:function()
{if(!Sortable.activeElement)
return;var parentNode=Sortable.activeElement.parentNode;parentNode.insertBefore(Sortable.activeElement,Sortable.nextElement);Sortable.reset();},reset:function()
{Sortable.activeElement=null;Sortable.nextElement=null;}});

CBCR3.namespace("CBCR3.Playlists");CBCR3.Playlists.TrackListManager=Class.create(CBCR3.Commons.EventDispatcher,{sortedListItem:null,trackItems:{},service:null,trackList:null,playlistPermalink:null,favouriteButton:null,trackRowBuilder:null,dynamicField:null,trackPager:null,initialize:function($super,service,trackRowBuilder,dynamicField,options){try{$super();this.service=service;this.service.addEventListener(CBCR3.Playlists.Events.ServiceEvent.trackReceived,this.onTrackReceived.bind(this));this.trackRowBuilder=trackRowBuilder;this.dynamicField=dynamicField;this.dynamicField.addEventListener(CBCR3.Playlists.Events.FieldEvent.changed,this.onTitleFieldChanged.bind(this));this.trackItems=new Array();this.trackList=(options.trackListObj)?options.trackListObj:$(options.trackList);this.activate();this.enableSorting(this.trackList);this.playlistPermalink=options.playlistPermalink;}catch(e){Trace.write("Error in Tracklistmanager.js ",true);Trace.error(e);}},activate:function(){var listItems=this.trackList.select("li");for(var i=0;i<listItems.length;i++){this.activateTrackItem(listItems[i]);}},activateTrackItem:function(listItem){var trackItem=new CBCR3.Playlists.Modules.TrackItem(listItem);trackItem.addEventListener(CBCR3.Playlists.Events.ItemEvent.remove,this.onItemRemove.bindAsEventListener(this,trackItem));trackItem.addEventListener(CBCR3.Playlists.Events.ItemEvent.sort,this.onInputSort.bindAsEventListener(this,trackItem));this.trackItems[trackItem.getClientId()]=trackItem;},enableSorting:function(element){Sortable.create(element,{scroll:window,constraint:false,ghosting:Prototype.Browser.Opera,dropOnEmpty:false,onUpdate:this.onUpdate.bind(this),onChange:this.onChange.bind(this),overlap:"vertical",hoverClass:"draggable"});Draggables.addObserver({onStart:this.onStart.bind(this),onEnd:this.onEnd.bind(this)});},getTrackListItems:function(){return this.trackList.select("li");},onStart:function(eventName,item,event){},onChange:function(item){this.sortedListItem=item;},onUpdate:function(element){if(!this.sortedListItem)
return;var trackItem=this.trackItems[this.sortedListItem.id];var oldSequence=trackItem.getSequence();this.updateSequence();var newSequence=trackItem.getSequence();this.registerUpdate(oldSequence,newSequence);},onEnd:function(eventName,item,event){},onItemRemove:function(event,trackItem){delete this.trackItems[event.target.getClientId()];this.registerRemove(trackItem.getSequence());this.updateSequence();},onInputSort:function(event,trackItem){var oldSequence=event.data.oldSequence;var newSequence=event.data.newSequence;var listItems=this.getTrackListItems();if(newSequence>0&&newSequence<(listItems.length+1)){this.moveItem(trackItem.getClientId(),oldSequence,newSequence,listItems);this.registerUpdate(oldSequence,newSequence)}
this.updateSequence();},moveItem:function(elementToMove,oldSequence,newSequence,listItems){if(newSequence<oldSequence)
this.moveUp($(elementToMove),newSequence,listItems);if(newSequence>oldSequence)
this.moveDown($(elementToMove),newSequence,listItems);},moveUp:function(item,sequence,listItems){this.trackList.insertBefore(item,listItems[sequence-1]);},moveDown:function(item,sequence,listItems){this.trackList.insertBefore(item,listItems[sequence-1].nextSibling);},updateSequence:function(){var listItems=this.trackList.select("li");for(var i=0;i<listItems.length;i++){this.trackItems[listItems[i].id].setSequence(i+1);}
this.updatePager();},registerUpdate:function(oldSequence,newSequence){Trace.write("*** Update Sequence ***");Trace.write("permalink:"+this.playlistPermalink+" old sequence:"+oldSequence+" new sequence:"+newSequence);this.service.updateSequence(this.playlistPermalink,oldSequence,newSequence);},registerRemove:function(sequence){this.service.removeTrack(this.playlistPermalink,sequence);},cancel:function(item){Sortable.cancel();},favouriteButton_Click:function(event){Event.stop(event);this.dispatchEvent(CBCR3.Playlists.Events.PlaylistEvent.addPlaylistToFavourites,{playlistPermalink:this.playlistPermalink});},appendTrackToList:function(playlistPermalink,trackPermalink,sequence){if(this.playlistPermalink!=playlistPermalink)
return;this.service.getPlaylistTrack(playlistPermalink,sequence);},onTrackReceived:function(event){var track=event.data.track;if(track.sequence>(this.trackList.childNodes.length+1))
return;var item=this.trackRowBuilder.createRow(track);this.trackList.appendChild(item);item.highlight({startcolor:"#ffcc00",endcolor:"#3a3a3a"});this.activateTrackItem(item);this.enableSorting(this.trackList);this.updateSequence();},initPaging:function(trackPager){this.trackPager=trackPager;this.trackPager.addEventListener(CBCR3.Playlists.Events.PlaylistEvent.pagedTracksReceived,this.onPagedTracksReceived.bind(this));},onPagedTracksReceived:function(event){var rows=event.data.rows;var rowsDoc=document.createDocumentFragment();for(var i=0;i<rows.length;i++){this.activateTrackItem(rows[i]);rowsDoc.appendChild(rows[i])}
this.trackList.appendChild(rowsDoc);this.enableSorting(this.trackList);this.updatePager();},updatePager:function(){if(this.trackPager){this.trackPager.setStartSequence(this.trackList.getElementsByTagName('li').length+1);}},onTitleFieldChanged:function(event){window.location.href=event.data.playlistPermalink;}});

CBCR3.namespace("CBCR3.Playlists");CBCR3.Playlists.PlaylistManager=Class.create({playlistService:null,permalinkService:null,playlistPanel:null,playlistItems:{},personalPlaylistTray:null,favouritePlaylistTray:null,tracklistManager:null,r3Player:null,initialize:function(playlistService,permalinkService,tracklistManager,personalPlaylistTray,favouritePlaylistTray,r3PlayerInstanceService){this.playlistService=playlistService;this.permalinkService=permalinkService;this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.trackAddedToPlaylist,this.onTrackAddedToPlaylist.bind(this));this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.playlistAddedToFavourites,this.onPlaylistAddedToFavourites.bind(this));this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.playlistsReceived,this.onPlaylistsReceived.bind(this));this.playlistService.addEventListener(CBCR3.Playlists.Events.ServiceEvent.favouritesReceived,this.onFavouritesReceived.bind(this));this.permalinkService.addEventListener(CBCR3.Player.Events.ServiceExceptionEvent.duplicateTrack,this.duplicateTrackHandler.bind(this));this.tracklistManager=tracklistManager;this.tracklistManager.addEventListener(CBCR3.Playlists.Events.PlaylistEvent.addPlaylistToFavourites,this.onAddPlaylistToFavourites.bind(this));this.tracklistManager.addEventListener(CBCR3.Playlists.Events.FieldEvent.changed,this.onPlaylistTitleChanged.bind(this));this.personalPlaylistTray=personalPlaylistTray;this.personalPlaylistTray.addEventListener(CBCR3.Playlists.Events.PlaylistEvent.addTrackToPlaylist,this.onAddTrackToPlaylist.bind(this));this.favouritePlaylistTray=favouritePlaylistTray;this.trackExistsChooser=new CBCR3.Player.Modules.TrackExistsChooser();this.trackExistsChooser.addEventListener(CBCR3.Player.Events.PermalinkEvent.confirm,this.permalinkConfirmHandler.bind(this));this.trackExistsChooser.addEventListener(CBCR3.Player.Events.PermalinkEvent.cancel,this.permalinkCancelHandler.bind(this));if(r3PlayerInstanceService.getInstance()!=undefined)
this.setR3Player(r3PlayerInstanceService.getInstance());else
r3PlayerInstanceService.addEventListener(CBCR3.Player.Events.StateInitEvent.r3PlayerInit,this.onR3PlayerInit.bind(this));},duplicateTrackHandler:function(event){this.trackExistsChooser.attachTo(this.parentElement);this.dispatchEvent(CBCR3.Player.Events.DisplayEvent.forceIERefresh,null);},permalinkConfirmHandler:function(event){this.permalinkService.addTrackToPlaylist(this.trackPermalink,this.playlistPermalink,true);},permalinkCancelHandler:function(event){this.dispatchEvent(CBCR3.Player.Events.DisplayEvent.forceIERefresh,null);},onR3PlayerInit:function(event){this.setR3Player(event.data.r3Player);},setR3Player:function(r3Player){this.r3Player=r3Player;this.r3Player.addEventListener(CBCR3.Player.Events.PermalinkEvent.favouriteAdded,this.onPlayerFavouriteAdded.bind(this));this.r3Player.addEventListener(CBCR3.Player.Events.PermalinkEvent.favouriteRemoved,this.onPlayerFavouriteRemoved.bind(this));this.r3Player.addEventListener(CBCR3.Player.Events.PlaylistEvent.newPlaylistCreated,this.onPlayerNewPlaylistCreated.bind(this));this.r3Player.addEventListener(CBCR3.Player.Events.PermalinkEvent.trackAdded,this.onPlayerTrackAdded.bind(this));},onAddTrackToPlaylist:function(event){this.tracklistManager.cancel(event.data.element);this.permalinkService.addTrackToPlaylist(event.data.trackPermalink,event.data.playlistPermalink,false);},onAddPlaylistToFavourites:function(event){this.playlistService.addLike(event.data.playlistPermalink);},onPlaylistAddedToFavourites:function(event){this.playlistService.getFavourites(event.data.playlistPermalink);},onTrackAddedToPlaylist:function(event){this.tracklistManager.appendTrackToList(event.data.playlistPermalink,event.data.trackPermalink,event.data.sequence);},onPlaylistTitleChanged:function(event){this.playlistService.getPlaylists(event.data.playlistPermalink);this.playlistService.getFavourites(event.data.playlistPermalink);},onPlayerNewPlaylistCreated:function(event){this.playlistService.getPlaylists(event.data.playlistPermalink);},onPlayerFavouriteAdded:function(event){this.playlistService.getFavourites(event.data.playlistPermalink);},onPlayerFavouriteRemoved:function(event){this.playlistService.getFavourites(event.data.playlistPermalink);},onPlayerTrackAdded:function(event){this.tracklistManager.appendTrackToList(event.data.playlistPermalink,event.data.trackPermalink,event.data.sequence);},onPlaylistsReceived:function(event){this.personalPlaylistTray.reload(event.data.playlists,event.data.playlistPermalink);},onFavouritesReceived:function(event){this.favouritePlaylistTray.reload(event.data.playlists,event.data.playlistPermalink);}});

CBCR3.namespace("CBCR3.Playlists");CBCR3.Playlists.GuestTrackListManager=Class.create(CBCR3.Commons.EventDispatcher,{listElement:null,trackPager:null,initialize:function($super,options)
{$super();this.listElement=$(options.trackList);},initPaging:function(trackPager)
{this.trackPager=trackPager;this.trackPager.addEventListener(CBCR3.Playlists.Events.PlaylistEvent.pagedTracksReceived,this.onPagedTracksReceived.bind(this));},onPagedTracksReceived:function(event)
{var rows=event.data.rows;var rowsDoc=document.createDocumentFragment();for(var i=0;i<rows.length;i++){var row=rows[i];rowsDoc.appendChild(row);}
this.listElement.appendChild(rowsDoc);this.trackPager.setStartSequence(this.listElement.getElementsByTagName('li').length+1);}});

CBCR3.namespace("CBCR3.Playlists");CBCR3.Playlists.AnonymousTrackListManager=Class.create(CBCR3.Commons.EventDispatcher,{listElement:null,trackPager:null,initialize:function($super,options)
{$super();this.listElement=$(options.trackList);this.hookupElements();},hookupElements:function()
{var listItems=this.listElement.select("li");listItems.each(this.wireUpItem.bind(this));},wireUpItem:function(item)
{new Draggable(item,{revert:true,hoverClass:"draggable"});},initPaging:function(trackPager)
{this.trackPager=trackPager;this.trackPager.addEventListener(CBCR3.Playlists.Events.PlaylistEvent.pagedTracksReceived,this.onPagedTracksReceived.bind(this));},onPagedTracksReceived:function(event)
{var rows=event.data.rows;var rowsDoc=document.createDocumentFragment();for(var i=0;i<rows.length;i++){var row=rows[i];rowsDoc.appendChild(row);this.wireUpItem(row);}
this.listElement.appendChild(rowsDoc);this.trackPager.setStartSequence(this.listElement.getElementsByTagName('li').length+1);},cancel:function()
{},appendTrackToList:function()
{}});

CBCR3.namespace("CBCR3.Playlists.Dom");CBCR3.Playlists.Dom.AnonymousTrackRowBuilder=Class.create({pageInitializer:null,initialize:function(pageInitializer){this.pageInitializer=pageInitializer;},createRow:function(track){var li=new Element("li");li.update(this.getTemplate().evaluate({permalink:track.permalink,title:track.title,sequence:track.sequence,infoLink:track.infoLink,artist:track.artist,playlistPermalink:track.playlistPermalink,iTunesLink:track.iTunesLink,displayiTunesLink:track.iTunesLink?"block":"none"}));this.pageInitializer.registerNode(li);return li;},getTemplate:function(){return new Template("<div class='playlistTrack item'>"+"<div class='left'>"+"<div class='sequence'>"+"<span>#{sequence}</span>"+"</div>"+"<div class='trackInfo'>"+"<a title='Go to #{artist}&#39;s artist profile' href='#{infoLink}'>#{artist}</a>&nbsp;"+"<label>#{title}</label>"+"</div>"+"</div>"+"<div class='right'>"+"<a class='playButton' href='#{playlistPermalink}##{sequence}'>Play #{title}</a>"+"<a class='gearsButton noinfo' title='Permalink' href='#{permalink}'>Permalink</a>"+"</div>"+"<div class='clear'/>"+"</div>");}});

CBCR3.namespace("CBCR3.Playlists.Modules");CBCR3.Playlists.Modules.FavouritePlaylistTray=Class.create(CBCR3.Commons.EventDispatcher,{listElement:null,playlistTrayHelper:null,initialize:function($super,listElement,currentPlaylistPermalink)
{$super();this.listElement=$(listElement);this.playlistTrayHelper=new CBCR3.Playlists.Dom.PlaylistTrayHelper(this.listElement,currentPlaylistPermalink);},reload:function(playlists,playlistPermalink)
{this.playlistTrayHelper.insertPlaylistItems(playlists);this.playlistTrayHelper.highlightItem(playlistPermalink);},appendPlaylist:function(playlist)
{this.listElement.appendChild(this.createPlaylistItem(playlist));}});

CBCR3.namespace("CBCR3.Playlists.Modules");CBCR3.Playlists.Modules.PermalinkTab=Class.create({parent:null,tab:null,button:null,permalink:null,isOpen:false,playlistService:null,effect:null,input:null,initialize:function(button)
{this.button=button;this.button.observe("click",this.onPermalinkClick.bind(this));this.permalink=button.href;},show:function()
{if(this.tab==null)
this.createTab();if(this.isOpen){this.hide();return;}
this.isOpen=true;this.animate(0,210);this.button.addClassName("on");},animate:function(start,finish)
{if(this.effect)
this.effect.cancel();this.effect=new Effect.Tween(this.tab,start,finish,{duration:.2},function(value){this.setStyle({width:value+"px"});});},createTab:function()
{this.tab=new Element("div");this.tab.addClassName("permalinkTab");this.tab.appendChild(this.createInput());this.tab.setStyle({width:"0px"});$(this.button.parentNode).insert({bottom:this.tab});},createInput:function()
{this.input=new Element("input",{type:"text",value:this.permalink});this.input.observe("click",this.onFocusInput.bind(this));return this.input;},onFocusInput:function(event)
{this.input.focus();this.input.select();},hide:function()
{this.isOpen=false;this.animate(210,0);this.button.removeClassName("on");},onPermalinkClick:function(event)
{Event.stop(event);this.show();}});

CBCR3.namespace("CBCR3.Playlists.Modules");CBCR3.Playlists.Modules.PersonalPlaylistTray=Class.create(CBCR3.Commons.EventDispatcher,{listElement:null,playlistTrayHelper:null,playlistItems:{},initialize:function($super,listElement,currentPlaylistPermalink)
{$super();this.listElement=$(listElement);this.playlistTrayHelper=new CBCR3.Playlists.Dom.PlaylistTrayHelper(this.listElement,currentPlaylistPermalink);this.playlistTrayHelper.activateCurrent();this.activatePlaylistDropping();},reload:function(playlists,playlistPermalink)
{this.clearPlaylistDropping();this.playlistTrayHelper.insertPlaylistItems(playlists);this.playlistTrayHelper.activateCurrent();this.playlistTrayHelper.highlightItem(playlistPermalink);this.activatePlaylistDropping();},activatePlaylistDropping:function()
{var listItems=this.listElement.select("li");this.playlistItems=new Array();for(var i=0;i<listItems.length;i++)
{var playlistItem=new CBCR3.Playlists.Modules.PlaylistItem(listItems[i]);playlistItem.addEventListener(CBCR3.Playlists.Events.PlaylistEvent.addTrackToPlaylist,this.onAddTrackToPlaylist.bind(this));this.playlistItems.push(playlistItem);}},clearPlaylistDropping:function()
{this.playlistItems.each(function(item){item.clearDropping()});},onAddTrackToPlaylist:function(event)
{this.dispatchEvent(CBCR3.Playlists.Events.PlaylistEvent.addTrackToPlaylist,event.data);}});

CBCR3.namespace("CBCR3.Playlists.Modules");CBCR3.Playlists.Modules.TrackItem=Class.create(CBCR3.Commons.EventDispatcher,{clientId:null,listItem:null,sequence:0,sequenceInput:null,removeButton:null,playButton:null,initialize:function($super,listItem){$super();this.listItem=listItem;this.registerDomActions();},registerDomActions:function(){this.removeButton=this.listItem.down(".removeButton");if(this.removeButton)
this.removeButton.observe("click",this.onRemoveClick.bind(this));this.sequenceInput=this.listItem.down(".sequenceInput");if(this.sequenceInput){this.sequenceInput.observe("keypress",this.onInputKeyPress.bind(this));this.sequence=this.sequenceInput.getValue();}
this.clientId=this.listItem.id;this.playButton=this.listItem.down(".playButton");},getClientId:function(){return this.clientId;},getSequence:function(){return this.sequence;},setSequence:function(sequence){this.sequence=sequence;this.sequenceInput.value=sequence;this.setPermalinkSequence(sequence);},setPermalinkSequence:function(newSequence){var permalink=this.playButton.href;var hashIndex=permalink.indexOf("#");this.playButton.href=permalink.substring(0,hashIndex+1)+newSequence;},onRemoveClick:function(event){this.listItem.remove();this.dispatchEvent(CBCR3.Playlists.Events.ItemEvent.remove,{sequence:this.sequence});},onInputKeyPress:function(event){if(event.keyCode==13){Event.stop(event);this.dispatchEvent(CBCR3.Playlists.Events.ItemEvent.sort,{oldSequence:this.sequence,newSequence:this.sequenceInput.getValue()});}}});

CBCR3.namespace("CBCR3.Playlists.Modules");CBCR3.Playlists.Modules.DynamicField=Class.create(CBCR3.Commons.EventDispatcher,{element:null,input:null,options:{},clickFn:null,originalText:"",playlistPermalink:null,initialize:function($super,element,playlistPermalink,options)
{$super();this.element=$(element);this.playlistPermalink=playlistPermalink;this.options=options;this.activate();},activate:function()
{this.clickFn=this.onElementClick.bind(this);this.enable();if(this.options.editOnLoad)
this.startEditing();},enable:function()
{Event.observe(this.element,"click",this.clickFn);this.element.addClassName("enabled");this.element.setAttribute("title","CLICK TO EDIT");},disable:function()
{Event.stopObserving(this.element,"click",this.clickFn);this.element.removeClassName("enabled");},onElementClick:function(event)
{this.startEditing();},startEditing:function()
{this.disable();this.originalText=this.getText().unescapeHTML();this.clearContents();this.createInput(this.originalText);this.createButton();},createInput:function(text)
{this.input=new Element("input",{type:"text",value:text,maxLength:"300"})
this.input.observe("keypress",this.onKeyPress.bind(this));this.element.appendChild(this.input);this.input.focus();},createButton:function()
{var buttonBox=new Element("span",{className:"defaultButton"});var button=new Element("button",{type:"button",className:"yellowButton smallButton"});buttonBox.update(button);button.update("save");button.observe("click",this.onSaveClick.bind(this));var cancelBox=new Element("span",{className:"defaultButton"});var cancel=new Element("button",{type:"button",className:"greyButton smallButton"});cancelBox.update(cancel);cancel.update("cancel");cancel.observe("click",this.onCancelClick.bind(this));this.element.appendChild(buttonBox);this.element.appendChild(cancelBox);},getText:function()
{return this.element.innerHTML;},setText:function(value)
{this.element.innerHTML=value;},clearContents:function()
{this.element.innerHTML="";},onKeyPress:function(event)
{this.checkForEscapeOrReturn(event);},onSaveClick:function(event)
{Event.stop(event);this.submitChanges();},onCancelClick:function(event)
{Event.stop(event);this.cancelForm();},hideElement:function()
{this.element.hide();},checkForEscapeOrReturn:function(event)
{if(Event.KEY_ESC==event.keyCode){this.cancelForm();return;}
if(Event.KEY_RETURN==event.keyCode){Event.stop(event);this.submitChanges();return;}},submitChanges:function()
{this.endEditing();this.setText("Saving...");this.options.onUpdate(this.playlistPermalink,this.input.getValue(),this.onSuccess.bind(this),this.onFailed.bind(this));},onSuccess:function(response)
{this.enable();var playlist=this.parsePlaylistDto(response);this.setText(playlist.title);this.originalText=playlist.title;this.element.observe("click",this.clickFn);this.dispatchEvent(CBCR3.Playlists.Events.FieldEvent.changed,{text:playlist.title,playlistPermalink:playlist.permalink});},parsePlaylistDto:function(dto)
{var playlist=new CBCR3.Playlists.Models.Playlist();playlist.playlistId=dto.PlaylistId;playlist.permalink=dto.Permalink;playlist.title=dto.Title;return playlist;},onFailed:function(response)
{alert("There was an error updating. Please try refreshing the page");},endEditing:function()
{this.clearContents();this.setText(this.text);},cancelForm:function()
{this.enable();this.setText(this.originalText);}});

CBCR3.namespace("CBCR3.Playlists.Modules");CBCR3.Playlists.Modules.PlaylistCreator=Class.create(CBCR3.Commons.EventDispatcher,{nameInput:null,submitButton:null,initialize:function($super)
{$super();this.nameInput=$("playlistManager_newPlaylistName");this.nameInput.observe("keypress",this.onKeyPress.bind(this));this.submitButton=$("playlistManager_submitButton");this.submitButton.observe("click",this.onSubmit.bind(this));},onKeyPress:function(event)
{if(event.keyCode==13){Event.stop(event);this.onSubmit();}},onSubmit:function(event)
{this.dispatchEvent(CBCR3.Playlists.Events.PlaylistCreatorEvent.createPlaylist,{playlistName:this.nameInput.getValue()});this.nameInput.clear();}})

CBCR3.namespace("CBCR3.Playlists.Modules");CBCR3.Playlists.Modules.PlaylistItem=Class.create(CBCR3.Commons.EventDispatcher,{listElement:null,playlistPermalink:null,playlistService:null,initialize:function($super,listElement,playlistService)
{$super();this.listElement=listElement;this.playlistPermalink=this.listElement.down("a").href;this.playlistService=playlistService;this.activate();},activate:function()
{Droppables.add(this.listElement,{onDrop:this.onDrop.bind(this),onHover:this.onHover.bind(this),hoverclass:"dropHover",greedy:true});},clearDropping:function()
{Droppables.remove(this.listElement);},onDrop:function(item)
{var trackPermalink=item.down(".addButton").href;this.listElement.highlight({startcolor:"#ffcc00"});this.dispatchEvent(CBCR3.Playlists.Events.PlaylistEvent.addTrackToPlaylist,{playlistPermalink:this.playlistPermalink,trackPermalink:trackPermalink,element:item});},onHover:function(item)
{}});

CBCR3.namespace("CBCR3.Playlists.Modules");CBCR3.Playlists.Modules.TrackPager=Class.create(CBCR3.Commons.EventDispatcher,{trackCount:0,pageSize:0,pagingTrigger:null,service:null,trackRowBuilder:null,playlistPermalink:null,startSequence:0,initialize:function(service,trackRowBuilder,playlistPermalink,pagingTrigger,trackCount,pageSize)
{if(trackCount<pageSize)
return;this.service=service;this.service.addEventListener(CBCR3.Playlists.Events.ServiceEvent.tracksReceived,this.onTracksReceived.bind(this));this.trackRowBuilder=trackRowBuilder;this.pagingTrigger=pagingTrigger;this.pagingTrigger.show();this.pagingTrigger.observe("click",this.onTriggerClick.bind(this));this.trackCount=trackCount;this.pageSize=pageSize;this.playlistPermalink=playlistPermalink;this.startSequence=pageSize+1;},setStartSequence:function(value)
{this.startSequence=value;},onTriggerClick:function(event)
{event.stop();this.disableTrigger();this.service.getPlaylistTracks(this.playlistPermalink,this.pageSize,this.startSequence);},onTracksReceived:function(event)
{var tracks=event.data.tracks;var rows=new Array();for(var i=0;i<tracks.length;i++)
{var row=this.trackRowBuilder.createRow(tracks[i]);rows.push(row)}
this.dispatchEvent(CBCR3.Playlists.Events.PlaylistEvent.pagedTracksReceived,{rows:$(rows)});if(tracks.length<this.pageSize)
this.pagingTrigger.hide();this.enableTrigger();},disableTrigger:function()
{this.pagingTrigger.addClassName("loading");this.pagingTrigger.setAttribute("disabled","disabled");this.pagingTrigger.down("span").hide();},enableTrigger:function()
{this.pagingTrigger.removeClassName("loading");this.pagingTrigger.removeAttribute("disabled");this.pagingTrigger.down("span").show();}});

CBCR3.namespace("CBCR3.Playlists.Models");CBCR3.Playlists.Models.Playlist=Class.create({initialize:function()
{this.playlistId="";this.permalink="";this.title="";}});

CBCR3.namespace("CBCR3.Playlists.Dom");CBCR3.Playlists.Dom.GuestTrackRowBuilder=Class.create({pageInitializer:null,initialize:function(pageInitializer)
{this.pageInitializer=pageInitializer;},createRow:function(track)
{var li=new Element("li");li.update(this.getTemplate().evaluate({permalink:track.permalink,title:track.title,sequence:track.sequence,artistPermalink:track.artistPermalink,artist:track.artist,playlistPermalink:track.playlistPermalink,iTunesLink:track.iTunesLink,displayiTunesLink:track.iTunesLink?"block":"none"}));this.pageInitializer.registerNode(li);return li;},getTemplate:function()
{return new Template("<div class='playlistTrack'>"+"<div class='sequence'>"+"<span>#{sequence}</span>"+"</div>"+"<div class='trackInfo'>"+"<a title='Go to #{artist}&#39;s artist profile' href='#{infoLink}'>#{artist}</a>&nbsp;"+"<label>#{title}</label>"+"</div>"+"<div class='trackButtons' style='display: none'"+"<a class='playButton trackButton play' title='Play this track' href='#{playlistPermalink}##{sequence}'>Play this track</a>"+"<a class='addButton trackButton add' title='Add this track to a playlist' href='#{permalink}'>Add this track to a playlist</a>"+"<a class='permalinkButton trackButton permalink' title='Permalink' href='#{permalink}'>Permalink</a>"+"<a target='_blank' style='display:#{displayiTunesLink}' class='trackButton iTunes' title='Buy this track on iTunes' href='#{iTunesLink}'>Buy on iTunes</a>"+"</div>"+"<a class='playButton borderLeft'></a>"+"<a class='gearsButton borderLeft'></a>"+"<div class='clear'/>"+"</div>");}});

CBCR3.namespace("CBCR3.Playlists.Dom");CBCR3.Playlists.Dom.OwnerTrackRowBuilder=Class.create({pageInitializer:null,playlistId:null,initialize:function(pageInitializer,playlistId)
{this.pageInitializer=pageInitializer;this.playlistId=playlistId||"";},createRow:function(track){var li=new Element("li",{title:"Drag and drop to reorder or add to playlists",className:"draggable"});if(track.sequence!=null)
li.id=this.playlistId+"track_"+track.sequence;li.update(this.getTemplate().evaluate({permalink:track.permalink,title:track.title,sequence:track.sequence,infoLink:track.infoLink,artist:track.artist,playlistPermalink:track.playlistPermalink,iTunesLink:track.iTunesLink,displayiTunesLink:track.iTunesLink?"block":"none"}));this.pageInitializer.registerNode(li);return li;},getTemplate:function()
{return new Template("<div class='playlistTrack item'>"+"<div class='left'>"+"<div class='sequence'>"+"<input class='sequenceInput'  value='#{sequence}' type='text' title='Enter a new sequence number here to move this track'/>"+"</div>"+"<div class='trackInfo'>"+"<a title='Go to #{artist}&#39;s artist profile' href='#{infoLink}'>#{artist}</a>&nbsp;"+"<label>#{title}</label>"+"</div>"+"</div>"+"<div class='right'>"+"<a class='playButton' title='Play #{title}' href='#{playlistPermalink}##{sequence}'>Play #{title}</a>"+"<a class='gearsButton noinfo' title='Permalink' href='#{permalink}'>Permalink</a>"+"<button class='removeButton' title='Remove this track from this playlist' type='button' value='#{permalink}'>Remove this track from this playlist</button>"+"</div>"+"<div class='clear'/>"+"</div>");}});

CBCR3.namespace("CBCR3.Playlists.Dom");CBCR3.Playlists.Dom.PlaylistTrayHelper=Class.create({listElement:null,currentPlaylistPermalink:null,initialize:function(listElement,currentPlaylistPermalink)
{this.listElement=listElement;this.currentPlaylistPermalink=currentPlaylistPermalink||"";},insertPlaylistItems:function(playlists)
{this.listElement.update();playlists.each(this.appendPlaylist.bind(this));this.restripeList();},appendPlaylist:function(playlist)
{this.listElement.appendChild(this.createPlaylistItem(playlist));},createPlaylistItem:function(playlist)
{var li=new Element("li").update(this.getItemTemplate().evaluate({permalink:playlist.permalink,title:playlist.title}));return li;},restripeList:function()
{CBCR3.Playlists.Util.restripeList(this.listElement);},highlightItem:function(permalink)
{var existingItems=this.listElement.select("li");for(var i=0;i<existingItems.length;i++)
if(existingItems[i].down("a").href==permalink)
existingItems[i].highlight({startcolor:"#ffcc00"});},activateCurrent:function()
{this.showActivePlaylistItem(this.currentPlaylistPermalink);},showActivePlaylistItem:function(playlistPermalink)
{this.listElement.select("li").each(function(item){if(item.down("a").href==playlistPermalink)
item.addClassName("active");});},getItemTemplate:function()
{return new Template("<div class='item'>"+"<div class='title'>"+"<a href='#{permalink}' title='Click to view this playlist'>#{title}</a>"+"</div>"+"</div>");}});

CBCR3.namespace("CBCR3.Playlists.Dom");CBCR3.Playlists.Dom.PlaylistRowBuilder=Class.create({playlist:null,initialize:function(playlist)
{this.playlist=playlist;},createRow:function()
{var li=new Element("li");li.update(this.getTemplate().evaluate({permalink:this.playlist.permalink,title:this.playlist.title}));return li;},getTemplate:function()
{return new Template("<div class='item'>"+"<div class='title'>"+"<a href='#{permalink}' title='Click to view this playlist'>#{title}</a>"+"</div>"+"<div class='buttons'>"+"<a href='#{permalink}' class='playButton button' title='Play this playlist'>Play</a>"+"<a href='#{permalink}' class='button deletePlaylist' title='Delete this playlist'>Delete</a>"+"<a href='#{permalink}' class='button playlistPermalink' title='Share this permalink'>Share this permalink</a>"+"</div>"+"</div>");}});

CBCR3.namespace("CBCR3.Playlists.Services");CBCR3.Playlists.Services.DynamicFieldService=Class.create(CBCR3.Commons.EventDispatcher,{initialize:function($super)
{$super();},renamePlaylist:function(playlistPermalink,title)
{}});

CBCR3.namespace("CBCR3.Playlists.Models");CBCR3.Playlists.Models.Track=Class.create({initialize:function(){this.id=0;this.artist="";this.permalink="";this.title="";this.infoLink="";this.sequence=0;this.length=0;this.playlistPermalink="";this.iTunesLink="";this.thumbnail="";}});

CBCR3.namespace("CBCR3.Playlists");CBCR3.Playlists.Util={restripeList:function(listElement)
{var items=listElement.select("li");for(var i=0;i<items.length;i++)
{if(i%2==0)
items[i].removeClassName("odd");else
items[i].addClassName("odd");}}};

CBCR3.namespace("CBCR3.ArtistTrackList");CBCR3.ArtistTrackList.TrackItemEvent={open:"open",close:"close",retrieveInfo:"retrieveInfo"};CBCR3.ArtistTrackList.ServiceEvent={infoReceived:"infoReceived",trackInfoReceived:"trackInfoReceived"};CBCR3.ArtistTrackList.ArtistTrackList=Class.create({options:{},trackList:null,trackItems:null,initialize:function(options){this.options=options;this.trackList=$(options.trackList);if(this.trackList!=null&&this.trackList.childElements()!=null)
this.trackList.childElements().each(this.createTrackItem.bind(this));},createTrackItem:function(item){if(!this.trackItems)
this.trackItems=new Hash();var trackItem=new CBCR3.ArtistTrackList.Modules.TrackItem(item);this.trackItems.set(trackItem.getTrackPermalink(),trackItem);}});

CBCR3.namespace("CBCR3.ArtistTrackList.Services");CBCR3.ArtistTrackList.Services.ArtistInfoService=Class.create(CBCR3.Commons.EventDispatcher,{artistPermalink:null,debug:false,initialize:function($super,artistPermalink){$super();this.artistPermalink=artistPermalink;},getTrackInfo:function(trackPermalink){Trace.write("getTrackInfo: "+trackPermalink,this.debug);CBC.Radio3.Music.WebServices.ArtistWebService.GetTrackInfo(trackPermalink,this.getTrackInfo_Success.bind(this),this.getTrackInfo_Failed.bind(this));},getTrackInfo_Success:function(response){Trace.write("getTrackInfo_Success: ",this.debug);Trace.write(response,this.debug);this.dispatchEvent(CBCR3.ArtistTrackList.ServiceEvent.trackInfoReceived,{trackInfo:this.parseTrackInfo(response)});},getTrackInfo_Failed:function(response){Trace.write("getTrackInfo_Failed: ",this.debug);Trace.write(response,this.debug);},getTrackInfos:function(){CBC.Radio3.Music.WebServices.ArtistWebService.GetTrackInfos(this.artistPermalink,this.getTrackInfos_Success.bind(this),this.getTrackInfos_Failed.bind(this));},getTrackInfos_Success:function(response){this.dispatchEvent(CBCR3.ArtistTrackList.ServiceEvent.infoReceived,{trackInfos:this.parseTrackInfos(response)});},parseTrackInfos:function(dtoArray){var trackInfos=[];for(var i=0;i<dtoArray.length;i++){var trackInfo=this.parseTrackInfo(dtoArray[i]);trackInfos.push(trackInfo);}
return trackInfos;},parseTrackInfo:function(dto){var trackInfo=new CBCR3.ArtistTrackList.Models.TrackInfo();trackInfo.thumbnail=dto.Thumbnail;trackInfo.permalink=dto.Permalink;trackInfo.title=dto.Title;trackInfo.releaseTitle=dto.ReleaseTitle;trackInfo.titleshort=dto.TitleShort;trackInfo.format=dto.Format;trackInfo.label=dto.Label;trackInfo.subGenre=dto.SubGenre;trackInfo.recordingDate=dto.RecordingDate;trackInfo.artist=dto.Artist;trackInfo.ituneslink=dto.iTunesLink;trackInfo.urlToAudioFile=dto.UrlToAudioFile;trackInfo.credits=dto.Credits;return trackInfo;},getTrackInfos_Failed:function(response){}});

CBCR3.namespace("CBCR3.Gears.Services");CBCR3.Gears.Services.InfoService=Class.create(CBCR3.Commons.EventDispatcher,{artistPermalink:null,debug:true,initialize:function($super,artistPermalink){$super();this.artistPermalink=artistPermalink;},getTrackInfo:function(trackPermalink){Trace.write("getTrackInfo: "+trackPermalink,this.debug);CBC.Radio3.Music.WebServices.GearsInfoWebService.GetTrackInfo(trackPermalink,this.getTrackInfo_Success.bind(this),this.getTrackInfo_Failed.bind(this));},getTrackInfo_Success:function(response){Trace.write("getTrackInfo_Success: ",this.debug);Trace.write(response,this.debug);this.dispatchEvent(CBCR3.ArtistTrackList.ServiceEvent.trackInfoReceived,{trackInfo:this.parseTrackInfo(response)});},getTrackInfo_Failed:function(response){Trace.write("getTrackInfo_Failed: ",this.debug);Trace.write(response,this.debug);},getTrackInfos:function(){CBC.Radio3.Music.WebServices.GearsInfoWebService.GetTrackInfos(this.artistPermalink,this.getTrackInfos_Success.bind(this),this.getTrackInfos_Failed.bind(this));},getTrackInfos_Success:function(response){this.dispatchEvent(CBCR3.ArtistTrackList.ServiceEvent.infoReceived,{trackInfos:this.parseTrackInfos(response)});},parseTrackInfos:function(dtoArray){var trackInfos=[];for(var i=0;i<dtoArray.length;i++){var trackInfo=this.parseTrackInfo(dtoArray[i]);trackInfos.push(trackInfo);}
return trackInfos;},parseTrackInfo:function(dto){var trackInfo=new CBCR3.ArtistTrackList.Models.TrackInfo();trackInfo.thumbnail=dto.Thumbnail;trackInfo.permalink=dto.Permalink;trackInfo.title=dto.Title;trackInfo.releaseTitle=dto.ReleaseTitle;trackInfo.titleshort=dto.TitleShort;trackInfo.format=dto.Format;trackInfo.label=dto.Label;trackInfo.subGenre=dto.SubGenre;trackInfo.recordingDate=dto.RecordingDate;trackInfo.artist=dto.Artist;trackInfo.ituneslink=dto.iTunesLink;trackInfo.urlToAudioFile=dto.UrlToAudioFile;trackInfo.credits=dto.Credits;trackInfo.performers=dto.Performers;return trackInfo;},getTrackInfos_Failed:function(response){}});

CBCR3.namespace("CBCR3.ArtistTrackList.Models");CBCR3.ArtistTrackList.Models.TrackInfo=Class.create({initialize:function(){this.thumbnail="";this.permalink="";this.title="";this.releaseTitle="";this.format="";this.recordingDate="";this.label="";this.subGenre="";this.trackInfo="";this.ituneslink="";this.urlToAudioFile="";this.credits=new Array();this.performers=new Array();}});

CBCR3.namespace("CBCR3.ArtistTrackList.Modules");CBCR3.ArtistTrackList.Modules.TrackInfoPanel=Class.create({trackInfo:null,panelElement:null,loadingClip:null,initialize:function()
{},isLoaded:function()
{return(this.trackInfo!=null);},create:function()
{this.panelElement=new Element("div",{className:"trackInfo"});return this.panelElement;},load:function(trackInfo)
{this.trackInfo=trackInfo;this.hideLoading();this.panelElement.update(this.getTemplate().evaluate({thumbnail:trackInfo.thumbnail,title:trackInfo.title,format:trackInfo.format,label:trackInfo.label,recordingDate:trackInfo.recordingDate.strftime("%B %Y"),subGenre:trackInfo.subGenre}));},formatDate:function(date)
{},show:function()
{this.panelElement.show();},hide:function()
{this.panelElement.hide();},getTemplate:function()
{return new Template("<div class='thumbnail'>"+"<img src='#{thumbnail}' alt='' />"+"</div>"+"<div class='details miniText'>"+"<h4>#{title}</h4>"+"<div><label>FORMAT</label> #{format}</div>"+"<div><label>RECORDING DATE</label> #{recordingDate}</div>"+"<div><label>SUBGENRE</label> #{subGenre}</div>"+"<div><label>LABEL</label> #{label}</div>"+"</div>");},showLoading:function()
{if(this.loadingClip)
return;this.loadingClip=new Element("div",{className:"loading"}).update("loading...");this.loadingClip.setOpacity(0.6);this.panelElement.insert({bottom:this.loadingClip});},hideLoading:function()
{if(!this.loadingClip)
return;this.loadingClip.remove();this.loadingClip=null;}});

CBCR3.namespace("CBCR3.ArtistTrackList.Modules");CBCR3.ArtistTrackList.Modules.InfoButton=Class.create(CBCR3.Commons.EventDispatcher,{buttonElement:null,isOpen:null,initialize:function($super,buttonElement)
{$super();this.buttonElement=buttonElement;this.buttonElement.observe("click",this.buttonElement_Click.bind(this));},buttonElement_Click:function(event)
{if(this.isOpen)
this.close();else
this.open();},open:function()
{this.showOpen();this.dispatchEvent(CBCR3.ArtistTrackList.TrackItemEvent.open);this.isOpen=true;},close:function()
{this.showClosed();this.dispatchEvent(CBCR3.ArtistTrackList.TrackItemEvent.close);this.isOpen=false;},showOpen:function()
{this.buttonElement.addClassName("selected");},showClosed:function()
{this.buttonElement.removeClassName("selected");}});

CBCR3.namespace("CBCR3.ArtistTrackList.Modules");CBCR3.ArtistTrackList.Modules.TrackItem=Class.create(CBCR3.Commons.EventDispatcher,{element:null,trackInfoPanel:null,trackPermalink:null,fadeEffect:null,playCount:null,optionsButton:null,initialize:function($super,element){$super();this.element=element;},appendPanel:function(){this.element.insert({bottom:this.trackInfoPanel.create()});}});

CBCR3.namespace("CBCR3.SocialLinkPanel.Events");CBCR3.SocialLinkPanel.MessageType={success:"success",error:"error",loading:"loading"};CBCR3.SocialLinkPanel.Events.ServiceEvent={shortenedUrlReceived:"shortenedUrlReceived",emailSent:"emailSent"};CBCR3.SocialLinkPanel.Events.ServiceErrorEvent={emailError:"emailError"};

CBCR3.namespace("CBCR3.SocialLinkPanel");CBCR3.namespace("CBCR3.SocialLinkPanel.Services");CBCR3.SocialLinkPanel.Services.SocialLinkService=Class.create(CBCR3.Commons.EventDispatcher,{initialize:function($super){$super();},getShareInfo:function(permalink){CBC.Radio3.Publishing.WebServices.SocialWebService.GetShareLink(permalink,this.onShareInfoSuccess.bind(this),this.onShareInfoFailure.bind(this));},getSearchlightShareInfo:function(permalink,searchlightLink){CBC.Radio3.Publishing.WebServices.SocialWebService.GetSearchlightShareLink(permalink,searchlightLink,this.onShareInfoSuccess.bind(this),this.onShareInfoFailure.bind(this));},onShareInfoSuccess:function(response){this.dispatchEvent("shareInfo:received",this.mapShareDTO(response));},onShareInfoFailure:function(response){this.dispatchEvent("shareInfo:failure",{message:"Error in SocialWebService"});},mapShareDTO:function(data){var shareDto=data.ShareLinkDto;return{author:shareDto.Author,title:shareDto.Title,permalink:shareDto.Permalink,imageUrl:shareDto.ImageUrl,url:data.ShortenedUrl};},shortenUrl:function(permalink){CBC.Radio3.Web.WebServices.PermalinkWebService.ShortenUrl(permalink,this.onUrlShortenedSuccess.bind(this),this.onShortenUrlFailure.bind(this));},onUrlShortenedSuccess:function(response){this.dispatchEvent(CBCR3.SocialLinkPanel.Events.ServiceEvent.shortenedUrlReceived,{url:response});},onShortenUrlFailure:function(reponse){alert("could not shorten url");},sendEmail:function(senderName,email,message,permalink,permalinkTitle){CBC.Radio3.Web.WebServices.PermalinkWebService.SendEmail(senderName,email,message,permalink,permalinkTitle,this.onSendEmailSuccess.bind(this),this.onSendEmailFailure.bind(this));},onSendEmailSuccess:function(respose){this.dispatchEvent(CBCR3.SocialLinkPanel.Events.ServiceEvent.emailSent,null);},onSendEmailFailure:function(response){this.dispatchEvent(CBCR3.SocialLinkPanel.Events.ServiceErrorEvent.emailError,{message:response.get_message()});}});

CBCR3.namespace("CBCR3.SocialLinkPanel.Controls");CBCR3.SocialLinkPanel.Controls.ModulePanel=Class.create({panel:null,modulePanel:null,permalink:"",shortLink:"",title:"",initialize:function()
{this.panel=new Element("div",{id:"postPanel",className:"social_links"}).update(this.getTemplate().evaluate({}));this.modulePanel=this.panel.down(".socialNetworkModules");},create:function()
{return this.panel;},setLinks:function(permalink,shortLink,title)
{this.permalink=permalink;this.shortLink=shortLink;this.title=title;},addModules:function(moduleCollection)
{this.modulePanel.update();moduleCollection.each(this.addModule.bind(this));this.modulePanel.appendChild(new Element("div",{className:"clear"}).update("&nbsp;"));},addModule:function(module)
{this.modulePanel.insert({bottom:module.render(this.permalink,this.shortLink,this.title)});},getTemplate:function()
{var markup="<div class='socialNetworkModules'></div><div class='socialNetworkNotes'><span>NOTES</span>If you are not logged in to Facebook or Twitter, a window will open allowing you to sign in and post this link.</div>";return new Template(markup);}});

CBCR3.namespace("CBCR3.SocialLinkPanel.Modules");CBCR3.SocialLinkPanel.Modules.SocialNetworkModuleBase=Class.create({urlTemplate:null,cssClass:null,initialize:function(urlTemplate,cssClass)
{this.urlTemplate=urlTemplate;this.cssClass=cssClass;},render:function(url,title)
{throw"Render method must be overridden by subclass";},createElement:function(url,title)
{var hyperlink=new Template(this.urlTemplate).evaluate({url:url,title:encodeURIComponent(title)});return new this.getTemplate().evaluate({hyperlink:hyperlink,cssClass:this.cssClass});},getTemplate:function()
{return new Template("<a class='imageButton socialLinkStamp #{cssClass}' href='#{hyperlink}' target='_blank'>Post to a Social Network</a><br />");}});

CBCR3.namespace("CBCR3.SocialLinkPanel.Modules");CBCR3.SocialLinkPanel.Modules.DeliciousModule=Class.create(CBCR3.SocialLinkPanel.Modules.SocialNetworkModuleBase,{initialize:function($super)
{$super("http://delicious.com/post?v=5&amp;jump=close&amp;url=#{url}&amp;title=#{title}","delicious");},render:function(permalink,shortLink,title)
{return this.createElement(permalink,title);}});

CBCR3.namespace("CBCR3.SocialLinkPanel.Modules");CBCR3.SocialLinkPanel.Modules.TwitterModule=Class.create(CBCR3.SocialLinkPanel.Modules.SocialNetworkModuleBase,{initialize:function($super){$super("https://twitter.com/intent/tweet?url=#{url}","twitter");},render:function(permalink,shortLink,title){var apostropheRegEx=new RegExp("'","g");var prefaceTxt="Check out ";var isVideos=permalink.indexOf("/videos/");var isPlay=permalink.indexOf("/play/");if(isVideos>-1){prefaceTxt="Watch ";}else if(isPlay>-1){prefaceTxt="Listen to ";}
title=prefaceTxt+title;title=encodeURIComponent(title.truncate(80)).replace(apostropheRegEx,"&#39;");var encodedLink=encodeURIComponent(shortLink);return this.createElement(encodedLink+"&via=cbcmusic&text="+title);}});

CBCR3.namespace("CBCR3.Publishing.Modules");function initFacebookModule(){CBCR3.Publishing.Modules.FacebookModuleTasks.fbModuleInstance();};var _fbModuleInstance;var _subscribeToLogin=false;CBCR3.Publishing.Modules.FacebookModuleTasks={fbModuleInstance:function(){if(!_fbModuleInstance)
_fbModuleInstance=new CBCR3.Publishing.Modules.FacebookModule();return _fbModuleInstance;},subscribeLogin:function(value)
{_subscribeToLogin=value;}};CBCR3.Publishing.Modules.FacebookModule=Class.create(CBCR3.Commons.EventDispatcher,{_callbackFunction:null,_facebookPost:null,_loginCallback:null,_accessToken:null,_authResponse:null,status:"unknown",initialize:function($super){try{$super();}catch(e){Trace.error(e);}},fbInit:function(){try{if(typeof CBCMusicConfig=='undefined'||CBCMusicConfig==null)
return;FB.init({appId:CBCMusicConfig.facebookApiKey,channelUrl:window.location.protocol+'//'+window.location.hostname+'/channel.html',version:CBCMusicConfig.facebookApiVersion,status:true,cookie:true,xfbml:true});if(_subscribeToLogin)
FB.Event.subscribe('auth.statusChange',CBCR3.Publishing.Modules.FacebookModuleTasks.fbModuleInstance().checkLoginStatus.bind(CBCR3.Publishing.Modules.FacebookModuleTasks.fbModuleInstance()));}catch(e){Trace.write("ERROR fbInit()",true);Trace.error(e);}},subscribeToLoginEvent:function(){FB.Event.subscribe('auth.statusChange',this.checkLoginStatus.bind(this));},authUser:function(){if(this._authResponse){var form=new Element("form",{action:"/loginfacebook.aspx",method:"post"});form.insert(new Element("input",{type:"hidden",name:"signed_request",value:this._authResponse.signedRequest}));document.body.appendChild(form);form.submit();}},userDisconnectHandler:function(event){this.dispatchEvent(CBCR3.Social.Events.SocialEvent.disconnected,{type:"facebook"});},getUserInfo:function(me){var userName="";var userLink="";if(me.name){userName=me.username;userLink=me.link;}
this.dispatchEvent(CBCR3.Social.Events.SocialEvent.authorized,{type:"facebook",username:userName,link:userLink});},checkLoginStatus:function(response){try{Trace.write("Facebook status: "+response.status,true);if(response.authResponse){this._authResponse=response.authResponse;this._accessToken=response.authResponse.accessToken;FB.api('/me',this.getUserInfo.bind(this));}else{}
if(response&&response.status)
this.status=response.status;}catch(e){Trace.error(e);}},connect:function(){},disconnect:function(){FB.logout(this.userDisconnectHandler.bind(this));}});window.fbAsyncInit=CBCR3.Publishing.Modules.FacebookModuleTasks.fbModuleInstance().fbInit;

CBCR3.namespace("CBCR3.SocialLinkPanel.Controls");CBCR3.SocialLinkPanel.Controls.FriendEmailer=Class.create({panel:null,submitButton:null,nameInput:null,emailInput:null,messageInput:null,feedbackMessage:null,permalink:"",title:"",permalinkService:null,initialize:function(permalinkService){this.permalinkService=permalinkService;this.permalinkService.addEventListener(CBCR3.SocialLinkPanel.Events.ServiceEvent.emailSent,this.onEmailSent.bind(this))
this.permalinkService.addEventListener(CBCR3.SocialLinkPanel.Events.ServiceErrorEvent.emailError,this.onEmailError.bind(this))},setLinks:function(permalink,title){this.permalink=permalink;this.title=title;},create:function(){this.panel=new Element("div",{id:"emailPanel",className:"emailAFriend"}).update(this.getTemplate().evaluate({}));var nInput=this.panel.down("input[name='mailerNameInput']");this.nameInput=new CBCR3.Commons.Controls.InputPlaceHolder(nInput,"Enter your name...",{placeHolderColor:"#666666"});var eInput=this.panel.down("input[name='mailerEmailInput']");this.emailInput=new CBCR3.Commons.Controls.InputPlaceHolder(eInput,"Enter your friend's email...",{placeHolderColor:"#666666"});var mInput=this.panel.down("textarea[name='mailerMessageInput']");this.messageInput=new CBCR3.Commons.Controls.InputPlaceHolder(mInput,"Add a message (optional)...",{placeHolderColor:"#666666"});this.submitButton=this.panel.down(".sendEmailButton");this.submitButton.observe("click",this.onSubmitEmail_Click.bind(this));this.feedbackMessage=this.panel.down(".feedbackMessage");return this.panel;},onSubmitEmail_Click:function(event){this.attemptSendEmail();},attemptSendEmail:function(){if(!this.nameInput.hasValue()){this.addMessage("Please enter your name",CBCR3.SocialLinkPanel.MessageType.error);return;}
if(!this.emailInput.hasValue()){this.addMessage("Please enter an email address",CBCR3.SocialLinkPanel.MessageType.error);return;}
this.disableButton();this.addMessage("Sending...",CBCR3.SocialLinkPanel.MessageType.loading);this.permalinkService.sendEmail(this.nameInput.getValue(),this.emailInput.getValue(),this.messageInput.getValue(),this.permalink,this.title);},addMessage:function(message,type){var content=new Element("div",{className:type}).update(message);this.feedbackMessage.update(content);},onEmailSent:function(event){this.addMessage("Email successfully sent",CBCR3.SocialLinkPanel.MessageType.success);this.enableButton();this.resetForm();},onEmailError:function(event){this.addMessage("Error: "+event.data.message,CBCR3.SocialLinkPanel.MessageType.error);this.enableButton();},disableButton:function(){this.submitButton.addClassName("disabled");this.submitButton.setAttribute("disabled","disabled");},enableButton:function(){this.submitButton.removeClassName("disabled");this.submitButton.removeAttribute("disabled");},resetForm:function(){this.nameInput.reset();this.emailInput.reset();this.messageInput.reset();},getTemplate:function(){var markup="<input type='text' id='fromName' name='mailerNameInput' title=\"Enter your name here...\" />"+"<input type='text' id='fromEmail' name='mailerEmailInput' title=\"Enter the recipient&#39;s email address...\" />"+"<textarea name='mailerMessageInput' title='Add a short message (optional)...' cols='3' rows='5'></textarea>"+"<div id='sendEmail'>"+"<div class='feedbackMessage'></div>"+"<div class='defaultButton'><span>NOTE</span> Your friend&#39;s email address will never be shared with anyone.</div>"+"</div>"+"<div class='defaultButton'><button type='button' class='sendEmailButton yellowButton right'>SEND</button>";return new Template(markup);}});

CBCR3.namespace("CBCR3.SocialLinkPanel.Controls");CBCR3.SocialLinkPanel.Controls.LinkField=Class.create({item:null,initialValue:null,labelText:null,input:null,buttonContainer:null,swfCopyButton:null,initialize:function(initialValue,labelText){this.initialValue=initialValue||"";this.labelText=labelText||"";},create:function(){if(this.labelText=="Permalink"){this.item=new Element("div",{id:"copyPanelTop",className:"permalinkField_top"});}else{this.item=new Element("div",{id:"copyPanelBottom",className:"permalinkField"});};this.item.update(this.getTemplate().evaluate({inputValue:this.initialValue,labelText:this.labelText}));this.input=this.item.down("input");this.input.observe("click",this.input_Click.bind(this));this.buttonContainer=this.item.down(".swfCopyButton");this.buttonContainer.identify();return this.item;},createButton:function(){this.swfCopyButton=new CBCR3.SocialLinkPanel.Controls.SwfCopyButton(this.buttonContainer,this.initialValue);},setSwf:function(){this.swfCopyButton.renderSwf();},input_Click:function(event){this.hightlightInput();},hightlightInput:function(){this.input.focus();this.input.select();},getTemplate:function(){var markup="<label>#{labelText}:</label>"+"<input type='text' value='#{inputValue}' readonly='readonly' />"+"<div class='swfCopyButton'>Copy</div>";return new Template(markup);}});

CBCR3.namespace("CBCR3.SocialLinkPanel.Controls");CBCR3.SocialLinkPanel.Controls.SwfCopyButton=Class.create({container:null,swfId:null,swfBox:null,swfObject:null,copyText:"",count:0,initialize:function(container,copyText){this.container=$(container);this.copyText=copyText;this.embedSwf();Event.observe(window,"scroll",this.onWindowScroll.bind(this));},swf:function(){if(!this.swfObject)
this.swfObject=$(this.swfId);return this.swfObject;},embedSwf:function(){try{Trace.write("In EMBEDSwf()",true);this.swfId=this.container.id+"_swf";this.swfBox=new Element("div",{id:this.container.id+"_swfBox"});this.container.update(this.swfBox);}catch(errr){Trace.error(errr);}},renderSwf:function(){var flashVars={copyText:this.copyText};var params={menu:'false',allowScriptAccess:'always',wmode:"transparent"};var attributes={id:this.swfId};if(swfobject!=null||swfBox.id!=null){swfobject.embedSWF(CBCR3.Application.Config.applicationPath+"/lib/cbcmusic/js/sociallinkpanel/flash/clipboard.swf",this.swfBox.id,"62","32","10.0.0",null,flashVars,params,attributes);}},onWindowScroll:function(event){if(Prototype.Browser.Gecko)
{this.container.addClassName("fix");this.refresh.bind(this).delay(0.3);}},refresh:function(){this.container.removeClassName("fix");}});

CBCR3.namespace("CBCR3.SocialLinkPanel");var _socialLinkPanelInstance;CBCR3.SocialLinkPanel.SocialLinkPanelTasks={launchPanel:function(permalink,title,type,opts){if(!_socialLinkPanelInstance){var moduleCollection=[new CBCR3.SocialLinkPanel.Modules.FacebookModule(),new CBCR3.SocialLinkPanel.Modules.TwitterModule()];_socialLinkPanelInstance=new CBCR3.SocialLinkPanel.SocialLinkPanel(new CBCR3.SocialLinkPanel.Services.SocialLinkService(),moduleCollection);}
if(type!=null&&!type.empty()){if(type=="contest")
_socialLinkPanelInstance.openContest(permalink,title);else
_socialLinkPanelInstance.openShare(permalink,title,type);}else
_socialLinkPanelInstance.open(permalink,title,opts);},getInstance:function(){return _socialLinkPanelInstance;}};CBCR3.SocialLinkPanel.SocialLinkPanel=Class.create({panel:null,panelContent:null,contentDiv:null,modal:null,debug:false,permalinkField:null,shortenedLinkField:null,linkField:null,permalinkService:null,moduleCollection:[],modulePanel:null,permalink:"",shortenedLink:"",opts:{},title:"",author:"",imageUrl:"",friendEmailer:null,directLink:false,tabsArray:new Array('postTab','emailTab','copyTab'),panelsArray:new Array('postPanel','emailPanel','copyPanel'),isSearchlight:false,initialize:function(socialService,moduleCollection){this.socialService=socialService;this.socialService.addEventListener("shareInfo:received",this.onShareInfoReceived.bind(this));this.moduleCollection=moduleCollection;},getShareInfo:function(){var div=new Element("div");var imageDiv=(this.imageUrl)?'<div class="sharingImage"><a href="'+this.permalink+'" title="'+this.title+'" alt="'+this.title+'"><img width="140" height="80" border="0" alt="'+this.title+'" class="rounded-all" src="'+this.imageUrl+'" /></a></div >':'';var infoStyle=(imageDiv=='')?'':'height:80px;width:200px;';var infoDiv='<div class="sharingContent" style="'+infoStyle+'"><a href="'+this.permalink+'" title="'+this.title+'">'+this.title+'</a>'+((this.author!="")?'<span> by '+this.author+'</span>':'')+'</div>';div.update('<div id="sharingInfo">'+imageDiv+infoDiv+'</div>');return div;},getTabs:function(){var tab=new Element("ul");tab.update("<li id='postTab'><a>POST LINK</a></li><li id='emailTab'><a>EMAIL LINK</a></li><li id='copyTab'><a>COPY LINK</a></li>");return tab;},getLinks:function(){var links=new Element("div",{id:"linksPanel",className:""});this.permalinkField=new CBCR3.SocialLinkPanel.Controls.LinkField(this.composeUrl(this.permalink),"Permalink");this.shortenedLinkField=new CBCR3.SocialLinkPanel.Controls.LinkField(this.shortenedLink,"Shortened Link");var permalinkField=this.permalinkField.create();var shortLinkField=this.shortenedLinkField.create();this.permalinkField.createButton();this.shortenedLinkField.createButton();links.update(permalinkField+shortLinkField);return links;},openShare:function(permalink,title,type,opts){this.directLink=true;this.opts.type=type;this.permalink=permalink;this.title=title;this.socialService.getShareInfo(permalink);},openContest:function(permalink,title){try{this.directLink=false;this.panel=new Element("div",{id:"socialLinkPanel",className:"socialLinkPanel modalWindow socialLinkWindow"});this.panel.insert(this.getTemplate().evaluate());this.permalink=permalink;this.title=title;Trace.write("sociallinkpanel open Tiny.box",true);Trace.write("sociallinkpanel innerHTML: "+this.panel.innerHTML,true);this.openModal({boxId:"sociallink_modal"});var containerDiv=$("sociallink_modal");var contentDiv=containerDiv.down(".tcontent");contentDiv.update();contentDiv.update(this.panel);this.panelContent=this.panel.down(".panelContent");}catch(e){Trace.error(e);}},showContestShare:function(opts){this.shortenedLink=opts.shortened;opts.url=this.shortenedLink;this.onShareInfoReceived({data:opts});},open:function(permalink,title,opts){try{this.directLink=false;this.panel=new Element("div",{id:"socialLinkPanel",className:"socialLinkPanel modalWindow socialLinkWindow"});this.panel.insert(this.getTemplate().evaluate());this.opts=opts;this.permalink=permalink;this.title=title;if(opts.isSearchlight){this.isSearchlight=true;this.socialService.getSearchlightShareInfo(permalink,opts.searchlightLink);}else{this.socialService.getShareInfo(permalink);}
Trace.write("sociallinkpanel open Tiny.box",true);Trace.write("sociallinkpanel innerHTML: "+this.panel.innerHTML,true);this.openModal({boxId:"sociallink_modal"});var containerDiv=$("sociallink_modal");var contentDiv=containerDiv.down(".tcontent");contentDiv.update();contentDiv.update(this.panel);this.panelContent=this.panel.down(".panelContent");}catch(e){Trace.error(e);}},openModal:function(opts){var _width=opts.width||420;var _height=opts.height||400;var _boxId=opts.boxId||"cbcmusic_Modal";var _link=opts.link||this.panel;if(opts.iframe){TINY.box.show({iframe:opts.iframe,width:_width,height:_height,animate:false,close:true,opacity:75,maskopacity:75,boxid:_boxId});}else{TINY.box.show({html:_link,width:_width,height:_height,animate:false,close:true,opacity:75,maskopacity:75,boxid:_boxId});}},getLoading:function(){return"<div class=\"loading\">Loading...</div>";},onShareInfoReceived:function(event,shortLink){try{Trace.write("onShareInfoReceived() ->",this.debug);Trace.write(event,this.debug);var data=event.data;this.author=data.author;this.shortenedLink=data.url;this.permalink=data.permalink;this.title=data.title;this.imageUrl=data.imageUrl;this.summary=data.summary||"";if(this.opts!=null&&this.opts.type=="glenngould"){this.imageUrl=this.opts.imageUrl;this.permalink=this.opts.permalink;this.author="";this.title=this.opts.title;}
this.showShareInfo();}catch(e){Trace.write("ERROR: onShareInfoReceived:",this.debug);Trace.error(e);}},showShareInfo:function(){if(this.directLink){if(this.opts.type=="twitterShare"){var link=this.permalink;var prefaceTxt="Check out ";var isVideos=link.indexOf("/videos/");var isPlay=link.indexOf("/play/");if(isVideos>-1){prefaceTxt="Watch ";}else if(isPlay>-1){prefaceTxt="Listen to ";}
var shareTitle=prefaceTxt+this.title;shareTitle=encodeURIComponent(shareTitle.truncate(80)).replace(apostropheRegEx,"&#39;");this.openWindow('https://twitter.com/intent/tweet?url='+this.shortenedLink+'&via=cbcmusic&text='+shareTitle);}
if(this.opts.type=="facebookShare")
this.openWindow('http://www.facebook.com/sharer.php?s=100&p[title]='+this.title+'&p[summary]='+this.summary+'&p[url]='+this.permalink+'&p[images][0]='+this.imageUrl);}else{this.panelContent.update();this.addControls();this.embedSwfs();}},openWindow:function(link,id,opts){window.open(link,'_blank').focus();window.focus();},onShortenedUrlReceived:function(event){try{Trace.write("onShortenedUrlReceived() ->",this.debug);Trace.write(event,this.debug);this.shortenedLink=event.data.url;this.panelContent.update();this.addControls();this.embedSwfs();}catch(errr){Trace.write("ERROR: onshortenedURLreceived:",this.debug);Trace.error(errr);}},embedSwfs:function(){if(this.permalinkField)
this.permalinkField.setSwf();if(this.shortenedLink)
this.shortenedLinkField.setSwf();},composeUrl:function(url){if(url.startsWith("http://"+CBCR3.Application.Config.hostName))
return url;return"http://"+CBCR3.Application.Config.hostName+url;},addControls:function(){try{if(this.panelContent==null)
return;this.permalinkField=new CBCR3.SocialLinkPanel.Controls.LinkField(this.composeUrl(this.permalink),"Permalink");this.shortenedLinkField=new CBCR3.SocialLinkPanel.Controls.LinkField(this.shortenedLink,"Shortened Link");this.panelContent.insert({bottom:this.getShareInfo()});this.panelContent.insert({bottom:this.getTabs()});var contentPanel=new Element("div",{style:"float:left"});var copyPanel=new Element("div",{id:"copyPanel"});copyPanel.insert({bottom:this.permalinkField.create()});copyPanel.insert({bottom:this.shortenedLinkField.create()});contentPanel.insert({bottom:copyPanel});this.permalinkField.createButton();this.shortenedLinkField.createButton();this.modulePanel=new CBCR3.SocialLinkPanel.Controls.ModulePanel();this.modulePanel.setLinks(this.permalink,this.shortenedLink,this.title);this.modulePanel.addModules(this.moduleCollection);contentPanel.insert({bottom:this.modulePanel.create()});this.friendEmailer=new CBCR3.SocialLinkPanel.Controls.FriendEmailer(this.socialService);this.friendEmailer.setLinks(this.permalink,this.title);contentPanel.insert({bottom:this.friendEmailer.create()});this.panelContent.insert({bottom:contentPanel});this.bindTabs();}catch(e){Trace.write("Add Controls ERROR:",this.debug);Trace.error(e);}},bindTabs:function(){$("postTab").observe('click',this.activateTab.bind(this,"post"));$("emailTab").observe('click',this.activateTab.bind(this,"email"));$("copyTab").observe('click',this.activateTab.bind(this,"copy"));this.activateTab('post');},activateTab:function(s){this.removeSelectedTabs();var tab=s+"Tab";var panel=s+"Panel";var selectedTab=$(tab).down('a');if(selectedTab)
selectedTab.addClassName('selected');var curPanel=$(panel);if(curPanel==null)
return;curPanel.addClassName('selected');if(panel=="copyPanel"){panel=panel+"Top";$(panel).addClassName('selected');}},removeSelectedTabs:function(){this.tabsArray.each(function(tabName){var tabLink=$(tabName).down('a');if(tabLink!=null&&tabLink.hasClassName('selected'))
tabLink.removeClassName('selected');});this.panelsArray.each(function(panelName){var panel=$(panelName);if(panel!=null&&panel.hasClassName('selected'))
panel.removeClassName('selected');});},isOpen:function(){if(this.panel==undefined)
return false;return this.panel.isOpen;},hideLoading:function(){this.panel.down(".loading").remove();},createCopyInput:function(input){},onClose_Click:function(event){Event.stop(event);this.close();},getTemplate:function(){var markup="<div class='topCap'></div>"+"<div class='panelContent'>"+"<div class='loading'></div>"+"</div>"+"<div class='bottomCap'></div>"+"<div class='tclose'>close</div>";return new Template(markup);}});

CBCR3.namespace("CBCR3.Stats");CBCR3.Stats.UI={mediaTracker:null,getMediaTracker:function(){if(this.mediaTracker==null)
this.mediaTracker=new CBCR3.Stats.MediaTracker();return this.mediaTracker;}};CBCR3.Stats.MediaTracker=Class.create({STREAM_MAX_TIME:43199,playerName:"r3player",playerpage:"",streamName:"",category:null,itemMetaData:null,chapters:null,showName:null,itemURL:null,itemType:null,audioVideo:null,type:null,timePassed:0,playTimestamp:null,totalTime:null,LiveOrDemand:null,eventType:null,progressCounter:0,progressInterval:1000,lastTimeInterval:0,isPaused:false,pausedOffset:0,pausedMetaData:null,eventPlay:"PLAY",eventMid:"MID",eventPause:"PAUSE",eventClose:"CLOSE",eventNewStart:"NEWSTART",eventFinish:"FINISH",intCounter:0,initialize:function(options){;},initVars:function(options){try{this.category=options.category;this.itemMetaData=options.itemMetaData;this.streamName=options.streamName;this.playerpage=parent.getStatsPageName();this.type=options.type;this.releaseDate="";this.audioVideo=options.audioVideo;this.showName=options.showName;this.playTimestamp=options.playTimestamp;this.lastTimeInterval=0;this.chapters=options.chapters;this.itemURL=options.itemURL;this.totalTime=options.totalTime;this.LiveOrDemand=options.LiveOrDemand;Trace.write("initVars() - itemMetaData: "+this.itemMetaData);s_cbc_sitecatalyst.Media.open(this.itemMetaData,this.totalTime,this.playerpage);}catch(e){Trace.write("ERROR in InitVars uistats.js:"+e,true);Trace.error(e);}},sendInfo:function(options){this.intCounter++;Trace.write("uistats.js -> sendInfo()",true);try{s_cbc_sitecatalyst.Media.trackVars="events,products,prop44,prop45,prop46,prop47,prop48,prop49,prop50,eVar23,eVar24,eVar29,eVar39,eVar43,eVar44,eVar45,eVar46,eVar47,eVar48,eVar49,eVar50";this.setTrackerType(options.eventType);s_cbc_sitecatalyst.products=";;;;event33="+options.timePassed;s_cbc_sitecatalyst.pageName=parent.getStatsPageName();s_cbc_sitecatalyst.prop44=this.streamName;s_cbc_sitecatalyst.prop45=this.category;s_cbc_sitecatalyst.prop46=this.playTimestamp;s_cbc_sitecatalyst.prop47=this.audioVideo;s_cbc_sitecatalyst.prop48=this.LiveOrDemand;s_cbc_sitecatalyst.prop49=this.itemMetaData;s_cbc_sitecatalyst.prop50=this.type;s_cbc_sitecatalyst.eVar23=parent.getStatsPageName();s_cbc_sitecatalyst.eVar24=this.showName;s_cbc_sitecatalyst.eVar29=this.type;s_cbc_sitecatalyst.eVar39="+1";s_cbc_sitecatalyst.eVar43=this.releaseDate;s_cbc_sitecatalyst.eVar44=this.streamName;s_cbc_sitecatalyst.eVar45=this.category;s_cbc_sitecatalyst.eVar46=this.playTimestamp;s_cbc_sitecatalyst.eVar47=this.audioVideo;s_cbc_sitecatalyst.eVar48=this.LiveOrDemand;s_cbc_sitecatalyst.eVar49=this.chapters;s_cbc_sitecatalyst.eVar50=this.totalTime;}catch(e){Trace.write("Error in uistats.js sendInfo() (initialize vars) - "+e,true);Trace.error(e);}
try{if(options.eventType==this.eventPlay){Trace.write("^^^ EVENT Play Event ^*^*: "+this.intCounter,true);s_cbc_sitecatalyst.Media.play(this.itemMetaData,options.timeOffset);this.isPaused=false;}
if(options.eventType==this.eventMid){Trace.write("^^^ EVENT Mid Event ^*^*: "+this.intCounter);s_cbc_sitecatalyst.Media.track(this.itemMetaData,options.timeOffset);}
if(options.eventType==this.eventPause){Trace.write("^^^ EVENT Pause Event ^*^*: "+this.intCounter);this.isPaused=true;this.pausedOffset=options.timeOffset;this.pausedMetaData=this.itemMetaData;Trace.write("### EVENT timePassed: "+options.timePassed);s_cbc_sitecatalyst.Media.stop(this.itemMetaData,options.timeOffset);}
if(options.eventType==this.eventNewStart){if(this.isPaused)
s_cbc_sitecatalyst.Media.stop(this.pausedMetaData,this.pausedOffset);s_cbc_sitecatalyst.Media.track(this.pausedMetaData,this.pausedOffset);this.pausedMetaData=null;this.pausedOffset=0;}
if(options.eventType==this.eventClose){Trace.write("^^^ EVENT Close Event ^*^*: "+this.intCounter);Trace.write("^^^ timeOffset: "+options.timeOffset);s_cbc_sitecatalyst.Media.stop(this.itemMetaData,options.timeOffset);s_cbc_sitecatalyst.Media.close(this.itemMetaData);}}catch(e){Trace.write("Error in uistats.js sendInfo() eventCalls - options:"+options+" error:"+e,true);Trace.error(e);}},resetProgress:function(){this.progressCounter=0;},getProgressTime:function(thisTimeOffset){if(this.isPaused)
return;Trace.write("thisTimeOffset:"+thisTimeOffset+" lastTimeInterval:"+this.lastTimeInterval);var retValue=thisTimeOffset-this.lastTimeInterval;this.lastTimeInterval=thisTimeOffset;return retValue;},setTrackerType:function(type){switch(type){case this.eventPlay:this.setTrackingEvents("event30,event31,event33");break;case this.eventMid:this.setTrackingEvents("event33");break;case this.eventPause:this.setTrackingEvents("event33");break;case this.eventNewStart:this.setTrackingEvents("event33");break;case this.eventClose:this.setTrackingEvents("event32,event33");break;default:break;}},setTrackingEvents:function(strEvents){Trace.write("^^^ setTrackingEvents: "+strEvents);s_cbc_sitecatalyst.Media.trackEvents=strEvents;s_cbc_sitecatalyst.events=strEvents;}});

var clientOsName="os";var clientOsVersion="osVersion";(function(){"use strict";var device=null;var deviceTypes=['tv','tablet','mobile','desktop'];var _clientDetectInit=function(){device={type:'',model:'',os:'',osVersion:'',osVersionFull:'',userAgent:(navigator.userAgent||navigator.vendor||window.opera).toLowerCase()};initVars();};var test=function(regex){if(device!=null&&device.userAgent!=null)
return regex.test(device.userAgent);return false;};var exec=function(regex){return regex.exec(device.userAgent);};var is=function(key){return device.userAgent.indexOf(key)>-1;};var initVars=function(){if(test(/GoogleTV|SmartTV|Internet.TV|NetCast|NETTV|AppleTV|boxee|Kylo|Roku|DLNADOC|CE\-HTML/i)){device.type=deviceTypes[0];device.model='smartTv';}else if(test(/Xbox|PLAYSTATION.3|Wii/i)){device.type=deviceTypes[0];device.model='gameConsole';}else if(test(/iP(a|ro)d/i)){device.type=deviceTypes[1];device.model='ipad';}else if((test(/tablet/i)&&!test(/RX-34/i))||test(/FOLIO/i)){device.type=deviceTypes[1];device.model=String(exec(/playbook/));}else if(test(/Linux/i)&&test(/Android/i)&&!test(/Fennec|mobi|HTC.Magic|HTCX06HT|Nexus.One|SC-02B|fone.945/i)){device.type=deviceTypes[1];device.model='android';}else if(test(/Kindle/i)||(test(/Mac.OS/i)&&test(/Silk/i))){device.type=deviceTypes[1];device.model='kindle';}else if(test(/GT-P10|SC-01C|SHW-M180S|SGH-T849|SCH-I800|SHW-M180L|SPH-P100|SGH-I987|zt180|HTC(.Flyer|\_Flyer)|Sprint.ATP51|ViewPad7|pandigital(sprnova|nova)|Ideos.S7|Dell.Streak.7|Advent.Vega|A101IT|A70BHT|MID7015|Next2|nook/i)||(test(/MB511/i)&&test(/RUTEM/i))){device.type=deviceTypes[1];device.model='android';}else if(test(/BB10/i)){device.type=deviceTypes[1];device.model='blackberry';}else{device.model=exec(/iphone|ipod|android|blackberry|opera mini|opera mobi|skyfire|maemo|windows phone|palm|iemobile|symbian|symbianos|fennec|j2me/i);if(device.model!==null){device.type=deviceTypes[2];device.model=String(device.model);}else{device.model='';if(test(/BOLT|Fennec|Iris|Maemo|Minimo|Mobi|mowser|NetFront|Novarra|Prism|RX-34|Skyfire|Tear|XV6875|XV6975|Google.Wireless.Transcoder/i)){device.type=deviceTypes[2];}else if(test(/Opera/i)&&test(/Windows.NT.5/i)&&test(/HTC|Xda|Mini|Vario|SAMSUNG\-GT\-i8000|SAMSUNG\-SGH\-i9/i)){device.type=deviceTypes[2];}else if((test(/Windows.(NT|XP|ME|9)/i)&&!test(/Phone/i))||test(/Win(9|.9|NT)/i)||test(/\(Windows 8\)/i)){device.type=deviceTypes[3];}else if(test(/Macintosh|PowerPC/i)&&!test(/Silk/i)){device.type=deviceTypes[3];}else if(test(/Linux/i)&&test(/X11/i)){device.type=deviceTypes[3];}else if(test(/Solaris|SunOS|BSD/i)){device.type=deviceTypes[3];}else if(test(/Bot|Crawler|Spider|Yahoo|ia_archiver|Covario-IDS|findlinks|DataparkSearch|larbin|Mediapartners-Google|NG-Search|Snappy|Teoma|Jeeves|TinEye/i)&&!test(/Mobile/i)){device.type=deviceTypes[3];device.model='crawler';}else{device.type=deviceTypes[2];}}}
if(device.model!==''){if(device.model==='ipad'||device.model==='iphone'||device.model==='ipod'){device.osVersion=(test(/os\s(\d+)_/)?RegExp.$1:'');device.os='ios';device.osVersionFull=(test(/os ([^\s]+)/)?RegExp.$1.replace(/_/g,'.'):'');}else if(device.model==='android'){device.osVersion=(test(/os\s(\d+)_/)?RegExp.$1:'').substr(0,2);if(!device.osVersion){device.osVersion=(test(/android\s(\d+)\./)?RegExp.$1:'');device.osVersionFull=(test(/android ([^\s]+)/)?RegExp.$1.replace(/_/g,'.'):'');}
device.os='android';}else if(device.model==='blackberry'){device.osVersion=(test(/version\/([^\s]+)/)?RegExp.$1:'');device.os='blackberry';}else if(device.model==='playbook'){device.osVersion=(test(/os ([^\s]+)/)?RegExp.$1.replace(';',''):'');device.os='blackberry';}}
if(device.os===''){if(is('win')||is('16bit')){device.os='windows';if(is('windows nt 6.3')){device.osVersion='8';device.osVersionFull='8.1';}else if(is('windows nt 6.2')||test(/\(windows 8\)/)){device.osVersion='8';}else if(is('windows nt 6.1')){device.osVersion='7';}else if(is('windows nt 6.0')){device.osVersion='vista';}else if(is('windows nt 5.2')||is('windows nt 5.1')||is('windows xp')){device.osVersion='xp';}else if(is('windows nt 5.0')||is('windows 2000')){device.osVersion='2k';}else if(is('winnt')||is('windows nt')){device.osVersion='nt';}else if(is('win98')||is('windows 98')){device.osVersion='98';}else if(is('win95')||is('windows 95')){device.osVersion='95';}}else if(is('mac')||is('darwin')){device.os='mac';if(is('68k')||is('68000')){device.osVersion='68k';}else if(is('ppc')||is('powerpc')){device.osVersion='ppc';}else if(is('os x')){device.osVersion='os x';}}else if(is('webtv')){device.os='webtv';}else if(is('x11')||is('inux')){device.os='linux';}else if(is('sunos')){device.os='sun';}else if(is('irix')){device.os='irix';}else if(is('freebsd')){device.os='freebsd';}else if(is('bsd')){device.os='bsd';}}
if(device.os!==''){if(!device.osVersionFull&&!!device.osVersion){device.osVersionFull=device.osVersion;}}
if(device!=null){clientOsName=device.os;clientOsVersion=device.osVersion;}};_clientDetectInit();})();

var s_cbc_sitecatalyst=s_gi(CBCMusicConfig.siteCatalystAccount);var s_cbc_sitecatalyst_init=function(s){s.charSet="UTF-8"
s.currencyCode="USD"
s.trackDownloadLinks=true
s.trackExternalLinks=false
s.trackInlineStats=false
s.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx"
s.linkInternalFilters="javascript:,music.cbc.ca,stage.music.cbc.ca"
s.linkLeaveQueryString=false
s.linkTrackVars="None"
s.linkTrackEvents="None"
s.dstStart="03/09/2014";s.dstEnd="11/02/2014";s.currentYear="2014";s.formList=""
s.trackFormList=true
s.trackPageName=true
s.useCommerce=false
s.varUsed="prop19"
s.eventList=""
s.usePlugins=true
function s_cbc_sitecatalyst_doPlugins(sc_obj){if(!sc_obj.campaign)
sc_obj.campaign=sc_obj.getQueryParam('cmp')
sc_obj.campaign=sc_obj.getValOnce(sc_obj.campaign,'s_campaign',0)
if(sc_obj.prop7){sc_obj.prop7=sc_obj.prop7.toLowerCase();sc_obj.eVar7="D=c7";var t_search=sc_obj.getValOnce(sc_obj.eVar7,'ev7',0);if(t_search){sc_obj.events=sc_obj.apl(sc_obj.events,"event1",",",2);}}
sc_obj.setupFormAnalysis();sc_obj.hbx_lt="auto"
sc_obj.events=sc_obj.apl(sc_obj.events,'event2',',',2)
if(!sc_obj.prop9&&!sc_obj.eVar9)sc_obj.prop9=sc_obj.eVar9=sc_obj.getTimeParting('d','-5');if(!sc_obj.prop10&&!sc_obj.eVar10)sc_obj.prop10=sc_obj.eVar10=sc_obj.getTimeParting('w','-5');sc_obj.prop16=sc_obj.getNewRepeat(365,'s_nr2');if(sc_obj.pageName&&!sc_obj.eVar11)sc_obj.eVar11="D=pageName";if(sc_obj.channel&&!sc_obj.eVar12)sc_obj.eVar12="D=ch";if(sc_obj.prop1&&!sc_obj.eVar1)sc_obj.eVar1="D=c1";if(sc_obj.prop2&&!sc_obj.eVar2)sc_obj.eVar2="D=c2";if(sc_obj.prop3&&!sc_obj.eVar3)sc_obj.eVar3="D=c3";if(sc_obj.prop4&&!sc_obj.eVar4)sc_obj.eVar4="D=c4";if(sc_obj.prop5&&!sc_obj.eVar5)sc_obj.eVar5="D=c5";if(sc_obj.prop6&&!sc_obj.eVar6)sc_obj.eVar6="D=c6";if(sc_obj.prop7&&!sc_obj.eVar7)sc_obj.eVar7="D=c7";if(sc_obj.prop9&&!sc_obj.eVar9)sc_obj.eVar9="D=c9";if(sc_obj.prop10&&!sc_obj.eVar10)sc_obj.eVar10="D=c10";if(sc_obj.prop16&&!sc_obj.eVar16)sc_obj.eVar16="D=c16";if(sc_obj.prop17&&!sc_obj.eVar17)sc_obj.eVar17="D=c17";if(sc_obj.prop18&&!sc_obj.eVar18)sc_obj.eVar18="D=c18";if(sc_obj.purchaseID&&!sc_obj.eVar19)sc_obj.eVar19=sc_obj.purchaseID;if(sc_obj.prop20&&!sc_obj.eVar20)sc_obj.eVar20="D=c20";if(sc_obj.prop25&&!sc_obj.eVar25)sc_obj.eVar25="D=c25";if(sc_obj.prop26&&!sc_obj.eVar26)sc_obj.eVar26="D=c26";if(sc_obj.prop27&&!sc_obj.eVar27)sc_obj.eVar27="D=c27";if(sc_obj.prop28&&!sc_obj.eVar28)sc_obj.eVar28="D=c28";if(sc_obj.prop29&&!sc_obj.eVar29)sc_obj.eVar29="D=c29";if(sc_obj.prop30&&!sc_obj.eVar30)sc_obj.eVar30="D=c30";if(sc_obj.prop31&&!sc_obj.eVar31)sc_obj.eVar31="D=c31";if(sc_obj.prop32&&!sc_obj.eVar32)sc_obj.eVar32="D=c32";if(sc_obj.prop33&&!sc_obj.eVar33)sc_obj.eVar33="D=c33";if(sc_obj.prop34&&!sc_obj.eVar34)sc_obj.eVar34="D=c34";if(sc_obj.prop35&&!sc_obj.eVar35)sc_obj.eVar35="D=c35";if(sc_obj.prop36&&!sc_obj.eVar36)sc_obj.eVar36="D=c36";if(sc_obj.prop60&&!sc_obj.eVar60)sc_obj.eVar60="D=c60";if(sc_obj.prop61&&!sc_obj.eVar61)sc_obj.eVar61="D=c61";if(sc_obj.prop62&&!sc_obj.eVar62)sc_obj.eVar62="D=c62";if(sc_obj.prop63&&!sc_obj.eVar63)sc_obj.eVar63="D=c63";if(sc_obj.prop64&&!sc_obj.eVar64)sc_obj.eVar64="D=c64";}
s.doPlugins=s_cbc_sitecatalyst_doPlugins
if(!s.__ccucr){s.c_rr=s.c_r;s.__ccucr=true;s.c_r=new Function("k",""
+"var s=this,d=new Date,v=s.c_rr(k),c=s.c_rr('s_pers'),i,m,e;if(v)ret"
+"urn v;k=s.ape(k);i=c.indexOf(' '+k+'=');c=i<0?s.c_rr('s_sess'):c;i="
+"c.indexOf(' '+k+'=');m=i<0?i:c.indexOf('|',i);e=i<0?i:c.indexOf(';'"
+",i);m=m>0?m:e;v=i<0?'':s.epa(c.substring(i+2+k.length,m<0?c.length:"
+"m));if(m>0&&m!=e)if(parseInt(c.substring(m+1,e<0?c.length:e))<d.get"
+"Time()){d.setTime(d.getTime()-60000);s.c_w(s.epa(k),'',d);v='';}ret"
+"urn v;");}
if(!s.__ccucw){s.c_wr=s.c_w;s.__ccucw=true;s.c_w=new Function("k","v","e",""
+"this.new2 = true;"
+"var s=this,d=new Date,ht=0,pn='s_pers',sn='s_sess',pc=0,sc=0,pv,sv,"
+"c,i,t;d.setTime(d.getTime()-60000);if(s.c_rr(k)) s.c_wr(k,'',d);k=s"
+".ape(k);pv=s.c_rr(pn);i=pv.indexOf(' '+k+'=');if(i>-1){pv=pv.substr"
+"ing(0,i)+pv.substring(pv.indexOf(';',i)+1);pc=1;}sv=s.c_rr(sn);i=sv"
+".indexOf(' '+k+'=');if(i>-1){sv=sv.substring(0,i)+sv.substring(sv.i"
+"ndexOf(';',i)+1);sc=1;}d=new Date;if(e){if(e.getTime()>d.getTime())"
+"{pv+=' '+k+'='+s.ape(v)+'|'+e.getTime()+';';pc=1;}}else{sv+=' '+k+'"
+"='+s.ape(v)+';';sc=1;}if(sc) s.c_wr(sn,sv,0);if(pc){t=pv;while(t&&t"
+".indexOf(';')!=-1){var t1=parseInt(t.substring(t.indexOf('|')+1,t.i"
+"ndexOf(';')));t=t.substring(t.indexOf(';')+1);ht=ht<t1?t1:ht;}d.set"
+"Time(ht);s.c_wr(pn,pv,d);}return v==s.c_r(s.epa(k));");}
s.getTimeParting=new Function("t","z",""
+"var s=this,cy;dc=new Date('1/1/2000');"
+"if(dc.getDay()!=6||dc.getMonth()!=0){return'Data Not Available'}"
+"else{;z=parseFloat(z);var dsts=new Date(s.dstStart);"
+"var dste=new Date(s.dstEnd);fl=dste;cd=new Date();if(cd>dsts&&cd<fl)"
+"{z=z+1}else{z=z};utc=cd.getTime()+(cd.getTimezoneOffset()*60000);"
+"tz=new Date(utc + (3600000*z));thisy=tz.getFullYear();"
+"var days=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday',"
+"'Saturday'];if(thisy!=s.currentYear){return'Data Not Available'}else{;"
+"thish=tz.getHours();thismin=tz.getMinutes();thisd=tz.getDay();"
+"var dow=days[thisd];var ap='AM';var dt='Weekday';var mint='00';"
+"if(thismin>30){mint='30'}if(thish>=12){ap='PM';thish=thish-12};"
+"if (thish==0){thish=12};if(thisd==6||thisd==0){dt='Weekend'};"
+"var timestring=thish+':'+mint+ap;if(t=='h'){return timestring}"
+"if(t=='d'){return dow};if(t=='w'){return dt}}};");s.getQueryParam=new Function("p","d","u",""
+"var s=this,v='',i,t;d=d?d:'';u=u?u:(s.pageURL?s.pageURL:s.wd.locati"
+"on);if(u=='f')u=s.gtfs().location;while(p){i=p.indexOf(',');i=i<0?p"
+".length:i;t=s.p_gpv(p.substring(0,i),u+'');if(t)v+=v?d+t:t;p=p.subs"
+"tring(i==p.length?i:i+1)}return v");s.p_gpv=new Function("k","u",""
+"var s=this,v='',i=u.indexOf('?'),q;if(k&&i>-1){q=u.substring(i+1);v"
+"=s.pt(q,'&','p_gvf',k)}return v");s.p_gvf=new Function("t","k",""
+"if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'T"
+"rue':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s."
+"epa(v)}return ''");s.getValOnce=new Function("v","c","e",""
+"var s=this,k=s.c_r(c),a=new Date;e=e?e:0;if(v){a.setTime(a.getTime("
+")+e*86400000);s.c_w(c,v,e?a:0);}return v==k?'':v");s.split=new Function("l","d",""
+"var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x"
+"++]=l.substring(0,i);l=l.substring(i+d.length);}return a");s.apl=new Function("L","v","d","u",""
+"var s=this,m=0;if(!L)L='';if(u){var i,n,a=s.split(L,d);for(i=0;i<a."
+"length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCas"
+"e()));}}if(!m)L=L?L+d+v:v;return L");s.getNewRepeat=new Function("d","cn",""
+"var s=this,e=new Date(),cval,sval,ct=e.getTime();d=d?d:30;cn=cn?cn:"
+"'s_nr';e.setTime(ct+d*24*60*60*1000);cval=s.c_r(cn);if(cval.length="
+"=0){s.c_w(cn,ct+'-New',e);return'New';}sval=s.split(cval,'-');if(ct"
+"-sval[0]<30*60*1000&&sval[1]=='New'){s.c_w(cn,ct+'-New',e);return'N"
+"ew';}else{s.c_w(cn,ct+'-Repeat',e);return'Repeat';}");s.setupLinkTrack=new Function("vl","c",""
+"var s=this;var l=s.d.links,cv,cva,vla,h,i,l,t,b,o,y,n,oc,d='';cv=s."
+"c_r(c);if(vl&&cv!=''){cva=s.split(cv,'^^');vla=s.split(vl,',');for("
+"x in vla)s._hbxm(vla[x])?s[vla[x]]=cva[x]:'';}s.c_w(c,'',0);if(!s.e"
+"o&&!s.lnk)return '';o=s.eo?s.eo:s.lnk;y=s.ot(o);n=s.oid(o);if(s.eo&"
+"&o==s.eo){while(o&&!n&&y!='BODY'){o=o.parentElement?o.parentElement"
+":o.parentNode;if(!o)return '';y=s.ot(o);n=s.oid(o);}for(i=0;i<4;i++"
+")if(o.tagName)if(o.tagName.toLowerCase()!='a')if(o.tagName.toLowerC"
+"ase()!='area')o=o.parentElement;}b=s._LN(o);o.lid=b[0];o.lpos=b[1];"
+"if(s.hbx_lt&&s.hbx_lt!='manual'){if((o.tagName&&s._TL(o.tagName)=='"
+"area')){if(!s._IL(o.lid)){if(o.parentNode){if(o.parentNode.name)o.l"
+"id=o.parentNode.name;else o.lid=o.parentNode.id}}if(!s._IL(o.lpos))"
+"o.lpos=o.coords}else{if(s._IL(o.lid)<1)o.lid=s._LS(o.lid=o.text?o.t"
+"ext:o.innerText?o.innerText:'');if(!s._IL(o.lid)||s._II(s._TL(o.lid"
+"),'<img')>-1){h=''+o.innerHTML;bu=s._TL(h);i=s._II(bu,'<img');if(bu"
+"&&i>-1){eval(\"__f=/ src\s*=\s*[\'\\\"]?([^\'\\\" ]+)[\'\\\"]?/i\")"
+";__f.exec(h);if(RegExp.$1)h=RegExp.$1}o.lid=h}if(o.lid.length>50)o."
+"lid=o.lid.substr(0,50);}}h=o.href?o.href:'';"
+"i=h.indexOf('?');h=s.linkLeaveQueryString||i<0?h:h.substring(0,i);l"
+"=s.linkName?s.linkName:s._hbxln(h);t=s.linkType?s.linkType.toLowerC"
+"ase():s.lt(h);oc=o.onclick?''+o.onclick:'';cv=s.pageName+'^^'+o.lid"
+"+'^^'+s.pageName+' | '+(o.lid=o.lid?o.lid:'no &lid')+'^^'+o.lpos;if"
+"(t&&(h||l)){cva=s.split(cv,'^^');vla=s.split(vl,',');for(x in vla)s"
+"._hbxm(vla[x])?s[vla[x]]=cva[x]:'';}else if(!t&&oc.indexOf('.tl(')<"
+"0){s.c_w(c,cv,0);}else return ''");s._IL=new Function("a","var s=this;return a!='undefined'?a.length:0");s._II=new Function("a","b","c","var s=this;return a.indexOf(b,c?c:0)");s._IS=new Function("a","b","c",""
+"var s=this;return b>s._IL(a)?'':a.substring(b,c!=null?c:s._IL(a))");s._LN=new Function("a","b","c","d",""
+"var s=this;b=a.href;b+=a.name?a.name:'';c=s._LVP(b,'lid');d=s._LVP("
+"b,'lpos');r"
+"eturn[c,d]");s._LVP=new Function("a","b","c","d","e",""
+"var s=this;c=s._II(a,'&'+b+'=');c=c<0?s._II(a,'?'+b+'='):c;if(c>-1)"
+"{d=s._II(a,'&',c+s._IL(b)+2);e=s._IS(a,c+s._IL(b)+2,d>-1?d:s._IL(a)"
+");return e}return ''");s._LS=new Function("a",""
+"var s=this,b,c=100,d,e,f,g;b=(s._IL(a)>c)?escape(s._IS(a,0,c)):esca"
+"pe(a);b=s._LSP(b,'%0A','%20');b=s._LSP(b,'%0D','%20');b=s._LSP(b,'%"
+"09','%20');c=s._IP(b,'%20');d=s._NA();e=0;for(f=0;f<s._IL(c);f++){g"
+"=s._RP(c[f],'%20','');if(s._IL(g)>0){d[e++]=g}}b=d.join('%20');retu"
+"rn unescape(b)");s._LSP=new Function("a","b","c","d","var s=this;d=s._IP(a,b);return d"
+".join(c)");s._IP=new Function("a","b","var s=this;return a.split(b)");s._RP=new Function("a","b","c","d",""
+"var s=this;d=s._II(a,b);if(d>-1){a=s._RP(s._IS(a,0,d)+','+s._IS(a,d"
+"+s._IL(b),s._IL(a)),b,c)}return a");s._TL=new Function("a","var s=this;return a.toLowerCase()");s._NA=new Function("a","var s=this;return new Array(a?a:0)");s._hbxm=new Function("m","var s=this;return (''+m).indexOf('{')<0");s._hbxln=new Function("h","var s=this,n=s.linkNames;if(n)return s.pt("
+"n,',','lnf',h);return ''");s.setupFormAnalysis=new Function(""
+"var s=this;if(!s.fa){s.fa=new Object;var f=s.fa;f.ol=s.wd.onload;s."
+"wd.onload=s.faol;f.uc=s.useCommerce;f.vu=s.varUsed;f.vl=f.uc?s.even"
+"tList:'';f.tfl=s.trackFormList;f.fl=s.formList;f.va=new Array('',''"
+",'','')}");s.sendFormEvent=new Function("t","pn","fn","en",""
+"var s=this,f=s.fa;t=t=='s'?t:'e';f.va[0]=pn;f.va[1]=fn;f.va[3]=t=='"
+"s'?'Success':en;s.fasl(t);f.va[1]='';f.va[3]='';");s.faol=new Function("e",""
+"var s=s_c_il["+s._in+"],f=s.fa,r=true,fo,fn,i,en,t,tf;if(!e)e=s.wd."
+"event;f.os=new Array;if(f.ol)r=f.ol(e);if(s.d.forms&&s.d.forms.leng"
+"th>0){for(i=s.d.forms.length-1;i>=0;i--){fo=s.d.forms[i];fn=fo.name"
+";tf=f.tfl&&s.pt(f.fl,',','ee',fn)||!f.tfl&&!s.pt(f.fl,',','ee',fn);"
+"if(tf){f.os[fn]=fo.onsubmit;fo.onsubmit=s.faos;f.va[1]=fn;f.va[3]='"
+"No Data Entered';for(en=0;en<fo.elements.length;en++){el=fo.element"
+"s[en];t=el.type;if(t&&t.toUpperCase){t=t.toUpperCase();var md=el.on"
+"mousedown,kd=el.onkeydown,omd=md?md.toString():'',okd=kd?kd.toStrin"
+"g():'';if(omd.indexOf('.fam(')<0&&okd.indexOf('.fam(')<0){el.s_famd"
+"=md;el.s_fakd=kd;el.onmousedown=s.fam;el.onkeydown=s.fam}}}}}f.ul=s"
+".wd.onunload;s.wd.onunload=s.fasl;}return r;");s.faos=new Function("e",""
+"var s=s_c_il["+s._in+"],f=s.fa,su;if(!e)e=s.wd.event;if(f.vu){s[f.v"
+"u]='';f.va[1]='';f.va[3]='';}su=f.os[this.name];return su?su(e):tru"
+"e;");s.fasl=new Function("e",""
+"var s=s_c_il["+s._in+"],f=s.fa,a=f.va,l=s.wd.location,ip=s.trackPag"
+"eName,p=s.pageName;if(a[1]!=''&&a[3]!=''){a[0]=!p&&ip?l.host+l.path"
+"name:a[0]?a[0]:p;if(!f.uc&&a[3]!='No Data Entered'){if(e=='e')a[2]="
+"'Error';else if(e=='s')a[2]='Success';else a[2]='Abandon'}else a[2]"
+"='';var tp=ip?a[0]+':':'',t3=e!='s'?':('+a[3]+')':'',ym=!f.uc&&a[3]"
+"!='No Data Entered'?tp+a[1]+':'+a[2]+t3:tp+a[1]+t3,ltv=s.linkTrackV"
+"ars,lte=s.linkTrackEvents,up=s.usePlugins;if(f.uc){s.linkTrackVars="
+"ltv=='None'?f.vu+',events':ltv+',events,'+f.vu;s.linkTrackEvents=lt"
+"e=='None'?f.vl:lte+','+f.vl;f.cnt=-1;if(e=='e')s.events=s.pt(f.vl,'"
+",','fage',2);else if(e=='s')s.events=s.pt(f.vl,',','fage',1);else s"
+".events=s.pt(f.vl,',','fage',0)}else{s.linkTrackVars=ltv=='None'?f."
+"vu:ltv+','+f.vu}s[f.vu]=ym;s.usePlugins=false;s.tl(true,'o','Form A"
+"nalysis');s[f.vu]='';s.usePlugins=up}return f.ul&&e!='e'&&e!='s'?f."
+"ul(e):true;");s.fam=new Function("e",""
+"var s=s_c_il["+s._in+"],f=s.fa;if(!e) e=s.wd.event;var o=s.trackLas"
+"tChanged,et=e.type.toUpperCase(),t=this.type.toUpperCase(),fn=this."
+"form.name,en=this.name,sc=false;if(document.layers){kp=e.which;b=e."
+"which}else{kp=e.keyCode;b=e.button}et=et=='MOUSEDOWN'?1:et=='KEYDOW"
+"N'?2:et;if(f.ce!=en||f.cf!=fn){if(et==1&&b!=2&&'BUTTONSUBMITRESETIM"
+"AGERADIOCHECKBOXSELECT-ONEFILE'.indexOf(t)>-1){f.va[1]=fn;f.va[3]=e"
+"n;sc=true}else if(et==1&&b==2&&'TEXTAREAPASSWORDFILE'.indexOf(t)>-1"
+"){f.va[1]=fn;f.va[3]=en;sc=true}else if(et==2&&kp!=9&&kp!=13){f.va["
+"1]=fn;f.va[3]=en;sc=true}if(sc){nface=en;nfacf=fn}}if(et==1&&this.s"
+"_famd)return this.s_famd(e);if(et==2&&this.s_fakd)return this.s_fak"
+"d(e);");s.ee=new Function("e","n",""
+"return n&&n.toLowerCase?e.toLowerCase()==n.toLowerCase():false;");s.fage=new Function("e","a",""
+"var s=this,f=s.fa,x=f.cnt;x=x?x+1:1;f.cnt=x;return x==a?e:'';");s.loadModule("Media")
s.Media.autoTrack=false
s.Media.trackWhilePlaying=true
s.Media.trackVars="None"
s.Media.trackEvents="None"
s.visitorNamespace="cbcca"
s.trackingServer="metrics.cbc.ca"
s.trackingServerSecure="smetrics.cbc.ca"
s.m_Media_c="var m=s.m_i('Media');m.cn=function(n){var m=this;return m.s.rep(m.s.rep(m.s.rep(n,\"\\n\",''),\"\\r\",''),'--**--','')};m.open=function(n,l,p,b){var m=this,i=new Object,"
+"tm=new Date,a='',x;n=m.cn(n);l=parseInt(l);if(!l)l=1;if(n&&p){if(!m.l)m.l=new Object;if(m.l[n])m.close(n);if(b&&b.id)a=b.id;for (x in m.l)if(m.l[x]&&m.l[x].a==a)m.close(m.l[x].n);i.n=n;i.l=l;i.p=m."
+"cn(p);i.a=a;i.t=0;i.ts=0;i.s=Math.floor(tm.getTime()/1000);i.lx=0;i.lt=i.s;i.lo=0;i.e='';i.to=-1;m.l[n]=i}};m.close=function(n){this.e(n,0,-1)};m.play=function(n,o){var m=this,i;i=m.e(n,1,o);i.m=ne"
+"w Function('var m=s_c_il['+m._in+'],i;if(m.l){i=m.l[\"'+m.s.rep(i.n,'\"','\\\\\"')+'\"];if(i){if(i.lx==1)m.e(i.n,3,-1);i.mt=setTimeout(i.m,5000)}}');i.m()};m.stop=function(n,o){this.e(n,2,o)};m.tra"
+"ck=function(n){var m=this;if (m.trackWhilePlaying) {m.e(n,4,-1)}};m.e=function(n,x,o){var m=this,i,tm=new Date,ts=Math.floor(tm.getTime()/1000),ti=m.trackSeconds,tp=m.trackMilestones,z=new Array,j,"
+"d='--**--',t=1,b,v=m.trackVars,e=m.trackEvents,pe='media',pev3,w=new Object,vo=new Object;n=m.cn(n);i=n&&m.l&&m.l[n]?m.l[n]:0;if(i){w.name=n;w.length=i.l;w.playerName=i.p;if(i.to<0)w.event=\"OPEN\""
+";else w.event=(x==1?\"PLAY\":(x==2?\"STOP\":(x==3?\"MONITOR\":\"CLOSE\")));w.openTime=new Date();w.openTime.setTime(i.s*1000);if(x>2||(x!=i.lx&&(x!=2||i.lx==1))) {b=\"Media.\"+name;pev3 = m.s.ape(i"
+".n)+d+i.l+d+m.s.ape(i.p)+d;if(x){if(o<0&&i.lt>0){o=(ts-i.lt)+i.lo;o=o<i.l?o:i.l-1}o=Math.floor(o);if(x>=2&&i.lo<o){i.t+=o-i.lo;i.ts+=o-i.lo;}if(x<=2){i.e+=(x==1?'S':'E')+o;i.lx=x;}else if(i.lx!=1)m"
+".e(n,1,o);i.lt=ts;i.lo=o;pev3+=i.t+d+i.s+d+(m.trackWhilePlaying&&i.to>=0?'L'+i.to:'')+i.e+(x!=2?(m.trackWhilePlaying?'L':'E')+o:'');if(m.trackWhilePlaying){b=0;pe='m_o';if(x!=4){w.offset=o;w.percen"
+"t=((w.offset+1)/w.length)*100;w.percent=w.percent>100?100:Math.floor(w.percent);w.timePlayed=i.t;if(m.monitor)m.monitor(m.s,w)}if(i.to<0)pe='m_s';else if(x==4)pe='m_i';else{t=0;v=e='None';ti=ti?par"
+"seInt(ti):0;z=tp?m.s.sp(tp,','):0;if(ti&&i.ts>=ti)t=1;else if(z){if(o<i.to)i.to=o;else{for(j=0;j<z.length;j++){ti=z[j]?parseInt(z[j]):0;if(ti&&((i.to+1)/i.l<ti/100)&&((o+1)/i.l>=ti/100)){t=1;j=z.le"
+"ngth}}}}}}}else{m.e(n,2,-1);if(m.trackWhilePlaying){w.offset=i.lo;w.percent=((w.offset+1)/w.length)*100;w.percent=w.percent>100?100:Math.floor(w.percent);w.timePlayed=i.t;if(m.monitor)m.monitor(m.s"
+",w)}m.l[n]=0;if(i.e){pev3+=i.t+d+i.s+d+(m.trackWhilePlaying&&i.to>=0?'L'+i.to:'')+i.e;if(m.trackWhilePlaying){v=e='None';pe='m_o'}else{t=0;m.s.fbr(b)}}else t=0;b=0}if(t){vo.linkTrackVars=v;vo.linkT"
+"rackEvents=e;vo.pe=pe;vo.pev3=pev3;m.s.t(vo,b);if(m.trackWhilePlaying){i.ts=0;i.to=o;i.e=''}}}}return i};m.ae=function(n,l,p,x,o,b){if(n&&p){var m=this;if(!m.l||!m.l[n])m.open(n,l,p,b);m.e(n,x,o)}}"
+";m.a=function(o,t){var m=this,i=o.id?o.id:o.name,n=o.name,p=0,v,c,c1,c2,xc=m.s.h,x,e,f1,f2='s_media_'+m._in+'_oc',f3='s_media_'+m._in+'_t',f4='s_media_'+m._in+'_s',f5='s_media_'+m._in+'_l',f6='s_me"
+"dia_'+m._in+'_m',f7='s_media_'+m._in+'_c',tcf,w;if(!i){if(!m.c)m.c=0;i='s_media_'+m._in+'_'+m.c;m.c++}if(!o.id)o.id=i;if(!o.name)o.name=n=i;if(!m.ol)m.ol=new Object;if(m.ol[i])return;m.ol[i]=o;if(!"
+"xc)xc=m.s.b;tcf=new Function('o','var e,p=0;try{if(o.versionInfo&&o.currentMedia&&o.controls)p=1}catch(e){p=0}return p');p=tcf(o);if(!p){tcf=new Function('o','var e,p=0,t;try{t=o.GetQuickTimeVersio"
+"n();if(t)p=2}catch(e){p=0}return p');p=tcf(o);if(!p){tcf=new Function('o','var e,p=0,t;try{t=o.GetVersionInfo();if(t)p=3}catch(e){p=0}return p');p=tcf(o)}}v=\"var m=s_c_il[\"+m._in+\"],o=m.ol['\"+i"
+"+\"']\";if(p==1){p='Windows Media Player '+o.versionInfo;c1=v+',n,p,l,x=-1,cm,c,mn;if(o){cm=o.currentMedia;c=o.controls;if(cm&&c){mn=cm.name?cm.name:c.URL;l=cm.duration;p=c.currentPosition;n=o.play"
+"State;if(n){if(n==8)x=0;if(n==3)x=1;if(n==1||n==2||n==4||n==5||n==6)x=2;}';c2='if(x>=0)m.ae(mn,l,\"'+p+'\",x,x!=2?p:-1,o)}}';c=c1+c2;if(m.s.isie&&xc){x=m.s.d.createElement('script');x.language='jsc"
+"ript';x.type='text/javascript';x.htmlFor=i;x.event='PlayStateChange(NewState)';x.defer=true;x.text=c;xc.appendChild(x);o[f6]=new Function(c1+'if(n==3){x=3;'+c2+'}setTimeout(o.'+f6+',5000)');o[f6]()"
+"}}if(p==2){p='QuickTime Player '+(o.GetIsQuickTimeRegistered()?'Pro ':'')+o.GetQuickTimeVersion();f1=f2;c=v+',n,x,t,l,p,p2,mn;if(o){mn=o.GetMovieName()?o.GetMovieName():o.GetURL();n=o.GetRate();t=o"
+".GetTimeScale();l=o.GetDuration()/t;p=o.GetTime()/t;p2=o.'+f5+';if(n!=o.'+f4+'||p<p2||p-p2>5){x=2;if(n!=0)x=1;else if(p>=l)x=0;if(p<p2||p-p2>5)m.ae(mn,l,\"'+p+'\",2,p2,o);m.ae(mn,l,\"'+p+'\",x,x!=2"
+"?p:-1,o)}if(n>0&&o.'+f7+'>=10){m.ae(mn,l,\"'+p+'\",3,p,o);o.'+f7+'=0}o.'+f7+'++;o.'+f4+'=n;o.'+f5+'=p;setTimeout(\"'+v+';o.'+f2+'(0,0)\",500)}';o[f1]=new Function('a','b',c);o[f4]=-1;o[f7]=0;o[f1]("
+"0,0)}if(p==3){p='RealPlayer '+o.GetVersionInfo();f1=n+'_OnPlayStateChange';c1=v+',n,x=-1,l,p,mn;if(o){mn=o.GetTitle()?o.GetTitle():o.GetSource();n=o.GetPlayState();l=o.GetLength()/1000;p=o.GetPosit"
+"ion()/1000;if(n!=o.'+f4+'){if(n==3)x=1;if(n==0||n==2||n==4||n==5)x=2;if(n==0&&(p>=l||p==0))x=0;if(x>=0)m.ae(mn,l,\"'+p+'\",x,x!=2?p:-1,o)}if(n==3&&(o.'+f7+'>=10||!o.'+f3+')){m.ae(mn,l,\"'+p+'\",3,p"
+",o);o.'+f7+'=0}o.'+f7+'++;o.'+f4+'=n;';c2='if(o.'+f2+')o.'+f2+'(o,n)}';if(m.s.wd[f1])o[f2]=m.s.wd[f1];m.s.wd[f1]=new Function('a','b',c1+c2);o[f1]=new Function('a','b',c1+'setTimeout(\"'+v+';o.'+f1"
+"+'(0,0)\",o.'+f3+'?500:5000);'+c2);o[f4]=-1;if(m.s.isie)o[f3]=1;o[f7]=0;o[f1](0,0)}};m.as=new Function('e','var m=s_c_il['+m._in+'],l,n;if(m.autoTrack&&m.s.d.getElementsByTagName){l=m.s.d.getElemen"
+"tsByTagName(m.s.isie?\"OBJECT\":\"EMBED\");if(l)for(n=0;n<l.length;n++)m.a(l[n]);}');if(s.wd.attachEvent)s.wd.attachEvent('onload',m.as);else if(s.wd.addEventListener)s.wd.addEventListener('load',m"
+".as,false)";s.m_i("Media");}
s_cbc_sitecatalyst_init(s_cbc_sitecatalyst);var s_code='',s_objectID;function s_gi(un,pg,ss){var c="s.version='H.25.2';s.an=s_an;s.logDebug=function(m){var s=this,tcf=new Function('var e;try{console.log(\"'+s.rep(s.rep(s.rep(m,\"\\\\\",\"\\\\"
+"\\\\\"),\"\\n\",\"\\\\n\"),\"\\\"\",\"\\\\\\\"\")+'\");}catch(e){}');tcf()};s.cls=function(x,c){var i,y='';if(!c)c=this.an;for(i=0;i<x.length;i++){n=x.substring(i,i+1);if(c.indexOf(n)>=0)y+=n}retur"
+"n y};s.fl=function(x,l){return x?(''+x).substring(0,l):x};s.co=function(o){return o};s.num=function(x){x=''+x;for(var p=0;p<x.length;p++)if(('0123456789').indexOf(x.substring(p,p+1))<0)return 0;ret"
+"urn 1};s.rep=s_rep;s.sp=s_sp;s.jn=s_jn;s.ape=function(x){var s=this,h='0123456789ABCDEF',f=\"+~!*()'\",i,c=s.charSet,n,l,e,y='';c=c?c.toUpperCase():'';if(x){x=''+x;if(s.em==3){x=encodeURIComponent("
+"x);for(i=0;i<f.length;i++) {n=f.substring(i,i+1);if(x.indexOf(n)>=0)x=s.rep(x,n,\"%\"+n.charCodeAt(0).toString(16).toUpperCase())}}else if(c=='AUTO'&&('').charCodeAt){for(i=0;i<x.length;i++){c=x.su"
+"bstring(i,i+1);n=x.charCodeAt(i);if(n>127){l=0;e='';while(n||l<4){e=h.substring(n%16,n%16+1)+e;n=(n-n%16)/16;l++}y+='%u'+e}else if(c=='+')y+='%2B';else y+=escape(c)}x=y}else x=s.rep(escape(''+x),'+"
+"','%2B');if(c&&c!='AUTO'&&s.em==1&&x.indexOf('%u')<0&&x.indexOf('%U')<0){i=x.indexOf('%');while(i>=0){i++;if(h.substring(8).indexOf(x.substring(i,i+1).toUpperCase())>=0)return x.substring(0,i)+'u00"
+"'+x.substring(i);i=x.indexOf('%',i)}}}return x};s.epa=function(x){var s=this;if(x){x=s.rep(''+x,'+',' ');return s.em==3?decodeURIComponent(x):unescape(x)}return x};s.pt=function(x,d,f,a){var s=this"
+",t=x,z=0,y,r;while(t){y=t.indexOf(d);y=y<0?t.length:y;t=t.substring(0,y);r=s[f](t,a);if(r)return r;z+=y+d.length;t=x.substring(z,x.length);t=z<x.length?t:''}return ''};s.isf=function(t,a){var c=a.i"
+"ndexOf(':');if(c>=0)a=a.substring(0,c);c=a.indexOf('=');if(c>=0)a=a.substring(0,c);if(t.substring(0,2)=='s_')t=t.substring(2);return (t!=''&&t==a)};s.fsf=function(t,a){var s=this;if(s.pt(a,',','isf"
+"',t))s.fsg+=(s.fsg!=''?',':'')+t;return 0};s.fs=function(x,f){var s=this;s.fsg='';s.pt(x,',','fsf',f);return s.fsg};s.mpc=function(m,a){var s=this,c,l,n,v;v=s.d.visibilityState;if(!v)v=s.d.webkitVi"
+"sibilityState;if(v&&v=='prerender'){if(!s.mpq){s.mpq=new Array;l=s.sp('webkitvisibilitychange,visibilitychange',',');for(n=0;n<l.length;n++){s.d.addEventListener(l[n],new Function('var s=s_c_il['+s"
+"._in+'],c,v;v=s.d.visibilityState;if(!v)v=s.d.webkitVisibilityState;if(s.mpq&&v==\"visible\"){while(s.mpq.length>0){c=s.mpq.shift();s[c.m].apply(s,c.a)}s.mpq=0}'),false)}}c=new Object;c.m=m;c.a=a;s"
+".mpq.push(c);return 1}return 0};s.si=function(){var s=this,i,k,v,c=s_gi+'var s=s_gi(\"'+s.oun+'\");s.sa(\"'+s.un+'\");';for(i=0;i<s.va_g.length;i++){k=s.va_g[i];v=s[k];if(v!=undefined){if(typeof(v)"
+"!='number')c+='s.'+k+'=\"'+s_fe(v)+'\";';else c+='s.'+k+'='+v+';'}}c+=\"s.lnk=s.eo=s.linkName=s.linkType=s.wd.s_objectID=s.ppu=s.pe=s.pev1=s.pev2=s.pev3='';\";return c};s.c_d='';s.c_gdf=function(t,"
+"a){var s=this;if(!s.num(t))return 1;return 0};s.c_gd=function(){var s=this,d=s.wd.location.hostname,n=s.fpCookieDomainPeriods,p;if(!n)n=s.cookieDomainPeriods;if(d&&!s.c_d){n=n?parseInt(n):2;n=n>2?n"
+":2;p=d.lastIndexOf('.');if(p>=0){while(p>=0&&n>1){p=d.lastIndexOf('.',p-1);n--}s.c_d=p>0&&s.pt(d,'.','c_gdf',0)?d.substring(p):d}}return s.c_d};s.c_r=function(k){var s=this;k=s.ape(k);var c=' '+s.d"
+".cookie,i=c.indexOf(' '+k+'='),e=i<0?i:c.indexOf(';',i),v=i<0?'':s.epa(c.substring(i+2+k.length,e<0?c.length:e));return v!='[[B]]'?v:''};s.c_w=function(k,v,e){var s=this,d=s.c_gd(),l=s.cookieLifeti"
+"me,t;v=''+v;l=l?(''+l).toUpperCase():'';if(e&&l!='SESSION'&&l!='NONE'){t=(v!=''?parseInt(l?l:0):-60);if(t){e=new Date;e.setTime(e.getTime()+(t*1000))}}if(k&&l!='NONE'){s.d.cookie=k+'='+s.ape(v!=''?"
+"v:'[[B]]')+'; path=/;'+(e&&l!='SESSION'?' expires='+e.toGMTString()+';':'')+(d?' domain='+d+';':'');return s.c_r(k)==v}return 0};s.eh=function(o,e,r,f){var s=this,b='s_'+e+'_'+s._in,n=-1,l,i,x;if(!"
+"s.ehl)s.ehl=new Array;l=s.ehl;for(i=0;i<l.length&&n<0;i++){if(l[i].o==o&&l[i].e==e)n=i}if(n<0){n=i;l[n]=new Object}x=l[n];x.o=o;x.e=e;f=r?x.b:f;if(r||f){x.b=r?0:o[e];x.o[e]=f}if(x.b){x.o[b]=x.b;ret"
+"urn b}return 0};s.cet=function(f,a,t,o,b){var s=this,r,tcf;if(s.apv>=5&&(!s.isopera||s.apv>=7)){tcf=new Function('s','f','a','t','var e,r;try{r=s[f](a)}catch(e){r=s[t](e)}return r');r=tcf(s,f,a,t)}"
+"else{if(s.ismac&&s.u.indexOf('MSIE 4')>=0)r=s[b](a);else{s.eh(s.wd,'onerror',0,o);r=s[f](a);s.eh(s.wd,'onerror',1)}}return r};s.gtfset=function(e){var s=this;return s.tfs};s.gtfsoe=new Function('e'"
+",'var s=s_c_il['+s._in+'],c;s.eh(window,\"onerror\",1);s.etfs=1;c=s.t();if(c)s.d.write(c);s.etfs=0;return true');s.gtfsfb=function(a){return window};s.gtfsf=function(w){var s=this,p=w.parent,l=w.lo"
+"cation;s.tfs=w;if(p&&p.location!=l&&p.location.host==l.host){s.tfs=p;return s.gtfsf(s.tfs)}return s.tfs};s.gtfs=function(){var s=this;if(!s.tfs){s.tfs=s.wd;if(!s.etfs)s.tfs=s.cet('gtfsf',s.tfs,'gtf"
+"set',s.gtfsoe,'gtfsfb')}return s.tfs};s.mrq=function(u){var s=this,l=s.rl[u],n,r;s.rl[u]=0;if(l)for(n=0;n<l.length;n++){r=l[n];s.mr(0,0,r.r,r.t,r.u)}};s.flushBufferedRequests=function(){};s.mr=func"
+"tion(sess,q,rs,ta,u){var s=this,dc=s.dc,t1=s.trackingServer,t2=s.trackingServerSecure,tb=s.trackingServerBase,p='.sc',ns=s.visitorNamespace,un=s.cls(u?u:(ns?ns:s.fun)),r=new Object,l,imn='s_i_'+(un"
+"),im,b,e;if(!rs){if(t1){if(t2&&s.ssl)t1=t2}else{if(!tb)tb='2o7.net';if(dc)dc=(''+dc).toLowerCase();else dc='d1';if(tb=='2o7.net'){if(dc=='d1')dc='112';else if(dc=='d2')dc='122';p=''}t1=un+'.'+dc+'."
+"'+p+tb}rs='http'+(s.ssl?'s':'')+'://'+t1+'/b/ss/'+s.un+'/'+(s.mobile?'5.1':'1')+'/'+s.version+(s.tcn?'T':'')+'/'+sess+'?AQB=1&ndh=1'+(q?q:'')+'&AQE=1';if(s.isie&&!s.ismac)rs=s.fl(rs,2047)}if(s.d.im"
+"ages&&s.apv>=3&&(!s.isopera||s.apv>=7)&&(s.ns6<0||s.apv>=6.1)){if(!s.rc)s.rc=new Object;if(!s.rc[un]){s.rc[un]=1;if(!s.rl)s.rl=new Object;s.rl[un]=new Array;setTimeout('if(window.s_c_il)window.s_c_"
+"il['+s._in+'].mrq(\"'+un+'\")',750)}else{l=s.rl[un];if(l){r.t=ta;r.u=un;r.r=rs;l[l.length]=r;return ''}imn+='_'+s.rc[un];s.rc[un]++}if(s.debugTracking){var d='AppMeasurement Debug: '+rs,dl=s.sp(rs,"
+"'&'),dln;for(dln=0;dln<dl.length;dln++)d+=\"\\n\\t\"+s.epa(dl[dln]);s.logDebug(d)}im=s.wd[imn];if(!im)im=s.wd[imn]=new Image;im.s_l=0;im.onload=new Function('e','this.s_l=1;var wd=window,s;if(wd.s_"
+"c_il){s=wd.s_c_il['+s._in+'];s.bcr();s.mrq(\"'+un+'\");s.nrs--;if(!s.nrs)s.m_m(\"rr\")}');if(!s.nrs){s.nrs=1;s.m_m('rs')}else s.nrs++;im.src=rs;if(s.useForcedLinkTracking||s.bcf){if(!s.forcedLinkTr"
+"ackingTimeout)s.forcedLinkTrackingTimeout=250;setTimeout('var wd=window,s;if(wd.s_c_il){s=wd.s_c_il['+s._in+'];s.bcr()}',s.forcedLinkTrackingTimeout);}else if((s.lnk||s.eo)&&(!ta||ta=='_self'||ta=="
+"'_top'||(s.wd.name&&ta==s.wd.name))){b=e=new Date;while(!im.s_l&&e.getTime()-b.getTime()<500)e=new Date}return ''}return '<im'+'g sr'+'c=\"'+rs+'\" width=1 height=1 border=0 alt=\"\">'};s.gg=functi"
+"on(v){var s=this;if(!s.wd['s_'+v])s.wd['s_'+v]='';return s.wd['s_'+v]};s.glf=function(t,a){if(t.substring(0,2)=='s_')t=t.substring(2);var s=this,v=s.gg(t);if(v)s[t]=v};s.gl=function(v){var s=this;i"
+"f(s.pg)s.pt(v,',','glf',0)};s.rf=function(x){var s=this,y,i,j,h,p,l=0,q,a,b='',c='',t;if(x&&x.length>255){y=''+x;i=y.indexOf('?');if(i>0){q=y.substring(i+1);y=y.substring(0,i);h=y.toLowerCase();j=0"
+";if(h.substring(0,7)=='http://')j+=7;else if(h.substring(0,8)=='https://')j+=8;i=h.indexOf(\"/\",j);if(i>0){h=h.substring(j,i);p=y.substring(i);y=y.substring(0,i);if(h.indexOf('google')>=0)l=',q,ie"
+",start,search_key,word,kw,cd,';else if(h.indexOf('yahoo.co')>=0)l=',p,ei,';if(l&&q){a=s.sp(q,'&');if(a&&a.length>1){for(j=0;j<a.length;j++){t=a[j];i=t.indexOf('=');if(i>0&&l.indexOf(','+t.substring"
+"(0,i)+',')>=0)b+=(b?'&':'')+t;else c+=(c?'&':'')+t}if(b&&c)q=b+'&'+c;else c=''}i=253-(q.length-c.length)-y.length;x=y+(i>0?p.substring(0,i):'')+'?'+q}}}}return x};s.s2q=function(k,v,vf,vfp,f){var s"
+"=this,qs='',sk,sv,sp,ss,nke,nk,nf,nfl=0,nfn,nfm;if(k==\"contextData\")k=\"c\";if(v){for(sk in v)if((!f||sk.substring(0,f.length)==f)&&v[sk]&&(!vf||vf.indexOf(','+(vfp?vfp+'.':'')+sk+',')>=0)&&(!Obj"
+"ect||!Object.prototype||!Object.prototype[sk])){nfm=0;if(nfl)for(nfn=0;nfn<nfl.length;nfn++)if(sk.substring(0,nfl[nfn].length)==nfl[nfn])nfm=1;if(!nfm){if(qs=='')qs+='&'+k+'.';sv=v[sk];if(f)sk=sk.s"
+"ubstring(f.length);if(sk.length>0){nke=sk.indexOf('.');if(nke>0){nk=sk.substring(0,nke);nf=(f?f:'')+nk+'.';if(!nfl)nfl=new Array;nfl[nfl.length]=nf;qs+=s.s2q(nk,v,vf,vfp,nf)}else{if(typeof(sv)=='bo"
+"olean'){if(sv)sv='true';else sv='false'}if(sv){if(vfp=='retrieveLightData'&&f.indexOf('.contextData.')<0){sp=sk.substring(0,4);ss=sk.substring(4);if(sk=='transactionID')sk='xact';else if(sk=='chann"
+"el')sk='ch';else if(sk=='campaign')sk='v0';else if(s.num(ss)){if(sp=='prop')sk='c'+ss;else if(sp=='eVar')sk='v'+ss;else if(sp=='list')sk='l'+ss;else if(sp=='hier'){sk='h'+ss;sv=sv.substring(0,255)}"
+"}}qs+='&'+s.ape(sk)+'='+s.ape(sv)}}}}}if(qs!='')qs+='&.'+k}return qs};s.hav=function(){var s=this,qs='',l,fv='',fe='',mn,i,e;if(s.lightProfileID){l=s.va_m;fv=s.lightTrackVars;if(fv)fv=','+fv+','+s."
+"vl_mr+','}else{l=s.va_t;if(s.pe||s.linkType){fv=s.linkTrackVars;fe=s.linkTrackEvents;if(s.pe){mn=s.pe.substring(0,1).toUpperCase()+s.pe.substring(1);if(s[mn]){fv=s[mn].trackVars;fe=s[mn].trackEvent"
+"s}}}if(fv)fv=','+fv+','+s.vl_l+','+s.vl_l2;if(fe){fe=','+fe+',';if(fv)fv+=',events,'}if (s.events2)e=(e?',':'')+s.events2}for(i=0;i<l.length;i++){var k=l[i],v=s[k],b=k.substring(0,4),x=k.substring("
+"4),n=parseInt(x),q=k;if(!v)if(k=='events'&&e){v=e;e=''}if(v&&(!fv||fv.indexOf(','+k+',')>=0)&&k!='linkName'&&k!='linkType'){if(k=='timestamp')q='ts';else if(k=='dynamicVariablePrefix')q='D';else if"
+"(k=='visitorID')q='vid';else if(k=='pageURL'){q='g';v=s.fl(v,255)}else if(k=='referrer'){q='r';v=s.fl(s.rf(v),255)}else if(k=='vmk'||k=='visitorMigrationKey')q='vmt';else if(k=='visitorMigrationSer"
+"ver'){q='vmf';if(s.ssl&&s.visitorMigrationServerSecure)v=''}else if(k=='visitorMigrationServerSecure'){q='vmf';if(!s.ssl&&s.visitorMigrationServer)v=''}else if(k=='charSet'){q='ce';if(v.toUpperCase"
+"()=='AUTO')v='ISO8859-1';else if(s.em==2||s.em==3)v='UTF-8'}else if(k=='visitorNamespace')q='ns';else if(k=='cookieDomainPeriods')q='cdp';else if(k=='cookieLifetime')q='cl';else if(k=='variableProv"
+"ider')q='vvp';else if(k=='currencyCode')q='cc';else if(k=='channel')q='ch';else if(k=='transactionID')q='xact';else if(k=='campaign')q='v0';else if(k=='resolution')q='s';else if(k=='colorDepth')q='"
+"c';else if(k=='javascriptVersion')q='j';else if(k=='javaEnabled')q='v';else if(k=='cookiesEnabled')q='k';else if(k=='browserWidth')q='bw';else if(k=='browserHeight')q='bh';else if(k=='connectionTyp"
+"e')q='ct';else if(k=='homepage')q='hp';else if(k=='plugins')q='p';else if(k=='events'){if(e)v+=(v?',':'')+e;if(fe)v=s.fs(v,fe)}else if(k=='events2')v='';else if(k=='contextData'){qs+=s.s2q('c',s[k]"
+",fv,k,0);v=''}else if(k=='lightProfileID')q='mtp';else if(k=='lightStoreForSeconds'){q='mtss';if(!s.lightProfileID)v=''}else if(k=='lightIncrementBy'){q='mti';if(!s.lightProfileID)v=''}else if(k=='"
+"retrieveLightProfiles')q='mtsr';else if(k=='deleteLightProfiles')q='mtsd';else if(k=='retrieveLightData'){if(s.retrieveLightProfiles)qs+=s.s2q('mts',s[k],fv,k,0);v=''}else if(s.num(x)){if(b=='prop'"
+")q='c'+n;else if(b=='eVar')q='v'+n;else if(b=='list')q='l'+n;else if(b=='hier'){q='h'+n;v=s.fl(v,255)}}if(v)qs+='&'+s.ape(q)+'='+(k.substring(0,3)!='pev'?s.ape(v):v)}}return qs};s.ltdf=function(t,h"
+"){t=t?t.toLowerCase():'';h=h?h.toLowerCase():'';var qi=h.indexOf('?');h=qi>=0?h.substring(0,qi):h;if(t&&h.substring(h.length-(t.length+1))=='.'+t)return 1;return 0};s.ltef=function(t,h){t=t?t.toLow"
+"erCase():'';h=h?h.toLowerCase():'';if(t&&h.indexOf(t)>=0)return 1;return 0};s.lt=function(h){var s=this,lft=s.linkDownloadFileTypes,lef=s.linkExternalFilters,lif=s.linkInternalFilters;lif=lif?lif:s"
+".wd.location.hostname;h=h.toLowerCase();if(s.trackDownloadLinks&&lft&&s.pt(lft,',','ltdf',h))return 'd';if(s.trackExternalLinks&&h.substring(0,1)!='#'&&(lef||lif)&&(!lef||s.pt(lef,',','ltef',h))&&("
+"!lif||!s.pt(lif,',','ltef',h)))return 'e';return ''};s.lc=new Function('e','var s=s_c_il['+s._in+'],b=s.eh(this,\"onclick\");s.lnk=this;s.t();s.lnk=0;if(b)return this[b](e);return true');s.bcr=func"
+"tion(){var s=this;if(s.bct&&s.bce)s.bct.dispatchEvent(s.bce);if(s.bcf){if(typeof(s.bcf)=='function')s.bcf();else if(s.bct&&s.bct.href)s.d.location=s.bct.href}s.bct=s.bce=s.bcf=0};s.bc=new Function("
+"'e','if(e&&e.s_fe)return;var s=s_c_il['+s._in+'],f,tcf,t,n;if(s.d&&s.d.all&&s.d.all.cppXYctnr)return;if(!s.bbc)s.useForcedLinkTracking=0;else if(!s.useForcedLinkTracking){s.b.removeEventListener(\""
+"click\",s.bc,true);s.bbc=s.useForcedLinkTracking=0;return}else s.b.removeEventListener(\"click\",s.bc,false);s.eo=e.srcElement?e.srcElement:e.target;s.t();s.eo=0;if(s.nrs>0&&s.useForcedLinkTracking"
+"&&e.target){t=e.target.target;if(e.target.dispatchEvent&&(!t||t==\\'_self\\'||t==\\'_top\\'||(s.wd.name&&t==s.wd.name))){e.stopPropagation();e.stopImmediatePropagation();e.preventDefault();n=s.d.cr"
+"eateEvent(\"MouseEvents\");n.initMouseEvent(\"click\",e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget"
+");n.s_fe=1;s.bct=e.target;s.bce=n;}}');s.oh=function(o){var s=this,l=s.wd.location,h=o.href?o.href:'',i,j,k,p;i=h.indexOf(':');j=h.indexOf('?');k=h.indexOf('/');if(h&&(i<0||(j>=0&&i>j)||(k>=0&&i>k)"
+")){p=o.protocol&&o.protocol.length>1?o.protocol:(l.protocol?l.protocol:'');i=l.pathname.lastIndexOf('/');h=(p?p+'//':'')+(o.host?o.host:(l.host?l.host:''))+(h.substring(0,1)!='/'?l.pathname.substri"
+"ng(0,i<0?0:i)+'/':'')+h}return h};s.ot=function(o){var t=o.tagName;if(o.tagUrn||(o.scopeName&&o.scopeName.toUpperCase()!='HTML'))return '';t=t&&t.toUpperCase?t.toUpperCase():'';if(t=='SHAPE')t='';i"
+"f(t){if((t=='INPUT'||t=='BUTTON')&&o.type&&o.type.toUpperCase)t=o.type.toUpperCase();else if(!t&&o.href)t='A';}return t};s.oid=function(o){var s=this,t=s.ot(o),p,c,n='',x=0;if(t&&!o.s_oid){p=o.prot"
+"ocol;c=o.onclick;if(o.href&&(t=='A'||t=='AREA')&&(!c||!p||p.toLowerCase().indexOf('javascript')<0))n=s.oh(o);else if(c){n=s.rep(s.rep(s.rep(s.rep(''+c,\"\\r\",''),\"\\n\",''),\"\\t\",''),' ','');x="
+"2}else if(t=='INPUT'||t=='SUBMIT'){if(o.value)n=o.value;else if(o.innerText)n=o.innerText;else if(o.textContent)n=o.textContent;x=3}else if(o.src&&t=='IMAGE')n=o.src;if(n){o.s_oid=s.fl(n,100);o.s_o"
+"idt=x}}return o.s_oid};s.rqf=function(t,un){var s=this,e=t.indexOf('='),u=e>=0?t.substring(0,e):'',q=e>=0?s.epa(t.substring(e+1)):'';if(u&&q&&(','+u+',').indexOf(','+un+',')>=0){if(u!=s.un&&s.un.in"
+"dexOf(',')>=0)q='&u='+u+q+'&u=0';return q}return ''};s.rq=function(un){if(!un)un=this.un;var s=this,c=un.indexOf(','),v=s.c_r('s_sq'),q='';if(c<0)return s.pt(v,'&','rqf',un);return s.pt(un,',','rq'"
+",0)};s.sqp=function(t,a){var s=this,e=t.indexOf('='),q=e<0?'':s.epa(t.substring(e+1));s.sqq[q]='';if(e>=0)s.pt(t.substring(0,e),',','sqs',q);return 0};s.sqs=function(un,q){var s=this;s.squ[un]=q;re"
+"turn 0};s.sq=function(q){var s=this,k='s_sq',v=s.c_r(k),x,c=0;s.sqq=new Object;s.squ=new Object;s.sqq[q]='';s.pt(v,'&','sqp',0);s.pt(s.un,',','sqs',q);v='';for(x in s.squ)if(x&&(!Object||!Object.pr"
+"ototype||!Object.prototype[x]))s.sqq[s.squ[x]]+=(s.sqq[s.squ[x]]?',':'')+x;for(x in s.sqq)if(x&&(!Object||!Object.prototype||!Object.prototype[x])&&s.sqq[x]&&(x==q||c<2)){v+=(v?'&':'')+s.sqq[x]+'='"
+"+s.ape(x);c++}return s.c_w(k,v,0)};s.wdl=new Function('e','var s=s_c_il['+s._in+'],r=true,b=s.eh(s.wd,\"onload\"),i,o,oc;if(b)r=this[b](e);for(i=0;i<s.d.links.length;i++){o=s.d.links[i];oc=o.onclic"
+"k?\"\"+o.onclick:\"\";if((oc.indexOf(\"s_gs(\")<0||oc.indexOf(\".s_oc(\")>=0)&&oc.indexOf(\".tl(\")<0)s.eh(o,\"onclick\",0,s.lc);}return r');s.wds=function(){var s=this;if(s.apv>3&&(!s.isie||!s.ism"
+"ac||s.apv>=5)){if(s.b&&s.b.attachEvent)s.b.attachEvent('onclick',s.bc);else if(s.b&&s.b.addEventListener){if(s.n&&s.n.userAgent.indexOf('WebKit')>=0&&s.d.createEvent){s.bbc=1;s.useForcedLinkTrackin"
+"g=1;s.b.addEventListener('click',s.bc,true)}s.b.addEventListener('click',s.bc,false)}else s.eh(s.wd,'onload',0,s.wdl)}};s.vs=function(x){var s=this,v=s.visitorSampling,g=s.visitorSamplingGroup,k='s"
+"_vsn_'+s.un+(g?'_'+g:''),n=s.c_r(k),e=new Date,y=e.getYear();e.setYear(y+10+(y<1900?1900:0));if(v){v*=100;if(!n){if(!s.c_w(k,x,e))return 0;n=x}if(n%10000>v)return 0}return 1};s.dyasmf=function(t,m)"
+"{if(t&&m&&m.indexOf(t)>=0)return 1;return 0};s.dyasf=function(t,m){var s=this,i=t?t.indexOf('='):-1,n,x;if(i>=0&&m){var n=t.substring(0,i),x=t.substring(i+1);if(s.pt(x,',','dyasmf',m))return n}retu"
+"rn 0};s.uns=function(){var s=this,x=s.dynamicAccountSelection,l=s.dynamicAccountList,m=s.dynamicAccountMatch,n,i;s.un=s.un.toLowerCase();if(x&&l){if(!m)m=s.wd.location.host;if(!m.toLowerCase)m=''+m"
+";l=l.toLowerCase();m=m.toLowerCase();n=s.pt(l,';','dyasf',m);if(n)s.un=n}i=s.un.indexOf(',');s.fun=i<0?s.un:s.un.substring(0,i)};s.sa=function(un){var s=this;if(s.un&&s.mpc('sa',arguments))return;s"
+".un=un;if(!s.oun)s.oun=un;else if((','+s.oun+',').indexOf(','+un+',')<0)s.oun+=','+un;s.uns()};s.m_i=function(n,a){var s=this,m,f=n.substring(0,1),r,l,i;if(!s.m_l)s.m_l=new Object;if(!s.m_nl)s.m_nl"
+"=new Array;m=s.m_l[n];if(!a&&m&&m._e&&!m._i)s.m_a(n);if(!m){m=new Object,m._c='s_m';m._in=s.wd.s_c_in;m._il=s._il;m._il[m._in]=m;s.wd.s_c_in++;m.s=s;m._n=n;m._l=new Array('_c','_in','_il','_i','_e'"
+",'_d','_dl','s','n','_r','_g','_g1','_t','_t1','_x','_x1','_rs','_rr','_l');s.m_l[n]=m;s.m_nl[s.m_nl.length]=n}else if(m._r&&!m._m){r=m._r;r._m=m;l=m._l;for(i=0;i<l.length;i++)if(m[l[i]])r[l[i]]=m["
+"l[i]];r._il[r._in]=r;m=s.m_l[n]=r}if(f==f.toUpperCase())s[n]=m;return m};s.m_a=new Function('n','g','e','if(!g)g=\"m_\"+n;var s=s_c_il['+s._in+'],c=s[g+\"_c\"],m,x,f=0;if(s.mpc(\"m_a\",arguments))r"
+"eturn;if(!c)c=s.wd[\"s_\"+g+\"_c\"];if(c&&s_d)s[g]=new Function(\"s\",s_ft(s_d(c)));x=s[g];if(!x)x=s.wd[\\'s_\\'+g];if(!x)x=s.wd[g];m=s.m_i(n,1);if(x&&(!m._i||g!=\"m_\"+n)){m._i=f=1;if((\"\"+x).ind"
+"exOf(\"function\")>=0)x(s);else s.m_m(\"x\",n,x,e)}m=s.m_i(n,1);if(m._dl)m._dl=m._d=0;s.dlt();return f');s.m_m=function(t,n,d,e){t='_'+t;var s=this,i,x,m,f='_'+t,r=0,u;if(s.m_l&&s.m_nl)for(i=0;i<s."
+"m_nl.length;i++){x=s.m_nl[i];if(!n||x==n){m=s.m_i(x);u=m[t];if(u){if((''+u).indexOf('function')>=0){if(d&&e)u=m[t](d,e);else if(d)u=m[t](d);else u=m[t]()}}if(u)r=1;u=m[t+1];if(u&&!m[f]){if((''+u).i"
+"ndexOf('function')>=0){if(d&&e)u=m[t+1](d,e);else if(d)u=m[t+1](d);else u=m[t+1]()}}m[f]=1;if(u)r=1}}return r};s.m_ll=function(){var s=this,g=s.m_dl,i,o;if(g)for(i=0;i<g.length;i++){o=g[i];if(o)s.l"
+"oadModule(o.n,o.u,o.d,o.l,o.e,1);g[i]=0}};s.loadModule=function(n,u,d,l,e,ln){var s=this,m=0,i,g,o=0,f1,f2,c=s.h?s.h:s.b,b,tcf;if(n){i=n.indexOf(':');if(i>=0){g=n.substring(i+1);n=n.substring(0,i)}"
+"else g=\"m_\"+n;m=s.m_i(n)}if((l||(n&&!s.m_a(n,g)))&&u&&s.d&&c&&s.d.createElement){if(d){m._d=1;m._dl=1}if(ln){if(s.ssl)u=s.rep(u,'http:','https:');i='s_s:'+s._in+':'+n+':'+g;b='var s=s_c_il['+s._i"
+"n+'],o=s.d.getElementById(\"'+i+'\");if(s&&o){if(!o.l&&s.wd.'+g+'){o.l=1;if(o.i)clearTimeout(o.i);o.i=0;s.m_a(\"'+n+'\",\"'+g+'\"'+(e?',\"'+e+'\"':'')+')}';f2=b+'o.c++;if(!s.maxDelay)s.maxDelay=250"
+";if(!o.l&&o.c<(s.maxDelay*2)/100)o.i=setTimeout(o.f2,100)}';f1=new Function('e',b+'}');tcf=new Function('s','c','i','u','f1','f2','var e,o=0;try{o=s.d.createElement(\"script\");if(o){o.type=\"text/"
+"javascript\";'+(n?'o.id=i;o.defer=true;o.onload=o.onreadystatechange=f1;o.f2=f2;o.l=0;':'')+'o.src=u;c.appendChild(o);'+(n?'o.c=0;o.i=setTimeout(f2,100)':'')+'}}catch(e){o=0}return o');o=tcf(s,c,i,"
+"u,f1,f2)}else{o=new Object;o.n=n+':'+g;o.u=u;o.d=d;o.l=l;o.e=e;g=s.m_dl;if(!g)g=s.m_dl=new Array;i=0;while(i<g.length&&g[i])i++;g[i]=o}}else if(n){m=s.m_i(n);m._e=1}return m};s.voa=function(vo,r){v"
+"ar s=this,l=s.va_g,i,k,v,x;for(i=0;i<l.length;i++){k=l[i];v=vo[k];if(v||vo['!'+k]){if(!r&&(k==\"contextData\"||k==\"retrieveLightData\")&&s[k])for(x in s[k])if(!v[x])v[x]=s[k][x];s[k]=v}}};s.vob=fu"
+"nction(vo){var s=this,l=s.va_g,i,k;for(i=0;i<l.length;i++){k=l[i];vo[k]=s[k];if(!vo[k])vo['!'+k]=1}};s.dlt=new Function('var s=s_c_il['+s._in+'],d=new Date,i,vo,f=0;if(s.dll)for(i=0;i<s.dll.length;"
+"i++){vo=s.dll[i];if(vo){if(!s.m_m(\"d\")||d.getTime()-vo._t>=s.maxDelay){s.dll[i]=0;s.t(vo)}else f=1}}if(s.dli)clearTimeout(s.dli);s.dli=0;if(f){if(!s.dli)s.dli=setTimeout(s.dlt,s.maxDelay)}else s."
+"dll=0');s.dl=function(vo){var s=this,d=new Date;if(!vo)vo=new Object;s.vob(vo);vo._t=d.getTime();if(!s.dll)s.dll=new Array;s.dll[s.dll.length]=vo;if(!s.maxDelay)s.maxDelay=250;s.dlt()};s.track=s.t="
+"function(vo){var s=this,trk=1,tm=new Date,sed=Math&&Math.random?Math.floor(Math.random()*10000000000000):tm.getTime(),sess='s'+Math.floor(tm.getTime()/10800000)%10+sed,y=tm.getYear(),vt=tm.getDate("
+")+'/'+tm.getMonth()+'/'+(y<1900?y+1900:y)+' '+tm.getHours()+':'+tm.getMinutes()+':'+tm.getSeconds()+' '+tm.getDay()+' '+tm.getTimezoneOffset(),tcf,tfs=s.gtfs(),ta=-1,q='',qs='',code='',vb=new Objec"
+"t;if(s.mpc('t',arguments))return;s.gl(s.vl_g);s.uns();s.m_ll();if(!s.td){var tl=tfs.location,a,o,i,x='',c='',v='',p='',bw='',bh='',j='1.0',k=s.c_w('s_cc','true',0)?'Y':'N',hp='',ct='',pn=0,ps;if(St"
+"ring&&String.prototype){j='1.1';if(j.match){j='1.2';if(tm.setUTCDate){j='1.3';if(s.isie&&s.ismac&&s.apv>=5)j='1.4';if(pn.toPrecision){j='1.5';a=new Array;if(a.forEach){j='1.6';i=0;o=new Object;tcf="
+"new Function('o','var e,i=0;try{i=new Iterator(o)}catch(e){}return i');i=tcf(o);if(i&&i.next){j='1.7';if(a.reduce){j='1.8';if(j.trim){j='1.8.1';if(Date.parse){j='1.8.2';if(Object.create)j='1.8.5'}}"
+"}}}}}}}if(s.apv>=4)x=screen.width+'x'+screen.height;if(s.isns||s.isopera){if(s.apv>=3){v=s.n.javaEnabled()?'Y':'N';if(s.apv>=4){c=screen.pixelDepth;bw=s.wd.innerWidth;bh=s.wd.innerHeight}}s.pl=s.n."
+"plugins}else if(s.isie){if(s.apv>=4){v=s.n.javaEnabled()?'Y':'N';c=screen.colorDepth;if(s.apv>=5){bw=s.d.documentElement.offsetWidth;bh=s.d.documentElement.offsetHeight;if(!s.ismac&&s.b){tcf=new Fu"
+"nction('s','tl','var e,hp=0;try{s.b.addBehavior(\"#default#homePage\");hp=s.b.isHomePage(tl)?\"Y\":\"N\"}catch(e){}return hp');hp=tcf(s,tl);tcf=new Function('s','var e,ct=0;try{s.b.addBehavior(\"#d"
+"efault#clientCaps\");ct=s.b.connectionType}catch(e){}return ct');ct=tcf(s)}}}else r=''}if(s.pl)while(pn<s.pl.length&&pn<30){ps=s.fl(s.pl[pn].name,100)+';';if(p.indexOf(ps)<0)p+=ps;pn++}s.resolution"
+"=x;s.colorDepth=c;s.javascriptVersion=j;s.javaEnabled=v;s.cookiesEnabled=k;s.browserWidth=bw;s.browserHeight=bh;s.connectionType=ct;s.homepage=hp;s.plugins=p;s.td=1}if(vo){s.vob(vb);s.voa(vo)}if((v"
+"o&&vo._t)||!s.m_m('d')){if(s.usePlugins)s.doPlugins(s);var l=s.wd.location,r=tfs.document.referrer;if(!s.pageURL)s.pageURL=l.href?l.href:l;if(!s.referrer&&!s._1_referrer){s.referrer=r;s._1_referrer"
+"=1}s.m_m('g');if(s.lnk||s.eo){var o=s.eo?s.eo:s.lnk,p=s.pageName,w=1,t=s.ot(o),n=s.oid(o),x=o.s_oidt,h,l,i,oc;if(s.eo&&o==s.eo){while(o&&!n&&t!='BODY'){o=o.parentElement?o.parentElement:o.parentNod"
+"e;if(o){t=s.ot(o);n=s.oid(o);x=o.s_oidt}}if(!n||t=='BODY')o='';if(o){oc=o.onclick?''+o.onclick:'';if((oc.indexOf('s_gs(')>=0&&oc.indexOf('.s_oc(')<0)||oc.indexOf('.tl(')>=0)o=0}}if(o){if(n)ta=o.tar"
+"get;h=s.oh(o);i=h.indexOf('?');h=s.linkLeaveQueryString||i<0?h:h.substring(0,i);l=s.linkName;t=s.linkType?s.linkType.toLowerCase():s.lt(h);if(t&&(h||l)){s.pe='lnk_'+(t=='d'||t=='e'?t:'o');s.pev1=(h"
+"?s.ape(h):'');s.pev2=(l?s.ape(l):'')}else trk=0;if(s.trackInlineStats){if(!p){p=s.pageURL;w=0}t=s.ot(o);i=o.sourceIndex;if(o.dataset&&o.dataset.sObjectId){s.wd.s_objectID=o.dataset.sObjectId;}else "
+"if(o.getAttribute&&o.getAttribute('data-s-object-id')){s.wd.s_objectID=o.getAttribute('data-s-object-id');}else if(s.useForcedLinkTracking){s.wd.s_objectID='';oc=o.onclick?''+o.onclick:'';if(oc){va"
+"r ocb=oc.indexOf('s_objectID'),oce,ocq,ocx;if(ocb>=0){ocb+=10;while(ocb<oc.length&&(\"= \\t\\r\\n\").indexOf(oc.charAt(ocb))>=0)ocb++;if(ocb<oc.length){oce=ocb;ocq=ocx=0;while(oce<oc.length&&(oc.ch"
+"arAt(oce)!=';'||ocq)){if(ocq){if(oc.charAt(oce)==ocq&&!ocx)ocq=0;else if(oc.charAt(oce)==\"\\\\\")ocx=!ocx;else ocx=0;}else{ocq=oc.charAt(oce);if(ocq!='\"'&&ocq!=\"'\")ocq=0}oce++;}oc=oc.substring("
+"ocb,oce);if(oc){o.s_soid=new Function('s','var e;try{s.wd.s_objectID='+oc+'}catch(e){}');o.s_soid(s)}}}}}if(s.gg('objectID')){n=s.gg('objectID');x=1;i=1}if(p&&n&&t)qs='&pid='+s.ape(s.fl(p,255))+(w?"
+"'&pidt='+w:'')+'&oid='+s.ape(s.fl(n,100))+(x?'&oidt='+x:'')+'&ot='+s.ape(t)+(i?'&oi='+i:'')}}else trk=0}if(trk||qs){s.sampled=s.vs(sed);if(trk){if(s.sampled)code=s.mr(sess,(vt?'&t='+s.ape(vt):'')+s"
+".hav()+q+(qs?qs:s.rq()),0,ta);qs='';s.m_m('t');if(s.p_r)s.p_r();s.referrer=s.lightProfileID=s.retrieveLightProfiles=s.deleteLightProfiles=''}s.sq(qs)}}else s.dl(vo);if(vo)s.voa(vb,1);s.lnk=s.eo=s.l"
+"inkName=s.linkType=s.wd.s_objectID=s.ppu=s.pe=s.pev1=s.pev2=s.pev3='';if(s.pg)s.wd.s_lnk=s.wd.s_eo=s.wd.s_linkName=s.wd.s_linkType='';return code};s.trackLink=s.tl=function(o,t,n,vo,f){var s=this;s"
+".lnk=o;s.linkType=t;s.linkName=n;if(f){s.bct=o;s.bcf=f}s.t(vo)};s.trackLight=function(p,ss,i,vo){var s=this;s.lightProfileID=p;s.lightStoreForSeconds=ss;s.lightIncrementBy=i;s.t(vo)};s.setTagContai"
+"ner=function(n){var s=this,l=s.wd.s_c_il,i,t,x,y;s.tcn=n;if(l)for(i=0;i<l.length;i++){t=l[i];if(t&&t._c=='s_l'&&t.tagContainerName==n){s.voa(t);if(t.lmq)for(i=0;i<t.lmq.length;i++){x=t.lmq[i];y='m_"
+"'+x.n;if(!s[y]&&!s[y+'_c']){s[y]=t[y];s[y+'_c']=t[y+'_c']}s.loadModule(x.n,x.u,x.d)}if(t.ml)for(x in t.ml)if(s[x]){y=s[x];x=t.ml[x];for(i in x)if(!Object.prototype[i]){if(typeof(x[i])!='function'||"
+"(''+x[i]).indexOf('s_c_il')<0)y[i]=x[i]}}if(t.mmq)for(i=0;i<t.mmq.length;i++){x=t.mmq[i];if(s[x.m]){y=s[x.m];if(y[x.f]&&typeof(y[x.f])=='function'){if(x.a)y[x.f].apply(y,x.a);else y[x.f].apply(y)}}"
+"}if(t.tq)for(i=0;i<t.tq.length;i++)s.t(t.tq[i]);t.s=s;return}}};s.wd=window;s.ssl=(s.wd.location.protocol.toLowerCase().indexOf('https')>=0);s.d=document;s.b=s.d.body;if(s.d.getElementsByTagName){s"
+".h=s.d.getElementsByTagName('HEAD');if(s.h)s.h=s.h[0]}s.n=navigator;s.u=s.n.userAgent;s.ns6=s.u.indexOf('Netscape6/');var apn=s.n.appName,v=s.n.appVersion,ie=v.indexOf('MSIE '),o=s.u.indexOf('Opera"
+" '),i;if(v.indexOf('Opera')>=0||o>0)apn='Opera';s.isie=(apn=='Microsoft Internet Explorer');s.isns=(apn=='Netscape');s.isopera=(apn=='Opera');s.ismac=(s.u.indexOf('Mac')>=0);if(o>0)s.apv=parseFloat"
+"(s.u.substring(o+6));else if(ie>0){s.apv=parseInt(i=v.substring(ie+5));if(s.apv>3)s.apv=parseFloat(i)}else if(s.ns6>0)s.apv=parseFloat(s.u.substring(s.ns6+10));else s.apv=parseFloat(v);s.em=0;if(s."
+"em.toPrecision)s.em=3;else if(String.fromCharCode){i=escape(String.fromCharCode(256)).toUpperCase();s.em=(i=='%C4%80'?2:(i=='%U0100'?1:0))}if(s.oun)s.sa(s.oun);s.sa(un);s.vl_l='timestamp,dynamicVar"
+"iablePrefix,visitorID,vmk,visitorMigrationKey,visitorMigrationServer,visitorMigrationServerSecure,ppu,charSet,visitorNamespace,cookieDomainPeriods,cookieLifetime,pageName,pageURL,referrer,contextDa"
+"ta,currencyCode,lightProfileID,lightStoreForSeconds,lightIncrementBy,retrieveLightProfiles,deleteLightProfiles,retrieveLightData';s.va_l=s.sp(s.vl_l,',');s.vl_mr=s.vl_m='timestamp,charSet,visitorNa"
+"mespace,cookieDomainPeriods,cookieLifetime,contextData,lightProfileID,lightStoreForSeconds,lightIncrementBy';s.vl_t=s.vl_l+',variableProvider,channel,server,pageType,transactionID,purchaseID,campai"
+"gn,state,zip,events,events2,products,linkName,linkType';var n;for(n=1;n<=75;n++){s.vl_t+=',prop'+n+',eVar'+n;s.vl_m+=',prop'+n+',eVar'+n}for(n=1;n<=5;n++)s.vl_t+=',hier'+n;for(n=1;n<=3;n++)s.vl_t+="
+"',list'+n;s.va_m=s.sp(s.vl_m,',');s.vl_l2=',tnt,pe,pev1,pev2,pev3,resolution,colorDepth,javascriptVersion,javaEnabled,cookiesEnabled,browserWidth,browserHeight,connectionType,homepage,plugins';s.vl"
+"_t+=s.vl_l2;s.va_t=s.sp(s.vl_t,',');s.vl_g=s.vl_t+',trackingServer,trackingServerSecure,trackingServerBase,fpCookieDomainPeriods,disableBufferedRequests,mobile,visitorSampling,visitorSamplingGroup,"
+"dynamicAccountSelection,dynamicAccountList,dynamicAccountMatch,trackDownloadLinks,trackExternalLinks,trackInlineStats,linkLeaveQueryString,linkDownloadFileTypes,linkExternalFilters,linkInternalFilt"
+"ers,linkTrackVars,linkTrackEvents,linkNames,lnk,eo,lightTrackVars,_1_referrer,un';s.va_g=s.sp(s.vl_g,',');s.pg=pg;s.gl(s.vl_g);s.contextData=new Object;s.retrieveLightData=new Object;if(!ss)s.wds()"
+";if(pg){s.wd.s_co=function(o){return o};s.wd.s_gs=function(un){s_gi(un,1,1).t()};s.wd.s_dc=function(un){s_gi(un,1).t()}}",w=window,l=w.s_c_il,n=navigator,u=n.userAgent,v=n.appVersion,e=v.indexOf('MSIE '),m=u.indexOf('Netscape6/'),a,i,j,x,s;if(un){un=un.toLowerCase();if(l)for(j=0;j<2;j++)for(i=0;i<l.length;i++){s=l[i];x=s._c;if((!x||x=='s_c'||(j>0&&x=='s_l'))&&(s.oun==un||(s.fs&&s.sa&&s.fs(s.oun,un)))){if(s.sa)s.sa(un);if(x=='s_c')return s}else s=0}}w.s_an='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';w.s_sp=new Function("x","d","var a=new Array,i=0,j;if(x){if(x.split)a=x.split(d);else if(!d)for(i=0;i<x.length;i++)a[a.length]=x.substring(i,i+1);else while(i>=0){j=x.indexOf(d,i);a[a.length]=x.subst"
+"ring(i,j<0?x.length:j);i=j;if(i>=0)i+=d.length}}return a");w.s_jn=new Function("a","d","var x='',i,j=a.length;if(a&&j>0){x=a[0];if(j>1){if(a.join)x=a.join(d);else for(i=1;i<j;i++)x+=d+a[i]}}return x");w.s_rep=new Function("x","o","n","return s_jn(s_sp(x,o),n)");w.s_d=new Function("x","var t='`^@$#',l=s_an,l2=new Object,x2,d,b=0,k,i=x.lastIndexOf('~~'),j,v,w;if(i>0){d=x.substring(0,i);x=x.substring(i+2);l=s_sp(l,'');for(i=0;i<62;i++)l2[l[i]]=i;t=s_sp(t,'');d"
+"=s_sp(d,'~');i=0;while(i<5){v=0;if(x.indexOf(t[i])>=0) {x2=s_sp(x,t[i]);for(j=1;j<x2.length;j++){k=x2[j].substring(0,1);w=t[i]+k;if(k!=' '){v=1;w=d[b+l2[k]]}x2[j]=w+x2[j].substring(1)}}if(v)x=s_jn("
+"x2,'');else{w=t[i]+' ';if(x.indexOf(w)>=0)x=s_rep(x,w,t[i]);i++;b+=62}}}return x");w.s_fe=new Function("c","return s_rep(s_rep(s_rep(c,'\\\\','\\\\\\\\'),'\"','\\\\\"'),\"\\n\",\"\\\\n\")");w.s_fa=new Function("f","var s=f.indexOf('(')+1,e=f.indexOf(')'),a='',c;while(s>=0&&s<e){c=f.substring(s,s+1);if(c==',')a+='\",\"';else if((\"\\n\\r\\t \").indexOf(c)<0)a+=c;s++}return a?'\"'+a+'\"':"
+"a");w.s_ft=new Function("c","c+='';var s,e,o,a,d,q,f,h,x;s=c.indexOf('=function(');while(s>=0){s++;d=1;q='';x=0;f=c.substring(s);a=s_fa(f);e=o=c.indexOf('{',s);e++;while(d>0){h=c.substring(e,e+1);if(q){i"
+"f(h==q&&!x)q='';if(h=='\\\\')x=x?0:1;else x=0}else{if(h=='\"'||h==\"'\")q=h;if(h=='{')d++;if(h=='}')d--}if(d>0)e++}c=c.substring(0,s)+'new Function('+(a?a+',':'')+'\"'+s_fe(c.substring(o+1,e))+'\")"
+"'+c.substring(e+1);s=c.indexOf('=function(')}return c;");c=s_d(c);if(e>0){a=parseInt(i=v.substring(e+5));if(a>3)a=parseFloat(i)}else if(m>0)a=parseFloat(u.substring(m+10));else a=parseFloat(v);if(a<5||v.indexOf('Opera')>=0||u.indexOf('Opera')>=0)c=s_ft(c);if(!s){s=new Object;if(!w.s_c_in){w.s_c_il=new Array;w.s_c_in=0}s._il=w.s_c_il;s._in=w.s_c_in;s._il[s._in]=s;w.s_c_in++;}s._c='s_c';(new Function("s","un","pg","ss",c))(s,un,pg,ss);return s}
function s_giqf(){var w=window,q=w.s_giq,i,t,s;if(q)for(i=0;i<q.length;i++){t=q[i];s=s_gi(t.oun);s.sa(t.un);s.setTagContainer(t.tagContainerName)}w.s_giq=0}s_giqf()

if(typeof jwplayer=="undefined"){var jwplayer=function(a){if(jwplayer.api){return jwplayer.api.selectPlayer(a)}};var $jw=jwplayer;jwplayer.version="5.10.2295 (Licensed version)";jwplayer.vid=document.createElement("video");jwplayer.audio=document.createElement("audio");jwplayer.source=document.createElement("source");(function(b){b.utils=function(){};b.utils.typeOf=function(d){var c=typeof d;if(c==="object"){if(d){if(d instanceof Array){c="array"}}else{c="null"}}return c};b.utils.extend=function(){var c=b.utils.extend["arguments"];if(c.length>1){for(var e=1;e<c.length;e++){for(var d in c[e]){c[0][d]=c[e][d]}}return c[0]}return null};b.utils.clone=function(f){var c;var d=b.utils.clone["arguments"];if(d.length==1){switch(b.utils.typeOf(d[0])){case"object":c={};for(var e in d[0]){c[e]=b.utils.clone(d[0][e])}break;case"array":c=[];for(var e in d[0]){c[e]=b.utils.clone(d[0][e])}break;default:return d[0];break}}return c};b.utils.extension=function(c){if(!c){return""}c=c.substring(c.lastIndexOf("/")+1,c.length);c=c.split("?")[0];if(c.lastIndexOf(".")>-1){return c.substr(c.lastIndexOf(".")+1,c.length).toLowerCase()}return};b.utils.html=function(c,d){c.innerHTML=d};b.utils.wrap=function(c,d){if(c.parentNode){c.parentNode.replaceChild(d,c)}d.appendChild(c)};b.utils.ajax=function(g,f,c){var e;if(window.XMLHttpRequest){e=new XMLHttpRequest()}else{e=new ActiveXObject("Microsoft.XMLHTTP")}e.onreadystatechange=function(){if(e.readyState===4){if(e.status===200){if(f){if(!b.utils.exists(e.responseXML)){try{if(window.DOMParser){var h=(new DOMParser()).parseFromString(e.responseText,"text/xml");if(h){e=b.utils.extend({},e,{responseXML:h})}}else{h=new ActiveXObject("Microsoft.XMLDOM");h.async="false";h.loadXML(e.responseText);e=b.utils.extend({},e,{responseXML:h})}}catch(j){if(c){c(g)}}}f(e)}}else{if(c){c(g)}}}};try{e.open("GET",g,true);e.send(null)}catch(d){if(c){c(g)}}return e};b.utils.load=function(d,e,c){d.onreadystatechange=function(){if(d.readyState===4){if(d.status===200){if(e){e()}}else{if(c){c()}}}}};b.utils.find=function(d,c){return d.getElementsByTagName(c)};b.utils.append=function(c,d){c.appendChild(d)};b.utils.isIE=function(){return((!+"\v1")||(typeof window.ActiveXObject!="undefined"))};b.utils.userAgentMatch=function(d){var c=navigator.userAgent.toLowerCase();return(c.match(d)!==null)};b.utils.isIOS=function(){return b.utils.userAgentMatch(/iP(hone|ad|od)/i)};b.utils.isIPad=function(){return b.utils.userAgentMatch(/iPad/i)};b.utils.isIPod=function(){return b.utils.userAgentMatch(/iP(hone|od)/i)};b.utils.isAndroid=function(){return b.utils.userAgentMatch(/android/i)};b.utils.isLegacyAndroid=function(){return b.utils.userAgentMatch(/android 2.[012]/i)};b.utils.isBlackberry=function(){return b.utils.userAgentMatch(/blackberry/i)};b.utils.isMobile=function(){return b.utils.userAgentMatch(/(iP(hone|ad|od))|android/i)};b.utils.getFirstPlaylistItemFromConfig=function(c){var d={};var e;if(c.playlist&&c.playlist.length){e=c.playlist[0]}else{e=c}d.file=e.file;d.levels=e.levels;d.streamer=e.streamer;d.playlistfile=e.playlistfile;d.provider=e.provider;if(!d.provider){if(d.file&&(d.file.toLowerCase().indexOf("youtube.com")>-1||d.file.toLowerCase().indexOf("youtu.be")>-1)){d.provider="youtube"}if(d.streamer&&d.streamer.toLowerCase().indexOf("rtmp://")==0){d.provider="rtmp"}if(e.type){d.provider=e.type.toLowerCase()}}if(d.provider=="audio"){d.provider="sound"}return d};b.utils.getOuterHTML=function(c){if(c.outerHTML){return c.outerHTML}else{try{return new XMLSerializer().serializeToString(c)}catch(d){return""}}};b.utils.setOuterHTML=function(f,e){if(f.outerHTML){f.outerHTML=e}else{var g=document.createElement("div");g.innerHTML=e;var c=document.createRange();c.selectNodeContents(g);var d=c.extractContents();f.parentNode.insertBefore(d,f);f.parentNode.removeChild(f)}};b.utils.hasFlash=function(){if(typeof navigator.plugins!="undefined"&&typeof navigator.plugins["Shockwave Flash"]!="undefined"){return true}if(typeof window.ActiveXObject!="undefined"){try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return true}catch(c){}}return false};b.utils.getPluginName=function(c){if(c.lastIndexOf("/")>=0){c=c.substring(c.lastIndexOf("/")+1,c.length)}if(c.lastIndexOf("-")>=0){c=c.substring(0,c.lastIndexOf("-"))}if(c.lastIndexOf(".swf")>=0){c=c.substring(0,c.lastIndexOf(".swf"))}if(c.lastIndexOf(".js")>=0){c=c.substring(0,c.lastIndexOf(".js"))}return c};b.utils.getPluginVersion=function(c){if(c.lastIndexOf("-")>=0){if(c.lastIndexOf(".js")>=0){return c.substring(c.lastIndexOf("-")+1,c.lastIndexOf(".js"))}else{if(c.lastIndexOf(".swf")>=0){return c.substring(c.lastIndexOf("-")+1,c.lastIndexOf(".swf"))}else{return c.substring(c.lastIndexOf("-")+1)}}}return""};b.utils.getAbsolutePath=function(j,h){if(!b.utils.exists(h)){h=document.location.href}if(!b.utils.exists(j)){return undefined}if(a(j)){return j}var k=h.substring(0,h.indexOf("://")+3);var g=h.substring(k.length,h.indexOf("/",k.length+1));var d;if(j.indexOf("/")===0){d=j.split("/")}else{var e=h.split("?")[0];e=e.substring(k.length+g.length+1,e.lastIndexOf("/"));d=e.split("/").concat(j.split("/"))}var c=[];for(var f=0;f<d.length;f++){if(!d[f]||!b.utils.exists(d[f])||d[f]=="."){continue}else{if(d[f]==".."){c.pop()}else{c.push(d[f])}}}return k+g+"/"+c.join("/")};function a(d){if(!b.utils.exists(d)){return}var e=d.indexOf("://");var c=d.indexOf("?");return(e>0&&(c<0||(c>e)))}b.utils.pluginPathType={ABSOLUTE:"ABSOLUTE",RELATIVE:"RELATIVE",CDN:"CDN"};b.utils.getPluginPathType=function(d){if(typeof d!="string"){return}d=d.split("?")[0];var e=d.indexOf("://");if(e>0){return b.utils.pluginPathType.ABSOLUTE}var c=d.indexOf("/");var f=b.utils.extension(d);if(e<0&&c<0&&(!f||!isNaN(f))){return b.utils.pluginPathType.CDN}return b.utils.pluginPathType.RELATIVE};b.utils.mapEmpty=function(c){for(var d in c){return false}return true};b.utils.mapLength=function(d){var c=0;for(var e in d){c++}return c};b.utils.log=function(d,c){if(typeof console!="undefined"&&typeof console.log!="undefined"){if(c){console.log(d,c)}else{console.log(d)}}};b.utils.css=function(d,g,c){if(b.utils.exists(d)){for(var e in g){try{if(typeof g[e]==="undefined"){continue}else{if(typeof g[e]=="number"&&!(e=="zIndex"||e=="opacity")){if(isNaN(g[e])){continue}if(e.match(/color/i)){g[e]="#"+b.utils.strings.pad(g[e].toString(16),6)}else{g[e]=Math.ceil(g[e])+"px"}}}d.style[e]=g[e]}catch(f){}}}};b.utils.isYouTube=function(c){return(c.indexOf("youtube.com")>-1||c.indexOf("youtu.be")>-1)};b.utils.transform=function(e,d,c,g,h){if(!b.utils.exists(d)){d=1}if(!b.utils.exists(c)){c=1}if(!b.utils.exists(g)){g=0}if(!b.utils.exists(h)){h=0}if(d==1&&c==1&&g==0&&h==0){e.style.webkitTransform="";e.style.MozTransform="";e.style.OTransform=""}else{var f="scale("+d+","+c+") translate("+g+"px,"+h+"px)";e.style.webkitTransform=f;e.style.MozTransform=f;e.style.OTransform=f}};b.utils.stretch=function(k,q,p,g,n,h){if(typeof p=="undefined"||typeof g=="undefined"||typeof n=="undefined"||typeof h=="undefined"){return}var d=p/n;var f=g/h;var m=0;var l=0;var e=false;var c={};if(q.parentElement){q.parentElement.style.overflow="hidden"}b.utils.transform(q);switch(k.toUpperCase()){case b.utils.stretching.NONE:c.width=n;c.height=h;c.top=(g-c.height)/2;c.left=(p-c.width)/2;break;case b.utils.stretching.UNIFORM:if(d>f){c.width=n*f;c.height=h*f;if(c.width/p>0.95){e=true;d=Math.ceil(100*p/c.width)/100;f=1;c.width=p}}else{c.width=n*d;c.height=h*d;if(c.height/g>0.95){e=true;d=1;f=Math.ceil(100*g/c.height)/100;c.height=g}}c.top=(g-c.height)/2;c.left=(p-c.width)/2;break;case b.utils.stretching.FILL:if(d>f){c.width=n*d;c.height=h*d}else{c.width=n*f;c.height=h*f}c.top=(g-c.height)/2;c.left=(p-c.width)/2;break;case b.utils.stretching.EXACTFIT:c.width=n;c.height=h;var o=Math.round((n/2)*(1-1/d));var j=Math.round((h/2)*(1-1/f));e=true;c.top=c.left=0;break;default:break}if(e){b.utils.transform(q,d,f,o,j)}b.utils.css(q,c)};b.utils.stretching={NONE:"NONE",FILL:"FILL",UNIFORM:"UNIFORM",EXACTFIT:"EXACTFIT"};b.utils.deepReplaceKeyName=function(k,e,c){switch(b.utils.typeOf(k)){case"array":for(var g=0;g<k.length;g++){k[g]=b.utils.deepReplaceKeyName(k[g],e,c)}break;case"object":for(var f in k){var j,h;if(e instanceof Array&&c instanceof Array){if(e.length!=c.length){continue}else{j=e;h=c}}else{j=[e];h=[c]}var d=f;for(var g=0;g<j.length;g++){d=d.replace(new RegExp(e[g],"g"),c[g])}k[d]=b.utils.deepReplaceKeyName(k[f],e,c);if(f!=d){delete k[f]}}break}return k};b.utils.isInArray=function(e,d){if(!(e)||!(e instanceof Array)){return false}for(var c=0;c<e.length;c++){if(d===e[c]){return true}}return false};b.utils.exists=function(c){switch(typeof(c)){case"string":return(c.length>0);break;case"object":return(c!==null);case"undefined":return false}return true};b.utils.empty=function(c){if(typeof c.hasChildNodes=="function"){while(c.hasChildNodes()){c.removeChild(c.firstChild)}}};b.utils.parseDimension=function(c){if(typeof c=="string"){if(c===""){return 0}else{if(c.lastIndexOf("%")>-1){return c}else{return parseInt(c.replace("px",""),10)}}}return c};b.utils.getDimensions=function(c){if(c&&c.style){return{x:b.utils.parseDimension(c.style.left),y:b.utils.parseDimension(c.style.top),width:b.utils.parseDimension(c.style.width),height:b.utils.parseDimension(c.style.height)}}else{return{}}};b.utils.getElementWidth=function(c){if(!c){return null}else{if(c==document.body){return b.utils.parentNode(c).clientWidth}else{if(c.clientWidth>0){return c.clientWidth}else{if(c.style){return b.utils.parseDimension(c.style.width)}else{return null}}}}};b.utils.getElementHeight=function(c){if(!c){return null}else{if(c==document.body){return b.utils.parentNode(c).clientHeight}else{if(c.clientHeight>0){return c.clientHeight}else{if(c.style){return b.utils.parseDimension(c.style.height)}else{return null}}}}};b.utils.timeFormat=function(c){str="00:00";if(c>0){str=Math.floor(c/60)<10?"0"+Math.floor(c/60)+":":Math.floor(c/60)+":";str+=Math.floor(c%60)<10?"0"+Math.floor(c%60):Math.floor(c%60)}return str};b.utils.useNativeFullscreen=function(){return(navigator&&navigator.vendor&&navigator.vendor.indexOf("Apple")==0)};b.utils.parentNode=function(c){if(!c){return document.body}else{if(c.parentNode){return c.parentNode}else{if(c.parentElement){return c.parentElement}else{return c}}}};b.utils.getBoundingClientRect=function(c){if(typeof c.getBoundingClientRect=="function"){return c.getBoundingClientRect()}else{return{left:c.offsetLeft+document.body.scrollLeft,top:c.offsetTop+document.body.scrollTop,width:c.offsetWidth,height:c.offsetHeight}}};b.utils.translateEventResponse=function(e,c){var g=b.utils.extend({},c);if(e==b.api.events.JWPLAYER_FULLSCREEN&&!g.fullscreen){g.fullscreen=g.message=="true"?true:false;delete g.message}else{if(typeof g.data=="object"){g=b.utils.extend(g,g.data);delete g.data}else{if(typeof g.metadata=="object"){b.utils.deepReplaceKeyName(g.metadata,["__dot__","__spc__","__dsh__"],["."," ","-"])}}}var d=["position","duration","offset"];for(var f in d){if(g[d[f]]){g[d[f]]=Math.round(g[d[f]]*1000)/1000}}return g};b.utils.saveCookie=function(c,d){document.cookie="jwplayer."+c+"="+d+"; path=/"};b.utils.getCookies=function(){var f={};var e=document.cookie.split("; ");for(var d=0;d<e.length;d++){var c=e[d].split("=");if(c[0].indexOf("jwplayer.")==0){f[c[0].substring(9,c[0].length)]=c[1]}}return f};b.utils.readCookie=function(c){return b.utils.getCookies()[c]}})(jwplayer);(function(a){a.events=function(){};a.events.COMPLETE="COMPLETE";a.events.ERROR="ERROR"})(jwplayer);(function(jwplayer){jwplayer.events.eventdispatcher=function(debug){var _debug=debug;var _listeners;var _globallisteners;this.resetEventListeners=function(){_listeners={};_globallisteners=[]};this.resetEventListeners();this.addEventListener=function(type,listener,count){try{if(!jwplayer.utils.exists(_listeners[type])){_listeners[type]=[]}if(typeof(listener)=="string"){eval("listener = "+listener)}_listeners[type].push({listener:listener,count:count})}catch(err){jwplayer.utils.log("error",err)}return false};this.removeEventListener=function(type,listener){if(!_listeners[type]){return}try{for(var listenerIndex=0;listenerIndex<_listeners[type].length;listenerIndex++){if(_listeners[type][listenerIndex].listener.toString()==listener.toString()){_listeners[type].splice(listenerIndex,1);break}}}catch(err){jwplayer.utils.log("error",err)}return false};this.addGlobalListener=function(listener,count){try{if(typeof(listener)=="string"){eval("listener = "+listener)}_globallisteners.push({listener:listener,count:count})}catch(err){jwplayer.utils.log("error",err)}return false};this.removeGlobalListener=function(listener){if(!listener){return}try{for(var globalListenerIndex=0;globalListenerIndex<_globallisteners.length;globalListenerIndex++){if(_globallisteners[globalListenerIndex].listener.toString()==listener.toString()){_globallisteners.splice(globalListenerIndex,1);break}}}catch(err){jwplayer.utils.log("error",err)}return false};this.sendEvent=function(type,data){if(!jwplayer.utils.exists(data)){data={}}if(_debug){jwplayer.utils.log(type,data)}if(typeof _listeners[type]!="undefined"){for(var listenerIndex=0;listenerIndex<_listeners[type].length;listenerIndex++){try{_listeners[type][listenerIndex].listener(data)}catch(err){jwplayer.utils.log("There was an error while handling a listener: "+err.toString(),_listeners[type][listenerIndex].listener)}if(_listeners[type][listenerIndex]){if(_listeners[type][listenerIndex].count===1){delete _listeners[type][listenerIndex]}else{if(_listeners[type][listenerIndex].count>0){_listeners[type][listenerIndex].count=_listeners[type][listenerIndex].count-1}}}}}for(var globalListenerIndex=0;globalListenerIndex<_globallisteners.length;globalListenerIndex++){try{_globallisteners[globalListenerIndex].listener(data)}catch(err){jwplayer.utils.log("There was an error while handling a listener: "+err.toString(),_globallisteners[globalListenerIndex].listener)}if(_globallisteners[globalListenerIndex]){if(_globallisteners[globalListenerIndex].count===1){delete _globallisteners[globalListenerIndex]}else{if(_globallisteners[globalListenerIndex].count>0){_globallisteners[globalListenerIndex].count=_globallisteners[globalListenerIndex].count-1}}}}}}})(jwplayer);(function(a){var b={};a.utils.animations=function(){};a.utils.animations.transform=function(c,d){c.style.webkitTransform=d;c.style.MozTransform=d;c.style.OTransform=d;c.style.msTransform=d};a.utils.animations.transformOrigin=function(c,d){c.style.webkitTransformOrigin=d;c.style.MozTransformOrigin=d;c.style.OTransformOrigin=d;c.style.msTransformOrigin=d};a.utils.animations.rotate=function(c,d){a.utils.animations.transform(c,["rotate(",d,"deg)"].join(""))};a.utils.cancelAnimation=function(c){delete b[c.id]};a.utils.fadeTo=function(m,f,e,j,h,d){if(b[m.id]!=d&&a.utils.exists(d)){return}if(m.style.opacity==f){return}var c=new Date().getTime();if(d>c){setTimeout(function(){a.utils.fadeTo(m,f,e,j,0,d)},d-c)}if(m.style.display=="none"){m.style.display="block"}if(!a.utils.exists(j)){j=m.style.opacity===""?1:m.style.opacity}if(m.style.opacity==f&&m.style.opacity!==""&&a.utils.exists(d)){if(f===0){m.style.display="none"}return}if(!a.utils.exists(d)){d=c;b[m.id]=d}if(!a.utils.exists(h)){h=0}var k=(e>0)?((c-d)/(e*1000)):0;k=k>1?1:k;var l=f-j;var g=j+(k*l);if(g>1){g=1}else{if(g<0){g=0}}m.style.opacity=g;if(h>0){b[m.id]=d+h*1000;a.utils.fadeTo(m,f,e,j,0,b[m.id]);return}setTimeout(function(){a.utils.fadeTo(m,f,e,j,0,d)},10)}})(jwplayer);(function(a){a.utils.arrays=function(){};a.utils.arrays.indexOf=function(c,d){for(var b=0;b<c.length;b++){if(c[b]==d){return b}}return-1};a.utils.arrays.remove=function(c,d){var b=a.utils.arrays.indexOf(c,d);if(b>-1){c.splice(b,1)}}})(jwplayer);(function(a){a.utils.extensionmap={"3gp":{html5:"video/3gpp",flash:"video"},"3gpp":{html5:"video/3gpp"},"3g2":{html5:"video/3gpp2",flash:"video"},"3gpp2":{html5:"video/3gpp2"},flv:{flash:"video"},f4a:{html5:"audio/mp4"},f4b:{html5:"audio/mp4",flash:"video"},f4v:{html5:"video/mp4",flash:"video"},mov:{html5:"video/quicktime",flash:"video"},m4a:{html5:"audio/mp4",flash:"video"},m4b:{html5:"audio/mp4"},m4p:{html5:"audio/mp4"},m4v:{html5:"video/mp4",flash:"video"},mp4:{html5:"video/mp4",flash:"video"},rbs:{flash:"sound"},aac:{html5:"audio/aac",flash:"video"},mp3:{html5:"audio/mp3",flash:"sound"},ogg:{html5:"audio/ogg"},oga:{html5:"audio/ogg"},ogv:{html5:"video/ogg"},webm:{html5:"video/webm"},m3u8:{html5:"audio/x-mpegurl"},gif:{flash:"image"},jpeg:{flash:"image"},jpg:{flash:"image"},swf:{flash:"image"},png:{flash:"image"},wav:{html5:"audio/x-wav"}}})(jwplayer);(function(e){e.utils.mediaparser=function(){};var g={element:{width:"width",height:"height",id:"id","class":"className",name:"name"},media:{src:"file",preload:"preload",autoplay:"autostart",loop:"repeat",controls:"controls"},source:{src:"file",type:"type",media:"media","data-jw-width":"width","data-jw-bitrate":"bitrate"},video:{poster:"image"}};var f={};e.utils.mediaparser.parseMedia=function(j){return d(j)};function c(k,j){if(!e.utils.exists(j)){j=g[k]}else{e.utils.extend(j,g[k])}return j}function d(n,j){if(f[n.tagName.toLowerCase()]&&!e.utils.exists(j)){return f[n.tagName.toLowerCase()](n)}else{j=c("element",j);var o={};for(var k in j){if(k!="length"){var m=n.getAttribute(k);if(e.utils.exists(m)){o[j[k]]=m}}}var l=n.style["#background-color"];if(l&&!(l=="transparent"||l=="rgba(0, 0, 0, 0)")){o.screencolor=l}return o}}function h(n,k){k=c("media",k);var l=[];var j=e.utils.selectors("source",n);for(var m in j){if(!isNaN(m)){l.push(a(j[m]))}}var o=d(n,k);if(e.utils.exists(o.file)){l[0]={file:o.file}}o.levels=l;return o}function a(l,k){k=c("source",k);var j=d(l,k);j.width=j.width?j.width:0;j.bitrate=j.bitrate?j.bitrate:0;return j}function b(l,k){k=c("video",k);var j=h(l,k);return j}f.media=h;f.audio=h;f.source=a;f.video=b})(jwplayer);(function(a){a.utils.loaderstatus={NEW:"NEW",LOADING:"LOADING",ERROR:"ERROR",COMPLETE:"COMPLETE"};a.utils.scriptloader=function(c){var d=a.utils.loaderstatus.NEW;var b=new a.events.eventdispatcher();a.utils.extend(this,b);this.load=function(){if(d==a.utils.loaderstatus.NEW){d=a.utils.loaderstatus.LOADING;var e=document.createElement("script");e.onload=function(f){d=a.utils.loaderstatus.COMPLETE;b.sendEvent(a.events.COMPLETE)};e.onerror=function(f){d=a.utils.loaderstatus.ERROR;b.sendEvent(a.events.ERROR)};e.onreadystatechange=function(){if(e.readyState=="loaded"||e.readyState=="complete"){d=a.utils.loaderstatus.COMPLETE;b.sendEvent(a.events.COMPLETE)}};document.getElementsByTagName("head")[0].appendChild(e);e.src=c}};this.getStatus=function(){return d}}})(jwplayer);(function(a){a.utils.selectors=function(b,e){if(!a.utils.exists(e)){e=document}b=a.utils.strings.trim(b);var c=b.charAt(0);if(c=="#"){return e.getElementById(b.substr(1))}else{if(c=="."){if(e.getElementsByClassName){return e.getElementsByClassName(b.substr(1))}else{return a.utils.selectors.getElementsByTagAndClass("*",b.substr(1))}}else{if(b.indexOf(".")>0){var d=b.split(".");return a.utils.selectors.getElementsByTagAndClass(d[0],d[1])}else{return e.getElementsByTagName(b)}}}return null};a.utils.selectors.getElementsByTagAndClass=function(e,h,g){var j=[];if(!a.utils.exists(g)){g=document}var f=g.getElementsByTagName(e);for(var d=0;d<f.length;d++){if(a.utils.exists(f[d].className)){var c=f[d].className.split(" ");for(var b=0;b<c.length;b++){if(c[b]==h){j.push(f[d])}}}}return j}})(jwplayer);(function(a){a.utils.strings=function(){};a.utils.strings.trim=function(b){return b.replace(/^\s*/,"").replace(/\s*$/,"")};a.utils.strings.pad=function(c,d,b){if(!b){b="0"}while(c.length<d){c=b+c}return c};a.utils.strings.serialize=function(b){if(b==null){return null}else{if(b=="true"){return true}else{if(b=="false"){return false}else{if(isNaN(Number(b))||b.length>5||b.length==0){return b}else{return Number(b)}}}}};a.utils.strings.seconds=function(d){d=d.replace(",",".");var b=d.split(":");var c=0;if(d.substr(-1)=="s"){c=Number(d.substr(0,d.length-1))}else{if(d.substr(-1)=="m"){c=Number(d.substr(0,d.length-1))*60}else{if(d.substr(-1)=="h"){c=Number(d.substr(0,d.length-1))*3600}else{if(b.length>1){c=Number(b[b.length-1]);c+=Number(b[b.length-2])*60;if(b.length==3){c+=Number(b[b.length-3])*3600}}else{c=Number(d)}}}}return c};a.utils.strings.xmlAttribute=function(b,c){for(var d=0;d<b.attributes.length;d++){if(b.attributes[d].name&&b.attributes[d].name.toLowerCase()==c.toLowerCase()){return b.attributes[d].value.toString()}}return""};a.utils.strings.jsonToString=function(f){var h=h||{};if(h&&h.stringify){return h.stringify(f)}var c=typeof(f);if(c!="object"||f===null){if(c=="string"){f='"'+f.replace(/"/g,'\\"')+'"'}else{return String(f)}}else{var g=[],b=(f&&f.constructor==Array);for(var d in f){var e=f[d];switch(typeof(e)){case"string":e='"'+e.replace(/"/g,'\\"')+'"';break;case"object":if(a.utils.exists(e)){e=a.utils.strings.jsonToString(e)}break}if(b){if(typeof(e)!="function"){g.push(String(e))}}else{if(typeof(e)!="function"){g.push('"'+d+'":'+String(e))}}}if(b){return"["+String(g)+"]"}else{return"{"+String(g)+"}"}}}})(jwplayer);(function(c){var d=new RegExp(/^(#|0x)[0-9a-fA-F]{3,6}/);c.utils.typechecker=function(g,f){f=!c.utils.exists(f)?b(g):f;return e(g,f)};function b(f){var g=["true","false","t","f"];if(g.toString().indexOf(f.toLowerCase().replace(" ",""))>=0){return"boolean"}else{if(d.test(f)){return"color"}else{if(!isNaN(parseInt(f,10))&&parseInt(f,10).toString().length==f.length){return"integer"}else{if(!isNaN(parseFloat(f))&&parseFloat(f).toString().length==f.length){return"float"}}}}return"string"}function e(g,f){if(!c.utils.exists(f)){return g}switch(f){case"color":if(g.length>0){return a(g)}return null;case"integer":return parseInt(g,10);case"float":return parseFloat(g);case"boolean":if(g.toLowerCase()=="true"){return true}else{if(g=="1"){return true}}return false}return g}function a(f){switch(f.toLowerCase()){case"blue":return parseInt("0000FF",16);case"green":return parseInt("00FF00",16);case"red":return parseInt("FF0000",16);case"cyan":return parseInt("00FFFF",16);case"magenta":return parseInt("FF00FF",16);case"yellow":return parseInt("FFFF00",16);case"black":return parseInt("000000",16);case"white":return parseInt("FFFFFF",16);default:f=f.replace(/(#|0x)?([0-9A-F]{3,6})$/gi,"$2");if(f.length==3){f=f.charAt(0)+f.charAt(0)+f.charAt(1)+f.charAt(1)+f.charAt(2)+f.charAt(2)}return parseInt(f,16)}return parseInt("000000",16)}})(jwplayer);(function(a){a.utils.parsers=function(){};a.utils.parsers.localName=function(b){if(!b){return""}else{if(b.localName){return b.localName}else{if(b.baseName){return b.baseName}else{return""}}}};a.utils.parsers.textContent=function(b){if(!b){return""}else{if(b.textContent){return b.textContent}else{if(b.text){return b.text}else{return""}}}}})(jwplayer);(function(a){a.utils.parsers.jwparser=function(){};a.utils.parsers.jwparser.PREFIX="jwplayer";a.utils.parsers.jwparser.parseEntry=function(c,d){for(var b=0;b<c.childNodes.length;b++){if(c.childNodes[b].prefix==a.utils.parsers.jwparser.PREFIX){d[a.utils.parsers.localName(c.childNodes[b])]=a.utils.strings.serialize(a.utils.parsers.textContent(c.childNodes[b]));if(a.utils.parsers.localName(c.childNodes[b])=="file"&&d.levels){delete d.levels}}if(!d.file&&String(d.link).toLowerCase().indexOf("youtube")>-1){d.file=d.link}}return d};a.utils.parsers.jwparser.getProvider=function(c){if(c.type){return c.type}else{if(c.file.indexOf("youtube.com/w")>-1||c.file.indexOf("youtube.com/v")>-1||c.file.indexOf("youtu.be/")>-1){return"youtube"}else{if(c.streamer&&c.streamer.indexOf("rtmp")==0){return"rtmp"}else{if(c.streamer&&c.streamer.indexOf("http")==0){return"http"}else{var b=a.utils.strings.extension(c.file);if(extensions.hasOwnProperty(b)){return extensions[b]}}}}}return""}})(jwplayer);(function(a){a.utils.parsers.mediaparser=function(){};a.utils.parsers.mediaparser.PREFIX="media";a.utils.parsers.mediaparser.parseGroup=function(d,f){var e=false;for(var c=0;c<d.childNodes.length;c++){if(d.childNodes[c].prefix==a.utils.parsers.mediaparser.PREFIX){if(!a.utils.parsers.localName(d.childNodes[c])){continue}switch(a.utils.parsers.localName(d.childNodes[c]).toLowerCase()){case"content":if(!e){f.file=a.utils.strings.xmlAttribute(d.childNodes[c],"url")}if(a.utils.strings.xmlAttribute(d.childNodes[c],"duration")){f.duration=a.utils.strings.seconds(a.utils.strings.xmlAttribute(d.childNodes[c],"duration"))}if(a.utils.strings.xmlAttribute(d.childNodes[c],"start")){f.start=a.utils.strings.seconds(a.utils.strings.xmlAttribute(d.childNodes[c],"start"))}if(d.childNodes[c].childNodes&&d.childNodes[c].childNodes.length>0){f=a.utils.parsers.mediaparser.parseGroup(d.childNodes[c],f)}if(a.utils.strings.xmlAttribute(d.childNodes[c],"width")||a.utils.strings.xmlAttribute(d.childNodes[c],"bitrate")||a.utils.strings.xmlAttribute(d.childNodes[c],"url")){if(!f.levels){f.levels=[]}f.levels.push({width:a.utils.strings.xmlAttribute(d.childNodes[c],"width"),bitrate:a.utils.strings.xmlAttribute(d.childNodes[c],"bitrate"),file:a.utils.strings.xmlAttribute(d.childNodes[c],"url")})}break;case"title":f.title=a.utils.parsers.textContent(d.childNodes[c]);break;case"description":f.description=a.utils.parsers.textContent(d.childNodes[c]);break;case"keywords":f.tags=a.utils.parsers.textContent(d.childNodes[c]);break;case"thumbnail":f.image=a.utils.strings.xmlAttribute(d.childNodes[c],"url");break;case"credit":f.author=a.utils.parsers.textContent(d.childNodes[c]);break;case"player":var b=d.childNodes[c].url;if(b.indexOf("youtube.com")>=0||b.indexOf("youtu.be")>=0){e=true;f.file=a.utils.strings.xmlAttribute(d.childNodes[c],"url")}break;case"group":a.utils.parsers.mediaparser.parseGroup(d.childNodes[c],f);break}}}return f}})(jwplayer);(function(b){b.utils.parsers.rssparser=function(){};b.utils.parsers.rssparser.parse=function(f){var c=[];for(var e=0;e<f.childNodes.length;e++){if(b.utils.parsers.localName(f.childNodes[e]).toLowerCase()=="channel"){for(var d=0;d<f.childNodes[e].childNodes.length;d++){if(b.utils.parsers.localName(f.childNodes[e].childNodes[d]).toLowerCase()=="item"){c.push(a(f.childNodes[e].childNodes[d]))}}}}return c};function a(d){var e={};for(var c=0;c<d.childNodes.length;c++){if(!b.utils.parsers.localName(d.childNodes[c])){continue}switch(b.utils.parsers.localName(d.childNodes[c]).toLowerCase()){case"enclosure":e.file=b.utils.strings.xmlAttribute(d.childNodes[c],"url");break;case"title":e.title=b.utils.parsers.textContent(d.childNodes[c]);break;case"pubdate":e.date=b.utils.parsers.textContent(d.childNodes[c]);break;case"description":e.description=b.utils.parsers.textContent(d.childNodes[c]);break;case"link":e.link=b.utils.parsers.textContent(d.childNodes[c]);break;case"category":if(e.tags){e.tags+=b.utils.parsers.textContent(d.childNodes[c])}else{e.tags=b.utils.parsers.textContent(d.childNodes[c])}break}}e=b.utils.parsers.mediaparser.parseGroup(d,e);e=b.utils.parsers.jwparser.parseEntry(d,e);return new b.html5.playlistitem(e)}})(jwplayer);(function(a){var c={};var b={};a.plugins=function(){};a.plugins.loadPlugins=function(e,d){b[e]=new a.plugins.pluginloader(new a.plugins.model(c),d);return b[e]};a.plugins.registerPlugin=function(h,f,e){var d=a.utils.getPluginName(h);if(c[d]){c[d].registerPlugin(h,f,e)}else{a.utils.log("A plugin ("+h+") was registered with the player that was not loaded. Please check your configuration.");for(var g in b){b[g].pluginFailed()}}}})(jwplayer);(function(a){a.plugins.model=function(b){this.addPlugin=function(c){var d=a.utils.getPluginName(c);if(!b[d]){b[d]=new a.plugins.plugin(c)}return b[d]}}})(jwplayer);(function(a){a.plugins.pluginmodes={FLASH:"FLASH",JAVASCRIPT:"JAVASCRIPT",HYBRID:"HYBRID"};a.plugins.plugin=function(b){var d="http://lp.longtailvideo.com";var j=a.utils.loaderstatus.NEW;var k;var h;var l;var c=new a.events.eventdispatcher();a.utils.extend(this,c);function e(){switch(a.utils.getPluginPathType(b)){case a.utils.pluginPathType.ABSOLUTE:return b;case a.utils.pluginPathType.RELATIVE:return a.utils.getAbsolutePath(b,window.location.href);case a.utils.pluginPathType.CDN:var o=a.utils.getPluginName(b);var n=a.utils.getPluginVersion(b);var m=(window.location.href.indexOf("https://")==0)?d.replace("http://","https://secure"):d;return m+"/"+a.version.split(".")[0]+"/"+o+"/"+o+(n!==""?("-"+n):"")+".js"}}function g(m){l=setTimeout(function(){j=a.utils.loaderstatus.COMPLETE;c.sendEvent(a.events.COMPLETE)},1000)}function f(m){j=a.utils.loaderstatus.ERROR;c.sendEvent(a.events.ERROR)}this.load=function(){if(j==a.utils.loaderstatus.NEW){if(b.lastIndexOf(".swf")>0){k=b;j=a.utils.loaderstatus.COMPLETE;c.sendEvent(a.events.COMPLETE);return}j=a.utils.loaderstatus.LOADING;var m=new a.utils.scriptloader(e());m.addEventListener(a.events.COMPLETE,g);m.addEventListener(a.events.ERROR,f);m.load()}};this.registerPlugin=function(o,n,m){if(l){clearTimeout(l);l=undefined}if(n&&m){k=m;h=n}else{if(typeof n=="string"){k=n}else{if(typeof n=="function"){h=n}else{if(!n&&!m){k=o}}}}j=a.utils.loaderstatus.COMPLETE;c.sendEvent(a.events.COMPLETE)};this.getStatus=function(){return j};this.getPluginName=function(){return a.utils.getPluginName(b)};this.getFlashPath=function(){if(k){switch(a.utils.getPluginPathType(k)){case a.utils.pluginPathType.ABSOLUTE:return k;case a.utils.pluginPathType.RELATIVE:if(b.lastIndexOf(".swf")>0){return a.utils.getAbsolutePath(k,window.location.href)}return a.utils.getAbsolutePath(k,e());case a.utils.pluginPathType.CDN:if(k.indexOf("-")>-1){return k+"h"}return k+"-h"}}return null};this.getJS=function(){return h};this.getPluginmode=function(){if(typeof k!="undefined"&&typeof h!="undefined"){return a.plugins.pluginmodes.HYBRID}else{if(typeof k!="undefined"){return a.plugins.pluginmodes.FLASH}else{if(typeof h!="undefined"){return a.plugins.pluginmodes.JAVASCRIPT}}}};this.getNewInstance=function(n,m,o){return new h(n,m,o)};this.getURL=function(){return b}}})(jwplayer);(function(a){a.plugins.pluginloader=function(h,e){var g={};var k=a.utils.loaderstatus.NEW;var d=false;var b=false;var c=new a.events.eventdispatcher();a.utils.extend(this,c);function f(){if(!b){b=true;k=a.utils.loaderstatus.COMPLETE;c.sendEvent(a.events.COMPLETE)}}function j(){if(!b){var m=0;for(plugin in g){var l=g[plugin].getStatus();if(l==a.utils.loaderstatus.LOADING||l==a.utils.loaderstatus.NEW){m++}}if(m==0){f()}}}this.setupPlugins=function(n,l,s){var m={length:0,plugins:{}};var p={length:0,plugins:{}};for(var o in g){var q=g[o].getPluginName();if(g[o].getFlashPath()){m.plugins[g[o].getFlashPath()]=l.plugins[o];m.plugins[g[o].getFlashPath()].pluginmode=g[o].getPluginmode();m.length++}if(g[o].getJS()){var r=document.createElement("div");r.id=n.id+"_"+q;r.style.position="absolute";r.style.zIndex=p.length+10;p.plugins[q]=g[o].getNewInstance(n,l.plugins[o],r);p.length++;if(typeof p.plugins[q].resize!="undefined"){n.onReady(s(p.plugins[q],r,true));n.onResize(s(p.plugins[q],r))}}}n.plugins=p.plugins;return m};this.load=function(){k=a.utils.loaderstatus.LOADING;d=true;for(var l in e){if(a.utils.exists(l)){g[l]=h.addPlugin(l);g[l].addEventListener(a.events.COMPLETE,j);g[l].addEventListener(a.events.ERROR,j)}}for(l in g){g[l].load()}d=false;j()};this.pluginFailed=function(){f()};this.getStatus=function(){return k}}})(jwplayer);(function(b){var a=[];b.api=function(d){this.container=d;this.id=d.id;var m={};var t={};var p={};var c=[];var g=undefined;var k=false;var h=[];var r=undefined;var o=b.utils.getOuterHTML(d);var s={};var j={};this.getBuffer=function(){return this.callInternal("jwGetBuffer")};this.getContainer=function(){return this.container};function e(v,u){return function(A,w,x,y){if(v.renderingMode=="flash"||v.renderingMode=="html5"){var z;if(w){j[A]=w;z="jwplayer('"+v.id+"').callback('"+A+"')"}else{if(!w&&j[A]){delete j[A]}}g.jwDockSetButton(A,z,x,y)}return u}}this.getPlugin=function(u){var w=this;var v={};if(u=="dock"){return b.utils.extend(v,{setButton:e(w,v),show:function(){w.callInternal("jwDockShow");return v},hide:function(){w.callInternal("jwDockHide");return v},onShow:function(x){w.componentListener("dock",b.api.events.JWPLAYER_COMPONENT_SHOW,x);return v},onHide:function(x){w.componentListener("dock",b.api.events.JWPLAYER_COMPONENT_HIDE,x);return v}})}else{if(u=="controlbar"){return b.utils.extend(v,{show:function(){w.callInternal("jwControlbarShow");return v},hide:function(){w.callInternal("jwControlbarHide");return v},onShow:function(x){w.componentListener("controlbar",b.api.events.JWPLAYER_COMPONENT_SHOW,x);return v},onHide:function(x){w.componentListener("controlbar",b.api.events.JWPLAYER_COMPONENT_HIDE,x);return v}})}else{if(u=="display"){return b.utils.extend(v,{show:function(){w.callInternal("jwDisplayShow");return v},hide:function(){w.callInternal("jwDisplayHide");return v},onShow:function(x){w.componentListener("display",b.api.events.JWPLAYER_COMPONENT_SHOW,x);return v},onHide:function(x){w.componentListener("display",b.api.events.JWPLAYER_COMPONENT_HIDE,x);return v}})}else{return this.plugins[u]}}}};this.callback=function(u){if(j[u]){return j[u]()}};this.getDuration=function(){return this.callInternal("jwGetDuration")};this.getFullscreen=function(){return this.callInternal("jwGetFullscreen")};this.getHeight=function(){return this.callInternal("jwGetHeight")};this.getLockState=function(){return this.callInternal("jwGetLockState")};this.getMeta=function(){return this.getItemMeta()};this.getMute=function(){return this.callInternal("jwGetMute")};this.getPlaylist=function(){var v=this.callInternal("jwGetPlaylist");if(this.renderingMode=="flash"){b.utils.deepReplaceKeyName(v,["__dot__","__spc__","__dsh__"],["."," ","-"])}for(var u=0;u<v.length;u++){if(!b.utils.exists(v[u].index)){v[u].index=u}}return v};this.getPlaylistItem=function(u){if(!b.utils.exists(u)){u=this.getCurrentItem()}return this.getPlaylist()[u]};this.getPosition=function(){return this.callInternal("jwGetPosition")};this.getRenderingMode=function(){return this.renderingMode};this.getState=function(){return this.callInternal("jwGetState")};this.getVolume=function(){return this.callInternal("jwGetVolume")};this.getWidth=function(){return this.callInternal("jwGetWidth")};this.setFullscreen=function(u){if(!b.utils.exists(u)){this.callInternal("jwSetFullscreen",!this.callInternal("jwGetFullscreen"))}else{this.callInternal("jwSetFullscreen",u)}return this};this.setMute=function(u){if(!b.utils.exists(u)){this.callInternal("jwSetMute",!this.callInternal("jwGetMute"))}else{this.callInternal("jwSetMute",u)}return this};this.lock=function(){return this};this.unlock=function(){return this};this.load=function(u){this.callInternal("jwLoad",u);return this};this.playlistItem=function(u){this.callInternal("jwPlaylistItem",u);return this};this.playlistPrev=function(){this.callInternal("jwPlaylistPrev");return this};this.playlistNext=function(){this.callInternal("jwPlaylistNext");return this};this.resize=function(v,u){if(this.renderingMode=="html5"){g.jwResize(v,u)}else{this.container.width=v;this.container.height=u;var w=document.getElementById(this.id+"_wrapper");if(w){w.style.width=v+"px";w.style.height=u+"px"}}return this};this.play=function(u){if(typeof u=="undefined"){u=this.getState();if(u==b.api.events.state.PLAYING||u==b.api.events.state.BUFFERING){this.callInternal("jwPause")}else{this.callInternal("jwPlay")}}else{this.callInternal("jwPlay",u)}return this};this.pause=function(u){if(typeof u=="undefined"){u=this.getState();if(u==b.api.events.state.PLAYING||u==b.api.events.state.BUFFERING){this.callInternal("jwPause")}else{this.callInternal("jwPlay")}}else{this.callInternal("jwPause",u)}return this};this.stop=function(){this.callInternal("jwStop");return this};this.seek=function(u){this.callInternal("jwSeek",u);return this};this.setVolume=function(u){this.callInternal("jwSetVolume",u);return this};this.loadInstream=function(v,u){r=new b.api.instream(this,g,v,u);return r};this.onBufferChange=function(u){return this.eventListener(b.api.events.JWPLAYER_MEDIA_BUFFER,u)};this.onBufferFull=function(u){return this.eventListener(b.api.events.JWPLAYER_MEDIA_BUFFER_FULL,u)};this.onError=function(u){return this.eventListener(b.api.events.JWPLAYER_ERROR,u)};this.onFullscreen=function(u){return this.eventListener(b.api.events.JWPLAYER_FULLSCREEN,u)};this.onMeta=function(u){return this.eventListener(b.api.events.JWPLAYER_MEDIA_META,u)};this.onMute=function(u){return this.eventListener(b.api.events.JWPLAYER_MEDIA_MUTE,u)};this.onPlaylist=function(u){return this.eventListener(b.api.events.JWPLAYER_PLAYLIST_LOADED,u)};this.onPlaylistItem=function(u){return this.eventListener(b.api.events.JWPLAYER_PLAYLIST_ITEM,u)};this.onReady=function(u){return this.eventListener(b.api.events.API_READY,u)};this.onResize=function(u){return this.eventListener(b.api.events.JWPLAYER_RESIZE,u)};this.onComplete=function(u){return this.eventListener(b.api.events.JWPLAYER_MEDIA_COMPLETE,u)};this.onSeek=function(u){return this.eventListener(b.api.events.JWPLAYER_MEDIA_SEEK,u)};this.onTime=function(u){return this.eventListener(b.api.events.JWPLAYER_MEDIA_TIME,u)};this.onVolume=function(u){return this.eventListener(b.api.events.JWPLAYER_MEDIA_VOLUME,u)};this.onBeforePlay=function(u){return this.eventListener(b.api.events.JWPLAYER_MEDIA_BEFOREPLAY,u)};this.onBeforeComplete=function(u){return this.eventListener(b.api.events.JWPLAYER_MEDIA_BEFORECOMPLETE,u)};this.onBuffer=function(u){return this.stateListener(b.api.events.state.BUFFERING,u)};this.onPause=function(u){return this.stateListener(b.api.events.state.PAUSED,u)};this.onPlay=function(u){return this.stateListener(b.api.events.state.PLAYING,u)};this.onIdle=function(u){return this.stateListener(b.api.events.state.IDLE,u)};this.remove=function(){if(!k){throw"Cannot call remove() before player is ready";return}q(this)};function q(u){h=[];if(b.utils.getOuterHTML(u.container)!=o){b.api.destroyPlayer(u.id,o)}}this.setup=function(v){if(b.embed){var u=this.id;q(this);var w=b(u);w.config=v;return new b.embed(w)}return this};this.registerPlugin=function(w,v,u){b.plugins.registerPlugin(w,v,u)};this.setPlayer=function(u,v){g=u;this.renderingMode=v};this.stateListener=function(u,v){if(!t[u]){t[u]=[];this.eventListener(b.api.events.JWPLAYER_PLAYER_STATE,f(u))}t[u].push(v);return this};this.detachMedia=function(){if(this.renderingMode=="html5"){return this.callInternal("jwDetachMedia")}};this.attachMedia=function(){if(this.renderingMode=="html5"){return this.callInternal("jwAttachMedia")}};function f(u){return function(w){var v=w.newstate,y=w.oldstate;if(v==u){var x=t[v];if(x){for(var z=0;z<x.length;z++){if(typeof x[z]=="function"){x[z].call(this,{oldstate:y,newstate:v})}}}}}}this.componentListener=function(u,v,w){if(!p[u]){p[u]={}}if(!p[u][v]){p[u][v]=[];this.eventListener(v,l(u,v))}p[u][v].push(w);return this};function l(u,v){return function(x){if(u==x.component){var w=p[u][v];if(w){for(var y=0;y<w.length;y++){if(typeof w[y]=="function"){w[y].call(this,x)}}}}}}this.addInternalListener=function(u,v){try{u.jwAddEventListener(v,'function(dat) { jwplayer("'+this.id+'").dispatchEvent("'+v+'", dat); }')}catch(w){b.utils.log("Could not add internal listener")}};this.eventListener=function(u,v){if(!m[u]){m[u]=[];if(g&&k){this.addInternalListener(g,u)}}m[u].push(v);return this};this.dispatchEvent=function(w){if(m[w]){var v=_utils.translateEventResponse(w,arguments[1]);for(var u=0;u<m[w].length;u++){if(typeof m[w][u]=="function"){m[w][u].call(this,v)}}}};this.dispatchInstreamEvent=function(u){if(r){r.dispatchEvent(u,arguments)}};this.callInternal=function(){if(k){var w=arguments[0],u=[];for(var v=1;v<arguments.length;v++){u.push(arguments[v])}if(typeof g!="undefined"&&typeof g[w]=="function"){if(u.length==2){return(g[w])(u[0],u[1])}else{if(u.length==1){return(g[w])(u[0])}else{return(g[w])()}}}return null}else{h.push(arguments)}};this.playerReady=function(v){k=true;if(!g){this.setPlayer(document.getElementById(v.id))}this.container=document.getElementById(this.id);for(var u in m){this.addInternalListener(g,u)}this.eventListener(b.api.events.JWPLAYER_PLAYLIST_ITEM,function(w){s={}});this.eventListener(b.api.events.JWPLAYER_MEDIA_META,function(w){b.utils.extend(s,w.metadata)});this.dispatchEvent(b.api.events.API_READY);while(h.length>0){this.callInternal.apply(this,h.shift())}};this.getItemMeta=function(){return s};this.getCurrentItem=function(){return this.callInternal("jwGetPlaylistIndex")};function n(w,y,x){var u=[];if(!y){y=0}if(!x){x=w.length-1}for(var v=y;v<=x;v++){u.push(w[v])}return u}return this};b.api.selectPlayer=function(d){var c;if(!b.utils.exists(d)){d=0}if(d.nodeType){c=d}else{if(typeof d=="string"){c=document.getElementById(d)}}if(c){var e=b.api.playerById(c.id);if(e){return e}else{return b.api.addPlayer(new b.api(c))}}else{if(typeof d=="number"){return b.getPlayers()[d]}}return null};b.api.events={API_READY:"jwplayerAPIReady",JWPLAYER_READY:"jwplayerReady",JWPLAYER_FULLSCREEN:"jwplayerFullscreen",JWPLAYER_RESIZE:"jwplayerResize",JWPLAYER_ERROR:"jwplayerError",JWPLAYER_MEDIA_BEFOREPLAY:"jwplayerMediaBeforePlay",JWPLAYER_MEDIA_BEFORECOMPLETE:"jwplayerMediaBeforeComplete",JWPLAYER_COMPONENT_SHOW:"jwplayerComponentShow",JWPLAYER_COMPONENT_HIDE:"jwplayerComponentHide",JWPLAYER_MEDIA_BUFFER:"jwplayerMediaBuffer",JWPLAYER_MEDIA_BUFFER_FULL:"jwplayerMediaBufferFull",JWPLAYER_MEDIA_ERROR:"jwplayerMediaError",JWPLAYER_MEDIA_LOADED:"jwplayerMediaLoaded",JWPLAYER_MEDIA_COMPLETE:"jwplayerMediaComplete",JWPLAYER_MEDIA_SEEK:"jwplayerMediaSeek",JWPLAYER_MEDIA_TIME:"jwplayerMediaTime",JWPLAYER_MEDIA_VOLUME:"jwplayerMediaVolume",JWPLAYER_MEDIA_META:"jwplayerMediaMeta",JWPLAYER_MEDIA_MUTE:"jwplayerMediaMute",JWPLAYER_PLAYER_STATE:"jwplayerPlayerState",JWPLAYER_PLAYLIST_LOADED:"jwplayerPlaylistLoaded",JWPLAYER_PLAYLIST_ITEM:"jwplayerPlaylistItem",JWPLAYER_INSTREAM_CLICK:"jwplayerInstreamClicked",JWPLAYER_INSTREAM_DESTROYED:"jwplayerInstreamDestroyed"};b.api.events.state={BUFFERING:"BUFFERING",IDLE:"IDLE",PAUSED:"PAUSED",PLAYING:"PLAYING"};b.api.playerById=function(d){for(var c=0;c<a.length;c++){if(a[c].id==d){return a[c]}}return null};b.api.addPlayer=function(c){for(var d=0;d<a.length;d++){if(a[d]==c){return c}}a.push(c);return c};b.api.destroyPlayer=function(h,d){var g=-1;for(var l=0;l<a.length;l++){if(a[l].id==h){g=l;continue}}if(g>=0){try{a[g].callInternal("jwDestroy")}catch(k){}var c=document.getElementById(a[g].id);if(document.getElementById(a[g].id+"_wrapper")){c=document.getElementById(a[g].id+"_wrapper")}if(c){if(d){b.utils.setOuterHTML(c,d)}else{var j=document.createElement("div");var f=c.id;if(c.id.indexOf("_wrapper")==c.id.length-8){newID=c.id.substring(0,c.id.length-8)}j.setAttribute("id",f);c.parentNode.replaceChild(j,c)}}a.splice(g,1)}return null};b.getPlayers=function(){return a.slice(0)}})(jwplayer);var _userPlayerReady=(typeof playerReady=="function")?playerReady:undefined;playerReady=function(b){var a=jwplayer.api.playerById(b.id);if(a){a.playerReady(b)}else{jwplayer.api.selectPlayer(b.id).playerReady(b)}if(_userPlayerReady){_userPlayerReady.call(this,b)}};(function(a){a.api.instream=function(c,j,n,q){var h=c;var b=j;var g=n;var k=q;var e={};var p={};function f(){h.callInternal("jwLoadInstream",n,q)}function m(r,s){b.jwInstreamAddEventListener(s,'function(dat) { jwplayer("'+h.id+'").dispatchInstreamEvent("'+s+'", dat); }')}function d(r,s){if(!e[r]){e[r]=[];m(b,r)}e[r].push(s);return this}function o(r,s){if(!p[r]){p[r]=[];d(a.api.events.JWPLAYER_PLAYER_STATE,l(r))}p[r].push(s);return this}function l(r){return function(t){var s=t.newstate,v=t.oldstate;if(s==r){var u=p[s];if(u){for(var w=0;w<u.length;w++){if(typeof u[w]=="function"){u[w].call(this,{oldstate:v,newstate:s,type:t.type})}}}}}}this.dispatchEvent=function(u,t){if(e[u]){var s=_utils.translateEventResponse(u,t[1]);for(var r=0;r<e[u].length;r++){if(typeof e[u][r]=="function"){e[u][r].call(this,s)}}}};this.onError=function(r){return d(a.api.events.JWPLAYER_ERROR,r)};this.onFullscreen=function(r){return d(a.api.events.JWPLAYER_FULLSCREEN,r)};this.onMeta=function(r){return d(a.api.events.JWPLAYER_MEDIA_META,r)};this.onMute=function(r){return d(a.api.events.JWPLAYER_MEDIA_MUTE,r)};this.onComplete=function(r){return d(a.api.events.JWPLAYER_MEDIA_COMPLETE,r)};this.onSeek=function(r){return d(a.api.events.JWPLAYER_MEDIA_SEEK,r)};this.onTime=function(r){return d(a.api.events.JWPLAYER_MEDIA_TIME,r)};this.onVolume=function(r){return d(a.api.events.JWPLAYER_MEDIA_VOLUME,r)};this.onBuffer=function(r){return o(a.api.events.state.BUFFERING,r)};this.onPause=function(r){return o(a.api.events.state.PAUSED,r)};this.onPlay=function(r){return o(a.api.events.state.PLAYING,r)};this.onIdle=function(r){return o(a.api.events.state.IDLE,r)};this.onInstreamClick=function(r){return d(a.api.events.JWPLAYER_INSTREAM_CLICK,r)};this.onInstreamDestroyed=function(r){return d(a.api.events.JWPLAYER_INSTREAM_DESTROYED,r)};this.play=function(r){b.jwInstreamPlay(r)};this.pause=function(r){b.jwInstreamPause(r)};this.seek=function(r){b.jwInstreamSeek(r)};this.destroy=function(){b.jwInstreamDestroy()};this.getState=function(){return b.jwInstreamGetState()};this.getDuration=function(){return b.jwInstreamGetDuration()};this.getPosition=function(){return b.jwInstreamGetPosition()};f()}})(jwplayer);(function(a){var c=a.utils;a.embed=function(h){var k={width:400,height:300,components:{controlbar:{position:"over"}}};var g=c.mediaparser.parseMedia(h.container);var f=new a.embed.config(c.extend(k,g,h.config),this);var j=a.plugins.loadPlugins(h.id,f.plugins);function d(n,m){for(var l in m){if(typeof n[l]=="function"){(n[l]).call(n,m[l])}}}function e(){if(j.getStatus()==c.loaderstatus.COMPLETE){for(var n=0;n<f.modes.length;n++){if(f.modes[n].type&&a.embed[f.modes[n].type]){var p=f.modes[n].config;var t=f;if(p){t=c.extend(c.clone(f),p);var s=["file","levels","playlist"];for(var m=0;m<s.length;m++){var q=s[m];if(c.exists(p[q])){for(var l=0;l<s.length;l++){if(l!=m){var o=s[l];if(c.exists(t[o])&&!c.exists(p[o])){delete t[o]}}}}}}var r=new a.embed[f.modes[n].type](document.getElementById(h.id),f.modes[n],t,j,h);if(r.supportsConfig()){r.embed();d(h,f.events);return h}}}c.log("No suitable players found");new a.embed.logo(c.extend({hide:true},f.components.logo),"none",h.id)}}j.addEventListener(a.events.COMPLETE,e);j.addEventListener(a.events.ERROR,e);j.load();return h};function b(){if(!document.body){return setTimeout(b,15)}var d=c.selectors.getElementsByTagAndClass("video","jwplayer");for(var e=0;e<d.length;e++){var f=d[e];if(f.id==""){f.id="jwplayer_"+Math.round(Math.random()*100000)}a(f.id).setup({})}}b()})(jwplayer);(function(e){var k=e.utils;function h(m){var l=[{type:"flash",src:m?m:"/jwplayer/player.swf"},{type:"html5"},{type:"download"}];if(k.isAndroid()){l[0]=l.splice(1,1,l[0])[0]}return l}var a={players:"modes",autoplay:"autostart"};function b(o){var n=o.toLowerCase();var m=["left","right","top","bottom"];for(var l=0;l<m.length;l++){if(n==m[l]){return true}}return false}function c(m){var l=false;l=(m instanceof Array)||(typeof m=="object"&&!m.position&&!m.size);return l}function j(l){if(typeof l=="string"){if(parseInt(l).toString()==l||l.toLowerCase().indexOf("px")>-1){return parseInt(l)}}return l}var g=["playlist","dock","controlbar","logo","display"];function f(l){var o={};switch(k.typeOf(l.plugins)){case"object":for(var n in l.plugins){o[k.getPluginName(n)]=n}break;case"string":var p=l.plugins.split(",");for(var m=0;m<p.length;m++){o[k.getPluginName(p[m])]=p[m]}break}return o}function d(p,o,n,l){if(k.typeOf(p[o])!="object"){p[o]={}}var m=p[o][n];if(k.typeOf(m)!="object"){p[o][n]=m={}}if(l){if(o=="plugins"){var q=k.getPluginName(n);m[l]=p[q+"."+l];delete p[q+"."+l]}else{m[l]=p[n+"."+l];delete p[n+"."+l]}}}e.embed.deserialize=function(m){var n=f(m);for(var l in n){d(m,"plugins",n[l])}for(var q in m){if(q.indexOf(".")>-1){var p=q.split(".");var o=p[0];var q=p[1];if(k.isInArray(g,o)){d(m,"components",o,q)}else{if(n[o]){d(m,"plugins",n[o],q)}}}}return m};e.embed.config=function(l,v){var u=k.extend({},l);var s;if(c(u.playlist)){s=u.playlist;delete u.playlist}u=e.embed.deserialize(u);u.height=j(u.height);u.width=j(u.width);if(typeof u.plugins=="string"){var m=u.plugins.split(",");if(typeof u.plugins!="object"){u.plugins={}}for(var q=0;q<m.length;q++){var r=k.getPluginName(m[q]);if(typeof u[r]=="object"){u.plugins[m[q]]=u[r];delete u[r]}else{u.plugins[m[q]]={}}}}for(var t=0;t<g.length;t++){var p=g[t];if(k.exists(u[p])){if(typeof u[p]!="object"){if(!u.components[p]){u.components[p]={}}if(p=="logo"){u.components[p].file=u[p]}else{u.components[p].position=u[p]}delete u[p]}else{if(!u.components[p]){u.components[p]={}}k.extend(u.components[p],u[p]);delete u[p]}}if(typeof u[p+"size"]!="undefined"){if(!u.components[p]){u.components[p]={}}u.components[p].size=u[p+"size"];delete u[p+"size"]}}if(typeof u.icons!="undefined"){if(!u.components.display){u.components.display={}}u.components.display.icons=u.icons;delete u.icons}for(var o in a){if(u[o]){if(!u[a[o]]){u[a[o]]=u[o]}delete u[o]}}var n;if(u.flashplayer&&!u.modes){n=h(u.flashplayer);delete u.flashplayer}else{if(u.modes){if(typeof u.modes=="string"){n=h(u.modes)}else{if(u.modes instanceof Array){n=u.modes}else{if(typeof u.modes=="object"&&u.modes.type){n=[u.modes]}}}delete u.modes}else{n=h()}}u.modes=n;if(s){u.playlist=s}return u}})(jwplayer);(function(a){a.embed.download=function(c,g,b,d,f){this.embed=function(){var k=a.utils.extend({},b);var q={};var j=b.width?b.width:480;if(typeof j!="number"){j=parseInt(j,10)}var m=b.height?b.height:320;if(typeof m!="number"){m=parseInt(m,10)}var u,o,n;var s={};if(b.playlist&&b.playlist.length){s.file=b.playlist[0].file;o=b.playlist[0].image;s.levels=b.playlist[0].levels}else{s.file=b.file;o=b.image;s.levels=b.levels}if(s.file){u=s.file}else{if(s.levels&&s.levels.length){u=s.levels[0].file}}n=u?"pointer":"auto";var l={display:{style:{cursor:n,width:j,height:m,backgroundColor:"#000",position:"relative",textDecoration:"none",border:"none",display:"block"}},display_icon:{style:{cursor:n,position:"absolute",display:u?"block":"none",top:0,left:0,border:0,margin:0,padding:0,zIndex:3,width:50,height:50,backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAALdJREFUeNrs18ENgjAYhmFouDOCcQJGcARHgE10BDcgTOIosAGwQOuPwaQeuFRi2p/3Sb6EC5L3QCxZBgAAAOCorLW1zMn65TrlkH4NcV7QNcUQt7Gn7KIhxA+qNIR81spOGkL8oFJDyLJRdosqKDDkK+iX5+d7huzwM40xptMQMkjIOeRGo+VkEVvIPfTGIpKASfYIfT9iCHkHrBEzf4gcUQ56aEzuGK/mw0rHpy4AAACAf3kJMACBxjAQNRckhwAAAABJRU5ErkJggg==)"}},display_iconBackground:{style:{cursor:n,position:"absolute",display:u?"block":"none",top:((m-50)/2),left:((j-50)/2),border:0,width:50,height:50,margin:0,padding:0,zIndex:2,backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAEpJREFUeNrszwENADAIA7DhX8ENoBMZ5KR10EryckCJiIiIiIiIiIiIiIiIiIiIiIh8GmkRERERERERERERERERERERERGRHSPAAPlXH1phYpYaAAAAAElFTkSuQmCC)"}},display_image:{style:{width:j,height:m,display:o?"block":"none",position:"absolute",cursor:n,left:0,top:0,margin:0,padding:0,textDecoration:"none",zIndex:1,border:"none"}}};var h=function(v,x,y){var w=document.createElement(v);if(y){w.id=y}else{w.id=c.id+"_jwplayer_"+x}a.utils.css(w,l[x].style);return w};q.display=h("a","display",c.id);if(u){q.display.setAttribute("href",a.utils.getAbsolutePath(u))}q.display_image=h("img","display_image");q.display_image.setAttribute("alt","Click to download...");if(o){q.display_image.setAttribute("src",a.utils.getAbsolutePath(o))}if(true){q.display_icon=h("div","display_icon");q.display_iconBackground=h("div","display_iconBackground");q.display.appendChild(q.display_image);q.display_iconBackground.appendChild(q.display_icon);q.display.appendChild(q.display_iconBackground)}_css=a.utils.css;_hide=function(v){_css(v,{display:"none"})};function r(v){_imageWidth=q.display_image.naturalWidth;_imageHeight=q.display_image.naturalHeight;t()}function t(){a.utils.stretch(a.utils.stretching.UNIFORM,q.display_image,j,m,_imageWidth,_imageHeight)}q.display_image.onerror=function(v){_hide(q.display_image)};q.display_image.onload=r;c.parentNode.replaceChild(q.display,c);var p=(b.plugins&&b.plugins.logo)?b.plugins.logo:{};q.display.appendChild(new a.embed.logo(b.components.logo,"download",c.id));f.container=document.getElementById(f.id);f.setPlayer(q.display,"download")};this.supportsConfig=function(){if(b){var j=a.utils.getFirstPlaylistItemFromConfig(b);if(typeof j.file=="undefined"&&typeof j.levels=="undefined"){return true}else{if(j.file){return e(j.file,j.provider,j.playlistfile)}else{if(j.levels&&j.levels.length){for(var h=0;h<j.levels.length;h++){if(j.levels[h].file&&e(j.levels[h].file,j.provider,j.playlistfile)){return true}}}}}}else{return true}};function e(j,l,h){if(h){return false}var k=["image","sound","youtube","http"];if(l&&(k.toString().indexOf(l)>-1)){return true}if(!l||(l&&l=="video")){var m=a.utils.extension(j);if(m&&a.utils.extensionmap[m]){return true}}return false}}})(jwplayer);(function(a){a.embed.flash=function(f,g,l,e,j){function m(o,n,p){var q=document.createElement("param");q.setAttribute("name",n);q.setAttribute("value",p);o.appendChild(q)}function k(o,p,n){return function(q){if(n){document.getElementById(j.id+"_wrapper").appendChild(p)}var s=document.getElementById(j.id).getPluginConfig("display");o.resize(s.width,s.height);var r={left:s.x,top:s.y};a.utils.css(p,r)}}function d(p){if(!p){return{}}var r={};for(var o in p){var n=p[o];for(var q in n){r[o+"."+q]=n[q]}}return r}function h(q,p){if(q[p]){var s=q[p];for(var o in s){var n=s[o];if(typeof n=="string"){if(!q[o]){q[o]=n}}else{for(var r in n){if(!q[o+"."+r]){q[o+"."+r]=n[r]}}}}delete q[p]}}function b(q){if(!q){return{}}var t={},s=[];for(var n in q){var p=a.utils.getPluginName(n);var o=q[n];s.push(n);for(var r in o){t[p+"."+r]=o[r]}}t.plugins=s.join(",");return t}function c(p){var n=p.netstreambasepath?"":"netstreambasepath="+encodeURIComponent(window.location.href.split("#")[0])+"&";for(var o in p){if(typeof(p[o])=="object"){n+=o+"="+encodeURIComponent("[[JSON]]"+a.utils.strings.jsonToString(p[o]))+"&"}else{n+=o+"="+encodeURIComponent(p[o])+"&"}}return n.substring(0,n.length-1)}this.embed=function(){l.id=j.id;var A;var r=a.utils.extend({},l);var o=r.width;var y=r.height;if(f.id+"_wrapper"==f.parentNode.id){A=document.getElementById(f.id+"_wrapper")}else{A=document.createElement("div");A.id=f.id+"_wrapper";a.utils.wrap(f,A);a.utils.css(A,{position:"relative",width:o,height:y})}var p=e.setupPlugins(j,r,k);if(p.length>0){a.utils.extend(r,b(p.plugins))}else{delete r.plugins}var s=["height","width","modes","events"];for(var v=0;v<s.length;v++){delete r[s[v]]}var q="opaque";if(r.wmode){q=r.wmode}h(r,"components");h(r,"providers");if(typeof r["dock.position"]!="undefined"){if(r["dock.position"].toString().toLowerCase()=="false"){r.dock=r["dock.position"];delete r["dock.position"]}}var x=a.utils.getCookies();for(var n in x){if(typeof(r[n])=="undefined"){r[n]=x[n]}}var z="#000000";var u;if(a.utils.isIE()){var w='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" bgcolor="'+z+'" width="100%" height="100%" id="'+f.id+'" name="'+f.id+'" tabindex=0"">';w+='<param name="movie" value="'+g.src+'">';w+='<param name="allowfullscreen" value="true">';w+='<param name="allowscriptaccess" value="always">';w+='<param name="seamlesstabbing" value="true">';w+='<param name="wmode" value="'+q+'">';w+='<param name="flashvars" value="'+c(r)+'">';w+="</object>";a.utils.setOuterHTML(f,w);u=document.getElementById(f.id)}else{var t=document.createElement("object");t.setAttribute("type","application/x-shockwave-flash");t.setAttribute("data",g.src);t.setAttribute("width","100%");t.setAttribute("height","100%");t.setAttribute("bgcolor","#000000");t.setAttribute("id",f.id);t.setAttribute("name",f.id);t.setAttribute("tabindex",0);m(t,"allowfullscreen","true");m(t,"allowscriptaccess","always");m(t,"seamlesstabbing","true");m(t,"wmode",q);m(t,"flashvars",c(r));f.parentNode.replaceChild(t,f);u=t}j.container=u;j.setPlayer(u,"flash")};this.supportsConfig=function(){if(a.utils.hasFlash()){if(l){var o=a.utils.getFirstPlaylistItemFromConfig(l);if(typeof o.file=="undefined"&&typeof o.levels=="undefined"){return true}else{if(o.file){return flashCanPlay(o.file,o.provider)}else{if(o.levels&&o.levels.length){for(var n=0;n<o.levels.length;n++){if(o.levels[n].file&&flashCanPlay(o.levels[n].file,o.provider)){return true}}}}}}else{return true}}return false};flashCanPlay=function(n,p){var o=["video","http","sound","image"];if(p&&(o.toString().indexOf(p)<0)){return true}var q=a.utils.extension(n);if(!q){return true}if(a.utils.exists(a.utils.extensionmap[q])&&!a.utils.exists(a.utils.extensionmap[q].flash)){return false}return true}}})(jwplayer);(function(a){a.embed.html5=function(c,g,b,d,f){function e(j,k,h){return function(l){var m=document.getElementById(c.id+"_displayarea");if(h){m.appendChild(k)}j.resize(m.clientWidth,m.clientHeight);k.left=m.style.left;k.top=m.style.top}}this.embed=function(){if(a.html5){d.setupPlugins(f,b,e);c.innerHTML="";var j=a.utils.extend({screencolor:"0x000000"},b);var h=["plugins","modes","events"];for(var k=0;k<h.length;k++){delete j[h[k]]}if(j.levels&&!j.sources){j.sources=b.levels}if(j.skin&&j.skin.toLowerCase().indexOf(".zip")>0){j.skin=j.skin.replace(/\.zip/i,".xml")}var l=new(a.html5(c)).setup(j);f.container=document.getElementById(f.id);f.setPlayer(l,"html5")}else{return null}};this.supportsConfig=function(){if(!!a.vid.canPlayType){if(b){var j=a.utils.getFirstPlaylistItemFromConfig(b);if(typeof j.file=="undefined"&&typeof j.levels=="undefined"){return true}else{if(j.file){return html5CanPlay(a.vid,j.file,j.provider,j.playlistfile)}else{if(j.levels&&j.levels.length){for(var h=0;h<j.levels.length;h++){if(j.levels[h].file&&html5CanPlay(a.vid,j.levels[h].file,j.provider,j.playlistfile)){return true}}}}}}else{return true}}return false};html5CanPlay=function(k,j,l,h){if(h){return false}if(l&&l=="youtube"){return true}if(l&&l!="video"&&l!="http"&&l!="sound"){return false}if(navigator.userAgent.match(/BlackBerry/i)!==null){return false}var m=a.utils.extension(j);if(!a.utils.exists(m)||!a.utils.exists(a.utils.extensionmap[m])){return true}if(!a.utils.exists(a.utils.extensionmap[m].html5)){return false}if(a.utils.isLegacyAndroid()&&m.match(/m4v|mp4/)){return true}return browserCanPlay(k,a.utils.extensionmap[m].html5)};browserCanPlay=function(j,h){if(!h){return true}if(j.canPlayType(h)){return true}else{if(h=="audio/mp3"&&navigator.userAgent.match(/safari/i)){return j.canPlayType("audio/mpeg")}else{return false}}}}})(jwplayer);(function(a){a.embed.logo=function(m,l,d){var j={prefix:"http://l.longtailvideo.com/"+l+"/",file:"",link:"",linktarget:"_top",margin:8,out:0.5,over:1,timeout:5,hide:false,position:"bottom-left"};_css=a.utils.css;var b;var h;k();function k(){o();c();f()}function o(){if(j.prefix){var q=a.version.split(/\W/).splice(0,2).join("/");if(j.prefix.indexOf(q)<0){j.prefix+=q+"/"}}h=a.utils.extend({},j,m)}function p(){var s={border:"none",textDecoration:"none",position:"absolute",cursor:"pointer",zIndex:10};s.display=h.hide?"none":"block";var r=h.position.toLowerCase().split("-");for(var q in r){s[r[q]]=h.margin}return s}function c(){b=document.createElement("img");b.id=d+"_jwplayer_logo";b.style.display="none";b.onload=function(q){_css(b,p());e()};if(!h.file){return}if(h.file.indexOf("http://")===0){b.src=h.file}else{b.src=h.prefix+h.file}}if(!h.file){return}function f(){if(h.link){b.onmouseover=g;b.onmouseout=e;b.onclick=n}else{this.mouseEnabled=false}}function n(q){if(typeof q!="undefined"){q.preventDefault();q.stopPropagation()}if(h.link){window.open(h.link,h.linktarget)}return}function e(q){if(h.link){b.style.opacity=h.out}return}function g(q){if(h.hide){b.style.opacity=h.over}return}return b}})(jwplayer);(function(a){a.html5=function(b){var c=b;this.setup=function(d){a.utils.extend(this,new a.html5.api(c,d));return this};return this}})(jwplayer);(function(a){var d=a.utils;var b=d.css;var c=d.isIOS();a.html5.view=function(n,H,h){var m=n;var y=H;var j=h;var R;var g;var t;var o;var F;var P;var O;var E=false;var x=false;var A,N;var f,S,u;function L(){R=document.createElement("div");R.id=y.id;R.className=y.className;_videowrapper=document.createElement("div");_videowrapper.id=R.id+"_video_wrapper";y.id=R.id+"_video";b(R,{position:"relative",height:j.height,width:j.width,padding:0,backgroundColor:U(),zIndex:0});function U(){if(m.skin.getComponentSettings("display")&&m.skin.getComponentSettings("display").backgroundcolor){return m.skin.getComponentSettings("display").backgroundcolor}return parseInt("000000",16)}b(y,{width:"100%",height:"100%",top:0,left:0,zIndex:1,margin:"auto",display:"block"});b(_videowrapper,{overflow:"hidden",position:"absolute",top:0,left:0,bottom:0,right:0});d.wrap(y,R);d.wrap(y,_videowrapper);o=document.createElement("div");o.id=R.id+"_displayarea";R.appendChild(o);_instreamArea=document.createElement("div");_instreamArea.id=R.id+"_instreamarea";b(_instreamArea,{overflow:"hidden",position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:100,background:"000000",display:"none"});R.appendChild(_instreamArea)}function K(){for(var U=0;U<j.plugins.order.length;U++){var V=j.plugins.order[U];if(d.exists(j.plugins.object[V].getDisplayElement)){j.plugins.object[V].height=d.parseDimension(j.plugins.object[V].getDisplayElement().style.height);j.plugins.object[V].width=d.parseDimension(j.plugins.object[V].getDisplayElement().style.width);j.plugins.config[V].currentPosition=j.plugins.config[V].position}}v()}function s(U){x=j.fullscreen}function p(U){if(S){return}switch(U.newstate){case a.api.events.state.PLAYING:if(j.getMedia()&&j.getMedia().hasChrome()){o.style.display="none"}break;default:o.style.display="block";break}l()}function v(V){var X=j.getMedia()?j.getMedia().getDisplayElement():null;if(d.exists(X)){if(O!=X){if(O&&O.parentNode){O.parentNode.replaceChild(X,O)}O=X}for(var U=0;U<j.plugins.order.length;U++){var W=j.plugins.order[U];if(d.exists(j.plugins.object[W].getDisplayElement)){j.plugins.config[W].currentPosition=j.plugins.config[W].position}}}G(j.width,j.height)}this.setup=function(){if(j&&j.getMedia()){y=j.getMedia().getDisplayElement()}L();K();m.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,p);m.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_LOADED,v);m.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_BEFOREPLAY,s);m.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_META,function(V){l()});var U;if(d.exists(window.onresize)){U=window.onresize}window.onresize=function(V){if(d.exists(U)){try{U(V)}catch(X){}}if(m.jwGetFullscreen()){if(!B()){var W=d.getBoundingClientRect(document.body);j.width=Math.abs(W.left)+Math.abs(W.right);j.height=window.innerHeight;G(j.width,j.height)}}else{G(j.width,j.height)}}};function M(U){switch(U.keyCode){case 27:if(m.jwGetFullscreen()){m.jwSetFullscreen(false)}break;case 32:if(m.jwGetState()!=a.api.events.state.IDLE&&m.jwGetState()!=a.api.events.state.PAUSED){m.jwPause()}else{m.jwPlay()}break}}function G(U,ad){if(R.style.display=="none"){return}var X=[].concat(j.plugins.order);X.reverse();F=X.length+2;if(x&&B()){try{if(j.fullscreen&&!j.getMedia().getDisplayElement().webkitDisplayingFullscreen){j.fullscreen=false}}catch(aa){}}if(!j.fullscreen){g=U;t=ad;if(typeof U=="string"&&U.indexOf("%")>0){g=d.getElementWidth(d.parentNode(R))*parseInt(U.replace("%"),"")/100}else{g=U}if(typeof ad=="string"&&ad.indexOf("%")>0){t=d.getElementHeight(d.parentNode(R))*parseInt(ad.replace("%"),"")/100}else{t=ad}var Y={top:0,bottom:0,left:0,right:0,width:g,height:t,position:"absolute"};b(o,Y);var ae={};var ab;try{ab=j.plugins.object.display.getDisplayElement()}catch(aa){}if(ab){ae.width=d.parseDimension(ab.style.width);ae.height=d.parseDimension(ab.style.height)}var ac=d.extend({},Y,ae,{zIndex:_instreamArea.style.zIndex,display:_instreamArea.style.display});b(_instreamArea,ac);b(R,{height:t,width:g});var Z=w(I,X);if(Z.length>0){F+=Z.length;var W=Z.indexOf("playlist"),V=Z.indexOf("controlbar");if(W>=0&&V>=0){Z[W]=Z.splice(V,1,Z[W])[0]}w(q,Z,true)}A=d.getElementWidth(o);N=d.getElementHeight(o)}else{if(!B()&&!c){w(e,X,true)}}l()}var r;function w(ab,X,Y){r=0;var Z=[];for(var W=0;W<X.length;W++){var aa=X[W];if(d.exists(j.plugins.object[aa].getDisplayElement)){if(j.plugins.config[aa].currentPosition!=a.html5.view.positions.NONE){var U=ab(aa,F--);if(!U){Z.push(aa)}else{var V=U.width;var ac=U.height;if(Y){delete U.width;delete U.height}b(j.plugins.object[aa].getDisplayElement(),U);j.plugins.object[aa].resize(V,ac)}}else{b(j.plugins.object[aa].getDisplayElement(),{display:"none"})}}}return Z}function I(V,W){if(d.exists(j.plugins.object[V].getDisplayElement)){if(j.plugins.config[V].position&&T(j.plugins.config[V].position)){if(!d.exists(j.plugins.object[V].getDisplayElement().parentNode)){R.appendChild(j.plugins.object[V].getDisplayElement())}var U=z(V);U.zIndex=W;return U}}return false}function q(U,V){if(!d.exists(j.plugins.object[U].getDisplayElement().parentNode)){o.appendChild(j.plugins.object[U].getDisplayElement())}return{position:"absolute",width:(d.getElementWidth(o)-d.parseDimension(o.style.right)),height:(d.getElementHeight(o)-d.parseDimension(o.style.bottom)),zIndex:V}}function e(U,V){return{position:"fixed",width:j.width,height:j.height,zIndex:V}}var l=this.resizeMedia=function(){o.style.position="absolute";var W=j.getMedia()?j.getMedia().getDisplayElement():u;if(!W){return}if(W&&W.tagName.toLowerCase()=="video"){if(!W.videoWidth||!W.videoHeight){W.style.width=o.style.width;W.style.height=o.style.height;return}W.style.position="absolute";d.fadeTo(W,1,0.25);if(W.parentNode){W.parentNode.style.left=o.style.left;W.parentNode.style.top=o.style.top}if(j.fullscreen&&m.jwGetStretching()==a.utils.stretching.EXACTFIT&&!d.isMobile()){var U=document.createElement("div");d.stretch(a.utils.stretching.UNIFORM,U,d.getElementWidth(o),d.getElementHeight(o),A,N);d.stretch(a.utils.stretching.EXACTFIT,W,d.parseDimension(U.style.width),d.parseDimension(U.style.height),W.videoWidth?W.videoWidth:400,W.videoHeight?W.videoHeight:300);b(W,{left:U.style.left,top:U.style.top})}else{if(!c){d.stretch(m.jwGetStretching(),W,d.getElementWidth(o),d.getElementHeight(o),W.videoWidth?W.videoWidth:400,W.videoHeight?W.videoHeight:300)}}}else{var V=j.plugins.object.display.getDisplayElement();if(V){j.getMedia().resize(d.parseDimension(V.style.width),d.parseDimension(V.style.height))}else{j.getMedia().resize(d.parseDimension(o.style.width),d.parseDimension(o.style.height))}}};var z=this.getComponentPosition=function(V){var W={position:"absolute",margin:0,padding:0,top:null};var U=j.plugins.config[V].currentPosition.toLowerCase();switch(U.toUpperCase()){case a.html5.view.positions.TOP:W.top=d.parseDimension(o.style.top);W.left=d.parseDimension(o.style.left);W.width=d.getElementWidth(o)-d.parseDimension(o.style.left)-d.parseDimension(o.style.right);W.height=j.plugins.object[V].height;o.style[U]=d.parseDimension(o.style[U])+j.plugins.object[V].height+"px";o.style.height=d.getElementHeight(o)-W.height+"px";break;case a.html5.view.positions.RIGHT:W.top=d.parseDimension(o.style.top);W.right=d.parseDimension(o.style.right);W.width=j.plugins.object[V].width;W.height=d.getElementHeight(o)-d.parseDimension(o.style.top)-d.parseDimension(o.style.bottom);o.style.width=d.getElementWidth(o)-W.width+"px";break;case a.html5.view.positions.BOTTOM:W.left=d.parseDimension(o.style.left);W.width=d.getElementWidth(o)-d.parseDimension(o.style.left)-d.parseDimension(o.style.right);W.height=j.plugins.object[V].height;W.bottom=d.parseDimension(o.style.bottom+r);r+=W.height;o.style.height=d.getElementHeight(o)-W.height+"px";break;case a.html5.view.positions.LEFT:W.top=d.parseDimension(o.style.top);W.left=d.parseDimension(o.style.left);W.width=j.plugins.object[V].width;W.height=d.getElementHeight(o)-d.parseDimension(o.style.top)-d.parseDimension(o.style.bottom);o.style[U]=d.parseDimension(o.style[U])+j.plugins.object[V].width+"px";o.style.width=d.getElementWidth(o)-W.width+"px";break;default:break}return W};this.resize=G;var J,k,Q;var C=this.fullscreen=function(W){if(c){return}var Y;try{Y=j.getMedia().getDisplayElement()}catch(X){}if(W){k=j.width;Q=j.height}var aa={position:"fixed",width:"100%",height:"100%",top:0,left:0,zIndex:2147483000},Z={position:"relative",height:k,width:Q,zIndex:0};if(B()&&Y&&Y.webkitSupportsFullscreen){if(W&&!Y.webkitDisplayingFullscreen){try{b(Y,aa);d.transform(Y);J=o.style.display;o.style.display="none";Y.webkitEnterFullscreen()}catch(V){}}else{if(!W){b(Y,Z);l();if(Y.webkitDisplayingFullscreen){try{Y.webkitExitFullscreen()}catch(V){}}o.style.display=J}}E=false}else{if(W){document.onkeydown=M;clearInterval(P);var U=d.getBoundingClientRect(document.body);j.width=Math.abs(U.left)+Math.abs(U.right);j.height=window.innerHeight;b(R,aa);aa.zIndex=1;if(j.getMedia()&&j.getMedia().getDisplayElement()){b(j.getMedia().getDisplayElement(),aa)}aa.zIndex=2;b(o,aa);E=true}else{document.onkeydown="";j.width=g;j.height=t;b(R,Z);E=false}G(j.width,j.height)}};function T(U){return([a.html5.view.positions.TOP,a.html5.view.positions.RIGHT,a.html5.view.positions.BOTTOM,a.html5.view.positions.LEFT].toString().indexOf(U.toUpperCase())>-1)}function B(){if(m.jwGetState()!=a.api.events.state.IDLE&&!E&&(j.getMedia()&&j.getMedia().getDisplayElement()&&j.getMedia().getDisplayElement().webkitSupportsFullscreen)&&d.useNativeFullscreen()){return true}return false}this.setupInstream=function(U,V){d.css(_instreamArea,{display:"block",position:"absolute"});o.style.display="none";_instreamArea.appendChild(U);u=V;S=true};var D=this.destroyInstream=function(){_instreamArea.style.display="none";_instreamArea.innerHTML="";o.style.display="block";u=null;S=false;G(j.width,j.height)}};a.html5.view.positions={TOP:"TOP",RIGHT:"RIGHT",BOTTOM:"BOTTOM",LEFT:"LEFT",OVER:"OVER",NONE:"NONE"}})(jwplayer);(function(a){var b={backgroundcolor:"",margin:10,font:"Arial,sans-serif",fontsize:10,fontcolor:parseInt("000000",16),fontstyle:"normal",fontweight:"bold",buttoncolor:parseInt("ffffff",16),position:a.html5.view.positions.BOTTOM,idlehide:false,hideplaylistcontrols:false,forcenextprev:false,layout:{left:{position:"left",elements:[{name:"play",type:"button"},{name:"divider",type:"divider"},{name:"prev",type:"button"},{name:"divider",type:"divider"},{name:"next",type:"button"},{name:"divider",type:"divider"},{name:"elapsed",type:"text"}]},center:{position:"center",elements:[{name:"time",type:"slider"}]},right:{position:"right",elements:[{name:"duration",type:"text"},{name:"blank",type:"button"},{name:"divider",type:"divider"},{name:"mute",type:"button"},{name:"volume",type:"slider"},{name:"divider",type:"divider"},{name:"fullscreen",type:"button"}]}}};_utils=a.utils;_css=_utils.css;_hide=function(c){_css(c,{display:"none"})};_show=function(c){_css(c,{display:"block"})};a.html5.controlbar=function(m,Y){window.controlbar=this;var l=m;var D=_utils.extend({},b,l.skin.getComponentSettings("controlbar"),Y);if(D.position==a.html5.view.positions.NONE||typeof a.html5.view.positions[D.position]=="undefined"){return}if(_utils.mapLength(l.skin.getComponentLayout("controlbar"))>0){D.layout=l.skin.getComponentLayout("controlbar")}var ag;var R;var af;var E;var w="none";var h;var k;var ah;var g;var f;var z;var S={};var q=false;var c={};var Q=-1;var ac;var j=false;var p;var d;var V=false;var G=false;var H;var aa=new a.html5.eventdispatcher();_utils.extend(this,aa);function K(){if(!ac){ac=l.skin.getSkinElement("controlbar","background");if(!ac){ac={width:0,height:0,src:null}}}return ac}function O(){af=0;E=0;R=0;if(!q){var ap={height:K().height,backgroundColor:D.backgroundcolor};ag=document.createElement("div");ag.id=l.id+"_jwplayer_controlbar";_css(ag,ap)}var ao=(l.skin.getSkinElement("controlbar","capLeft"));var an=(l.skin.getSkinElement("controlbar","capRight"));if(ao){y("capLeft","left",false,ag)}ad("background",ag,{position:"absolute",height:K().height,left:(ao?ao.width:0),zIndex:0},"img");if(K().src){S.background.src=K().src}ad("elements",ag,{position:"relative",height:K().height,zIndex:1});if(an){y("capRight","right",false,ag)}}this.getDisplayElement=function(){return ag};this.resize=function(ap,an){T();_utils.cancelAnimation(ag);f=ap;z=an;if(G!=l.jwGetFullscreen()){G=l.jwGetFullscreen();if(!G){Z()}d=undefined}var ao=x();J({id:l.id,duration:ah,position:k});v({id:l.id,bufferPercent:g});return ao};this.show=function(){if(j){j=false;_show(ag);W()}};this.hide=function(){if(!j){j=true;_hide(ag);ae()}};function r(){var ao=["timeSlider","volumeSlider","timeSliderRail","volumeSliderRail"];for(var ap in ao){var an=ao[ap];if(typeof S[an]!="undefined"){c[an]=_utils.getBoundingClientRect(S[an])}}}var e;function Z(an){if(j){return}clearTimeout(p);if(D.position==a.html5.view.positions.OVER||l.jwGetFullscreen()){switch(l.jwGetState()){case a.api.events.state.PAUSED:case a.api.events.state.IDLE:if(ag&&ag.style.opacity<1&&(!D.idlehide||_utils.exists(an))){e=false;setTimeout(function(){if(!e){X()}},100)}if(D.idlehide){p=setTimeout(function(){A()},2000)}break;default:e=true;if(an){X()}p=setTimeout(function(){A()},2000);break}}else{X()}}function A(){if(!j){ae();if(ag.style.opacity==1){_utils.cancelAnimation(ag);_utils.fadeTo(ag,0,0.1,1,0)}}}function X(){if(!j){W();if(ag.style.opacity==0){_utils.cancelAnimation(ag);_utils.fadeTo(ag,1,0.1,0,0)}}}function I(an){return function(){if(V&&d!=an){d=an;aa.sendEvent(an,{component:"controlbar",boundingRect:P()})}}}var W=I(a.api.events.JWPLAYER_COMPONENT_SHOW);var ae=I(a.api.events.JWPLAYER_COMPONENT_HIDE);function P(){if(D.position==a.html5.view.positions.OVER||l.jwGetFullscreen()){return _utils.getDimensions(ag)}else{return{x:0,y:0,width:0,height:0}}}function ad(ar,aq,ap,an){var ao;if(!q){if(!an){an="div"}ao=document.createElement(an);S[ar]=ao;ao.id=ag.id+"_"+ar;aq.appendChild(ao)}else{ao=document.getElementById(ag.id+"_"+ar)}if(_utils.exists(ap)){_css(ao,ap)}return ao}function N(){if(l.jwGetHeight()<=40){D.layout=_utils.clone(D.layout);for(var an=0;an<D.layout.left.elements.length;an++){if(D.layout.left.elements[an].name=="fullscreen"){D.layout.left.elements.splice(an,1)}}for(an=0;an<D.layout.right.elements.length;an++){if(D.layout.right.elements[an].name=="fullscreen"){D.layout.right.elements.splice(an,1)}}o()}am(D.layout.left);am(D.layout.center);am(D.layout.right)}function am(aq,an){var ar=aq.position=="right"?"right":"left";var ap=_utils.extend([],aq.elements);if(_utils.exists(an)){ap.reverse()}var aq=ad(aq.position+"Group",S.elements,{"float":"left",styleFloat:"left",cssFloat:"left",height:"100%"});for(var ao=0;ao<ap.length;ao++){C(ap[ao],ar,aq)}}function L(){return R++}function C(ar,au,aw){var aq,ao,ap,an,ax;if(!aw){aw=S.elements}if(ar.type=="divider"){y("divider"+L(),au,true,aw,undefined,ar.width,ar.element);return}switch(ar.name){case"play":y("playButton",au,false,aw);y("pauseButton",au,true,aw);U("playButton","jwPlay");U("pauseButton","jwPause");break;case"prev":y("prevButton",au,true,aw);U("prevButton","jwPlaylistPrev");break;case"stop":y("stopButton",au,true,aw);U("stopButton","jwStop");break;case"next":y("nextButton",au,true,aw);U("nextButton","jwPlaylistNext");break;case"elapsed":y("elapsedText",au,true,aw,null,null,l.skin.getSkinElement("controlbar","elapsedBackground"));break;case"time":ao=!_utils.exists(l.skin.getSkinElement("controlbar","timeSliderCapLeft"))?0:l.skin.getSkinElement("controlbar","timeSliderCapLeft").width;ap=!_utils.exists(l.skin.getSkinElement("controlbar","timeSliderCapRight"))?0:l.skin.getSkinElement("controlbar","timeSliderCapRight").width;aq=au=="left"?ao:ap;ax={height:K().height,position:"relative","float":"left",styleFloat:"left",cssFloat:"left"};var at=ad("timeSlider",aw,ax);y("timeSliderCapLeft",au,true,at,"relative");y("timeSliderRail",au,false,at,"relative");y("timeSliderBuffer",au,false,at,"absolute");y("timeSliderProgress",au,false,at,"absolute");y("timeSliderThumb",au,false,at,"absolute");y("timeSliderCapRight",au,true,at,"relative");ab("time");break;case"fullscreen":y("fullscreenButton",au,false,aw);y("normalscreenButton",au,true,aw);U("fullscreenButton","jwSetFullscreen",true);U("normalscreenButton","jwSetFullscreen",false);break;case"volume":ao=!_utils.exists(l.skin.getSkinElement("controlbar","volumeSliderCapLeft"))?0:l.skin.getSkinElement("controlbar","volumeSliderCapLeft").width;ap=!_utils.exists(l.skin.getSkinElement("controlbar","volumeSliderCapRight"))?0:l.skin.getSkinElement("controlbar","volumeSliderCapRight").width;aq=au=="left"?ao:ap;an=l.skin.getSkinElement("controlbar","volumeSliderRail").width+ao+ap;ax={height:K().height,position:"relative",width:an,"float":"left",styleFloat:"left",cssFloat:"left"};var av=ad("volumeSlider",aw,ax);y("volumeSliderCapLeft",au,false,av,"relative");y("volumeSliderRail",au,false,av,"relative");y("volumeSliderProgress",au,false,av,"absolute");y("volumeSliderThumb",au,false,av,"absolute");y("volumeSliderCapRight",au,false,av,"relative");ab("volume");break;case"mute":y("muteButton",au,false,aw);y("unmuteButton",au,true,aw);U("muteButton","jwSetMute",true);U("unmuteButton","jwSetMute",false);break;case"duration":y("durationText",au,true,aw,null,null,l.skin.getSkinElement("controlbar","durationBackground"));break}}function y(aq,au,ao,ax,ar,an,ap){if(_utils.exists(l.skin.getSkinElement("controlbar",aq))||aq.indexOf("Text")>0||aq.indexOf("divider")===0){var at={height:"100%",position:ar?ar:"relative",display:"block","float":"left",styleFloat:"left",cssFloat:"left"};if((aq.indexOf("next")===0||aq.indexOf("prev")===0)&&(l.jwGetPlaylist().length<2||D.hideplaylistcontrols.toString()=="true")){if(D.forcenextprev.toString()!="true"){ao=false;at.display="none"}}var ay;if(aq.indexOf("Text")>0){aq.innerhtml="00:00";at.font=D.fontsize+"px/"+(K().height+1)+"px "+D.font;at.color=D.fontcolor;at.textAlign="center";at.fontWeight=D.fontweight;at.fontStyle=D.fontstyle;at.cursor="default";if(ap){at.background="url("+ap.src+") no-repeat center";at.backgroundSize="100% "+K().height+"px"}at.padding="0 5px"}else{if(aq.indexOf("divider")===0){if(an){if(!isNaN(parseInt(an))){ay=parseInt(an)}}else{if(ap){var av=l.skin.getSkinElement("controlbar",ap);if(av){at.background="url("+av.src+") repeat-x center left";ay=av.width}}else{at.background="url("+l.skin.getSkinElement("controlbar","divider").src+") repeat-x center left";ay=l.skin.getSkinElement("controlbar","divider").width}}}else{at.background="url("+l.skin.getSkinElement("controlbar",aq).src+") repeat-x center left";ay=l.skin.getSkinElement("controlbar",aq).width}}if(au=="left"){if(ao){af+=ay}}else{if(au=="right"){if(ao){E+=ay}}}if(_utils.typeOf(ax)=="undefined"){ax=S.elements}at.width=ay;if(q){_css(S[aq],at)}else{var aw=ad(aq,ax,at);if(_utils.exists(l.skin.getSkinElement("controlbar",aq+"Over"))){aw.onmouseover=function(az){aw.style.backgroundImage=["url(",l.skin.getSkinElement("controlbar",aq+"Over").src,")"].join("")};aw.onmouseout=function(az){aw.style.backgroundImage=["url(",l.skin.getSkinElement("controlbar",aq).src,")"].join("")}}if(aq.indexOf("divider")==0){aw.setAttribute("class","divider")}aw.innerHTML="&nbsp;"}}}function F(){l.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,B);l.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,t);l.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_BUFFER,v);l.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,s);l.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_TIME,J);l.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_MUTE,al);l.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_VOLUME,n);l.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_COMPLETE,M)}function B(){if(!D.hideplaylistcontrols){if(l.jwGetPlaylist().length>1||D.forcenextprev.toString()=="true"){_show(S.nextButton);_show(S.prevButton)}else{_hide(S.nextButton);_hide(S.prevButton)}x();ai()}}function t(an){ah=l.jwGetPlaylist()[an.index].duration;Q=-1;J({id:l.id,duration:ah,position:0});v({id:l.id,bufferProgress:0})}function ai(){J({id:l.id,duration:l.jwGetDuration(),position:0});v({id:l.id,bufferProgress:0});al({id:l.id,mute:l.jwGetMute()});s({id:l.id,newstate:a.api.events.state.IDLE});n({id:l.id,volume:l.jwGetVolume()})}function U(ap,aq,ao){if(q){return}if(_utils.exists(l.skin.getSkinElement("controlbar",ap))){var an=S[ap];if(_utils.exists(an)){_css(an,{cursor:"pointer"});if(aq=="fullscreen"){an.onmouseup=function(ar){ar.stopPropagation();l.jwSetFullscreen(!l.jwGetFullscreen())}}else{an.onmouseup=function(ar){ar.stopPropagation();if(_utils.exists(ao)){l[aq](ao)}else{l[aq]()}}}}}}function ab(an){if(q){return}var ao=S[an+"Slider"];_css(S.elements,{cursor:"pointer"});_css(ao,{cursor:"pointer"});ao.onmousedown=function(ap){w=an};ao.onmouseup=function(ap){ap.stopPropagation();ak(ap.pageX)};ao.onmousemove=function(ap){if(w=="time"){h=true;var aq=ap.pageX-c[an+"Slider"].left-window.pageXOffset;_css(S[w+"SliderThumb"],{left:aq})}}}function ak(ao){h=false;var an;if(w=="time"){an=ao-c.timeSliderRail.left+window.pageXOffset;var aq=an/c.timeSliderRail.width*ah;if(aq<0){aq=0}else{if(aq>ah){aq=ah-3}}if(l.jwGetState()==a.api.events.state.PAUSED||l.jwGetState()==a.api.events.state.IDLE){l.jwPlay()}l.jwSeek(aq)}else{if(w=="volume"){an=ao-c.volumeSliderRail.left-window.pageXOffset;var ap=Math.round(an/c.volumeSliderRail.width*100);if(ap<10){ap=0}else{if(ap>100){ap=100}}if(l.jwGetMute()){l.jwSetMute(false)}l.jwSetVolume(ap)}}w="none"}function v(ao){if(_utils.exists(ao.bufferPercent)){g=ao.bufferPercent}if(c.timeSliderRail){var aq=l.skin.getSkinElement("controlbar","timeSliderCapLeft");var ap=c.timeSliderRail.width;var an=isNaN(Math.round(ap*g/100))?0:Math.round(ap*g/100);_css(S.timeSliderBuffer,{width:an,left:aq?aq.width:0})}}function al(an){if(an.mute){_hide(S.muteButton);_show(S.unmuteButton);_hide(S.volumeSliderProgress)}else{_show(S.muteButton);_hide(S.unmuteButton);_show(S.volumeSliderProgress)}}function s(an){if(an.newstate==a.api.events.state.BUFFERING||an.newstate==a.api.events.state.PLAYING){_show(S.pauseButton);_hide(S.playButton)}else{_hide(S.pauseButton);_show(S.playButton)}Z();if(an.newstate==a.api.events.state.IDLE){_hide(S.timeSliderBuffer);_hide(S.timeSliderProgress);_hide(S.timeSliderThumb);J({id:l.id,duration:l.jwGetDuration(),position:0})}else{_show(S.timeSliderBuffer);if(an.newstate!=a.api.events.state.BUFFERING){_show(S.timeSliderProgress);_show(S.timeSliderThumb)}}}function M(an){v({bufferPercent:0});J(_utils.extend(an,{position:0,duration:ah}))}function J(at){if(_utils.exists(at.position)){k=at.position}var ao=false;if(_utils.exists(at.duration)&&at.duration!=ah){ah=at.duration;ao=true}var aq=(k===ah===0)?0:k/ah;var av=c.timeSliderRail;if(av){var ap=isNaN(Math.round(av.width*aq))?0:Math.round(av.width*aq);var au=l.skin.getSkinElement("controlbar","timeSliderCapLeft");var ar=ap+(au?au.width:0);if(S.timeSliderProgress){_css(S.timeSliderProgress,{width:ap,left:au?au.width:0});if(!h){if(S.timeSliderThumb){S.timeSliderThumb.style.left=ar+"px"}}}}if(S.durationText){S.durationText.innerHTML=_utils.timeFormat(ah)}if(S.elapsedText){var an=_utils.timeFormat(k);S.elapsedText.innerHTML=an;if(Q!=an.length){ao=true;Q=an.length}}if(ao){x()}}function o(){var an=S.elements.childNodes;var at,aq;for(var ap=0;ap<an.length;ap++){var ar=an[ap].childNodes;for(var ao in ar){if(isNaN(parseInt(ao,10))){continue}if(ar[ao].id.indexOf(ag.id+"_divider")===0&&aq&&aq.id.indexOf(ag.id+"_divider")===0&&ar[ao].style.backgroundImage==aq.style.backgroundImage){ar[ao].style.display="none"}else{if(ar[ao].id.indexOf(ag.id+"_divider")===0&&at&&at.style.display!="none"){ar[ao].style.display="block"}}if(ar[ao].style.display!="none"){aq=ar[ao]}at=ar[ao]}}}function aj(){if(l.jwGetFullscreen()){_show(S.normalscreenButton);_hide(S.fullscreenButton)}else{_hide(S.normalscreenButton);_show(S.fullscreenButton)}if(l.jwGetState()==a.api.events.state.BUFFERING||l.jwGetState()==a.api.events.state.PLAYING){_show(S.pauseButton);_hide(S.playButton)}else{_hide(S.pauseButton);_show(S.playButton)}if(l.jwGetMute()==true){_hide(S.muteButton);_show(S.unmuteButton);_hide(S.volumeSliderProgress)}else{_show(S.muteButton);_hide(S.unmuteButton);_show(S.volumeSliderProgress)}}function x(){o();aj();var ap={width:f};var ax={"float":"left",styleFloat:"left",cssFloat:"left"};if(D.position==a.html5.view.positions.OVER||l.jwGetFullscreen()){ap.left=D.margin;ap.width-=2*D.margin;ap.top=z-K().height-D.margin;ap.height=K().height}var ar=l.skin.getSkinElement("controlbar","capLeft");var av=l.skin.getSkinElement("controlbar","capRight");ax.width=ap.width-(ar?ar.width:0)-(av?av.width:0);var aq=_utils.getBoundingClientRect(S.leftGroup).width;var au=_utils.getBoundingClientRect(S.rightGroup).width;var at=ax.width-aq-au-1;var ao=at;var an=l.skin.getSkinElement("controlbar","timeSliderCapLeft");var aw=l.skin.getSkinElement("controlbar","timeSliderCapRight");if(_utils.exists(an)){ao-=an.width}if(_utils.exists(aw)){ao-=aw.width}S.timeSlider.style.width=at+"px";S.timeSliderRail.style.width=ao+"px";_css(ag,ap);_css(S.elements,ax);_css(S.background,ax);r();return ap}function n(at){if(_utils.exists(S.volumeSliderRail)){var ap=isNaN(at.volume/100)?1:at.volume/100;var aq=_utils.parseDimension(S.volumeSliderRail.style.width);var an=isNaN(Math.round(aq*ap))?0:Math.round(aq*ap);var au=_utils.parseDimension(S.volumeSliderRail.style.right);var ao=(!_utils.exists(l.skin.getSkinElement("controlbar","volumeSliderCapLeft")))?0:l.skin.getSkinElement("controlbar","volumeSliderCapLeft").width;_css(S.volumeSliderProgress,{width:an,left:ao});if(S.volumeSliderThumb){var ar=(an-Math.round(_utils.parseDimension(S.volumeSliderThumb.style.width)/2));ar=Math.min(Math.max(ar,0),aq-_utils.parseDimension(S.volumeSliderThumb.style.width));_css(S.volumeSliderThumb,{left:ar})}if(_utils.exists(S.volumeSliderCapLeft)){_css(S.volumeSliderCapLeft,{left:0})}}}function T(){try{var ao=(l.id.indexOf("_instream")>0?l.id.replace("_instream",""):l.id);H=document.getElementById(ao);H.addEventListener("mousemove",Z)}catch(an){_utils.log("Could not add mouse listeners to controlbar: "+an)}}function u(){O();N();r();q=true;F();D.idlehide=(D.idlehide.toString().toLowerCase()=="true");if(D.position==a.html5.view.positions.OVER&&D.idlehide){ag.style.opacity=0;V=true}else{ag.style.opacity=1;setTimeout((function(){V=true;W()}),1)}T();ai()}u();return this}})(jwplayer);(function(b){var a=["width","height","state","playlist","item","position","buffer","duration","volume","mute","fullscreen"];var c=b.utils;b.html5.controller=function(o,K,f,h){var n=o,m=f,j=h,y=K,M=true,G=-1,A=false,d=false,P,C=[],q=false;var D=(c.exists(m.config.debug)&&(m.config.debug.toString().toLowerCase()=="console")),N=new b.html5.eventdispatcher(y.id,D);c.extend(this,N);function L(T){if(q){N.sendEvent(T.type,T)}else{C.push(T)}}function s(T){if(!q){q=true;N.sendEvent(b.api.events.JWPLAYER_READY,T);if(b.utils.exists(window.playerReady)){playerReady(T)}if(b.utils.exists(window[f.config.playerReady])){window[f.config.playerReady](T)}while(C.length>0){var V=C.shift();N.sendEvent(V.type,V)}if(f.config.autostart&&!b.utils.isIOS()){O()}while(x.length>0){var U=x.shift();B(U.method,U.arguments)}}}m.addGlobalListener(L);m.addEventListener(b.api.events.JWPLAYER_MEDIA_BUFFER_FULL,function(){m.getMedia().play()});m.addEventListener(b.api.events.JWPLAYER_MEDIA_TIME,function(T){if(T.position>=m.playlist[m.item].start&&G>=0){m.playlist[m.item].start=G;G=-1}});m.addEventListener(b.api.events.JWPLAYER_MEDIA_COMPLETE,function(T){setTimeout(E,25)});m.addEventListener(b.api.events.JWPLAYER_PLAYLIST_LOADED,O);m.addEventListener(b.api.events.JWPLAYER_FULLSCREEN,p);function F(){try{P=F;if(!A){A=true;N.sendEvent(b.api.events.JWPLAYER_MEDIA_BEFOREPLAY);A=false;if(d){d=false;P=null;return}}v(m.item);if(m.playlist[m.item].levels[0].file.length>0){if(M||m.state==b.api.events.state.IDLE){m.getMedia().load(m.playlist[m.item]);M=false}else{if(m.state==b.api.events.state.PAUSED){m.getMedia().play()}}}return true}catch(T){N.sendEvent(b.api.events.JWPLAYER_ERROR,T);P=null}return false}function e(){try{if(m.playlist[m.item].levels[0].file.length>0){switch(m.state){case b.api.events.state.PLAYING:case b.api.events.state.BUFFERING:if(m.getMedia()){m.getMedia().pause()}break;default:if(A){d=true}}}return true}catch(T){N.sendEvent(b.api.events.JWPLAYER_ERROR,T)}return false}function z(T){try{if(m.playlist[m.item].levels[0].file.length>0){if(typeof T!="number"){T=parseFloat(T)}switch(m.state){case b.api.events.state.IDLE:if(G<0){G=m.playlist[m.item].start;m.playlist[m.item].start=T}if(!A){F()}break;case b.api.events.state.PLAYING:case b.api.events.state.PAUSED:case b.api.events.state.BUFFERING:m.seek(T);break}}return true}catch(U){N.sendEvent(b.api.events.JWPLAYER_ERROR,U)}return false}function w(T){P=null;if(!c.exists(T)){T=true}try{if((m.state!=b.api.events.state.IDLE||T)&&m.getMedia()){m.getMedia().stop(T)}if(A){d=true}return true}catch(U){N.sendEvent(b.api.events.JWPLAYER_ERROR,U)}return false}function k(){try{if(m.playlist[m.item].levels[0].file.length>0){if(m.config.shuffle){v(S())}else{if(m.item+1==m.playlist.length){v(0)}else{v(m.item+1)}}}if(m.state!=b.api.events.state.IDLE){var U=m.state;m.state=b.api.events.state.IDLE;N.sendEvent(b.api.events.JWPLAYER_PLAYER_STATE,{oldstate:U,newstate:b.api.events.state.IDLE})}F();return true}catch(T){N.sendEvent(b.api.events.JWPLAYER_ERROR,T)}return false}function I(){try{if(m.playlist[m.item].levels[0].file.length>0){if(m.config.shuffle){v(S())}else{if(m.item===0){v(m.playlist.length-1)}else{v(m.item-1)}}}if(m.state!=b.api.events.state.IDLE){var U=m.state;m.state=b.api.events.state.IDLE;N.sendEvent(b.api.events.JWPLAYER_PLAYER_STATE,{oldstate:U,newstate:b.api.events.state.IDLE})}F();return true}catch(T){N.sendEvent(b.api.events.JWPLAYER_ERROR,T)}return false}function S(){var T=null;if(m.playlist.length>1){while(!c.exists(T)){T=Math.floor(Math.random()*m.playlist.length);if(T==m.item){T=null}}}else{T=0}return T}function H(U){if(!m.playlist||!m.playlist[U]){return false}try{if(m.playlist[U].levels[0].file.length>0){var V=m.state;if(V!==b.api.events.state.IDLE){if(m.playlist[m.item]&&m.playlist[m.item].provider==m.playlist[U].provider){w(false)}else{w()}}v(U);F()}return true}catch(T){N.sendEvent(b.api.events.JWPLAYER_ERROR,T)}return false}function v(T){if(!m.playlist[T]){return}m.setActiveMediaProvider(m.playlist[T]);if(m.item!=T){m.item=T;M=true;N.sendEvent(b.api.events.JWPLAYER_PLAYLIST_ITEM,{index:T})}}function g(U){try{v(m.item);var V=m.getMedia();switch(typeof(U)){case"number":V.volume(U);break;case"string":V.volume(parseInt(U,10));break}m.setVolume(U);return true}catch(T){N.sendEvent(b.api.events.JWPLAYER_ERROR,T)}return false}function r(U){try{v(m.item);var V=m.getMedia();if(typeof U=="undefined"){V.mute(!m.mute);m.setMute(!m.mute)}else{if(U.toString().toLowerCase()=="true"){V.mute(true);m.setMute(true)}else{V.mute(false);m.setMute(false)}}return true}catch(T){N.sendEvent(b.api.events.JWPLAYER_ERROR,T)}return false}function J(U,T){try{m.width=U;m.height=T;j.resize(U,T);N.sendEvent(b.api.events.JWPLAYER_RESIZE,{width:m.width,height:m.height});return true}catch(V){N.sendEvent(b.api.events.JWPLAYER_ERROR,V)}return false}function u(U,V){try{if(typeof U=="undefined"){U=!m.fullscreen}if(typeof V=="undefined"){V=true}if(U!=m.fullscreen){m.fullscreen=(U.toString().toLowerCase()=="true");j.fullscreen(m.fullscreen);if(V){N.sendEvent(b.api.events.JWPLAYER_FULLSCREEN,{fullscreen:m.fullscreen})}N.sendEvent(b.api.events.JWPLAYER_RESIZE,{width:m.width,height:m.height})}return true}catch(T){N.sendEvent(b.api.events.JWPLAYER_ERROR,T)}return false}function R(T){try{w();if(A){d=false}m.loadPlaylist(T);if(m.playlist[m.item].provider){v(m.item);if(m.config.autostart.toString().toLowerCase()=="true"&&!c.isIOS()&&!A){F()}return true}else{return false}}catch(U){N.sendEvent(b.api.events.JWPLAYER_ERROR,U)}return false}function O(T){if(!c.isIOS()){v(m.item);if(m.config.autostart.toString().toLowerCase()=="true"&&!c.isIOS()){F()}}}function p(T){u(T.fullscreen,false)}function t(){try{return m.getMedia().detachMedia()}catch(T){return null}}function l(){try{var T=m.getMedia().attachMedia();if(typeof P=="function"){P()}}catch(U){return null}}b.html5.controller.repeatoptions={LIST:"LIST",ALWAYS:"ALWAYS",SINGLE:"SINGLE",NONE:"NONE"};function E(){if(m.state!=b.api.events.state.IDLE){return}P=E;switch(m.config.repeat.toUpperCase()){case b.html5.controller.repeatoptions.SINGLE:F();break;case b.html5.controller.repeatoptions.ALWAYS:if(m.item==m.playlist.length-1&&!m.config.shuffle){H(0)}else{k()}break;case b.html5.controller.repeatoptions.LIST:if(m.item==m.playlist.length-1&&!m.config.shuffle){w();v(0)}else{k()}break;default:w();break}}var x=[];function Q(T){return function(){if(q){B(T,arguments)}else{x.push({method:T,arguments:arguments})}}}function B(V,U){var T=[];for(i=0;i<U.length;i++){T.push(U[i])}V.apply(this,T)}this.play=Q(F);this.pause=Q(e);this.seek=Q(z);this.stop=Q(w);this.next=Q(k);this.prev=Q(I);this.item=Q(H);this.setVolume=Q(g);this.setMute=Q(r);this.resize=Q(J);this.setFullscreen=Q(u);this.load=Q(R);this.playerReady=s;this.detachMedia=t;this.attachMedia=l;this.beforePlay=function(){return A};this.destroy=function(){if(m.getMedia()){m.getMedia().destroy()}}}})(jwplayer);(function(a){a.html5.defaultSkin=function(){this.text='<?xml version="1.0" ?><skin author="LongTail Video" name="Five" version="1.1"><components><component name="controlbar"><settings><setting name="margin" value="20"/><setting name="fontsize" value="11"/><setting name="fontcolor" value="0x000000"/></settings><layout><group position="left"><button name="play"/><divider name="divider"/><button name="prev"/><divider name="divider"/><button name="next"/><divider name="divider"/><text name="elapsed"/></group><group position="center"><slider name="time"/></group><group position="right"><text name="duration"/><divider name="divider"/><button name="blank"/><divider name="divider"/><button name="mute"/><slider name="volume"/><divider name="divider"/><button name="fullscreen"/></group></layout><elements><element name="background" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAIAAABvFaqvAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAElJREFUOI3t1LERACAMQlFgGvcfxNIhHMK4gsUvUviOmgtNsiAZkBSEKxKEnCYkkQrJn/YwbUNiSDDYRZaQRDaShv+oX9GBZEIuK+8hXVLs+/YAAAAASUVORK5CYII="/><element name="blankButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAYCAYAAAAyJzegAAAAFElEQVQYV2P8//8/AzpgHBUc7oIAGZdH0RjKN8EAAAAASUVORK5CYII="/><element name="capLeft" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAYCAYAAAA7zJfaAAAAQElEQVQIWz3LsRGAMADDQJ0XB5bMINABZ9GENGrszxhjT2WLSqxEJG2JQrTMdV2q5LpOAvyRaVmsi7WdeZ/7+AAaOTq7BVrfOQAAAABJRU5ErkJggg=="/><element name="capRight" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAYCAYAAAA7zJfaAAAAQElEQVQIWz3LsRGAMADDQJ0XB5bMINABZ9GENGrszxhjT2WLSqxEJG2JQrTMdV2q5LpOAvyRaVmsi7WdeZ/7+AAaOTq7BVrfOQAAAABJRU5ErkJggg=="/><element name="divider" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAYCAIAAAC0rgCNAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADhJREFUCB0FwcENgEAAw7Aq+893g8APUILNOQcbFRktVGqUVFRkWNz3xTa2sUaLNUosKlRUvvf5AdbWOTtzmzyWAAAAAElFTkSuQmCC"/><element name="playButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAANUlEQVR42u2RsQkAAAjD/NTTPaW6dXLrINJA1kBpGPMAjDWmOgp1HFQXx+b1KOefO4oxY57R73YnVYCQUCQAAAAASUVORK5CYII="/><element name="pauseButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAIUlEQVQ4jWNgGAWjYOiD/0gYG3/U0FFDB4Oho2AUDAYAAEwiL9HrpdMVAAAAAElFTkSuQmCC"/><element name="prevButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAQklEQVQ4y2NgGAWjYOiD/1AMA/JAfB5NjCJD/YH4PRaLyDa0H4lNNUP/DxlD59PCUBCIp3ZEwYA+NZLUKBgFgwEAAN+HLX9sB8u8AAAAAElFTkSuQmCC"/><element name="nextButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAYCAYAAAAVibZIAAAAQElEQVQ4y2NgGAWjYOiD/0B8Hojl0cT+U2ooCL8HYn9qGwrD/bQw9P+QMXQ+tSMqnpoRBUpS+tRMUqNgFAwGAADxZy1/mHvFnAAAAABJRU5ErkJggg=="/><element name="timeSliderRail" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAOElEQVRIDe3BwQkAIRADwAhhw/nU/kWwUK+KPITMABFh19Y+F0acY8CJvX9wYpXgRElwolSIiMf9ZWEDhtwurFsAAAAASUVORK5CYII="/><element name="timeSliderBuffer" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAN0lEQVRIDe3BwQkAMQwDMBcc55mRe9zi7RR+FCwBEWG39vcfGHFm4MTuhhMlwYlVBSdKhYh43AW/LQMKm1spzwAAAABJRU5ErkJggg=="/><element name="timeSliderProgress" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAIElEQVRIiWNgGAWjYBTQBfynMR61YCRYMApGwSigMQAAiVWPcbq6UkIAAAAASUVORK5CYII="/><element name="timeSliderThumb" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAYCAYAAAA/OUfnAAAAO0lEQVQYlWP4//8/Awwz0JgDBP/BeN6Cxf/hnI2btiI4u/fsQ3AOHjqK4Jw4eQbBOX/hEoKDYjSd/AMA4cS4mfLsorgAAAAASUVORK5CYII="/><element name="muteButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAYCAYAAADKx8xXAAAAJklEQVQ4y2NgGAUjDcwH4v/kaPxPikZkxcNVI9mBQ5XoGAWDFwAAsKAXKQQmfbUAAAAASUVORK5CYII="/><element name="unmuteButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAYCAYAAADKx8xXAAAAMklEQVQ4y2NgGAWDHPyntub5xBr6Hwv/Pzk2/yfVG/8psRFE25Oq8T+tQnsIaB4FVAcAi2YVysVY52AAAAAASUVORK5CYII="/><element name="volumeSliderRail" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYAgMAAACdGdVrAAAACVBMVEUAAACmpqampqbBXAu8AAAAAnRSTlMAgJsrThgAAAArSURBVAhbY2AgErBAyA4I2QEhOyBkB4TsYOhAoaCCUCUwDTDtMMNgRuMHAFB5FoGH5T0UAAAAAElFTkSuQmCC"/><element name="volumeSliderProgress" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYAgMAAACdGdVrAAAACVBMVEUAAAAAAAAAAACDY+nAAAAAAnRSTlMAgJsrThgAAAArSURBVAhbY2AgErBAyA4I2QEhOyBkB4TsYOhAoaCCUCUwDTDtMMNgRuMHAFB5FoGH5T0UAAAAAElFTkSuQmCC"/><element name="volumeSliderCapRight" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAYCAYAAAAyJzegAAAAFElEQVQYV2P8//8/AzpgHBUc7oIAGZdH0RjKN8EAAAAASUVORK5CYII="/><element name="fullscreenButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAQklEQVRIiWNgGAWjYMiD/0iYFDmSLbDHImdPLQtgBpEiR7Zl2NijAA5oEkT/0Whi5UiyAJ8BVMsHNMtoo2AUDAIAAGdcIN3IDNXoAAAAAElFTkSuQmCC"/><element name="normalscreenButton" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAP0lEQVRIx2NgGAWjYMiD/1RSQ5QB/wmIUWzJfzx8qhj+n4DYCAY0DyJ7PBbYU8sHMEvwiZFtODXUjIJRMJgBACpWIN2ZxdPTAAAAAElFTkSuQmCC"/></elements></component><component name="display"><elements><element name="background" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyAQMAAAAk8RryAAAABlBMVEUAAAAAAAClZ7nPAAAAAnRSTlOZpuml+rYAAAASSURBVBhXY2AYJuA/GBwY6jQAyDyoK8QcL4QAAAAASUVORK5CYII="/><element name="playIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAiUlEQVR42u3XSw2AMBREURwgAQlIQAISKgUpSEFKJeCg5b0E0kWBTVcD9ySTsL0Jn9IBAAAA+K2UUrBlW/Rr5ZDoIeeuoFkxJD9ss03aIXXQqB9SttoG7ZA6qNcOKdttiwcJh9RB+iFl4SshkRBuLR72+9cvH0SOKI2HRo7x/Fi1/uoCAAAAwLsD8ki99IlO2dQAAAAASUVORK5CYII="/><element name="muteIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAVUlEQVR42u3WMQrAIAxAUW/g/SdvGmvpoOBeSHgPsjj5QTANAACARCJilIhYM0tEvJM+Ik3Id9E957kQIb+F3OdCPC0hPkQriqWx9hp/x/QGAABQyAPLB22VGrpLDgAAAABJRU5ErkJggg=="/><element name="errorIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAA/0lEQVR42u2U0QmEMBAF7cASLMESUoIlpARLSCkpwRJSgiWkhOvAXD4WsgRkyaG5DbyB+Yvg8KITAAAAAAAYk+u61mwk15EjPtlEfihmqIiZR1Qx80ghjgdUuiHXGHSVsoag0x6x8DUoyjD5KovmEJ9NTDMRPIT0mtdIUkjlonuNohO+Ha99DTmkuGgKCTcvebAzx82ZoCWC3/3aIMWSRucaxcjORSFY4xpFdjYJGp1rFGcyCYZ/RVh6AUnfcNZ2zih3/mGj1jVCdiNDwyrq1rA/xMdeEXvDVdnYc1vDc3uPkDObXrlaxbNHSOohQhr/WOeLEWfWTgAAAAAAADzNF9sHJ7PJ57MlAAAAAElFTkSuQmCC"/><element name="bufferIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAACBklEQVR42u3Zv0sCYRzH8USTzOsHHEWGkC1HgaDgkktGDjUYtDQ01RDSljQ1BLU02+rk1NTm2NLq4Nx/0L/h9fnCd3j4cnZe1/U8xiO8h3uurufF0/3COd/3/0UWYiEWYiEWYiGJQ+J8xuPxKhXjEMZANinjIZhkGuVRNioE4wVURo4JkHm0xKWmhRAc1bh1EyCUw5BcBIjHiApKa4CErko6DEJwuRo6IRKzyJD8FJAyI3Zp2zRImiBcRhlfo5RtlxCcE3CcDNpGrhYIT2IhAJKilO0VRmzJ32fAMTpBTS0QMfGwlcuKMRftE0DJ0wCJdcOsCkBdXP3Mh9CEFUBTPS9mDZJBG6io4aqVzMdCokCw9H3kT6j/C/9iDdSeUMNC7DkyyxAs/Rk6Qss8FPWRZgdVtUH4DjxEn1zxh+/zj1wHlf4MQhNGrwqA6sY40U8JonRJwEQh+AO3AvCG6gHv4U7IY4krxkroWoAOkoQMGfCBrgIm+YBGqPENpIJ66CJg3x66Y0gnSUidAEEnNr9jjLiWMn5DiWP0OC/oAsCgkq43xBdGDMQr7YASP/vEkHvdl1+JOCcEV5sC4hGEOzTlPuKgd0b0xD4JkRcOgnRRTjdErkYhAsQVq6IdUuPJtmk7BCL3t/h88cx91pKQkI/pkDx6pmYTIjEoxiHsN1YWYiEWYiEWknhflZ5IErA5nr8AAAAASUVORK5CYII="/></elements></component><component name="dock"><settings><setting name="fontcolor" value="0xffffff"/></settings><elements><element name="button" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyAQMAAAAk8RryAAAABlBMVEUAAAAAAAClZ7nPAAAAAnRSTlOZpuml+rYAAAASSURBVBhXY2AYJuA/GBwY6jQAyDyoK8QcL4QAAAAASUVORK5CYII="/></elements></component><component name="playlist"><settings><setting name="backgroundcolor" value="0xe8e8e8"/></settings><elements><element name="item" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAIAAAC1nk4lAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHBJREFUaN7t2MENwCAMBEEe9N8wSKYC/D8YV7CyJoRkVtVImxkZPQInMxoP0XiIxkM0HsGbjjSNBx544IEHHnjggUe/6UQeey0PIh7XTftGxKPj4eXCtLsHHh+ZxkO0Iw8PR55Ni8ZD9Hu/EAoP0dc5RRg9qeRjVF8AAAAASUVORK5CYII="/><element name="sliderCapTop" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAHCAYAAADnCQYGAAAAFUlEQVQokWP8//8/A7UB46ihI9hQAKt6FPPXhVGHAAAAAElFTkSuQmCC"/><element name="sliderRail" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAUCAYAAABiS3YzAAAAKElEQVQ4y2P4//8/Az68bNmy/+iYkB6GUUNHDR01dNTQUUNHDaXcUABUDOKhcxnsSwAAAABJRU5ErkJggg=="/><element name="sliderThumb" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAUCAYAAABiS3YzAAAAJUlEQVQ4T2P4//8/Ay4MBP9xYbz6Rg0dNXTU0FFDRw0dNZRyQwHH4NBa7GJsXAAAAABJRU5ErkJggg=="/><element name="sliderCapBottom" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAHCAYAAADnCQYGAAAAFUlEQVQokWP8//8/A7UB46ihI9hQAKt6FPPXhVGHAAAAAElFTkSuQmCC"/></elements></component></components></skin>';this.xml=null;if(window.DOMParser){parser=new DOMParser();this.xml=parser.parseFromString(this.text,"text/xml")}else{this.xml=new ActiveXObject("Microsoft.XMLDOM");this.xml.async="false";this.xml.loadXML(this.text)}return this}})(jwplayer);(function(a){_utils=a.utils;_css=_utils.css;_hide=function(b){_css(b,{display:"none"})};_show=function(b){_css(b,{display:"block"})};a.html5.display=function(k,K){var j={icons:true,showmute:false};var X=_utils.extend({},j,K);var h=k;var W={};var e;var w;var z;var T;var u;var M;var E;var N=!_utils.exists(h.skin.getComponentSettings("display").bufferrotation)?15:parseInt(h.skin.getComponentSettings("display").bufferrotation,10);var s=!_utils.exists(h.skin.getComponentSettings("display").bufferinterval)?100:parseInt(h.skin.getComponentSettings("display").bufferinterval,10);var D=-1;var v=a.api.events.state.IDLE;var O=true;var d;var C=false,V=true;var p="";var g=false;var o=false;var m;var y,R;var L=new a.html5.eventdispatcher();_utils.extend(this,L);var H={display:{style:{cursor:"pointer",top:0,left:0,overflow:"hidden"},click:n},display_icon:{style:{cursor:"pointer",position:"absolute",top:((h.skin.getSkinElement("display","background").height-h.skin.getSkinElement("display","playIcon").height)/2),left:((h.skin.getSkinElement("display","background").width-h.skin.getSkinElement("display","playIcon").width)/2),border:0,margin:0,padding:0,zIndex:3,display:"none"}},display_iconBackground:{style:{cursor:"pointer",position:"absolute",top:((w-h.skin.getSkinElement("display","background").height)/2),left:((e-h.skin.getSkinElement("display","background").width)/2),border:0,backgroundImage:(["url(",h.skin.getSkinElement("display","background").src,")"]).join(""),width:h.skin.getSkinElement("display","background").width,height:h.skin.getSkinElement("display","background").height,margin:0,padding:0,zIndex:2,display:"none"}},display_image:{style:{display:"none",width:e,height:w,position:"absolute",cursor:"pointer",left:0,top:0,margin:0,padding:0,textDecoration:"none",zIndex:1}},display_text:{style:{zIndex:4,position:"relative",opacity:0.8,backgroundColor:parseInt("000000",16),color:parseInt("ffffff",16),textAlign:"center",fontFamily:"Arial,sans-serif",padding:"0 5px",fontSize:14}}};h.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,q);h.jwAddEventListener(a.api.events.JWPLAYER_MEDIA_MUTE,q);h.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,P);h.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,q);h.jwAddEventListener(a.api.events.JWPLAYER_ERROR,r);Q();function Q(){W.display=G("div","display");W.display_text=G("div","display_text");W.display.appendChild(W.display_text);W.display_image=G("img","display_image");W.display_image.onerror=function(Y){_hide(W.display_image)};W.display_image.onload=B;W.display_icon=G("div","display_icon");W.display_iconBackground=G("div","display_iconBackground");W.display.appendChild(W.display_image);W.display_iconBackground.appendChild(W.display_icon);W.display.appendChild(W.display_iconBackground);f();setTimeout((function(){o=true;if(X.icons.toString()=="true"){J()}}),1)}this.getDisplayElement=function(){return W.display};this.resize=function(Z,Y){if(h.jwGetFullscreen()&&_utils.isMobile()){return}_css(W.display,{width:Z,height:Y});_css(W.display_text,{width:(Z-10),top:((Y-_utils.getBoundingClientRect(W.display_text).height)/2)});_css(W.display_iconBackground,{top:((Y-h.skin.getSkinElement("display","background").height)/2),left:((Z-h.skin.getSkinElement("display","background").width)/2)});if(e!=Z||w!=Y){e=Z;w=Y;d=undefined;J()}if(!h.jwGetFullscreen()){y=Z;R=Y}c();q({})};this.show=function(){if(g){g=false;t(h.jwGetState())}};this.hide=function(){if(!g){F();g=true}};function B(Y){z=W.display_image.naturalWidth;T=W.display_image.naturalHeight;c();if(h.jwGetState()==a.api.events.state.IDLE||h.jwGetPlaylist()[h.jwGetPlaylistIndex()].provider=="sound"){_css(W.display_image,{display:"block",opacity:0});_utils.fadeTo(W.display_image,1,0.1)}C=false}function c(){if(h.jwGetFullscreen()&&h.jwGetStretching()==a.utils.stretching.EXACTFIT){var Y=document.createElement("div");_utils.stretch(a.utils.stretching.UNIFORM,Y,e,w,y,R);_utils.stretch(a.utils.stretching.EXACTFIT,W.display_image,_utils.parseDimension(Y.style.width),_utils.parseDimension(Y.style.height),z,T);_css(W.display_image,{left:Y.style.left,top:Y.style.top})}else{_utils.stretch(h.jwGetStretching(),W.display_image,e,w,z,T)}}function G(Y,aa){var Z=document.createElement(Y);Z.id=h.id+"_jwplayer_"+aa;_css(Z,H[aa].style);return Z}function f(){for(var Y in W){if(_utils.exists(H[Y].click)){W[Y].onclick=H[Y].click}}}function n(Y){if(typeof Y.preventDefault!="undefined"){Y.preventDefault()}else{Y.returnValue=false}if(typeof m=="function"){m(Y);return}else{if(h.jwGetState()!=a.api.events.state.PLAYING){h.jwPlay()}else{h.jwPause()}}}function U(Y){if(E){F();return}W.display_icon.style.backgroundImage=(["url(",h.skin.getSkinElement("display",Y).src,")"]).join("");_css(W.display_icon,{width:h.skin.getSkinElement("display",Y).width,height:h.skin.getSkinElement("display",Y).height,top:(h.skin.getSkinElement("display","background").height-h.skin.getSkinElement("display",Y).height)/2,left:(h.skin.getSkinElement("display","background").width-h.skin.getSkinElement("display",Y).width)/2});b();if(_utils.exists(h.skin.getSkinElement("display",Y+"Over"))){W.display_icon.onmouseover=function(Z){W.display_icon.style.backgroundImage=["url(",h.skin.getSkinElement("display",Y+"Over").src,")"].join("")};W.display_icon.onmouseout=function(Z){W.display_icon.style.backgroundImage=["url(",h.skin.getSkinElement("display",Y).src,")"].join("")}}else{W.display_icon.onmouseover=null;W.display_icon.onmouseout=null}}function F(){if(X.icons.toString()=="true"){_hide(W.display_icon);_hide(W.display_iconBackground);S()}}function b(){if(!g&&X.icons.toString()=="true"){_show(W.display_icon);_show(W.display_iconBackground);J()}}function r(Y){E=true;F();W.display_text.innerHTML=Y.message;_show(W.display_text);W.display_text.style.top=((w-_utils.getBoundingClientRect(W.display_text).height)/2)+"px"}function I(){V=false;W.display_image.style.display="none"}function P(){v=""}function q(Y){if((Y.type==a.api.events.JWPLAYER_PLAYER_STATE||Y.type==a.api.events.JWPLAYER_PLAYLIST_ITEM)&&E){E=false;_hide(W.display_text)}var Z=h.jwGetState();if(Z==v){return}v=Z;if(D>=0){clearTimeout(D)}if(O||h.jwGetState()==a.api.events.state.PLAYING||h.jwGetState()==a.api.events.state.PAUSED){t(h.jwGetState())}else{D=setTimeout(l(h.jwGetState()),500)}}function l(Y){return(function(){t(Y)})}function t(Y){if(_utils.exists(M)){clearInterval(M);M=null;_utils.animations.rotate(W.display_icon,0)}switch(Y){case a.api.events.state.BUFFERING:if(_utils.isIPod()){I();F()}else{if(h.jwGetPlaylist()[h.jwGetPlaylistIndex()].provider=="sound"){x()}u=0;M=setInterval(function(){u+=N;_utils.animations.rotate(W.display_icon,u%360)},s);U("bufferIcon");O=true}break;case a.api.events.state.PAUSED:if(!_utils.isIPod()){if(h.jwGetPlaylist()[h.jwGetPlaylistIndex()].provider!="sound"){_css(W.display_image,{background:"transparent no-repeat center center"})}U("playIcon");O=true}break;case a.api.events.state.IDLE:if(h.jwGetPlaylist()[h.jwGetPlaylistIndex()]&&h.jwGetPlaylist()[h.jwGetPlaylistIndex()].image){x()}else{I()}U("playIcon");O=true;break;default:if(h.jwGetPlaylist()[h.jwGetPlaylistIndex()]&&h.jwGetPlaylist()[h.jwGetPlaylistIndex()].provider=="sound"){if(_utils.isIPod()){I();O=false}else{x()}}else{I();O=false}if(h.jwGetMute()&&X.showmute){U("muteIcon")}else{F()}break}D=-1}function x(){if(h.jwGetPlaylist()[h.jwGetPlaylistIndex()]){var Y=h.jwGetPlaylist()[h.jwGetPlaylistIndex()].image;if(Y){if(Y!=p){p=Y;C=true;W.display_image.src=_utils.getAbsolutePath(Y)}else{if(!(C||V)){V=true;W.display_image.style.opacity=0;W.display_image.style.display="block";_utils.fadeTo(W.display_image,1,0.1)}}}}}function A(Y){return function(){if(!o){return}if(!g&&d!=Y){d=Y;L.sendEvent(Y,{component:"display",boundingRect:_utils.getDimensions(W.display_iconBackground)})}}}var J=A(a.api.events.JWPLAYER_COMPONENT_SHOW);var S=A(a.api.events.JWPLAYER_COMPONENT_HIDE);this.setAlternateClickHandler=function(Y){m=Y};this.revertAlternateClickHandler=function(){m=undefined};return this}})(jwplayer);(function(a){var c=a.utils;var b=c.css;a.html5.dock=function(w,D){function x(){return{align:a.html5.view.positions.RIGHT}}var n=c.extend({},x(),D);if(n.align=="FALSE"){return}var j={};var A=[];var k;var F;var f=false;var C=false;var g={x:0,y:0,width:0,height:0};var z;var o;var y;var m=new a.html5.eventdispatcher();c.extend(this,m);var r=document.createElement("div");r.id=w.id+"_jwplayer_dock";r.style.opacity=1;p();w.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,q);this.getDisplayElement=function(){return r};this.setButton=function(K,H,I,J){if(!H&&j[K]){c.arrays.remove(A,K);r.removeChild(j[K].div);delete j[K]}else{if(H){if(!j[K]){j[K]={}}j[K].handler=H;j[K].outGraphic=I;j[K].overGraphic=J;if(!j[K].div){A.push(K);j[K].div=document.createElement("div");j[K].div.style.position="absolute";r.appendChild(j[K].div);j[K].div.appendChild(document.createElement("div"));j[K].div.childNodes[0].style.position="relative";j[K].div.childNodes[0].style.width="100%";j[K].div.childNodes[0].style.height="100%";j[K].div.childNodes[0].style.zIndex=10;j[K].div.childNodes[0].style.cursor="pointer";j[K].div.appendChild(document.createElement("img"));j[K].div.childNodes[1].style.position="absolute";j[K].div.childNodes[1].style.left=0;j[K].div.childNodes[1].style.top=0;if(w.skin.getSkinElement("dock","button")){j[K].div.childNodes[1].src=w.skin.getSkinElement("dock","button").src}j[K].div.childNodes[1].style.zIndex=9;j[K].div.childNodes[1].style.cursor="pointer";j[K].div.onmouseover=function(){if(j[K].overGraphic){j[K].div.childNodes[0].style.background=h(j[K].overGraphic)}if(w.skin.getSkinElement("dock","buttonOver")){j[K].div.childNodes[1].src=w.skin.getSkinElement("dock","buttonOver").src}};j[K].div.onmouseout=function(){if(j[K].outGraphic){j[K].div.childNodes[0].style.background=h(j[K].outGraphic)}if(w.skin.getSkinElement("dock","button")){j[K].div.childNodes[1].src=w.skin.getSkinElement("dock","button").src}};if(w.skin.getSkinElement("dock","button")){j[K].div.childNodes[1].src=w.skin.getSkinElement("dock","button").src}}if(j[K].outGraphic){j[K].div.childNodes[0].style.background=h(j[K].outGraphic)}else{if(j[K].overGraphic){j[K].div.childNodes[0].style.background=h(j[K].overGraphic)}}if(H){j[K].div.onclick=function(L){L.preventDefault();a(w.id).callback(K);if(j[K].overGraphic){j[K].div.childNodes[0].style.background=h(j[K].overGraphic)}if(w.skin.getSkinElement("dock","button")){j[K].div.childNodes[1].src=w.skin.getSkinElement("dock","button").src}}}}}l(k,F)};function h(H){return"url("+H+") no-repeat center center"}function t(H){}function l(H,T){p();if(A.length>0){var I=10;var S=I;var P=-1;var Q=w.skin.getSkinElement("dock","button").height;var O=w.skin.getSkinElement("dock","button").width;var M=H-O-I;var R,L;if(n.align==a.html5.view.positions.LEFT){P=1;M=I}for(var J=0;J<A.length;J++){var U=Math.floor(S/T);if((S+Q+I)>((U+1)*T)){S=((U+1)*T)+I;U=Math.floor(S/T)}var K=j[A[J]].div;K.style.top=(S%T)+"px";K.style.left=(M+(w.skin.getSkinElement("dock","button").width+I)*U*P)+"px";var N={x:c.parseDimension(K.style.left),y:c.parseDimension(K.style.top),width:O,height:Q};if(!R||(N.x<=R.x&&N.y<=R.y)){R=N}if(!L||(N.x>=L.x&&N.y>=L.y)){L=N}K.style.width=O+"px";K.style.height=Q+"px";S+=w.skin.getSkinElement("dock","button").height+I}g={x:R.x,y:R.y,width:L.x-R.x+L.width,height:R.y-L.y+L.height}}if(C!=w.jwGetFullscreen()||k!=H||F!=T){k=H;F=T;C=w.jwGetFullscreen();z=undefined;setTimeout(s,1)}}function d(H){return function(){if(!f&&z!=H&&A.length>0){z=H;m.sendEvent(H,{component:"dock",boundingRect:g})}}}function q(H){if(c.isMobile()){if(H.newstate==a.api.events.state.IDLE){v()}else{e()}}else{B()}}function B(H){if(f){return}clearTimeout(y);if(D.position==a.html5.view.positions.OVER||w.jwGetFullscreen()){switch(w.jwGetState()){case a.api.events.state.PAUSED:case a.api.events.state.IDLE:if(r&&r.style.opacity<1&&(!D.idlehide||c.exists(H))){E()}if(D.idlehide){y=setTimeout(function(){u()},2000)}break;default:if(c.exists(H)){E()}y=setTimeout(function(){u()},2000);break}}else{E()}}var s=d(a.api.events.JWPLAYER_COMPONENT_SHOW);var G=d(a.api.events.JWPLAYER_COMPONENT_HIDE);this.resize=l;var v=function(){b(r,{display:"block"});if(f){f=false;s()}};var e=function(){b(r,{display:"none"});if(!f){G();f=true}};function u(){if(!f){G();if(r.style.opacity==1){c.cancelAnimation(r);c.fadeTo(r,0,0.1,1,0)}}}function E(){if(!f){s();if(r.style.opacity==0){c.cancelAnimation(r);c.fadeTo(r,1,0.1,0,0)}}}function p(){try{o=document.getElementById(w.id);o.addEventListener("mousemove",B)}catch(H){c.log("Could not add mouse listeners to dock: "+H)}}this.hide=e;this.show=v;return this}})(jwplayer);(function(a){a.html5.eventdispatcher=function(d,b){var c=new a.events.eventdispatcher(b);a.utils.extend(this,c);this.sendEvent=function(e,f){if(!a.utils.exists(f)){f={}}a.utils.extend(f,{id:d,version:a.version,type:e});c.sendEvent(e,f)}}})(jwplayer);(function(a){var b=a.utils;a.html5.instream=function(y,m,x,z){var t={controlbarseekable:"always",controlbarpausable:true,controlbarstoppable:true,playlistclickable:true};var v,A,C=y,E=m,j=x,w=z,r,H,o,G,e,f,g,l,q,h=false,k,d,n=this;this.load=function(M,K){c();h=true;A=b.extend(t,K);v=a.html5.playlistitem(M);F();d=document.createElement("div");d.id=n.id+"_instream_container";w.detachMedia();r=g.getDisplayElement();f=E.playlist[E.item];e=C.jwGetState();if(e==a.api.events.state.BUFFERING||e==a.api.events.state.PLAYING){r.pause()}H=r.src?r.src:r.currentSrc;o=r.innerHTML;G=r.currentTime;q=new a.html5.display(n,b.extend({},E.plugins.config.display));q.setAlternateClickHandler(function(N){if(_fakemodel.state==a.api.events.state.PAUSED){n.jwInstreamPlay()}else{D(a.api.events.JWPLAYER_INSTREAM_CLICK,N)}});d.appendChild(q.getDisplayElement());if(!b.isMobile()){l=new a.html5.controlbar(n,b.extend({},E.plugins.config.controlbar,{}));if(E.plugins.config.controlbar.position==a.html5.view.positions.OVER){d.appendChild(l.getDisplayElement())}else{var L=E.plugins.object.controlbar.getDisplayElement().parentNode;L.appendChild(l.getDisplayElement())}}j.setupInstream(d,r);p();g.load(v)};this.jwInstreamDestroy=function(K){if(!h){return}h=false;if(e!=a.api.events.state.IDLE){g.load(f,false);g.stop(false)}else{g.stop(true)}g.detachMedia();j.destroyInstream();if(l){try{l.getDisplayElement().parentNode.removeChild(l.getDisplayElement())}catch(L){}}D(a.api.events.JWPLAYER_INSTREAM_DESTROYED,{reason:(K?"complete":"destroyed")},true);w.attachMedia();if(e==a.api.events.state.BUFFERING||e==a.api.events.state.PLAYING){r.play();if(E.playlist[E.item]==f){E.getMedia().seek(G)}}return};this.jwInstreamAddEventListener=function(K,L){k.addEventListener(K,L)};this.jwInstreamRemoveEventListener=function(K,L){k.removeEventListener(K,L)};this.jwInstreamPlay=function(){if(!h){return}g.play(true)};this.jwInstreamPause=function(){if(!h){return}g.pause(true)};this.jwInstreamSeek=function(K){if(!h){return}g.seek(K)};this.jwInstreamGetState=function(){if(!h){return undefined}return _fakemodel.state};this.jwInstreamGetPosition=function(){if(!h){return undefined}return _fakemodel.position};this.jwInstreamGetDuration=function(){if(!h){return undefined}return _fakemodel.duration};this.playlistClickable=function(){return(!h||A.playlistclickable.toString().toLowerCase()=="true")};function s(){_fakemodel=new a.html5.model(this,E.getMedia()?E.getMedia().getDisplayElement():E.container,E);k=new a.html5.eventdispatcher();C.jwAddEventListener(a.api.events.JWPLAYER_RESIZE,p);C.jwAddEventListener(a.api.events.JWPLAYER_FULLSCREEN,p)}function c(){_fakemodel.setMute(E.mute);_fakemodel.setVolume(E.volume)}function F(){if(!g){g=new a.html5.mediavideo(_fakemodel,E.getMedia()?E.getMedia().getDisplayElement():E.container);g.addGlobalListener(I);g.addEventListener(a.api.events.JWPLAYER_MEDIA_META,J);g.addEventListener(a.api.events.JWPLAYER_MEDIA_COMPLETE,u);g.addEventListener(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL,B)}g.attachMedia()}function I(K){if(h){D(K.type,K)}}function B(K){if(h){g.play()}}function u(K){if(h){setTimeout(function(){n.jwInstreamDestroy(true)},10)}}function J(K){if(K.metadata.width&&K.metadata.height){j.resizeMedia()}}function D(K,L,M){if(h||M){k.sendEvent(K,L)}}function p(){var K=E.plugins.object.display.getDisplayElement().style;if(l){var L=E.plugins.object.controlbar.getDisplayElement().style;l.resize(b.parseDimension(K.width),b.parseDimension(K.height));_css(l.getDisplayElement(),b.extend({},L,{zIndex:1001,opacity:1}))}if(q){q.resize(b.parseDimension(K.width),b.parseDimension(K.height));_css(q.getDisplayElement(),b.extend({},K,{zIndex:1000}))}if(j){j.resizeMedia()}}this.jwPlay=function(K){if(A.controlbarpausable.toString().toLowerCase()=="true"){this.jwInstreamPlay()}};this.jwPause=function(K){if(A.controlbarpausable.toString().toLowerCase()=="true"){this.jwInstreamPause()}};this.jwStop=function(){if(A.controlbarstoppable.toString().toLowerCase()=="true"){this.jwInstreamDestroy();C.jwStop()}};this.jwSeek=function(K){switch(A.controlbarseekable.toLowerCase()){case"always":this.jwInstreamSeek(K);break;case"backwards":if(_fakemodel.position>K){this.jwInstreamSeek(K)}break}};this.jwGetPosition=function(){};this.jwGetDuration=function(){};this.jwGetWidth=C.jwGetWidth;this.jwGetHeight=C.jwGetHeight;this.jwGetFullscreen=C.jwGetFullscreen;this.jwSetFullscreen=C.jwSetFullscreen;this.jwGetVolume=function(){return E.volume};this.jwSetVolume=function(K){g.volume(K);C.jwSetVolume(K)};this.jwGetMute=function(){return E.mute};this.jwSetMute=function(K){g.mute(K);C.jwSetMute(K)};this.jwGetState=function(){return _fakemodel.state};this.jwGetPlaylist=function(){return[v]};this.jwGetPlaylistIndex=function(){return 0};this.jwGetStretching=function(){return E.config.stretching};this.jwAddEventListener=function(L,K){k.addEventListener(L,K)};this.jwRemoveEventListener=function(L,K){k.removeEventListener(L,K)};this.skin=C.skin;this.id=C.id+"_instream";s();return this}})(jwplayer);(function(a){var b={prefix:"",file:"",link:"",linktarget:"_top",margin:8,out:0.5,over:1,timeout:5,hide:true,position:"bottom-left"};_css=a.utils.css;a.html5.logo=function(n,r){var q=n;var u;var d;var t;var h=false;g();function g(){o();q.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,j);c();l()}function o(){if(b.prefix){var v=n.version.split(/\W/).splice(0,2).join("/");if(b.prefix.indexOf(v)<0){b.prefix+=v+"/"}}if(r.position==a.html5.view.positions.OVER){r.position=b.position}try{if(window.location.href.indexOf("https")==0){b.prefix=b.prefix.replace("http://l.longtailvideo.com","https://securel.longtailvideo.com")}}catch(w){}d=a.utils.extend({},b,r)}function c(){t=document.createElement("img");t.id=q.id+"_jwplayer_logo";t.style.display="none";t.onload=function(v){_css(t,k());p()};if(!d.file){return}if(d.file.indexOf("/")>=0){t.src=d.file}else{t.src=d.prefix+d.file}}if(!d.file){return}this.resize=function(w,v){};this.getDisplayElement=function(){return t};function l(){if(d.link){t.onmouseover=f;t.onmouseout=p;t.onclick=s}else{this.mouseEnabled=false}}function s(v){if(typeof v!="undefined"){v.stopPropagation()}if(!h){return}q.jwPause();q.jwSetFullscreen(false);if(d.link){window.open(d.link,d.linktarget)}return}function p(v){if(d.link&&h){t.style.opacity=d.out}return}function f(v){if(h){t.style.opacity=d.over}return}function k(){var x={textDecoration:"none",position:"absolute",cursor:"pointer"};x.display=(d.hide.toString()=="true"&&!h)?"none":"block";var w=d.position.toLowerCase().split("-");for(var v in w){x[w[v]]=parseInt(d.margin)}return x}function m(){if(d.hide.toString()=="true"){t.style.display="block";t.style.opacity=0;a.utils.fadeTo(t,d.out,0.1,parseFloat(t.style.opacity));u=setTimeout(function(){e()},d.timeout*1000)}h=true}function e(){h=false;if(d.hide.toString()=="true"){a.utils.fadeTo(t,0,0.1,parseFloat(t.style.opacity))}}function j(v){if(v.newstate==a.api.events.state.BUFFERING){clearTimeout(u);m()}}return this}})(jwplayer);(function(b){var d={ended:b.api.events.state.IDLE,playing:b.api.events.state.PLAYING,pause:b.api.events.state.PAUSED,buffering:b.api.events.state.BUFFERING};var f=b.utils;var a=f.isMobile();var g,e;var c={};b.html5.mediavideo=function(k,I){var M={abort:A,canplay:r,canplaythrough:r,durationchange:w,emptied:A,ended:r,error:q,loadeddata:w,loadedmetadata:w,loadstart:r,pause:r,play:A,playing:r,progress:G,ratechange:A,seeked:r,seeking:r,stalled:r,suspend:r,timeupdate:Q,volumechange:n,waiting:r,canshowcurrentframe:A,dataunavailable:A,empty:A,load:j,loadedfirstframe:A,webkitfullscreenchange:m};var E={};var N=new b.html5.eventdispatcher();f.extend(this,N);var l=k,D=I,o,h,F,W,H,P,O=false,v=false,z=false,L,J,T;U();this.load=function(Y,Z){if(typeof Z=="undefined"){Z=true}if(!v){return}W=Y;z=(W.duration>0);l.duration=W.duration;f.empty(o);o.style.display="block";o.style.opacity=1;if(g&&e){o.style.width=g;o.style.height=e;g=_previousHieght=0}T=0;s(Y.levels);if(Y.levels&&Y.levels.length>0){if(Y.levels.length==1||f.isIOS()){o.src=Y.levels[0].file}else{if(o.src){o.removeAttribute("src")}for(var X=0;X<Y.levels.length;X++){var aa=o.ownerDocument.createElement("source");aa.src=Y.levels[X].file;o.appendChild(aa);T++}}}else{o.src=Y.file}o.volume=l.volume/100;o.muted=l.mute;if(a){S()}L=J=F=false;l.buffer=0;if(!f.exists(Y.start)){Y.start=0}P=(Y.start>0)?Y.start:-1;u(b.api.events.JWPLAYER_MEDIA_LOADED);if((!a&&Y.levels.length==1)||!O){o.load()}O=false;if(Z){y(b.api.events.state.BUFFERING);u(b.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:0});C()}if(o.videoWidth>0&&o.videoHeight>0){w()}};this.play=function(){if(!v){return}C();if(J){y(b.api.events.state.PLAYING)}else{o.load();y(b.api.events.state.BUFFERING)}o.play()};this.pause=function(){if(!v){return}o.pause();y(b.api.events.state.PAUSED)};this.seek=function(X){if(!v){return}if(!F&&o.readyState>0){if(!(l.duration<=0||isNaN(l.duration))&&!(l.position<=0||isNaN(l.position))){o.currentTime=X;o.play()}}else{P=X}};var B=this.stop=function(X){if(!v){return}if(!f.exists(X)){X=true}t();if(X){J=false;var Y=navigator.userAgent;if(o.webkitSupportsFullscreen){try{o.webkitExitFullscreen()}catch(Z){}}o.style.opacity=0;x();if(f.isIE()){o.src=""}else{o.removeAttribute("src")}f.empty(o);o.load();O=true}if(f.isIPod()){g=o.style.width;e=o.style.height;o.style.width=0;o.style.height=0}else{if(f.isIPad()){o.style.display="none";try{o.webkitExitFullscreen()}catch(aa){}}}y(b.api.events.state.IDLE)};this.fullscreen=function(X){if(X===true){this.resize("100%","100%")}else{this.resize(l.config.width,l.config.height)}};this.resize=function(Y,X){};this.volume=function(X){if(!a){o.volume=X/100;u(b.api.events.JWPLAYER_MEDIA_VOLUME,{volume:(X/100)})}};this.mute=function(X){if(!a){o.muted=X;u(b.api.events.JWPLAYER_MEDIA_MUTE,{mute:X})}};this.getDisplayElement=function(){return o};this.hasChrome=function(){return a&&(h==b.api.events.state.PLAYING)};this.detachMedia=function(){v=false;return this.getDisplayElement()};this.attachMedia=function(){v=true};this.destroy=function(){if(o&&o.parentNode){t();for(var X in M){o.removeEventListener(X,K(X,M[X]),true)}f.empty(o);D=o.parentNode;o.parentNode.removeChild(o);delete c[l.id];o=null}};function K(Y,X){if(E[Y]){return E[Y]}else{E[Y]=function(Z){if(f.exists(Z.target.parentNode)){X(Z)}};return E[Y]}}function U(){h=b.api.events.state.IDLE;v=true;o=p();o.setAttribute("x-webkit-airplay","allow");if(D.parentNode){o.id=D.id;D.parentNode.replaceChild(o,D)}}function p(){var X=c[l.id];if(!X){if(D.tagName.toLowerCase()=="video"){X=D}else{X=document.createElement("video")}c[l.id]=X;if(!X.id){X.id=D.id}}for(var Y in M){X.addEventListener(Y,K(Y,M[Y]),true)}return X}function y(X){if(X==b.api.events.state.PAUSED&&h==b.api.events.state.IDLE){return}if(a){switch(X){case b.api.events.state.PLAYING:S();break;case b.api.events.state.BUFFERING:case b.api.events.state.PAUSED:x();break}}if(h!=X){var Y=h;l.state=h=X;u(b.api.events.JWPLAYER_PLAYER_STATE,{oldstate:Y,newstate:X})}}function A(X){}function n(X){var Y=Math.round(o.volume*100);u(b.api.events.JWPLAYER_MEDIA_VOLUME,{volume:Y},true);u(b.api.events.JWPLAYER_MEDIA_MUTE,{mute:o.muted},true)}function G(Z){if(!v){return}var Y;if(f.exists(Z)&&Z.lengthComputable&&Z.total){Y=Z.loaded/Z.total*100}else{if(f.exists(o.buffered)&&(o.buffered.length>0)){var X=o.buffered.length-1;if(X>=0){Y=o.buffered.end(X)/o.duration*100}}}if(f.useNativeFullscreen()&&f.exists(o.webkitDisplayingFullscreen)){if(l.fullscreen!=o.webkitDisplayingFullscreen){u(b.api.events.JWPLAYER_FULLSCREEN,{fullscreen:o.webkitDisplayingFullscreen},true)}}if(J===false&&h==b.api.events.state.BUFFERING){u(b.api.events.JWPLAYER_MEDIA_BUFFER_FULL);J=true}if(!L){if(Y==100){L=true}if(f.exists(Y)&&(Y>l.buffer)){l.buffer=Math.round(Y);u(b.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:Math.round(Y)})}}}function Q(Y){if(!v){return}if(f.exists(Y)&&f.exists(Y.target)){if(z>0){if(!isNaN(Y.target.duration)&&(isNaN(l.duration)||l.duration<1)){if(Y.target.duration==Infinity){l.duration=0}else{l.duration=Math.round(Y.target.duration*10)/10}}}if(!F&&o.readyState>0){y(b.api.events.state.PLAYING)}if(h==b.api.events.state.PLAYING){if(o.readyState>0&&(P>-1||!F)){F=true;try{if(o.currentTime!=P&&P>-1){o.currentTime=P;P=-1}}catch(X){}o.volume=l.volume/100;o.muted=l.mute}l.position=l.duration>0?(Math.round(Y.target.currentTime*10)/10):0;u(b.api.events.JWPLAYER_MEDIA_TIME,{position:l.position,duration:l.duration});if(l.position>=l.duration&&(l.position>0||l.duration>0)){R();return}}}G(Y)}function j(X){}function r(X){if(!v){return}if(g&&e){o.style.width=g;o.style.height=e;g=_previousHieght=0}if(d[X.type]){if(X.type=="ended"){R()}else{y(d[X.type])}}}function w(Y){if(!v){return}var X=Math.round(o.duration*10)/10;var Z={height:o.videoHeight,width:o.videoWidth,duration:X};if(!z){if((l.duration<X||isNaN(l.duration))&&o.duration!=Infinity){l.duration=X}}u(b.api.events.JWPLAYER_MEDIA_META,{metadata:Z})}function q(Z){if(!v){return}if(h==b.api.events.state.IDLE){return}var Y="There was an error: ";if((Z.target.error&&Z.target.tagName.toLowerCase()=="video")||Z.target.parentNode.error&&Z.target.parentNode.tagName.toLowerCase()=="video"){var X=!f.exists(Z.target.error)?Z.target.parentNode.error:Z.target.error;switch(X.code){case X.MEDIA_ERR_ABORTED:f.log("User aborted the video playback.");return;case X.MEDIA_ERR_NETWORK:Y="A network error caused the video download to fail part-way: ";break;case X.MEDIA_ERR_DECODE:Y="The video playback was aborted due to a corruption problem or because the video used features your browser did not support: ";break;case X.MEDIA_ERR_SRC_NOT_SUPPORTED:Y="The video could not be loaded, either because the server or network failed or because the format is not supported: ";break;default:Y="An unknown error occurred: ";break}}else{if(Z.target.tagName.toLowerCase()=="source"){T--;if(T>0){return}if(f.userAgentMatch(/firefox/i)){f.log("The video could not be loaded, either because the server or network failed or because the format is not supported.");B(false);return}else{Y="The video could not be loaded, either because the server or network failed or because the format is not supported: "}}else{f.log("An unknown error occurred.  Continuing...");return}}B(false);Y+=V();_error=true;u(b.api.events.JWPLAYER_ERROR,{message:Y});return}function V(){var Z="";for(var Y in W.levels){var X=W.levels[Y];var aa=D.ownerDocument.createElement("source");Z+=b.utils.getAbsolutePath(X.file);if(Y<(W.levels.length-1)){Z+=", "}}return Z}function C(){if(!f.exists(H)){H=setInterval(function(){G()},100)}}function t(){clearInterval(H);H=null}function R(){if(h==b.api.events.state.PLAYING){B(false);u(b.api.events.JWPLAYER_MEDIA_BEFORECOMPLETE);u(b.api.events.JWPLAYER_MEDIA_COMPLETE)}}function m(X){if(f.exists(o.webkitDisplayingFullscreen)){if(l.fullscreen&&!o.webkitDisplayingFullscreen){u(b.api.events.JWPLAYER_FULLSCREEN,{fullscreen:false},true)}}}function s(Z){if(Z.length>0&&f.userAgentMatch(/Safari/i)&&!f.userAgentMatch(/Chrome/i)){var X=-1;for(var Y=0;Y<Z.length;Y++){switch(f.extension(Z[Y].file)){case"mp4":if(X<0){X=Y}break;case"webm":Z.splice(Y,1);break}}if(X>0){var aa=Z.splice(X,1)[0];Z.unshift(aa)}}}function S(){setTimeout(function(){o.setAttribute("controls","controls")},100)}function x(){setTimeout(function(){o.removeAttribute("controls")},250)}function u(X,Z,Y){if(v||Y){if(Z){N.sendEvent(X,Z)}else{N.sendEvent(X)}}}}})(jwplayer);(function(a){var c={ended:a.api.events.state.IDLE,playing:a.api.events.state.PLAYING,pause:a.api.events.state.PAUSED,buffering:a.api.events.state.BUFFERING};var b=a.utils.css;a.html5.mediayoutube=function(j,e){var f=new a.html5.eventdispatcher();a.utils.extend(this,f);var l=j;var h=document.getElementById(e.id);var g=a.api.events.state.IDLE;var n,m;function k(p){if(g!=p){var q=g;l.state=p;g=p;f.sendEvent(a.api.events.JWPLAYER_PLAYER_STATE,{oldstate:q,newstate:p})}}this.getDisplayElement=this.detachMedia=function(){return h};this.attachMedia=function(){};this.play=function(){if(g==a.api.events.state.IDLE){f.sendEvent(a.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:100});f.sendEvent(a.api.events.JWPLAYER_MEDIA_BUFFER_FULL);k(a.api.events.state.PLAYING)}else{if(g==a.api.events.state.PAUSED){k(a.api.events.state.PLAYING)}}};this.pause=function(){k(a.api.events.state.PAUSED)};this.seek=function(p){};this.stop=function(p){if(!_utils.exists(p)){p=true}l.position=0;k(a.api.events.state.IDLE);if(p){b(h,{display:"none"})}};this.volume=function(p){l.setVolume(p);f.sendEvent(a.api.events.JWPLAYER_MEDIA_VOLUME,{volume:Math.round(p)})};this.mute=function(p){h.muted=p;f.sendEvent(a.api.events.JWPLAYER_MEDIA_MUTE,{mute:p})};this.resize=function(q,p){if(q*p>0&&n){n.width=m.width=q;n.height=m.height=p}};this.fullscreen=function(p){if(p===true){this.resize("100%","100%")}else{this.resize(l.config.width,l.config.height)}};this.load=function(p){o(p);b(n,{display:"block"});k(a.api.events.state.BUFFERING);f.sendEvent(a.api.events.JWPLAYER_MEDIA_BUFFER,{bufferPercent:0});f.sendEvent(a.api.events.JWPLAYER_MEDIA_LOADED);this.play()};this.hasChrome=function(){return(g!=a.api.events.state.IDLE)};function o(v){var s=v.levels[0].file;s=["http://www.youtube.com/v/",d(s),"&amp;hl=en_US&amp;fs=1&autoplay=1"].join("");n=document.createElement("object");n.id=h.id;n.style.position="absolute";var u={movie:s,allowfullscreen:"true",allowscriptaccess:"always"};for(var p in u){var t=document.createElement("param");t.name=p;t.value=u[p];n.appendChild(t)}m=document.createElement("embed");n.appendChild(m);var q={src:s,type:"application/x-shockwave-flash",allowfullscreen:"true",allowscriptaccess:"always",width:n.width,height:n.height};for(var r in q){m.setAttribute(r,q[r])}n.appendChild(m);n.style.zIndex=2147483000;if(h!=n&&h.parentNode){h.parentNode.replaceChild(n,h)}h=n}function d(q){var p=q.split(/\?|\#\!/);var s="";for(var r=0;r<p.length;r++){if(p[r].substr(0,2)=="v="){s=p[r].substr(2)}}if(s==""){if(q.indexOf("/v/")>=0){s=q.substr(q.indexOf("/v/")+3)}else{if(q.indexOf("youtu.be")>=0){s=q.substr(q.indexOf("youtu.be/")+9)}else{s=q}}}if(s.indexOf("?")>-1){s=s.substr(0,s.indexOf("?"))}if(s.indexOf("&")>-1){s=s.substr(0,s.indexOf("&"))}return s}this.embed=m;return this}})(jwplayer);(function(jwplayer){var _configurableStateVariables=["width","height","start","duration","volume","mute","fullscreen","item","plugins","stretching"];var _utils=jwplayer.utils;jwplayer.html5.model=function(api,container,options){var _api=api;var _container=container;var _cookies=_utils.getCookies();var _model={id:_container.id,playlist:[],state:jwplayer.api.events.state.IDLE,position:0,buffer:0,container:_container,config:{width:480,height:320,item:-1,skin:undefined,file:undefined,image:undefined,start:0,duration:0,bufferlength:5,volume:_cookies.volume?_cookies.volume:90,mute:_cookies.mute&&_cookies.mute.toString().toLowerCase()=="true"?true:false,fullscreen:false,repeat:"",stretching:jwplayer.utils.stretching.UNIFORM,autostart:false,debug:undefined,screencolor:undefined}};var _media;var _eventDispatcher=new jwplayer.html5.eventdispatcher();var _components=["display","logo","controlbar","playlist","dock"];jwplayer.utils.extend(_model,_eventDispatcher);for(var option in options){if(typeof options[option]=="string"){var type=/color$/.test(option)?"color":null;options[option]=jwplayer.utils.typechecker(options[option],type)}var config=_model.config;var path=option.split(".");for(var edge in path){if(edge==path.length-1){config[path[edge]]=options[option]}else{if(!jwplayer.utils.exists(config[path[edge]])){config[path[edge]]={}}config=config[path[edge]]}}}for(var index in _configurableStateVariables){var configurableStateVariable=_configurableStateVariables[index];_model[configurableStateVariable]=_model.config[configurableStateVariable]}var pluginorder=_components.concat([]);if(jwplayer.utils.exists(_model.plugins)){if(typeof _model.plugins=="string"){var userplugins=_model.plugins.split(",");for(var userplugin in userplugins){if(typeof userplugins[userplugin]=="string"){pluginorder.push(userplugins[userplugin].replace(/^\s+|\s+$/g,""))}}}}if(jwplayer.utils.isMobile()){pluginorder=["display","logo","dock","playlist"];if(!jwplayer.utils.exists(_model.config.repeat)){_model.config.repeat="list"}}else{if(_model.config.chromeless){pluginorder=["logo","dock","playlist"];if(!jwplayer.utils.exists(_model.config.repeat)){_model.config.repeat="list"}}}_model.plugins={order:pluginorder,config:{},object:{}};if(typeof _model.config.components!="undefined"){for(var component in _model.config.components){_model.plugins.config[component]=_model.config.components[component]}}var playlistVisible=false;for(var pluginIndex in _model.plugins.order){var pluginName=_model.plugins.order[pluginIndex];var pluginConfig=!jwplayer.utils.exists(_model.plugins.config[pluginName])?{}:_model.plugins.config[pluginName];_model.plugins.config[pluginName]=!jwplayer.utils.exists(_model.plugins.config[pluginName])?pluginConfig:jwplayer.utils.extend(_model.plugins.config[pluginName],pluginConfig);if(!jwplayer.utils.exists(_model.plugins.config[pluginName].position)){if(pluginName=="playlist"){_model.plugins.config[pluginName].position=jwplayer.html5.view.positions.NONE}else{_model.plugins.config[pluginName].position=jwplayer.html5.view.positions.OVER}}else{if(pluginName=="playlist"){playlistVisible=true}_model.plugins.config[pluginName].position=_model.plugins.config[pluginName].position.toString().toUpperCase()}}if(_model.plugins.config.controlbar&&playlistVisible){_model.plugins.config.controlbar.hideplaylistcontrols=true}if(typeof _model.plugins.config.dock!="undefined"){if(typeof _model.plugins.config.dock!="object"){var position=_model.plugins.config.dock.toString().toUpperCase();_model.plugins.config.dock={position:position}}if(typeof _model.plugins.config.dock.position!="undefined"){_model.plugins.config.dock.align=_model.plugins.config.dock.position;_model.plugins.config.dock.position=jwplayer.html5.view.positions.OVER}if(typeof _model.plugins.config.dock.idlehide=="undefined"){try{_model.plugins.config.dock.idlehide=_model.plugins.config.controlbar.idlehide}catch(e){}}}function _loadExternal(playlistfile){var loader=new jwplayer.html5.playlistloader();loader.addEventListener(jwplayer.api.events.JWPLAYER_PLAYLIST_LOADED,function(evt){_model.playlist=new jwplayer.html5.playlist(evt);_loadComplete(true)});loader.addEventListener(jwplayer.api.events.JWPLAYER_ERROR,function(evt){_model.playlist=new jwplayer.html5.playlist({playlist:[]});_loadComplete(false)});loader.load(playlistfile)}function _loadComplete(){if(_model.config.shuffle){_model.item=_getShuffleItem()}else{if(_model.config.item>=_model.playlist.length){_model.config.item=_model.playlist.length-1}else{if(_model.config.item<0){_model.config.item=0}}_model.item=_model.config.item}_model.position=0;_model.duration=_model.playlist.length>0?_model.playlist[_model.item].duration:0;_eventDispatcher.sendEvent(jwplayer.api.events.JWPLAYER_PLAYLIST_LOADED,{playlist:_model.playlist});_eventDispatcher.sendEvent(jwplayer.api.events.JWPLAYER_PLAYLIST_ITEM,{index:_model.item})}_model.loadPlaylist=function(arg){var input;if(typeof arg=="string"){if(arg.indexOf("[")==0||arg.indexOf("{")=="0"){try{input=eval(arg)}catch(err){input=arg}}else{input=arg}}else{input=arg}var config;switch(jwplayer.utils.typeOf(input)){case"object":config=input;break;case"array":config={playlist:input};break;default:config={file:input};break}_model.playlist=new jwplayer.html5.playlist(config);_model.item=_model.config.item>=0?_model.config.item:0;if(!_model.playlist[0].provider&&_model.playlist[0].file){_loadExternal(_model.playlist[0].file)}else{_loadComplete()}};function _getShuffleItem(){var result=null;if(_model.playlist.length>1){while(!jwplayer.utils.exists(result)){result=Math.floor(Math.random()*_model.playlist.length);if(result==_model.item){result=null}}}else{result=0}return result}function forward(evt){switch(evt.type){case jwplayer.api.events.JWPLAYER_MEDIA_LOADED:_container=_media.getDisplayElement();break;case jwplayer.api.events.JWPLAYER_MEDIA_MUTE:this.mute=evt.mute;break;case jwplayer.api.events.JWPLAYER_MEDIA_VOLUME:this.volume=evt.volume;break}_eventDispatcher.sendEvent(evt.type,evt)}var _mediaProviders={};_model.setActiveMediaProvider=function(playlistItem){if(playlistItem.provider=="audio"){playlistItem.provider="sound"}var provider=playlistItem.provider;var current=_media?_media.getDisplayElement():null;if(provider=="sound"||provider=="http"||provider==""){provider="video"}if(!jwplayer.utils.exists(_mediaProviders[provider])){switch(provider){case"video":_media=new jwplayer.html5.mediavideo(_model,current?current:_container);break;case"youtube":_media=new jwplayer.html5.mediayoutube(_model,current?current:_container);break}if(!jwplayer.utils.exists(_media)){return false}_media.addGlobalListener(forward);_mediaProviders[provider]=_media}else{if(_media!=_mediaProviders[provider]){if(_media){_media.stop()}_media=_mediaProviders[provider]}}return true};_model.getMedia=function(){return _media};_model.seek=function(pos){_eventDispatcher.sendEvent(jwplayer.api.events.JWPLAYER_MEDIA_SEEK,{position:_model.position,offset:pos});return _media.seek(pos)};_model.setVolume=function(newVol){_utils.saveCookie("volume",newVol);_model.volume=newVol};_model.setMute=function(state){_utils.saveCookie("mute",state);_model.mute=state};_model.setupPlugins=function(){if(!jwplayer.utils.exists(_model.plugins)||!jwplayer.utils.exists(_model.plugins.order)||_model.plugins.order.length==0){jwplayer.utils.log("No plugins to set up");return _model}for(var i=0;i<_model.plugins.order.length;i++){try{var pluginName=_model.plugins.order[i];if(jwplayer.utils.exists(jwplayer.html5[pluginName])){if(pluginName=="playlist"){_model.plugins.object[pluginName]=new jwplayer.html5.playlistcomponent(_api,_model.plugins.config[pluginName])}else{_model.plugins.object[pluginName]=new jwplayer.html5[pluginName](_api,_model.plugins.config[pluginName])}}else{_model.plugins.order.splice(plugin,plugin+1)}if(typeof _model.plugins.object[pluginName].addGlobalListener=="function"){_model.plugins.object[pluginName].addGlobalListener(forward)}}catch(err){jwplayer.utils.log("Could not setup "+pluginName)}}};return _model}})(jwplayer);(function(a){a.html5.playlist=function(b){var d=[];if(b.playlist&&b.playlist instanceof Array&&b.playlist.length>0){for(var c in b.playlist){if(!isNaN(parseInt(c))){d.push(new a.html5.playlistitem(b.playlist[c]))}}}else{d.push(new a.html5.playlistitem(b))}return d}})(jwplayer);(function(a){var c={size:180,position:a.html5.view.positions.NONE,itemheight:60,thumbs:true,fontcolor:"#000000",overcolor:"",activecolor:"",backgroundcolor:"#f8f8f8",font:"_sans",fontsize:"",fontstyle:"",fontweight:""};var b={_sans:"Arial, Helvetica, sans-serif",_serif:"Times, Times New Roman, serif",_typewriter:"Courier New, Courier, monospace"};_utils=a.utils;_css=_utils.css;_hide=function(d){_css(d,{display:"none"})};_show=function(d){_css(d,{display:"block"})};a.html5.playlistcomponent=function(r,C){var x=r;var e=a.utils.extend({},c,x.skin.getComponentSettings("playlist"),C);if(e.position==a.html5.view.positions.NONE||typeof a.html5.view.positions[e.position]=="undefined"){return}var y;var l;var D;var d;var g;var f;var k=-1;var h={background:undefined,item:undefined,itemOver:undefined,itemImage:undefined,itemActive:undefined};this.getDisplayElement=function(){return y};this.resize=function(G,E){l=G;D=E;if(x.jwGetFullscreen()){_hide(y)}else{var F={display:"block",width:l,height:D};_css(y,F)}};this.show=function(){_show(y)};this.hide=function(){_hide(y)};function j(){y=document.createElement("div");y.id=x.id+"_jwplayer_playlistcomponent";y.style.overflow="hidden";switch(e.position){case a.html5.view.positions.RIGHT:case a.html5.view.positions.LEFT:y.style.width=e.size+"px";break;case a.html5.view.positions.TOP:case a.html5.view.positions.BOTTOM:y.style.height=e.size+"px";break}B();if(h.item){e.itemheight=h.item.height}y.style.backgroundColor="#C6C6C6";x.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,s);x.jwAddEventListener(a.api.events.JWPLAYER_PLAYLIST_ITEM,v);x.jwAddEventListener(a.api.events.JWPLAYER_PLAYER_STATE,m)}function p(){var E=document.createElement("ul");_css(E,{width:y.style.width,minWidth:y.style.width,height:y.style.height,backgroundColor:e.backgroundcolor,backgroundImage:h.background?"url("+h.background.src+")":"",color:e.fontcolor,listStyle:"none",margin:0,padding:0,fontFamily:b[e.font]?b[e.font]:b._sans,fontSize:(e.fontsize?e.fontsize:11)+"px",fontStyle:e.fontstyle,fontWeight:e.fontweight,overflowY:"auto"});return E}function z(E){return function(){var F=f.getElementsByClassName("item")[E];var G=e.fontcolor;var H=h.item?"url("+h.item.src+")":"";if(E==x.jwGetPlaylistIndex()){if(e.activecolor!==""){G=e.activecolor}if(h.itemActive){H="url("+h.itemActive.src+")"}}_css(F,{color:e.overcolor!==""?e.overcolor:G,backgroundImage:h.itemOver?"url("+h.itemOver.src+")":H})}}function o(E){return function(){var F=f.getElementsByClassName("item")[E];var G=e.fontcolor;var H=h.item?"url("+h.item.src+")":"";if(E==x.jwGetPlaylistIndex()){if(e.activecolor!==""){G=e.activecolor}if(h.itemActive){H="url("+h.itemActive.src+")"}}_css(F,{color:G,backgroundImage:H})}}function q(J){var Q=d[J];var P=document.createElement("li");P.className="item";_css(P,{height:e.itemheight,display:"block",cursor:"pointer",backgroundImage:h.item?"url("+h.item.src+")":"",backgroundSize:"100% "+e.itemheight+"px"});P.onmouseover=z(J);P.onmouseout=o(J);var K=document.createElement("div");var G=new Image();var L=0;var M=0;var N=0;if(w()&&(Q.image||Q["playlist.image"]||h.itemImage)){G.className="image";if(h.itemImage){L=(e.itemheight-h.itemImage.height)/2;M=h.itemImage.width;N=h.itemImage.height}else{M=e.itemheight*4/3;N=e.itemheight}_css(K,{height:N,width:M,"float":"left",styleFloat:"left",cssFloat:"left",margin:"0 5px 0 0",background:"black",overflow:"hidden",margin:L+"px",position:"relative"});_css(G,{position:"relative"});K.appendChild(G);G.onload=function(){a.utils.stretch(a.utils.stretching.FILL,G,M,N,this.naturalWidth,this.naturalHeight)};if(Q["playlist.image"]){G.src=Q["playlist.image"]}else{if(Q.image){G.src=Q.image}else{if(h.itemImage){G.src=h.itemImage.src}}}P.appendChild(K)}var F=l-M-L*2;if(D<e.itemheight*d.length){F-=15}var E=document.createElement("div");_css(E,{position:"relative",height:"100%",overflow:"hidden"});var H=document.createElement("span");if(Q.duration>0){H.className="duration";_css(H,{fontSize:(e.fontsize?e.fontsize:11)+"px",fontWeight:(e.fontweight?e.fontweight:"bold"),width:"40px",height:e.fontsize?e.fontsize+10:20,lineHeight:24,"float":"right",styleFloat:"right",cssFloat:"right"});H.innerHTML=_utils.timeFormat(Q.duration);E.appendChild(H)}var O=document.createElement("span");O.className="title";_css(O,{padding:"5px 5px 0 "+(L?0:"5px"),height:e.fontsize?e.fontsize+10:20,lineHeight:e.fontsize?e.fontsize+10:20,overflow:"hidden","float":"left",styleFloat:"left",cssFloat:"left",width:((Q.duration>0)?F-50:F)-10+"px",fontSize:(e.fontsize?e.fontsize:13)+"px",fontWeight:(e.fontweight?e.fontweight:"bold")});O.innerHTML=Q?Q.title:"";E.appendChild(O);if(Q.description){var I=document.createElement("span");I.className="description";_css(I,{display:"block","float":"left",styleFloat:"left",cssFloat:"left",margin:0,paddingLeft:O.style.paddingLeft,paddingRight:O.style.paddingRight,lineHeight:(e.fontsize?e.fontsize+4:16)+"px",overflow:"hidden",position:"relative"});I.innerHTML=Q.description;E.appendChild(I)}P.appendChild(E);return P}function s(F){y.innerHTML="";d=t();if(!d){return}items=[];f=p();for(var G=0;G<d.length;G++){var E=q(G);E.onclick=A(G);f.appendChild(E);items.push(E)}k=x.jwGetPlaylistIndex();o(k)();y.appendChild(f);if(_utils.isIOS()&&window.iScroll){f.style.height=e.itemheight*d.length+"px";var H=new iScroll(y.id)}}function t(){var F=x.jwGetPlaylist();var G=[];for(var E=0;E<F.length;E++){if(!F[E]["ova.hidden"]){G.push(F[E])}}return G}function A(E){return function(){x.jwPlaylistItem(E);x.jwPlay(true)}}function n(){f.scrollTop=x.jwGetPlaylistIndex()*e.itemheight}function w(){return e.thumbs.toString().toLowerCase()=="true"}function v(E){if(k>=0){o(k)();k=E.index}o(E.index)();n()}function m(){if(e.position==a.html5.view.positions.OVER){switch(x.jwGetState()){case a.api.events.state.IDLE:_show(y);break;default:_hide(y);break}}}function B(){for(var E in h){h[E]=u(E)}}function u(E){return x.skin.getSkinElement("playlist",E)}j();return this}})(jwplayer);(function(b){b.html5.playlistitem=function(d){var e={author:"",date:"",description:"",image:"",link:"",mediaid:"",tags:"",title:"",provider:"",file:"",streamer:"",duration:-1,start:0,currentLevel:-1,levels:[]};var c=b.utils.extend({},e,d);if(c.type){c.provider=c.type;delete c.type}if(c.levels.length===0){c.levels[0]=new b.html5.playlistitemlevel(c)}if(!c.provider){c.provider=a(c.levels[0])}else{c.provider=c.provider.toLowerCase()}return c};function a(e){if(b.utils.isYouTube(e.file)){return"youtube"}else{var f=b.utils.extension(e.file);var c;if(f&&b.utils.extensionmap[f]){if(f=="m3u8"){return"video"}c=b.utils.extensionmap[f].html5}else{if(e.type){c=e.type}}if(c){var d=c.split("/")[0];if(d=="audio"){return"sound"}else{if(d=="video"){return d}}}}return""}})(jwplayer);(function(a){a.html5.playlistitemlevel=function(b){var d={file:"",streamer:"",bitrate:0,width:0};for(var c in d){if(a.utils.exists(b[c])){d[c]=b[c]}}return d}})(jwplayer);(function(a){a.html5.playlistloader=function(){var c=new a.html5.eventdispatcher();a.utils.extend(this,c);this.load=function(e){a.utils.ajax(e,d,b)};function d(g){var f=[];try{var f=a.utils.parsers.rssparser.parse(g.responseXML.firstChild);c.sendEvent(a.api.events.JWPLAYER_PLAYLIST_LOADED,{playlist:new a.html5.playlist({playlist:f})})}catch(h){b("Could not parse the playlist")}}function b(e){c.sendEvent(a.api.events.JWPLAYER_ERROR,{message:e?e:"Could not load playlist an unknown reason."})}}})(jwplayer);(function(a){a.html5.skin=function(){var b={};var c=false;this.load=function(d,e){new a.html5.skinloader(d,function(f){c=true;b=f;e()},function(){new a.html5.skinloader("",function(f){c=true;b=f;e()})})};this.getSkinElement=function(d,e){if(c){try{return b[d].elements[e]}catch(f){a.utils.log("No such skin component / element: ",[d,e])}}return null};this.getComponentSettings=function(d){if(c&&b&&b[d]){return b[d].settings}return null};this.getComponentLayout=function(d){if(c){return b[d].layout}return null}}})(jwplayer);(function(a){a.html5.skinloader=function(f,p,k){var o={};var c=p;var l=k;var e=true;var j;var n=f;var s=false;function m(){if(typeof n!="string"||n===""){d(a.html5.defaultSkin().xml)}else{a.utils.ajax(a.utils.getAbsolutePath(n),function(t){try{if(a.utils.exists(t.responseXML)){d(t.responseXML);return}}catch(u){h()}d(a.html5.defaultSkin().xml)},function(t){d(a.html5.defaultSkin().xml)})}}function d(y){var E=y.getElementsByTagName("component");if(E.length===0){return}for(var H=0;H<E.length;H++){var C=E[H].getAttribute("name");var B={settings:{},elements:{},layout:{}};o[C]=B;var G=E[H].getElementsByTagName("elements")[0].getElementsByTagName("element");for(var F=0;F<G.length;F++){b(G[F],C)}var z=E[H].getElementsByTagName("settings")[0];if(z&&z.childNodes.length>0){var K=z.getElementsByTagName("setting");for(var P=0;P<K.length;P++){var Q=K[P].getAttribute("name");var I=K[P].getAttribute("value");var x=/color$/.test(Q)?"color":null;o[C].settings[Q]=a.utils.typechecker(I,x)}}var L=E[H].getElementsByTagName("layout")[0];if(L&&L.childNodes.length>0){var M=L.getElementsByTagName("group");for(var w=0;w<M.length;w++){var A=M[w];o[C].layout[A.getAttribute("position")]={elements:[]};for(var O=0;O<A.attributes.length;O++){var D=A.attributes[O];o[C].layout[A.getAttribute("position")][D.name]=D.value}var N=A.getElementsByTagName("*");for(var v=0;v<N.length;v++){var t=N[v];o[C].layout[A.getAttribute("position")].elements.push({type:t.tagName});for(var u=0;u<t.attributes.length;u++){var J=t.attributes[u];o[C].layout[A.getAttribute("position")].elements[v][J.name]=J.value}if(!a.utils.exists(o[C].layout[A.getAttribute("position")].elements[v].name)){o[C].layout[A.getAttribute("position")].elements[v].name=t.tagName}}}}e=false;r()}}function r(){clearInterval(j);if(!s){j=setInterval(function(){q()},100)}}function b(y,x){var w=new Image();var t=y.getAttribute("name");var v=y.getAttribute("src");var A;if(v.indexOf("data:image/png;base64,")===0){A=v}else{var u=a.utils.getAbsolutePath(n);var z=u.substr(0,u.lastIndexOf("/"));A=[z,x,v].join("/")}o[x].elements[t]={height:0,width:0,src:"",ready:false,image:w};w.onload=function(B){g(w,t,x)};w.onerror=function(B){s=true;r();l()};w.src=A}function h(){for(var u in o){var w=o[u];for(var t in w.elements){var x=w.elements[t];var v=x.image;v.onload=null;v.onerror=null;delete x.image;delete w.elements[t]}delete o[u]}}function q(){for(var t in o){if(t!="properties"){for(var u in o[t].elements){if(!o[t].elements[u].ready){return}}}}if(e===false){clearInterval(j);c(o)}}function g(t,v,u){if(o[u]&&o[u].elements[v]){o[u].elements[v].height=t.height;o[u].elements[v].width=t.width;o[u].elements[v].src=t.src;o[u].elements[v].ready=true;r()}else{a.utils.log("Loaded an image for a missing element: "+u+"."+v)}}m()}})(jwplayer);(function(a){a.html5.api=function(c,p){var n={};var g=document.createElement("div");c.parentNode.replaceChild(g,c);g.id=c.id;n.version=a.version;n.id=g.id;var m=new a.html5.model(n,g,p);var k=new a.html5.view(n,g,m);var l=new a.html5.controller(n,g,m,k);n.skin=new a.html5.skin();n.jwPlay=function(q){if(typeof q=="undefined"){f()}else{if(q.toString().toLowerCase()=="true"){l.play()}else{l.pause()}}};n.jwPause=function(q){if(typeof q=="undefined"){f()}else{if(q.toString().toLowerCase()=="true"){l.pause()}else{l.play()}}};function f(){if(m.state==a.api.events.state.PLAYING||m.state==a.api.events.state.BUFFERING){l.pause()}else{l.play()}}n.jwStop=l.stop;n.jwSeek=l.seek;n.jwPlaylistItem=function(q){if(d){if(d.playlistClickable()){d.jwInstreamDestroy();return l.item(q)}}else{return l.item(q)}};n.jwPlaylistNext=l.next;n.jwPlaylistPrev=l.prev;n.jwResize=l.resize;n.jwLoad=l.load;n.jwDetachMedia=l.detachMedia;n.jwAttachMedia=l.attachMedia;function j(q){return function(){return m[q]}}function e(q,s,r){return function(){var t=m.plugins.object[q];if(t&&t[s]&&typeof t[s]=="function"){t[s].apply(t,r)}}}n.jwGetPlaylistIndex=j("item");n.jwGetPosition=j("position");n.jwGetDuration=j("duration");n.jwGetBuffer=j("buffer");n.jwGetWidth=j("width");n.jwGetHeight=j("height");n.jwGetFullscreen=j("fullscreen");n.jwSetFullscreen=l.setFullscreen;n.jwGetVolume=j("volume");n.jwSetVolume=l.setVolume;n.jwGetMute=j("mute");n.jwSetMute=l.setMute;n.jwGetStretching=function(){return m.stretching.toUpperCase()};n.jwGetState=j("state");n.jwGetVersion=function(){return n.version};n.jwGetPlaylist=function(){return m.playlist};n.jwAddEventListener=l.addEventListener;n.jwRemoveEventListener=l.removeEventListener;n.jwSendEvent=l.sendEvent;n.jwDockSetButton=function(t,q,r,s){if(m.plugins.object.dock&&m.plugins.object.dock.setButton){m.plugins.object.dock.setButton(t,q,r,s)}};n.jwControlbarShow=e("controlbar","show");n.jwControlbarHide=e("controlbar","hide");n.jwDockShow=e("dock","show");n.jwDockHide=e("dock","hide");n.jwDisplayShow=e("display","show");n.jwDisplayHide=e("display","hide");var d;n.jwLoadInstream=function(r,q){if(!d){d=new a.html5.instream(n,m,k,l)}setTimeout(function(){d.load(r,q)},10)};n.jwInstreamDestroy=function(){if(d){d.jwInstreamDestroy()}};n.jwInstreamAddEventListener=o("jwInstreamAddEventListener");n.jwInstreamRemoveEventListener=o("jwInstreamRemoveEventListener");n.jwInstreamGetState=o("jwInstreamGetState");n.jwInstreamGetDuration=o("jwInstreamGetDuration");n.jwInstreamGetPosition=o("jwInstreamGetPosition");n.jwInstreamPlay=o("jwInstreamPlay");n.jwInstreamPause=o("jwInstreamPause");n.jwInstreamSeek=o("jwInstreamSeek");function o(q){return function(){if(d&&typeof d[q]=="function"){return d[q].apply(this,arguments)}else{_utils.log("Could not call instream method - instream API not initialized")}}}n.jwDestroy=function(){l.destroy()};n.jwGetLevel=function(){};n.jwGetBandwidth=function(){};n.jwGetLockState=function(){};n.jwLock=function(){};n.jwUnlock=function(){};function b(){if(m.config.playlistfile){m.addEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,h);m.loadPlaylist(m.config.playlistfile)}else{if(typeof m.config.playlist=="string"){m.addEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,h);m.loadPlaylist(m.config.playlist)}else{m.loadPlaylist(m.config);setTimeout(h,25)}}}function h(q){m.removeEventListener(a.api.events.JWPLAYER_PLAYLIST_LOADED,h);m.setupPlugins();k.setup();var q={id:n.id,version:n.version};l.playerReady(q)}if(m.config.chromeless&&!a.utils.isIOS()){b()}else{n.skin.load(m.config.skin,b)}return n}})(jwplayer)};

CBCR3.namespace("CBCR3.SocialLinkPanel.Modules");CBCR3.SocialLinkPanel.Modules.FacebookModule=Class.create(CBCR3.SocialLinkPanel.Modules.SocialNetworkModuleBase,{initialize:function($super)
{$super("http://www.facebook.com/sharer.php?u=#{url}&t=#{title}","facebook");},render:function(permalink,shortLink,title)
{return this.createElement(permalink,title);}});

Event.observe(document,'dom:loaded',onClientLoad);Event.observe(window,'load',onWindowLoad);Event.observe(window,'unload',onWindowUnload);var _mtDebug=true;var _CBCMusicAdZone="music";var _searchlightPlayer=null;var _pollMaxVotesPerQuestion=1;function getCBCMusicAdZone(){return _CBCMusicAdZone;}
function setCBCMusicAdZone(value){if(value!=null&&value!="")
_CBCMusicAdZone=value;}
function _updatePollMaxVotesPerQuestion(votesPerQuestion)
{_pollMaxVotesPerQuestion=votesPerQuestion;}
function _getPollMaxVotesPerQuestion(){return _pollMaxVotesPerQuestion;}
function onClientLoad(event){Trace.write("mastertemplate.js onclientload cbcmusic ",_mtDebug);document.cookie='__utma=abcdef; expires=Fri, 3 Aug 2018 20:47:11 UTC; path=/';if(parent){parent.document.title=document.title;if(parent.onClientLoaded)
parent.onClientLoaded(event);}
fixLegacyPlayButtons();if(Prototype.Browser.MobileSafari&&CBCR3.environment().isIphone){$('r3player').remove();$$('.span-5').each(function(item){item.remove();});setMobilePlatform(true);}
else{_rotators.each(function(rotator){rotator.load();});}}
function onWindowLoad(event){Trace.write("mastertemplate.js onWindowLoad cbcmusic ",_mtDebug);initializePageButtons();parent.document.title=document.title;}
function setMobilePlatform(setting){if(parent)
parent.mobilePlatformReady=setting;}
function onWindowUnload(event){Trace.write("in mastertemplate.js onWindowUnload()",_mtDebug);if(playerInstanceService&&playerInstanceService.getInstance())
playerInstanceService.getInstance().unload();if(Prototype.Browser.MobileSafari&&CBCR3.environment().isIphone)
this.setMobilePlatform(false);if(parent&&parent.onClientUnloaded)
parent.onClientUnloaded();}
var _rotators=[];function registerRotator(rotator){_rotators.push(rotator);}
var playerInstanceService;var autoplayStreamService;function loadPlayer(masterPlayerInstance){try{Trace.write("mastertemplate.js cbcmusic -> loadPlayer",_mtDebug);playerInstanceService=new CBCR3.Player.Application.R3PlayerInstanceService();autoplayStreamService=CBCR3.Services.ServicesProvider.getInstanceOf("autoplayService");autoplayStreamService.addEventListener(CBCR3.Player.Events.AutoplayStream.permalinkReceived,autoplayStreamReceivedHandler);var r3Player=new CBCR3.Player.R3Player(masterPlayerInstance);playerInstanceService.setInstance(r3Player);r3Player.addEventListener(CBCR3.Player.Events.AuthenticationEvent.loginRequired,loginRequiredHandler);r3Player.addEventListener(CBCR3.Player.Events.PermalinkEvent.sendPermalink,permalinkHandler);r3Player.addEventListener(CBCR3.Player.Events.PermalinkEvent.trackAdded,trackAddedHandler);r3Player.addEventListener(CBCR3.Player.Events.PermalinkEvent.favouriteAdded,favouriteAddedHandler);r3Player.addEventListener(CBCR3.Player.Events.ThumbEvent.changed,thumbChangedHandler);r3Player.addEventListener(CBCR3.Player.Events.StwCueEvent.adBreak,updateAds);r3Player.addEventListener(CBCR3.Player.Events.StwCueEvent.endAdBreak,resetAds);masterPlayerInstance.addEventListener(CBCR3.Player.Events.PlaybackExceptionEvent.endOfPlaylist,autoplayStreamHandler);}catch(ex){Trace.error(ex);}}
function trackAddedHandler(){new CBCR3.Commons.Controls.ActionNotifier().notify("trackAdded");}
function favouriteAddedHandler(){try{new CBCR3.Commons.Controls.ActionNotifier().notify("favouriteAdded");}catch(e){Trace.error(e);}}
function thumbChangedHandler(event){if(event.data.thumbStatus=="up")
new CBCR3.Commons.Controls.ActionNotifier().notify("thumbUp");}
function getPlayerInstance(){return playerInstanceService.getInstance();}
function resumePlayer(){playerInstanceService.getInstance().resume();}
function checkEnvironment(){if(Prototype.Browser.MobileSafari&&CBCR3.environment().isIphone)
return;var flashDetector=new CBCR3.Commons.Controls.FlashDetector();flashDetector.check();}
function warnIe6(){var browserNotifier=new CBCR3.Commons.Controls.BrowserNotifier();browserNotifier.showAlert();}
function initializePageButtons(){var pageInitializer=new CBCR3.Application.PageInitializerProvider().getInstance();pageInitializer.addEventListener(CBCR3.Player.Events.PageEvent.playPermalink,playPermalinkHandler);pageInitializer.addEventListener(CBCR3.Player.Events.PageEvent.addPermalink,addPermalinkHandler);pageInitializer.addEventListener(CBCR3.Player.Events.PageEvent.favouritePermalink,favouritePermalinkHandler);pageInitializer.addEventListener(CBCR3.Player.Events.PageEvent.permalink,permalinkHandler);pageInitializer.addEventListener(CBCR3.Player.Events.PageEvent.playStream,playStreamHandler);pageInitializer.addEventListener(CBCR3.Player.Events.PageEvent.socialShare,socialShareHandler);pageInitializer.addEventListener(CBCR3.Player.Events.AuthenticationEvent.loginRequired,loginRequiredHandler);pageInitializer.registerNode(document.body);}
function playPermalinkHandler(event){try{Trace.write("playPermalinkHandler",_mtDebug);var isSearchlight=event.data.isSearchlight;var playerInst=playerInstanceService.getInstance();playerInst.setIsSearchlight(isSearchlight);playerInst.playPermalink(event.data.permalink);new CBCR3.Commons.Controls.ActionNotifier().notify("playlistPlayed");}catch(ex){Trace.error(ex);}}
function socialShareHandler(event){try{Trace.write("mastertemplate.js -> socialShareHandler()",_mtDebug);Trace.write(event,_mtDebug);CBCR3.SocialLinkPanel.SocialLinkPanelTasks.launchPanel(event.data.permalink,'',event.data.type);}catch(e){Trace.error(e);}}
function playStreamHandler(event){try{Trace.write("mastertemplate.js -> playStreamHandler()",_mtDebug);Trace.write(event,_mtDebug);var audioStream=this.getAudioStreamManager().getStreamByPermalink(event.data.streamPermalink);Trace.write("audioStream",_mtDebug);Trace.write(audioStream,_mtDebug);var playerInst=playerInstanceService.getInstance();playerInst.setIsSearchlight(false);playerInst.streamAudio(audioStream.roomid,event.data.streamPermalink,audioStream.mount,audioStream.name,audioStream.playpreroll,audioStream.prerollTarget);if($("videoPlayerContainer")!=undefined){var state=jwplayer(videos.videoPlayerId).getState();if(state=="PLAYING"){jwplayer(videos.videoPlayerId).pause();}}
new CBCR3.Commons.Controls.ActionNotifier().notify("streamPlayed");}catch(e){Trace.error(e);}}
function addPermalinkHandler(event){var helper=CBCR3.Panel.StreamPanelHelperProvider.getInstance();helper.addEventListener(CBCR3.Player.Events.PermalinkEvent.trackAdded,trackAddedHandler);helper.addEventListener(CBCR3.Player.Events.AuthenticationEvent.loginRequired,loginRequiredHandler);helper.addTrack(event.data.permalink);}
function favouritePermalinkHandler(event){try{Trace.write("favouritePermalinkHandler() -> mastertemplate.js",_mtDebug);new CBCR3.Player.Application.R3PlayerInstanceService().getInstance().addToFavourites(event.data.permalink);new CBCR3.Commons.Controls.ActionNotifier().notify("favouriteAdded");}catch(e){Trace.error(e);}}
function permalinkHandler(event){Trace.write("mastertemplate.js -> permalinkHandler()",true);Trace.write(event,true);CBCR3.SocialLinkPanel.SocialLinkPanelTasks.launchPanel(event.data.permalink,event.data.title,null,event.data);}
function fixLegacyPlayButtons(){$$("div.playButton img").each(function(button){button.src=CBCR3.Application.Config.applicationPath+"/images/playPermalink_small.gif";button.removeAttribute("onmousedown");button.removeAttribute("onmouseup");button.removeAttribute("onmouseout");button.removeAttribute("onmouseover");});}
function launchLogin(message){loginRequiredHandler(new CBCR3.Commons.Event(null,{message:message}));}
function loginRequiredHandler(event){Trace.write("mastertemplate -> loginRequiredHandler()",_mtDebug);CBCR3.Commons.LoginTasks.launchLogin(event.data.message,{loginUrl:"/login.aspx",returnUrl:window.location.href,signupUrl:"/signup.aspx",forgotUrl:"/password.aspx",facebookLoginUrl:FACEBOOK_LOGIN_URL});}
function forgotPassword(){CBCR3.Commons.PasswordTasks.launchPasswordWindow({passwordUrl:"/password.aspx"});}
var _iframeLeaderBoard=null;var _iframeBigBoxAd=null;var _origLeaderBoardSrc=null;var _origBigBoxAdSrc=null;var _leaderBoard=null;var _bigbox=null;document.observe("dom:loaded",function(){});function updateAds(event){try{Trace.write("mastertemplate.js -> updateAds()",_mtDebug);Trace.write(event,_mtDebug);if(event.data.cuePoint.adURL==null||event.data.cuePoint.adURL.blank())
return;}catch(e){Trace.error(e);}}
function resetAds(event){try{Trace.write("mastertemplate.js -> resetAds()",_mtDebug);Trace.write(event,_mtDebug);Trace.write("_origBigBoxAdSrc:"+_origBigBoxAdSrc,_mtDebug);Trace.write("_origLeaderBoardSrc:"+_origLeaderBoardSrc,_mtDebug);Trace.write("_iframeBigBoxAd.src:"+_iframeBigBoxAd.src,_mtDebug);Trace.write("_iframeLeaderBoard.src:"+_iframeLeaderBoard.src,_mtDebug);}catch(e)
{Trace.error(e);}}
function getSocketIO(){return parent.getSocketIO();}
function getNodeService(){return parent.getNodeListenerService();}
function getAudioStreamManager(){return parent.getAudioStreamManager();}
function clearMemberUserNameField(clientId){var inputName=$(clientId);if(inputName!=null){inputName.observe("focus",function(){if(inputName.value=="Member Name"){inputName.clear();inputName.addClassName("active");}});inputName.observe("blur",function(){if(inputName.value==""){inputName.value="Member Name";inputName.removeClassName("active");}});}}
function autoplayStreamHandler(event){autoplayStreamService.getStreamPermalinkFromPlaylistPermalink(event.target.playlistPlayer.permalink,autoplayStreamReceivedHandler);}
function autoplayStreamReceivedHandler(event){var pageInitializer=new CBCR3.Application.PageInitializerProvider().getInstance();pageInitializer.dispatchEvent(CBCR3.Player.Events.PageEvent.playStream,event.data);}
